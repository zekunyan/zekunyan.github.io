<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>åœŸåœŸå“¥çš„æŠ€æœ¯Blog</title>
  <subtitle>iOSï¼ŒAndroidç¨‹åºçŒ¿ï¼Œå–œæ¬¢Macã€Linuxã€å„ç§å¼€æºæŠ€æœ¯ï¼Œå„ç§è¯­è¨€</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://tutuge.me/"/>
  <updated>2016-12-25T14:29:38.000Z</updated>
  <id>http://tutuge.me/</id>
  
  <author>
    <name>ç‡•æ³½å ƒ</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¼€æºé¡¹ç›®-æ‹¼å›¾éªŒè¯æ§ä»¶TTGPuzzleVerifyçš„å®ç°</title>
    <link href="http://tutuge.me/2016/12/25/TTGPuzzleVerify/"/>
    <id>http://tutuge.me/2016/12/25/TTGPuzzleVerify/</id>
    <published>2016-12-25T10:15:40.000Z</published>
    <updated>2016-12-25T14:29:38.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘æŠ½ç©ºå†™äº†ä¸ªæ‹¼å›¾éªŒè¯æ§ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ°´å¹³ã€å‚ç›´ï¼Œæˆ–è€…ç›´æ¥æ‹–åŠ¨æ‹¼å›¾å—ï¼Œå®Œæˆæ‹¼å›¾å›¾æ¡ˆï¼Œæ¥å®ŒæˆéªŒè¯ã€‚æ‹¼å›¾å—çš„å½¢çŠ¶å¯ä»¥è‡ªå®šä¹‰ï¼Œé»˜è®¤æä¾›äº†ç»å…¸çš„æ‹¼å›¾å½¢çŠ¶ã€åœ†å½¢ã€æ­£æ–¹å½¢ï¼Œæ•´ä¸ªæ‹¼å›¾çš„å›¾æ¡ˆä¹Ÿæ˜¯æ”¯æŒä»å›¾ç‰‡ç”Ÿæˆçš„ã€‚</p>
<p><strong>CocoaPods</strong>: <code>pod &quot;TTGPuzzleVerify&quot;</code><br><strong>Github</strong>: <a href="https://github.com/zekunyan/TTGPuzzleVerify" target="_blank" rel="external">https://github.com/zekunyan/TTGPuzzleVerify</a></p>
<p><img src="http://zorrochen.qiniudn.com/blog_TTGPuzzleVerify_gif.gif" alt=""></p>
<p>æ¥ä¸‹æ¥ï¼Œè¯´è¯´TTGPuzzleVerifyçš„æ•´ä½“è®¾è®¡æ€è·¯å’Œå®ç°åŸç†ã€‚</p>
<a id="more"></a>
<h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><h3 id="ç»„æˆéƒ¨åˆ†"><a href="#ç»„æˆéƒ¨åˆ†" class="headerlink" title="ç»„æˆéƒ¨åˆ†"></a>ç»„æˆéƒ¨åˆ†</h3><p>å…ˆç›´è§‚ä¸Šåˆ†æä¸€ä¸‹æ§ä»¶çš„ç»„æˆéƒ¨åˆ†ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_TTGPuzzleVerify_1.png" alt="ç»„æˆéƒ¨åˆ†"></p>
<p>å¯ä»¥ç›´è§‚çœ‹å‡ºï¼Œæ§ä»¶åº”è¯¥ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p>
<ul>
<li>æ‹¼å›¾å—ï¼šå°±æ˜¯ä»åŸå›¾ä¸Š<strong>â€œæŠ â€</strong>å‡ºæ¥çš„æ‹¼å›¾å½¢çŠ¶çš„å›¾ç‰‡å—</li>
<li>åŸå§‹å›¾ç‰‡ï¼šæ‹¼å›¾æ•´ä½“å›¾æ¡ˆçš„å›¾ç‰‡</li>
<li>é•‚ç©ºèƒŒæ™¯ï¼šä»åŸå§‹å›¾ç‰‡ä¸ŠæŠ å‡ºæ‹¼å›¾å—ä»¥åï¼Œç»™ç”¨æˆ·æç¤ºç”¨çš„ï¼Œé€æ˜åº¦æ›´ä½çš„æ‹¼å›¾å—é•‚ç©ºèƒŒæ™¯</li>
</ul>
<h3 id="æ‹†è§£æ­¥éª¤"><a href="#æ‹†è§£æ­¥éª¤" class="headerlink" title="æ‹†è§£æ­¥éª¤"></a>æ‹†è§£æ­¥éª¤</h3><p>åˆ†æå®Œäº†æ§ä»¶çš„ç»„æˆï¼Œç°åœ¨å°±æ¥æ¢³ç†ä¸€ä¸‹æ§ä»¶çš„æ•´ä¸ªåˆ›å»ºã€äº¤äº’æµç¨‹ã€‚</p>
<p><img src="http://zorrochen.qiniudn.com/blog_TTGPuzzleVerify_2.png" alt="æ­¥éª¤"></p>
<ul>
<li>è¾“å…¥ï¼šå›¾ç‰‡ã€æ‹¼å›¾å½¢çŠ¶ã€æ‹¼å›¾å¤§å°ã€é•‚ç©ºçš„ä½ç½®ã€æ‹¼å›¾å—çš„èµ·å§‹ä½ç½®</li>
<li>ç”Ÿæˆæ‹¼å›¾è·¯å¾„ï¼šæ ¹æ®æ‹¼å›¾ç±»å‹ï¼Œç”Ÿæˆå¯¹åº”çš„è´å¡å°”æ›²çº¿</li>
<li>ä»å›¾ç‰‡æŠ å‡ºæ‹¼å›¾å—ã€é•‚ç©ºï¼šæœ‰äº†æ‹¼å›¾è·¯å¾„ï¼Œå°±å¯ä»¥æŠ å‡ºæ‹¼å›¾å—å’Œé•‚ç©ºçš„éƒ¨åˆ†</li>
<li>è®¾ç½®ä½ç½®ã€æ ·å¼ï¼šæ ¹æ®å‚æ•°è®¾ç½®æ‹¼å›¾å—çš„åˆå§‹ä½ç½®ã€æ ·å¼ï¼Œå¦‚é˜´å½±ã€é•‚ç©ºçš„é€æ˜åº¦ç­‰</li>
<li>ç”¨æˆ·æ‹–åŠ¨ï¼šå“åº”ç”¨æˆ·çš„å¤´åŠ¨æ‰‹åŠ¿ï¼Œç§»åŠ¨æ‹¼å›¾å—ï¼Œæ ¹æ®åæ ‡åˆ¤æ–­æ˜¯å¦å®Œæˆæ‹¼å›¾</li>
<li>å›è°ƒï¼šç”¨æˆ·å®Œæˆæ‹¼å›¾åï¼Œè¦å›è°ƒï¼Œè®©å¤–éƒ¨å“åº”æ‹¼å›¾å®Œæˆäº‹ä»¶</li>
</ul>
<h3 id="å…³é”®æŠ€æœ¯ç‚¹"><a href="#å…³é”®æŠ€æœ¯ç‚¹" class="headerlink" title="å…³é”®æŠ€æœ¯ç‚¹"></a>å…³é”®æŠ€æœ¯ç‚¹</h3><p>ä»ä¸Šé¢çš„æ­¥éª¤å¯ä»¥æ•´ç†å‡ºæ¥å‡ ä¸ªå…³é”®çš„æŠ€æœ¯ç‚¹ï¼Œå¦‚ä¸‹ï¼š</p>
<p><strong>æ‹¼å›¾çš„è·¯å¾„ç”Ÿæˆ</strong><br>æ™®é€šçš„å½¢çŠ¶ï¼Œå¦‚æ­£æ–¹å½¢ã€åœ†å½¢ä¹‹ç±»çš„è¿˜å¥½ï¼Œä»£ç å®ç°æ¯”è¾ƒæ–¹ä¾¿ï¼Œä½†æ˜¯å¤æ‚çš„æ‹¼å›¾å›¾æ¡ˆæ€ä¹ˆåŠï¼Ÿ</p>
<p><strong>ä»å›¾ç‰‡ä¸Šâ€œæŠ å‡ºâ€æ‹¼å›¾å—ã€é•‚ç©º</strong><br>æœ‰äº†æ‹¼å›¾çš„å½¢çŠ¶è·¯å¾„ï¼Œå¦‚ä½•ä»å›¾ç‰‡ä¸ŠæŠ å‡ºæ‹¼å›¾å—å’Œé•‚ç©ºï¼Ÿ</p>
<p><strong>ç”¨æˆ·æ‹–åŠ¨æ‹¼å›¾ã€å®Œæˆæ‹¼å›¾éªŒè¯</strong><br>æŠ å‡ºäº†æ‹¼å›¾å—ï¼Œå¦‚ä½•å°†ç”¨æˆ·çš„æ‰‹åŠ¿å¯¹åº”åˆ°ç§»åŠ¨æ‹¼å›¾å—ï¼Œæœ€ç»ˆå®ŒæˆéªŒè¯ï¼Ÿ</p>
<p>ä¸‹é¢é’ˆå¯¹è¿™ä¸‰ä¸ªç‚¹ç€é‡å†™ä¸‹å®ç°åŸç†ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="æ‹¼å›¾çš„è·¯å¾„ç”Ÿæˆ"><a href="#æ‹¼å›¾çš„è·¯å¾„ç”Ÿæˆ" class="headerlink" title="æ‹¼å›¾çš„è·¯å¾„ç”Ÿæˆ"></a>æ‹¼å›¾çš„è·¯å¾„ç”Ÿæˆ</h3><p>æ—¢ç„¶æ‰‹å†™ä»£ç å¤ªéš¾ï¼Œé‚£å°±ä»ç°æœ‰çš„å›¾æ¡ˆç”Ÿæˆä»£ç ã€‚</p>
<p><strong>1. æ‰¾SVGç´ æ</strong><br>æ—¢ç„¶è¦èƒ½éšæ„æ”¹å˜å¤§å°ï¼Œå°±è¦æ‰¾çŸ¢é‡çš„å›¾ï¼ŒGoogle â€œfree svgâ€ã€â€œfree iconâ€ä¹‹ç±»çš„ï¼Œå¾ˆå®¹æ˜“å°±èƒ½æ‰¾åˆ°å…è´¹çš„çŸ¢é‡å›¾ç´ æï¼Œä¾‹å¦‚TTGPuzzleVerifyé‡Œé¢ç”¨çš„æ‹¼å›¾å½¢çŠ¶å°±æ˜¯ä»<a href="http://iconmonstr.com/puzzle-1/" target="_blank" rel="external">iconmonstr.com</a>æ‰¾æ¥çš„ã€‚</p>
<p><strong>2. ç¼–è¾‘</strong><br>ç›´æ¥ä¸‹è½½å›æ¥çš„SVGè¿˜éœ€è¦è°ƒæ•´ä¸€ä¸‹ï¼Œå¦‚å»é™¤èƒŒæ™¯ï¼Œæˆ‘æ˜¯ç”¨Sketchæ¥ç¼–è¾‘çš„ã€‚</p>
<p><img src="http://zorrochen.qiniudn.com/blog_TTGPuzzleVerify_3.png" alt="æ‹¼å›¾SVGç¼–è¾‘"></p>
<p><strong>3. ç”Ÿæˆä»£ç </strong><br>æ‹¼å›¾çš„è·¯å¾„æœ¬è´¨ä¸Šå°±æ˜¯æ‹¼å›¾çš„è½®å»“ï¼Œåœ¨Sketché‡Œé¢æŠŠæ‹¼å›¾SVGçš„èƒŒæ™¯è‰²ç­‰é¢œè‰²åˆ é™¤ï¼Œç„¶åå°±æ˜¯å°†å…¶è½¬æ¢ä¸ºä»£ç ã€‚<br>è¿™é‡Œå¯ä»¥ç”¨<a href="https://www.paintcodeapp.com/sketch" target="_blank" rel="external">PaintCode plugin for Sketch</a>ï¼Œå°†Sketchçš„æ‹¼å›¾çŸ¢é‡è·¯å¾„å¯¼å‡ºæˆä»£ç ã€‚</p>
<p><strong>4. è°ƒæ•´ä»£ç </strong><br>ç›´æ¥ç”Ÿæˆçš„ä»£ç æœ‰æ—¶å¯èƒ½ä¼šä¸é€‚ç”¨ï¼Œå¯ä»¥äººå·¥è°ƒæ•´ä¸‹ï¼Œç„¶åå°±å¯ä»¥æ”¾åˆ°è‡ªå·±çš„ç±»é‡Œé¢äº†ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">+ (<span class="built_in">UIBezierPath</span> *)classicPuzzlePath &#123;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">UIBezierPath</span> *puzzleShape = <span class="literal">nil</span>;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        puzzleShape = [<span class="built_in">UIBezierPath</span> bezierPath];</div><div class="line">        [puzzleShape moveToPoint:<span class="built_in">CGPointMake</span>(<span class="number">17.45</span>, <span class="number">71.16</span>)];</div><div class="line">        <span class="comment">// æ­¤å¤„çœç•¥å¾ˆå¤šè¡Œ=ã€‚=ï¼ŒPaintCodeç”Ÿæˆçš„</span></div><div class="line">        [puzzleShape closePath];</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> puzzleShape;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>5. UIBezierPathæ‹¼å›¾è·¯å¾„çš„å¤§å°ã€ä½ç½®è°ƒæ•´</strong><br>ç›´æ¥å¯¼å‡ºçš„æ‹¼å›¾è·¯å¾„çš„å¤§å°ã€ä½ç½®æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯æ§ä»¶æ˜¯è¦å¯ä»¥æ”¯æŒæ”¹å˜å¤§å°ã€ä½ç½®çš„ï¼Œæ‰€ä»¥ï¼Œè¦å¯¹è·¯å¾„åšå˜æ¢ï¼Œåˆšå¥½<code>UIBezierPath</code>æ”¯æŒ<code>CGAffineTransform</code>å˜æ¢ã€‚</p>
<p>å¤§å°å˜æ¢ï¼š</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¤§å°å˜æ¢ï¼Œpathæ˜¯ç”Ÿæˆçš„åŸå§‹è·¯å¾„ï¼Œ_puzzleSizeæ˜¯ä¼ å…¥çš„æ‹¼å›¾å—å¤§å°</span></div><div class="line">[path applyTransform:CGAffineTransformMakeScale(_puzzleSize.<span class="built_in">width</span> / path.bounds.<span class="built_in">size</span>.<span class="built_in">width</span>,</div><div class="line">                                                _puzzleSize.<span class="built_in">height</span> / path.bounds.<span class="built_in">size</span>.<span class="built_in">height</span>)];</div></pre></td></tr></table></figure>
<p>ä½ç½®å˜æ¢ï¼š</p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// ä½ç½®å˜æ¢ï¼Œ<span class="built_in">path</span>æ˜¯ç”Ÿæˆçš„åŸå§‹è·¯å¾„ï¼Œ_puzzleBlankPositionæ˜¯ä¼ å…¥çš„æ‹¼å›¾å—ã€é•‚ç©ºä½ç½®</div><div class="line">[<span class="built_in">path</span> applyTransform:CGAffineTransformMakeTranslation(</div><div class="line">            _puzzleBlankPosition.x - <span class="built_in">path</span>.bounds.origin.x,</div><div class="line">            _puzzleBlankPosition.y - <span class="built_in">path</span>.bounds.origin.y)];</div></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œæ‹¼å›¾çš„è·¯å¾„å°±å†™å¥½äº†ã€‚</p>
<h3 id="ä»å›¾ç‰‡ä¸Šâ€œæŠ å‡ºâ€æ‹¼å›¾å—ã€é•‚ç©º"><a href="#ä»å›¾ç‰‡ä¸Šâ€œæŠ å‡ºâ€æ‹¼å›¾å—ã€é•‚ç©º" class="headerlink" title="ä»å›¾ç‰‡ä¸Šâ€œæŠ å‡ºâ€æ‹¼å›¾å—ã€é•‚ç©º"></a>ä»å›¾ç‰‡ä¸Šâ€œæŠ å‡ºâ€æ‹¼å›¾å—ã€é•‚ç©º</h3><p><strong>1. æ‹¼å›¾å—</strong><br>æœ‰äº†UIBezierPathè·¯å¾„ï¼ŒæŠ å‡ºæ‹¼å›¾å—è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ï¼Œç›´æ¥ç”¨<code>CAShapeLayer</code>æ¥<strong>â€œmaskâ€</strong>å›¾ç‰‡å³å¯ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ‹¼å›¾è·¯å¾„</span></div><div class="line"><span class="built_in">UIBezierPath</span> *puzzlePath = [<span class="keyword">self</span> getNewScaledPuzzledPath];</div><div class="line"></div><div class="line"><span class="comment">// åˆ›å»ºmask layer</span></div><div class="line"><span class="built_in">CAShapeLayer</span> *puzzleMaskLayer = [<span class="built_in">CAShapeLayer</span> new];</div><div class="line">puzzleMaskLayer.frame = <span class="keyword">self</span>.bounds;</div><div class="line">puzzleMaskLayer.path = puzzlePath.CGPath;</div><div class="line"></div><div class="line"><span class="comment">// Maskåˆ°å›¾ç‰‡imageViewä¸Š</span></div><div class="line">_puzzleImageView.layer.mask = puzzleMaskLayer;</div></pre></td></tr></table></figure>
<p>æ•ˆæœå°±æ˜¯ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_TTGPuzzleVerify_4.png" alt="æ‹¼å›¾å—"></p>
<p><strong>2. é•‚ç©ºå›¾ç‰‡</strong><br>æŠ å‡ºæ‹¼å›¾å—è¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œä½†æ˜¯â€œé•‚ç©ºâ€æ€ä¹ˆåŠï¼Ÿ<br>å…¶å®é“ç†æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯<strong>mask</strong>ï¼Œåªä¸è¿‡maskçš„åŒºåŸŸåè¿‡æ¥è€Œå·²ã€‚<br><code>CAShapeLayer</code>çš„<code>fillRule</code>å°±å¯ä»¥è°ƒæ•´â€œå¡«å……çš„è§„åˆ™â€ï¼Œæ­¤å¤„ç”¨<code>kCAFillRuleEvenOdd</code>å°±å¯ä»¥äº†ï¼Œæ–‡æ¡£çš„è§£é‡Šå¦‚ä¸‹ï¼š</p>
<blockquote>
<p>Specifies the even-odd winding rule. Count the total number of path crossings. If the number of crossings is even, the point is outside the path. If the number of crossings is odd, the point is inside the path and the region containing it should be filled.</p>
</blockquote>
<p>ç†è§£è¿‡æ¥å°±æ˜¯ï¼šåŒºåŸŸå†…ä¸€ç‚¹ï¼Œå¾€å¤–åˆ’ä¸€æ¡çº¿ï¼Œç»è¿‡å¥‡æ•°ä¸ªæ•°çš„äº¤ç‚¹ï¼Œåˆ™ç‚¹åœ¨åŒºåŸŸå†…ï¼Œå¶æ•°ä¸ªæ•°çš„äº¤ç‚¹ï¼Œåˆ™åœ¨åŒºåŸŸå¤–ã€‚</p>
<p>æ‰€ä»¥ï¼Œåªè¦åœ¨æ‹¼å›¾è·¯å¾„çš„åŸºç¡€ä¸Šï¼Œè¡¥å……æœ€å¤–éƒ¨çš„è¾¹æ¡†çš„è·¯å¾„å³å¯ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åˆ›å»ºçŸ©å½¢è¾¹æ¡†è·¯å¾„</span></div><div class="line"><span class="built_in">UIBezierPath</span> *maskPath = [<span class="built_in">UIBezierPath</span> bezierPathWithRect:<span class="keyword">self</span>.bounds];</div><div class="line"><span class="comment">// æ·»åŠ æ‹¼å›¾è·¯å¾„</span></div><div class="line">[maskPath appendPath:[<span class="built_in">UIBezierPath</span> bezierPathWithCGPath:puzzlePath.CGPath]];</div><div class="line"><span class="comment">// è®¾ç½®è§„åˆ™</span></div><div class="line">maskPath.usesEvenOddFillRule = <span class="literal">YES</span>;</div><div class="line"></div><div class="line"><span class="comment">// åˆ›å»ºmaskçš„layer</span></div><div class="line"><span class="built_in">CAShapeLayer</span> *frontMaskLayer = [<span class="built_in">CAShapeLayer</span> new];</div><div class="line">frontMaskLayer.frame = <span class="keyword">self</span>.bounds;</div><div class="line">frontMaskLayer.path = maskPath.CGPath;</div><div class="line">frontMaskLayer.fillRule = kCAFillRuleEvenOdd; <span class="comment">// å¡«å……è§„åˆ™</span></div><div class="line"></div><div class="line"><span class="comment">// è®¾ç½®mask</span></div><div class="line">_frontImageView.layer.mask = frontMaskLayer;</div></pre></td></tr></table></figure>
<p>æ•ˆæœï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_TTGPuzzleVerify_5.png" alt="é•‚ç©º"></p>
<p><strong>3. é•‚ç©ºèƒŒæ™¯</strong><br>æœ‰äº†æ‹¼å›¾å—ã€é•‚ç©ºï¼Œè¿˜å·®ä¸€å—ï¼Œå°±æ˜¯é•‚ç©ºçš„â€œåŠé€æ˜èƒŒæ™¯â€ï¼Œå…¶å®è¿™ä¸ªâ€œåŠé€æ˜èƒŒæ™¯â€å’Œæ‹¼å›¾å—æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸å†é‡å¤ä»£ç ï¼Œå”¯ä¸€å¢åŠ çš„å°±æ˜¯è®¾ç½®å…¶é€æ˜åº¦ã€‚</p>
<p><strong>4. ç»„åˆ</strong><br>å°†ä¸Šé¢çš„ç»„åˆåˆ°ä¸€èµ·ï¼Œå°±èƒ½å½¢æˆæœ€ç»ˆçš„æ•ˆæœï¼Œä»Revealé‡Œé¢çœ‹åˆ°åˆ†å±‚ç»“æ„å¦‚ä¸‹ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_TTGPuzzleVerify_6.png" alt="åˆ†å±‚"></p>
<p>å…¶å®å°±æ˜¯ä¸‰å¼ ä¸€æ ·çš„å›¾ç‰‡ï¼ŒæŒ‰ç…§ä¸åŒçš„maskè§„åˆ™åšäº†å¤„ç†ï¼Œå åŠ èµ·æ¥ã€‚</p>
<h3 id="ç”¨æˆ·æ‹–åŠ¨æ‹¼å›¾ã€å®Œæˆæ‹¼å›¾éªŒè¯"><a href="#ç”¨æˆ·æ‹–åŠ¨æ‹¼å›¾ã€å®Œæˆæ‹¼å›¾éªŒè¯" class="headerlink" title="ç”¨æˆ·æ‹–åŠ¨æ‹¼å›¾ã€å®Œæˆæ‹¼å›¾éªŒè¯"></a>ç”¨æˆ·æ‹–åŠ¨æ‹¼å›¾ã€å®Œæˆæ‹¼å›¾éªŒè¯</h3><p><strong>1. æ‹–åŠ¨å›¾ç‰‡</strong><br>æœ‰äº†ä¸Šé¢çš„ç»“æ„ï¼Œæ‹–åŠ¨æ‹¼å›¾çš„å¤„ç†ä¹Ÿå°±å®¹æ˜“å¤šäº†ï¼Œåªè¦ç§»åŠ¨æœ€ä¸Šå±‚çš„æ‹¼å›¾å—å°±è¡Œäº†ï¼Œè¿™é‡Œç›´æ¥ç”¨<code>UIPanGestureRecognizer</code>å®ç°ï¼Œç§»åŠ¨çš„æ—¶å€™åŸºäºæ‹¼å›¾çš„ä¸­å¿ƒç§»åŠ¨ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åˆ›å»ºæ‰‹åŠ¿</span></div><div class="line"><span class="built_in">UIPanGestureRecognizer</span> *panGestureRecognizer = [<span class="built_in">UIPanGestureRecognizer</span> new];</div><div class="line">[panGestureRecognizer addTarget:<span class="keyword">self</span> action:<span class="keyword">@selector</span>(onPanGesture:)];</div><div class="line">[<span class="keyword">self</span> addGestureRecognizer:panGestureRecognizer];</div><div class="line"></div><div class="line"><span class="comment">// æ‰‹åŠ¿å¤„ç†</span></div><div class="line">- (<span class="keyword">void</span>)onPanGesture:(<span class="built_in">UIPanGestureRecognizer</span> *)panGestureRecognizer &#123;</div><div class="line">    <span class="comment">// è·å–åæ ‡</span></div><div class="line">    <span class="built_in">CGPoint</span> panLocation = [panGestureRecognizer locationInView:<span class="keyword">self</span>];</div><div class="line">    <span class="comment">// æ‹¼å›¾ä¸­å¿ƒåç§»</span></div><div class="line">    <span class="built_in">CGPoint</span> position = <span class="built_in">CGPointZero</span>;</div><div class="line">    position.x = panLocation.x - _puzzleSize.width / <span class="number">2</span>;</div><div class="line">    position.y = panLocation.y - _puzzleSize.height / <span class="number">2</span>;</div><div class="line">    <span class="comment">// è®¾ç½®åæ ‡</span></div><div class="line">    [<span class="keyword">self</span> setPuzzlePosition:position];</div><div class="line">    <span class="comment">// åˆ¤æ–­ã€å›è°ƒã€‚ã€‚ã€‚</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>2. éªŒè¯ç”¨æˆ·çš„æ‹¼å›¾æ˜¯å¦å®Œæˆ</strong><br>ç”¨æˆ·ç§»åŠ¨æ‹¼å›¾æ—¶ï¼Œåªè¦åˆ¤æ–­æ‹¼å›¾çš„åæ ‡å’Œé•‚ç©ºçš„ä½ç½®æ˜¯å¦ä¸€è‡´å°±è¡Œã€‚ä½†æ˜¯å¦‚æœå®Œå…¨ç²¾ç¡®çš„åˆ¤æ–­ï¼Œç”¨æˆ·å¾ˆéš¾å‡†ç¡®çš„æŠŠæ‹¼å›¾æ‹¼å¯¹ä¸Šï¼Œæ‰€ä»¥è¿˜è¦å¢åŠ ä¸€å®šçš„<strong>â€œtoleranceâ€</strong>ï¼Œè®©æ‹¼å›¾æ›´åŠ å®¹æ˜“ï¼ŒåŒæ—¶æš´æ¼å‡ºè®©å¤–éƒ¨è®¾ç½®ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> verificationTolerance; <span class="comment">// Verification tolerance, default is 8</span></div></pre></td></tr></table></figure>
<p>åˆ¤æ–­çš„é€»è¾‘å¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// puzzlePositionæ˜¯å½“å‰æ‹¼å›¾å—çš„ä½ç½®ï¼Œ_puzzleBlankPositionæ˜¯æ‹¼å›¾é•‚ç©ºçš„ä½ç½®</span></div><div class="line">- (<span class="built_in">BOOL</span>)isVerified &#123;</div><div class="line">    <span class="keyword">return</span> fabsf([<span class="keyword">self</span> puzzlePosition].x - _puzzleBlankPosition.x) &lt;= _verificationTolerance &amp;&amp;</div><div class="line">           fabsf([<span class="keyword">self</span> puzzlePosition].y - _puzzleBlankPosition.y) &lt;= _verificationTolerance;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>3. å®Œæˆæ‹¼å›¾</strong><br>å½“ç”¨æˆ·å®Œæˆæ‹¼å›¾åï¼Œå¤–éƒ¨ä¼šå¾—åˆ°<code>delegate</code>ã€<code>block</code>çš„å›è°ƒå“åº”ï¼Œæ¥ç€å°±å¯ä»¥â€œå®Œæˆæ‹¼å›¾éªŒè¯â€ï¼Œå¯¹æ­¤å‘å¤–æä¾›ä¸€ä¸ªæ–¹æ³•ï¼š<code>- (void)completeVerificationWithAnimation:(BOOL)withAnimation</code>ï¼Œè°ƒç”¨åæ‹¼å›¾å—å°†ä¼šç§»åŠ¨å›é•‚ç©ºä½ç½®ï¼Œæ¨¡æ‹Ÿå‡ºæ‹¼å›¾å®Œæˆçš„æ•ˆæœã€‚</p>
<p>è‡³æ­¤ï¼ŒTTGPuzzleVerifyçš„å…³é”®å®ç°æŠ€æœ¯ç‚¹å°±æ˜¯è¿™äº›äº†ï½</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>å—¯ï¼Œåœ£è¯èŠ‚å¿«ä¹ï¼ â€“ 2016-12-25</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æœ€è¿‘æŠ½ç©ºå†™äº†ä¸ªæ‹¼å›¾éªŒè¯æ§ä»¶ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æ°´å¹³ã€å‚ç›´ï¼Œæˆ–è€…ç›´æ¥æ‹–åŠ¨æ‹¼å›¾å—ï¼Œå®Œæˆæ‹¼å›¾å›¾æ¡ˆï¼Œæ¥å®ŒæˆéªŒè¯ã€‚æ‹¼å›¾å—çš„å½¢çŠ¶å¯ä»¥è‡ªå®šä¹‰ï¼Œé»˜è®¤æä¾›äº†ç»å…¸çš„æ‹¼å›¾å½¢çŠ¶ã€åœ†å½¢ã€æ­£æ–¹å½¢ï¼Œæ•´ä¸ªæ‹¼å›¾çš„å›¾æ¡ˆä¹Ÿæ˜¯æ”¯æŒä»å›¾ç‰‡ç”Ÿæˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;CocoaPods&lt;/strong&gt;: &lt;code&gt;pod &amp;quot;TTGPuzzleVerify&amp;quot;&lt;/code&gt;&lt;br&gt;&lt;strong&gt;Github&lt;/strong&gt;: &lt;a href=&quot;https://github.com/zekunyan/TTGPuzzleVerify&quot;&gt;https://github.com/zekunyan/TTGPuzzleVerify&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://zorrochen.qiniudn.com/blog_TTGPuzzleVerify_gif.gif&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œè¯´è¯´TTGPuzzleVerifyçš„æ•´ä½“è®¾è®¡æ€è·¯å’Œå®ç°åŸç†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="å¼€æº" scheme="http://tutuge.me/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>Swiftå¼€æºMac App - BingWallPaper</title>
    <link href="http://tutuge.me/2016/08/28/TTGBingWallPaper/"/>
    <id>http://tutuge.me/2016/08/28/TTGBingWallPaper/</id>
    <published>2016-08-28T14:37:02.000Z</published>
    <updated>2016-09-05T14:46:57.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><ul>
<li>2016-09-05: <a href="https://github.com/zekunyan/TTGBingWallPaper/releases/download/0.3/BingWallPaper.app.zip" target="_blank" rel="external">æ–°ç‰ˆ0.3</a>å¢åŠ å­Menuï¼Œæ•´ç†é€‰é¡¹ï¼›å¢åŠ â€œHistory Wallpapersâ€æ‰“å¼€å†å²å›¾ç‰‡æ–‡ä»¶å¤¹ï¼›å¢åŠ â€œLaunch at startupâ€å¼€æœºå¯åŠ¨ã€‚</li>
<li>2016-09-03: <a href="https://github.com/zekunyan/TTGBingWallPaper/releases/download/0.2.0/BingWallPaper.app.zip" target="_blank" rel="external">æ–°ç‰ˆ0.2.0ï¼</a>å¢åŠ â€œAuto Updateâ€é€‰é¡¹ï¼›å¢åŠ â€œRandomâ€éšæœºé€‰æ‹©è®¾ç½®å£çº¸ï¼›ä¿®å¤è‡ªåŠ¨æ›´æ–°ä¸å‡†çš„Bugã€‚</li>
</ul>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/BingWallPaper_banner.png" alt="Banner"></p>
<p>æç®€çš„å£çº¸Mac Appï¼Œæ¯å¤©<strong>è‡ªåŠ¨</strong>ä¸‹è½½æœ€æ–°å¾®è½¯Bingçš„æ¯æ—¥å£çº¸å¹¶è®¾ç½®ä¸ºæ¡Œé¢èƒŒæ™¯ã€‚</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/BingWallPaper_screenshot_2.png?2=2" alt="ScreenShot1"></p>
<p>Github: <a href="https://github.com/zekunyan/TTGBingWallPaper" target="_blank" rel="external">https://github.com/zekunyan/TTGBingWallPaper</a></p>
<a id="more"></a>
<h2 id="ç”±æ¥"><a href="#ç”±æ¥" class="headerlink" title="ç”±æ¥"></a>ç”±æ¥</h2><p>å…¶å®æœ€å¼€å§‹åªæ˜¯å¾ˆå–œæ¬¢Bingçš„é¦–é¡µçš„å£çº¸å›¾ç‰‡ï¼Œç„¶åæ‰‹åŠ¨ä¸‹è½½å›æ¥åšå£çº¸ï¼Œåæ¥å‘ç°æ‰‹åŠ¨å¤ªéº»çƒ¦ï¼Œä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œè‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿï¼=ã€‚= ç„¶åèŠ±äº†ä¸ªå‘¨æœ«å†™äº†è¿™ä¸ªè¶…ç®€å•çš„Mac Appã€‚</p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>åˆ°Githubçš„é¡¹ç›®é¡µé¢ï¼Œå³<a href="https://github.com/zekunyan/TTGBingWallPaper" target="_blank" rel="external">https://github.com/zekunyan/TTGBingWallPaper</a>ï¼Œä»<code>release</code>é‡Œé¢ä¸‹è½½æœ€æ–°çš„<code>BingWallPaper.app.zip</code>å‹ç¼©åŒ…ï¼Œè§£å‹å‡º<code>BingWallPaper.app</code>ï¼Œæ‹–åˆ°<code>Applications</code>åº”ç”¨ç¨‹åºæ–‡ä»¶å¤¹é‡Œé¢ï¼Œæ‰“å¼€å³å¯ã€‚</p>
<h2 id="å¼€å‘"><a href="#å¼€å‘" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h2><p>ç”¨Swift 2.2å†™çš„ï¼Œç›®å‰å”¯ä¸€ä¾èµ–çš„åº“æ˜¯<a href="https://github.com/SwiftyJSON/SwiftyJSON" target="_blank" rel="external">SwiftyJSON/SwiftyJSON</a>ï¼Œéœ€è¦<a href="https://github.com/Carthage/Carthage" target="_blank" rel="external">Carthage</a>ã€‚</p>
<ul>
<li><code>git clone git@github.com:zekunyan/TTGBingWallPaper.git</code></li>
<li><code>cd TTGBingWallPaper</code></li>
<li><code>carthage update</code></li>
<li><code>open BingWallPaper.xcodeproj</code></li>
<li>ç¼–è¯‘ã€å®‰è£…ã€è¿è¡Œ</li>
</ul>
<h2 id="æœªæ¥"><a href="#æœªæ¥" class="headerlink" title="æœªæ¥"></a>æœªæ¥</h2><p>è¿˜æœ‰å¾ˆå¤šç‚¹å¯ä»¥åšï¼Œä¸€ç‚¹ä¸€ç‚¹æ¥å§=ã€‚=</p>
<p><strong>TODO</strong></p>
<ul>
<li>æ”¯æŒå¤šå›½åœ°åŒºçš„Bingæ¯æ—¥å›¾ç‰‡å£çº¸çš„è·å–</li>
<li>æ”¯æŒå¤šè¯­è¨€</li>
<li>æ”¯æŒæµè§ˆå†å²å›¾ç‰‡</li>
<li>å¯¼å‡ºå›¾ç‰‡</li>
<li>â€¦</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2016-09-05: &lt;a href=&quot;https://github.com/zekunyan/TTGBingWallPaper/releases/download/0.3/BingWallPaper.app.zip&quot;&gt;æ–°ç‰ˆ0.3&lt;/a&gt;å¢åŠ å­Menuï¼Œæ•´ç†é€‰é¡¹ï¼›å¢åŠ â€œHistory Wallpapersâ€æ‰“å¼€å†å²å›¾ç‰‡æ–‡ä»¶å¤¹ï¼›å¢åŠ â€œLaunch at startupâ€å¼€æœºå¯åŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;2016-09-03: &lt;a href=&quot;https://github.com/zekunyan/TTGBingWallPaper/releases/download/0.2.0/BingWallPaper.app.zip&quot;&gt;æ–°ç‰ˆ0.2.0ï¼&lt;/a&gt;å¢åŠ â€œAuto Updateâ€é€‰é¡¹ï¼›å¢åŠ â€œRandomâ€éšæœºé€‰æ‹©è®¾ç½®å£çº¸ï¼›ä¿®å¤è‡ªåŠ¨æ›´æ–°ä¸å‡†çš„Bugã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;http://7nj2iz.com1.z0.glb.clouddn.com/BingWallPaper_banner.png&quot; alt=&quot;Banner&quot;&gt;&lt;/p&gt;
&lt;p&gt;æç®€çš„å£çº¸Mac Appï¼Œæ¯å¤©&lt;strong&gt;è‡ªåŠ¨&lt;/strong&gt;ä¸‹è½½æœ€æ–°å¾®è½¯Bingçš„æ¯æ—¥å£çº¸å¹¶è®¾ç½®ä¸ºæ¡Œé¢èƒŒæ™¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7nj2iz.com1.z0.glb.clouddn.com/BingWallPaper_screenshot_2.png?2=2&quot; alt=&quot;ScreenShot1&quot;&gt;&lt;/p&gt;
&lt;p&gt;Github: &lt;a href=&quot;https://github.com/zekunyan/TTGBingWallPaper&quot;&gt;https://github.com/zekunyan/TTGBingWallPaper&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Mac" scheme="http://tutuge.me/categories/Mac/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="å¼€æº" scheme="http://tutuge.me/tags/%E5%BC%80%E6%BA%90/"/>
    
      <category term="Mac" scheme="http://tutuge.me/tags/Mac/"/>
    
      <category term="Swift" scheme="http://tutuge.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰è¶£çš„Autolayoutç¤ºä¾‹4-Masonryå®ç°</title>
    <link href="http://tutuge.me/2016/08/06/autolayout-example-with-masonry4/"/>
    <id>http://tutuge.me/2016/08/06/autolayout-example-with-masonry4/</id>
    <published>2016-08-06T13:41:17.000Z</published>
    <updated>2016-08-06T17:32:15.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¬¬å››ç¯‡æ¥äº†ã€‚<br>è¿˜æ˜¯3ä¸ªå°ä¾‹å­ï¼Œä»ç„¶æ˜¯ä¸»è¦éƒ¨åˆ†ç”¨Masonryæ‰‹å†™ä»£ç å®ç°ï¼Œå…¶å®ƒçš„çº¦æŸåœ¨storyboardé‡Œé¢ç›´æ¥æ‹–æ‹½æ­å»ºã€‚<br>ä¸‰ä¸ªä¾‹å­åˆ†åˆ«æ˜¯ï¼š  </p>
<ol>
<li>ç”¨çº¦æŸä¼˜å…ˆçº§ä¿è¯å¯ç§»åŠ¨Viewçš„å†…å®¹å¯è§æ€§</li>
<li>Autolayoutçš„çº¦æŸ=æ§ä»¶é—´ä½ç½®å…³ç³»çš„â€œç»‘å®šâ€</li>
<li>åˆ©ç”¨<code>layoutIfNeeded</code>æ§åˆ¶çº¦æŸçš„ç”Ÿæ•ˆæ—¶æœº</li>
</ol>
<p>å‰ä¸‰ç¯‡ï¼š  </p>
<ul>
<li>ç¬¬ä¸€ç¯‡ï¼š<a href="http://tutuge.me/2015/05/23/autolayout-example-with-masonry/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹-Masonryå®ç°</a>  </li>
<li>ç¬¬äºŒç¯‡ï¼š<a href="http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°</a>  </li>
<li>ç¬¬ä¸‰ç¯‡ï¼š<a href="http://tutuge.me/2015/12/14/autolayout-example-with-masonry3/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹3-Masonryå®ç°</a></li>
</ul>
<p>Githubåœ°å€ï¼š<br><a href="https://github.com/zekunyan/AutolayoutExampleWithMasonry" target="_blank" rel="external">https://github.com/zekunyan/AutolayoutExampleWithMasonry</a></p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry4_1.gif" alt="Gifç¤ºä¾‹"></p>
<a id="more"></a>
<h2 id="Case-1-ç”¨çº¦æŸä¼˜å…ˆçº§ä¿è¯å¯ç§»åŠ¨Viewçš„å†…å®¹å¯è§æ€§"><a href="#Case-1-ç”¨çº¦æŸä¼˜å…ˆçº§ä¿è¯å¯ç§»åŠ¨Viewçš„å†…å®¹å¯è§æ€§" class="headerlink" title="Case 1: ç”¨çº¦æŸä¼˜å…ˆçº§ä¿è¯å¯ç§»åŠ¨Viewçš„å†…å®¹å¯è§æ€§"></a>Case 1: ç”¨çº¦æŸä¼˜å…ˆçº§ä¿è¯å¯ç§»åŠ¨Viewçš„å†…å®¹å¯è§æ€§</h2><h3 id="å®ç°åŠŸèƒ½"><a href="#å®ç°åŠŸèƒ½" class="headerlink" title="å®ç°åŠŸèƒ½"></a>å®ç°åŠŸèƒ½</h3><p>Case 1å®ç°çš„åŠŸèƒ½å°±æ˜¯ï¼Œå¯ä»¥ç”¨æ‰‹æŒ‡æ‹–åŠ¨ä¸€ä¸ªç°è‰²çš„Tipæ§ä»¶ï¼Œåœ¨çº¢æ¡†containerViewå†…ç§»åŠ¨ï¼Œå¹¶ä¸”ä¿æŒç§»åŠ¨åˆ°çº¢æ¡†è¾¹ç¼˜æ—¶ï¼ŒTipæ§ä»¶çš„å†…å®¹ä¸ä¼šè¶…å‡ºçº¢æ¡†ï¼Œä¿è¯å†…å®¹çš„å¯è§æ€§ã€‚</p>
<h3 id="Frame-VS-Autolayout"><a href="#Frame-VS-Autolayout" class="headerlink" title="Frame VS Autolayout"></a>Frame VS Autolayout</h3><p>å¦‚æœä¸ç”¨Autolayoutçš„è¯ï¼Œç›´æ¥è®¡ç®—ã€è®¾å®šframeï¼Œé‚£ä¹ˆå¯èƒ½çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>è·å–æ‰‹æŒ‡å½“å‰è§¦æ‘¸ç‚¹åœ¨çº¢æ¡†containerViewå†…çš„åæ ‡</li>
<li>è®¡ç®—Tipæ§ä»¶çš„å®½é«˜</li>
<li>æ ¹æ®å®½é«˜ï¼Œè®¡ç®—ã€åˆ¤æ–­Tipæ§ä»¶ä¼šä¸ä¼šåœ¨æ–°çš„ä½ç½®ä¸Šè¶…å‡ºè¾¹ç•Œ</li>
<li>è°ƒæ•´æ–°çš„Tipä½ç½®åæ ‡</li>
<li>è®¾ç½®Tipæ§ä»¶çš„frameï¼ŒæŒ‡å®šæ–°çš„åæ ‡</li>
</ol>
<p>è¿™æ ·å»å®ç°çš„è¯ï¼Œä»£ç å°†ä¼šæ¯”è¾ƒâ€œä¸‘â€=ã€‚ã€‚=ï¼Œæœ‰å¤§é‡çš„åˆ¤æ–­ã€æ•°å€¼è®¡ç®—ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚</p>
<p>è€Œç”¨Autolayoutçš„è¯ï¼Œ<strong>åªéœ€è¦ä¸¤æ­¥</strong>ï¼š</p>
<ol>
<li>è®¾ç½®çº¦æŸ</li>
<li>æ ¹æ®æ‰‹æŒ‡åæ ‡ï¼Œæ›´æ–°leftã€topä¸¤ä¸ªçº¦æŸï¼Œå³æ›´æ–°Tipçš„ä½ç½®</li>
</ol>
<p>è‡³äºä¿è¯Tipå†…å®¹åœ¨å¯è§èŒƒå›´å†…ï¼Œå°±äº¤ç»™Autolayoutå¤„ç†å§~</p>
<h3 id="å…³é”®åŸç†"><a href="#å…³é”®åŸç†" class="headerlink" title="å…³é”®åŸç†"></a>å…³é”®åŸç†</h3><p>ç”¨Autolayoutå®ç°çš„å…³é”®ï¼Œå°±æ˜¯<strong>å–„äºåˆ©ç”¨çº¦æŸçš„ä¼˜å…ˆçº§</strong>ã€‚å…ˆçœ‹çœ‹è®¾ç½®çš„çº¦æŸç¤ºæ„å›¾ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry4_2.png?1=1" alt="Case 1: ç”¨çº¦æŸä¼˜å…ˆçº§ä¿è¯å¯ç§»åŠ¨Viewçš„å†…å®¹å¯è§æ€§"></p>
<p>ä¸­é—´çš„tipLabelå°±æ˜¯è¢«ç§»åŠ¨çš„æ§ä»¶  </p>
<ul>
<li>è¤è‰²çš„ä¸¤ä¸ªçº¦æŸï¼Œåˆ†åˆ«æ˜¯Tipæ§ä»¶çš„centerXå’ŒcenterYï¼Œä¸ä¸Šçº§Viewçš„leftå’Œtopçš„çº¦æŸï¼Œç”¨æ¥å¯¹Tipå®šä½</li>
<li>å››ä¸ªè“è‰²çš„çº¦æŸï¼Œåˆ™æ˜¯ç¡®ä¿Tipå†…å®¹ä¸è¶…å‡ºè¾¹ç•Œçš„çº¦æŸ</li>
</ul>
<p>é‡ç‚¹å…¶å®å°±åœ¨äºï¼Œ<strong>è“è‰²çš„çº¦æŸçš„ä¼˜å…ˆçº§æ¯”è¤è‰²çš„ä¼˜å…ˆçº§é«˜ï¼Œè¿™æ ·ï¼Œåœ¨ç§»åŠ¨ä¸­ï¼Œç³»ç»Ÿä¼šä¼˜å…ˆæ»¡è¶³Tipçš„å†…å®¹ä¿æŒåœ¨è¾¹ç•Œå†…</strong>ã€‚</p>
<h3 id="å®ç°ç»†èŠ‚"><a href="#å®ç°ç»†èŠ‚" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h3><p>å…·ä½“çš„è®¾ç½®çº¦æŸä»£ç å¦‚ä¸‹ï¼š</p>
<h4 id="å·¦è¾¹å’Œé¡¶éƒ¨çš„çº¦æŸ-æ§åˆ¶ä½ç½®"><a href="#å·¦è¾¹å’Œé¡¶éƒ¨çš„çº¦æŸ-æ§åˆ¶ä½ç½®" class="headerlink" title="å·¦è¾¹å’Œé¡¶éƒ¨çš„çº¦æŸ - æ§åˆ¶ä½ç½®"></a>å·¦è¾¹å’Œé¡¶éƒ¨çš„çº¦æŸ - æ§åˆ¶ä½ç½®</h4><p>é¦–å…ˆè®¾ç½®ä¸¤ä¸ªå±æ€§ï¼Œä¿å­˜å·¦è¾¹å’Œé¡¶éƒ¨çš„çº¦æŸï¼Œç”¨äºåœ¨ç§»åŠ¨æ—¶è°ƒæ•´ä½ç½®ï¼š</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@<span class="keyword">property</span><span class="title"> </span>(nonatomic, strong) MASConstraint *leftConstraint;</div><div class="line">@<span class="keyword">property</span><span class="title"> </span>(nonatomic, strong) MASConstraint *topConstraint;</div></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯è®¾ç½®å…·ä½“çš„leftã€topçº¦æŸï¼Œå¹¶è®¾ç½®ä¼˜å…ˆçº§ä¸º750ï¼Œä¹Ÿå°±æ˜¯High</p>
<figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[<span class="name">_tipLabel</span> mas_makeConstraints:^(<span class="name">MASConstraintMaker</span> *make) &#123;</div><div class="line">    // ä¼˜å…ˆçº§è¦æ¯”è¾¹ç•Œæ¡ä»¶ä½</div><div class="line">    _leftConstraint = make.centerX.equalTo(<span class="name">_containerView.mas_left</span>).with.offset(<span class="name">50</span>).priorityHigh()<span class="comment">; </span></div><div class="line">    // ä¼˜å…ˆçº§è¦æ¯”è¾¹ç•Œæ¡ä»¶ä½</div><div class="line">    _topConstraint = make.centerY.equalTo(<span class="name">_containerView.mas_top</span>).with.offset(<span class="name">50</span>).priorityHigh()<span class="comment">;</span></div><div class="line">    // ...</div><div class="line">&#125;]<span class="comment">;</span></div></pre></td></tr></table></figure>
<h4 id="å››å‘¨çš„çº¦æŸ-ä¿è¯å†…å®¹åœ¨è¾¹ç•Œå†…"><a href="#å››å‘¨çš„çº¦æŸ-ä¿è¯å†…å®¹åœ¨è¾¹ç•Œå†…" class="headerlink" title="å››å‘¨çš„çº¦æŸ - ä¿è¯å†…å®¹åœ¨è¾¹ç•Œå†…"></a>å››å‘¨çš„çº¦æŸ - ä¿è¯å†…å®¹åœ¨è¾¹ç•Œå†…</h4><p>ç„¶åå°±æ˜¯ä¸Šä¸‹å·¦å³å››ä¸ªè¾¹ç•Œçš„çº¦æŸï¼š</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">[_tipLabel mas_makeConstraints:^(<span class="name">MASConstraintMaker</span> *make) &#123;</div><div class="line">    // è®¾ç½®è¾¹ç•Œæ¡ä»¶çº¦æŸï¼Œä¿è¯å†…å®¹å¯è§ï¼Œä¼˜å…ˆçº§<span class="number">1000</span></div><div class="line">    make.left.greaterThanOrEqualTo(<span class="name">_containerView.mas_left</span>)<span class="comment">;</span></div><div class="line">    make.right.lessThanOrEqualTo(<span class="name">_containerView.mas_right</span>)<span class="comment">;</span></div><div class="line">    make.top.greaterThanOrEqualTo(<span class="name">_containerView.mas_top</span>)<span class="comment">;</span></div><div class="line">    make.bottom.lessThanOrEqualTo(<span class="name">_containerView.mas_bottom</span>)<span class="comment">;</span></div><div class="line">    // ...</div><div class="line">&#125;]<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªåœ°æ–¹è¦æ³¨æ„æ˜¯<code>lessThanOrEqualTo</code>è¿˜æ˜¯<code>greaterThanOrEqualTo</code>ã€‚</p>
<h4 id="æ»‘åŠ¨æ—¶æ›´æ–°Tipä½ç½®"><a href="#æ»‘åŠ¨æ—¶æ›´æ–°Tipä½ç½®" class="headerlink" title="æ»‘åŠ¨æ—¶æ›´æ–°Tipä½ç½®"></a>æ»‘åŠ¨æ—¶æ›´æ–°Tipä½ç½®</h4><p>è¿™ä¸€ç‚¹æ¯”è¾ƒç®€å•ï¼Œç›´æ¥å°†å½“å‰è§¦æ‘¸çš„åæ ‡èµ‹å€¼ç»™<code>leftConstraint</code>å’Œ<code>rightConstraint</code>å°±å¥½ï¼š</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">_leftConstraint.offset = touchPoint.x<span class="comment">;</span></div><div class="line">_topConstraint.offset = touchPoint.y<span class="comment">;</span></div></pre></td></tr></table></figure>
<h3 id="å°èŠ‚"><a href="#å°èŠ‚" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h3><p>å¯¹æ¯”èµ·æ¥ï¼Œæ˜æ˜¾æ˜¯ç”¨Autolayoutçš„æ–¹æ³•æ¯”è®¡ç®—è®¾ç½®frameçš„æ–¹æ³•è¦â€œä¼˜é›…â€çš„å¤š=ã€‚=ï¼Œçµæ´»è¿ç”¨çº¦æŸçš„ä¼˜å…ˆçº§ï¼Œå¾€å¾€å¯ä»¥å‡å°‘å¾ˆå¤šå·¥ä½œé‡ã€‚</p>
<h2 id="Case-2-Autolayoutçš„çº¦æŸ-æ§ä»¶é—´ä½ç½®å…³ç³»çš„â€œåŠ¨æ€ç»‘å®šâ€"><a href="#Case-2-Autolayoutçš„çº¦æŸ-æ§ä»¶é—´ä½ç½®å…³ç³»çš„â€œåŠ¨æ€ç»‘å®šâ€" class="headerlink" title="Case 2: Autolayoutçš„çº¦æŸ=æ§ä»¶é—´ä½ç½®å…³ç³»çš„â€œåŠ¨æ€ç»‘å®šâ€"></a>Case 2: Autolayoutçš„çº¦æŸ=æ§ä»¶é—´ä½ç½®å…³ç³»çš„â€œåŠ¨æ€ç»‘å®šâ€</h2><h3 id="å®ç°åŠŸèƒ½-1"><a href="#å®ç°åŠŸèƒ½-1" class="headerlink" title="å®ç°åŠŸèƒ½"></a>å®ç°åŠŸèƒ½</h3><p>Case 2çš„åŠŸèƒ½å…¶å®æ˜¯åœ¨Case 1çš„åŸºç¡€ä¸Šå®ç°çš„ï¼Œå°±æ˜¯åœ¨ç§»åŠ¨ä¸€ä¸ªViewçš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªAttachmenté™„ä»¶Viewï¼Œå§‹ç»ˆä¿æŒè·Ÿè¿™ä¸ªViewçš„ç›¸å¯¹ä½ç½®ä¸å˜ï¼Œå°±åƒæ˜¯â€œé™„ç€â€ã€â€œæ†ç»‘â€åœ¨è¿™ä¸ªViewä¸Šä¸€æ ·ã€‚</p>
<h3 id="å…³é”®æ¦‚å¿µï¼šçº¦æŸ-â€œåŠ¨æ€çš„ç»‘å®šâ€"><a href="#å…³é”®æ¦‚å¿µï¼šçº¦æŸ-â€œåŠ¨æ€çš„ç»‘å®šâ€" class="headerlink" title="å…³é”®æ¦‚å¿µï¼šçº¦æŸ = â€œåŠ¨æ€çš„ç»‘å®šâ€"></a>å…³é”®æ¦‚å¿µï¼šçº¦æŸ = â€œåŠ¨æ€çš„ç»‘å®šâ€</h3><p>ä¹‹æ‰€ä»¥å†™è¿™ä¸ªä¾‹å­ï¼Œä¸»è¦æ˜¯æƒ³ä»æ¦‚å¿µä¸Šæ›´åŠ æ·±å…¥çš„ç†è§£Autolayoutä¸ä¼ ç»Ÿçš„è®¾ç½®Frameçš„ä¸åŒï¼Œå³Autolayouté‡Œé¢çš„çº¦æŸï¼Œå…¶å®æ˜¯â€œåŠ¨æ€çš„ç»‘å®šâ€ï¼Œæ˜¯æ§ä»¶ç›¸äº’ä¹‹é—´çš„ä½ç½®å…³ç³»ç»‘å®šï¼Œçº¦æŸæ˜¯å¯ä»¥<strong>å®æ—¶</strong>ä¿è¯è¿™ç§ç»‘å®šå…³ç³»çš„ã€‚</p>
<p>ä¼ ç»Ÿçš„è®¾ç½®Frameï¼Œåœ¨Viewçš„å†…å®¹ã€ä½ç½®è¦å˜åŒ–æ—¶ï¼Œæ˜¯è¦æ‰‹åŠ¨è®¾ç½®çš„ï¼Œæ˜¯â€œä¸€æ¬¡æ€§â€çš„ï¼Œè€ŒAutolayoutï¼Œåœ¨ç¡®å®šäº†çº¦æŸåï¼Œä¼šå®æ—¶çš„ç”¨çº¦æŸçš„è§„åˆ™å»æ›´æ–°Frameï¼Œæ‰€ä»¥å¯ä»¥é¿å…è¿™ç§æ‰‹åŠ¨è®¾ç½®ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¯¹äºæœ¬ä¾‹å­æ¥è¯´ï¼Œè®¾ç½®Frameçš„æ–¹å¼å’ŒAutolayoutçš„æ–¹å¼å¯¹æ¯”å¦‚ä¸‹ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry4_3.png?1=1" alt="Case 2: Autolayoutçš„çº¦æŸ=æ§ä»¶é—´ä½ç½®å…³ç³»çš„â€œç»‘å®šâ€"></p>
<p>ç”¨Autolayoutçš„è¯ï¼Œåªè¦æŠŠAttachmentçš„ä½ç½®è®¾ç½®ä¸ºç›¸å¯¹äºTipLabelå°±å¯ä»¥äº†ã€‚</p>
<h3 id="å®ç°ç»†èŠ‚-1"><a href="#å®ç°ç»†èŠ‚-1" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h3><p>ä»£ç æ¯”è¾ƒç®€å•ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[attachmentView mas_makeConstraints:^(<span class="name">MASConstraintMaker</span> *make) &#123;</div><div class="line">    // ä¾é™„åœ¨tipLabelä¸Š</div><div class="line">    make.left.equalTo(<span class="name">_tipLabel.mas_left</span>).with.offset(<span class="number">20</span>).priorityHigh()<span class="comment">;</span></div><div class="line">    make.bottom.equalTo(<span class="name">_tipLabel.mas_top</span>).with.offset(<span class="name">-2</span>).priorityHigh()<span class="comment">;</span></div><div class="line">&#125;]<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>ç§»åŠ¨Tipçš„ç›¸å…³ä»£ç çœ‹Case 1çš„å°±è¡Œ~</p>
<h3 id="å°èŠ‚-1"><a href="#å°èŠ‚-1" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h3><p>æœ¬å°èŠ‚çš„Caseæ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç€é‡ç‚¹å‡ºâ€œAutolayoutçº¦æŸ=åŠ¨æ€ä½ç½®ç»‘å®šâ€è¿™ä¸ªç‚¹ï¼Œç†è§£äº†è¿™ä¸€ç‚¹ï¼Œæ‰èƒ½æ›´å¥½åœ°è¿ç”¨Autolayout~</p>
<h2 id="Case-3-åˆ©ç”¨layoutIfNeededæ§åˆ¶çº¦æŸçš„ç”Ÿæ•ˆæ—¶æœº"><a href="#Case-3-åˆ©ç”¨layoutIfNeededæ§åˆ¶çº¦æŸçš„ç”Ÿæ•ˆæ—¶æœº" class="headerlink" title="Case 3: åˆ©ç”¨layoutIfNeededæ§åˆ¶çº¦æŸçš„ç”Ÿæ•ˆæ—¶æœº"></a>Case 3: åˆ©ç”¨layoutIfNeededæ§åˆ¶çº¦æŸçš„ç”Ÿæ•ˆæ—¶æœº</h2><h3 id="å®ç°åŠŸèƒ½-2"><a href="#å®ç°åŠŸèƒ½-2" class="headerlink" title="å®ç°åŠŸèƒ½"></a>å®ç°åŠŸèƒ½</h3><p>Case 3çš„ä¾‹å­ï¼Œæ˜¯ä¸€ä¸ªç°è‰²çš„Viewï¼Œåˆå§‹æ—¶åœ¨å±å¹•ä¸­å¤®ï¼Œç„¶åæŒ‰ä¸‹â€œæ‰§è¡ŒåŠ¨ç”»â€åï¼Œä»å·¦è¾¹æ»‘å…¥ã€‚</p>
<h3 id="æ­¥éª¤åˆ†æ"><a href="#æ­¥éª¤åˆ†æ" class="headerlink" title="æ­¥éª¤åˆ†æ"></a>æ­¥éª¤åˆ†æ</h3><p>ç›´è§‚ä¸Šçœ‹ï¼Œæ„Ÿè§‰æ˜¯åœ¨æŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œä¿®æ”¹Viewçš„æ°´å¹³æ–¹å‘ä¸Šçš„æŸä¸ªçº¦æŸï¼Œç„¶åç”¨UIViewçš„åŠ¨ç”»æ‰§è¡Œå˜åŒ–å°±å¥½äº†ã€‚  </p>
<p>ä½†æ˜¯ä»”ç»†åˆ†æï¼Œåº”è¯¥æ˜¯å…ˆè®¾ç½®Viewçš„ä½ç½®åˆ°å±å¹•çš„å·¦è¾¹çœ‹ä¸è§çš„åŒºåŸŸï¼Œç„¶åç”¨åŠ¨ç”»å¹³æ»‘çš„å†è®©Viewç§»åŠ¨å›åŸä½ã€‚</p>
<p>å°±æ˜¯è¯´ï¼Œåªæ˜¯ä»å·¦è¾¹ç§»åŠ¨å›æ¥æ—¶ï¼Œæ‰è®©åŠ¨ç”»ç”Ÿæ•ˆï¼é—®é¢˜å°±å˜æˆäº†ï¼Œå¦‚ä½•è®©<strong>çº¦æŸåˆ†æ®µæ‰§è¡Œ</strong>ï¼Œæˆ–è€…è¯´ï¼Œ<strong>æ§åˆ¶çº¦æŸçš„ç”Ÿæ•ˆæ—¶æœº</strong>ã€‚</p>
<p>æ­¥éª¤å¯ä»¥ç”±ä¸‹å›¾è¡¨ç¤ºï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry4_4.png?1=1" alt="Case 3: åˆ©ç”¨layoutIfNeededæ§åˆ¶çº¦æŸçš„ç”Ÿæ•ˆæ—¶æœº"></p>
<h3 id="å®ç°å…³é”®"><a href="#å®ç°å…³é”®" class="headerlink" title="å®ç°å…³é”®"></a>å®ç°å…³é”®</h3><p>æ­¥éª¤åˆ†ææ¸…æ¥šäº†ï¼Œé‚£ä¹ˆé—®é¢˜å°±æ˜¯å¦‚ä½•è®©çº¦æŸåœ¨ä¿®æ”¹åï¼Œâ€œç«‹å³â€ç”Ÿæ•ˆï¼Œè€Œä¸æ˜¯ç­‰åˆ°ç³»ç»Ÿè‡ªåŠ¨åœ¨ä¸‹æ¬¡æ›´æ–°å¸ƒå±€æ—¶è¢«åŠ¨çš„ç”Ÿæ•ˆã€‚</p>
<p>ç­”æ¡ˆå°±æ˜¯ï¼šåˆ©ç”¨<strong><code>layoutIfNeeded</code></strong>  </p>
<p>åœ¨æ›´æ”¹äº†çº¦æŸåï¼Œè°ƒç”¨<code>layoutIfNeeded</code>ï¼Œå°±å¯ä»¥é€šçŸ¥ç³»ç»Ÿç«‹å³åˆ·æ–°å¸ƒå±€ï¼Œä»è€Œæ›´æ–°Frameã€‚å¦‚æœè¦æ›´åŠ â€œä¿é™©â€ï¼Œå¯ä»¥åœ¨è°ƒç”¨<code>layoutIfNeeded</code>å‰ï¼ŒåŠ ä¸Šè°ƒç”¨<code>setNeedsUpdateConstraints</code>ã€<code>setNeedsLayout</code>ï¼Œç³»ç»Ÿåˆ·æ–°å¸ƒå±€æ—¶ï¼Œå°±ä¼šå…ˆæ›´æ–°çº¦æŸï¼Œç„¶åæ ¹æ®çº¦æŸé‡æ–°è®¡ç®—ç›¸å…³Viewçš„Frameï¼Œæƒ³äº†è§£å…·ä½“çš„è¿‡ç¨‹çš„ï¼Œå¯ä»¥å‚è€ƒï¼š<a href="https://developer.apple.com/videos/play/wwdc2015/218/" target="_blank" rel="external">Mysteries of Auto Layout, Part 1 - WWDC 2015</a>ã€<a href="https://developer.apple.com/videos/play/wwdc2015/219/" target="_blank" rel="external">Mysteries of Auto Layout, Part 2</a></p>
<h3 id="å®ç°ç»†èŠ‚-2"><a href="#å®ç°ç»†èŠ‚-2" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h3><p>å…·ä½“çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è®¾ç½®åˆå§‹çŠ¶æ€ï¼Œç§»åŠ¨Viewåˆ°å±å¹•å·¦è¾¹ä¸å¯è§åŒºåŸŸ</span></div><div class="line"><span class="selector-tag">_centerXConstraint</span><span class="selector-class">.equalTo</span>(@(-CGRectGetWidth(self.view.frame)));</div><div class="line"><span class="comment">// ç«‹å³è®©çº¦æŸç”Ÿæ•ˆ,åˆ·æ–°Frame</span></div><div class="line"><span class="selector-attr">[self.view layoutIfNeeded]</span>;</div><div class="line"><span class="comment">// è®¾ç½®è¦åŠ¨ç”»çš„çº¦æŸï¼Œç§»å›åŸä½</span></div><div class="line"><span class="selector-tag">_centerXConstraint</span><span class="selector-class">.equalTo</span>(<span class="variable">@0</span>);</div><div class="line"><span class="comment">// æ‰§è¡ŒåŠ¨ç”»</span></div><div class="line"><span class="selector-attr">[UIView animateWithDuration:0.3f animations:^&#123;</span></div><div class="line">    [self.view layoutIfNeeded]; </div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h3 id="å°èŠ‚-2"><a href="#å°èŠ‚-2" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h3><p>ä¹‹å‰åœ¨å®ç°<a href="https://github.com/zekunyan/TTGSnackbar" target="_blank" rel="external">TTGSnackbar</a>çš„æ—¶å€™ï¼Œå°±å¤§é‡çš„ä½¿ç”¨äº†<code>layoutIfNeeded</code>æ¥ç«‹å³åˆ·æ–°Viewçš„Frameï¼Œç„¶åæ‰è®©äº§ç”ŸåŠ¨ç”»çš„çº¦æŸå˜åŠ¨ç”Ÿæ•ˆï¼Œä¹Ÿå°±æ˜¯åˆ†é˜¶æ®µçš„è®©çº¦æŸç”Ÿæ•ˆï¼Œéå¸¸ç®¡ç”¨~</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸çŸ¥ä¸è§‰å·²ç»ç¬¬å››ç¯‡äº†ï¼Œä¸€å…±12ä¸ªCaseï¼Œéƒ½æ˜¯å¹³æ—¶å¼€å‘æ—¶æ€»ç»“å‡ºæ¥çš„ç‚¹ï¼Œä»¥åŠå¯¹Autolayoutçš„ç†è§£ï¼Œå¸Œæœ›å¯ä»¥ä¸€ç›´å°†è¿™ä¸ªç³»åˆ—åšæŒä¸‹å»~~</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ç¬¬å››ç¯‡æ¥äº†ã€‚&lt;br&gt;è¿˜æ˜¯3ä¸ªå°ä¾‹å­ï¼Œä»ç„¶æ˜¯ä¸»è¦éƒ¨åˆ†ç”¨Masonryæ‰‹å†™ä»£ç å®ç°ï¼Œå…¶å®ƒçš„çº¦æŸåœ¨storyboardé‡Œé¢ç›´æ¥æ‹–æ‹½æ­å»ºã€‚&lt;br&gt;ä¸‰ä¸ªä¾‹å­åˆ†åˆ«æ˜¯ï¼š  &lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨çº¦æŸä¼˜å…ˆçº§ä¿è¯å¯ç§»åŠ¨Viewçš„å†…å®¹å¯è§æ€§&lt;/li&gt;
&lt;li&gt;Autolayoutçš„çº¦æŸ=æ§ä»¶é—´ä½ç½®å…³ç³»çš„â€œç»‘å®šâ€&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨&lt;code&gt;layoutIfNeeded&lt;/code&gt;æ§åˆ¶çº¦æŸçš„ç”Ÿæ•ˆæ—¶æœº&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å‰ä¸‰ç¯‡ï¼š  &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ç¯‡ï¼š&lt;a href=&quot;http://tutuge.me/2015/05/23/autolayout-example-with-masonry/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹-Masonryå®ç°&lt;/a&gt;  &lt;/li&gt;
&lt;li&gt;ç¬¬äºŒç¯‡ï¼š&lt;a href=&quot;http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°&lt;/a&gt;  &lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰ç¯‡ï¼š&lt;a href=&quot;http://tutuge.me/2015/12/14/autolayout-example-with-masonry3/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹3-Masonryå®ç°&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Githubåœ°å€ï¼š&lt;br&gt;&lt;a href=&quot;https://github.com/zekunyan/AutolayoutExampleWithMasonry&quot;&gt;https://github.com/zekunyan/AutolayoutExampleWithMasonry&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry4_1.gif&quot; alt=&quot;Gifç¤ºä¾‹&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="Autolayout" scheme="http://tutuge.me/tags/Autolayout/"/>
    
      <category term="Masonry" scheme="http://tutuge.me/tags/Masonry/"/>
    
  </entry>
  
  <entry>
    <title>ç¿»è¯‘-ä¸ºä»€ä¹ˆobjc_msgSendå¿…é¡»ç”¨æ±‡ç¼–å®ç°</title>
    <link href="http://tutuge.me/2016/06/19/translation-why-objcmsgsend-must-be-written-in-assembly/"/>
    <id>http://tutuge.me/2016/06/19/translation-why-objcmsgsend-must-be-written-in-assembly/</id>
    <published>2016-06-18T16:19:23.000Z</published>
    <updated>2016-08-07T06:17:32.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¯‘è€…å‰è¨€"><a href="#è¯‘è€…å‰è¨€" class="headerlink" title="è¯‘è€…å‰è¨€"></a>è¯‘è€…å‰è¨€</h2><p>æ€»æ˜¯çœ‹åˆ°æœ‰äººè¯´ç”¨æ±‡ç¼–å®ç°<code>objc_msgSend</code>æ˜¯ä¸ºäº†é€Ÿåº¦å¿«ï¼Œå½“ç„¶è¿™ä¸ªä¸å¯å¦è®¤ã€‚ä½†æ˜¯éš¾é“æ²¡æœ‰åˆ«çš„åŸå› ï¼Ÿäºæ˜¯å°±çœ‹åˆ°äº†è¿™ç¯‡æ–‡ç« ï¼Œé‚ç¿»è¯‘ä¹‹ï¼=ã€‚=  </p>
<p>æˆ‘è‡ªå·±çš„ç†è§£å°±æ˜¯ï¼Œç”¨æ±‡ç¼–å®ç°ï¼Œæ˜¯ä¸ºäº†åº”å¯¹ä¸åŒçš„â€œ<a href="https://en.wikipedia.org/wiki/Calling_convention" target="_blank" rel="external">Calling convention</a>â€ï¼ŒæŠŠå‡½æ•°è°ƒç”¨å‰çš„æ ˆå’Œå¯„å­˜å™¨çš„å‚æ•°ã€çŠ¶æ€è®¾ç½®ï¼Œäº¤ç»™ç¼–è¯‘å™¨å»å¤„ç†ã€‚<br>å…ˆçœ‹çœ‹åŸæ–‡å§ã€‚</p>
<blockquote>
<p>åŸä½œè€…: <a href="https://www.linkedin.com/in/ari-grant-789a1015" target="_blank" rel="external">Ari Grant</a><br>åŸæ–‡é“¾æ¥: <a href="http://arigrant.com/blog/2014/2/12/why-objcmsgsend-must-be-written-in-assembly" target="_blank" rel="external">Why objc_msgSend Must be Written in Assembly</a></p>
</blockquote>
<a id="more"></a>
<h2 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h2><p>å¯¹äºObjective-Cæ¥è¯´ï¼Œè°ƒç”¨ä¸€ä¸ªå¯¹è±¡å®ä¾‹çš„æ–¹æ³•ï¼Œä¹Ÿå«ä½œå‘è¿™ä¸ªå¯¹è±¡å®ä¾‹<strong>â€œå‘é€æ¶ˆæ¯â€</strong>ï¼Œè€Œæ¯æ¡â€œæ¶ˆæ¯â€ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µéƒ½ä¼šè½¬å˜ä¸ºä¸€æ¬¡å¯¹<code>objc_msgSend</code>å‡½æ•°çš„è°ƒç”¨ï¼Œè°ƒç”¨çš„å‚æ•°ä¸ä»…æœ‰åŸæœ¬æ¶ˆæ¯çš„æ‰€æœ‰å‚æ•°ï¼Œè¿˜æœ‰æ¶ˆæ¯çš„æ¥æ”¶è€…<code>receiver</code>å’Œå¯¹åº”çš„æ–¹æ³•<code>selector</code>ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢çš„è¯­å¥ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[receiver <span class="string">message:</span>foo <span class="string">beforeDate:</span>bar];</div></pre></td></tr></table></figure>
<p>å°†ä¼šè¢«ç¼–è¯‘æˆï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">objc_msgSend</span>(receiver, <span class="variable">@selector</span>(<span class="attribute">message</span>:<span class="attribute">beforeDate</span>:), foo, bar);</div></pre></td></tr></table></figure>
<p>å¯¹äº<code>objc_msgSend</code>å‡½æ•°çš„å®ç°åŸç†ï¼Œå‰äººå·²ç»åšäº†å¤§é‡çš„æ¢ç´¢ã€‚æ‰€ä»¥ï¼Œæœ¬æ–‡å°†ä¼šæŠŠé‡ç‚¹æ”¾åœ¨<code>objc_msgSend</code>çš„ä¸€ä¸ªä¹‹å‰æ²¡æœ‰å¤ªå—åˆ°å…³æ³¨çš„ç‚¹ä¸Šï¼Œé‚£å°±æ˜¯ï¼š</p>
<p><strong><code>objc_msgSend</code>æ˜¯ä¸å¯èƒ½ç”¨Objective-Cã€Cæˆ–è€…C++å®ç°çš„ã€‚</strong></p>
<h2 id="THE-RETURN-TYPE-è¿”å›ç±»å‹"><a href="#THE-RETURN-TYPE-è¿”å›ç±»å‹" class="headerlink" title="THE RETURN TYPE - è¿”å›ç±»å‹"></a>THE RETURN TYPE - è¿”å›ç±»å‹</h2><p>å…ˆçœ‹çœ‹å¦‚ä¸‹ä¸¤è¡Œä»£ç ï¼š </p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">NSUInteger n</span> = [array count];</div><div class="line"><span class="attribute">id obj</span> = [array objectAtIndex:6];</div></pre></td></tr></table></figure>
<p>ç›´è§‚ä¸Šçœ‹ï¼Œå°†ä¼šè¢«ç¼–è¯‘æˆï¼š</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NSUInteger n = objc_msgSend(<span class="name">array</span>,  @selector(<span class="name">count</span>))<span class="comment">;</span></div><div class="line">id obj = objc_msgSend(<span class="name">array</span>, @selector(<span class="name">objectAtIndex</span>:), <span class="number">6</span>)<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯å®é™…ä¸Šè¿™æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºæ²¡æœ‰å‡½æ•°å¯ä»¥åŒæ—¶æ»¡è¶³è¿™ä¸¤ä¸ªè°ƒç”¨ã€‚è€Œä¸”å®ƒçš„è¿”å›å€¼ä¹Ÿä¸èƒ½åŒæ—¶æ˜¯<code>NSUInteger</code>å’Œ<code>id</code>ã€‚</p>
<p>è€Œä¸”ï¼Œä¸Šé¢çš„ä»£ç ä¹Ÿæ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ã€‚é‚£ä¹ˆï¼ŒåŠ ä¸Šç±»å‹è½¬æ¢æ€ä¹ˆæ ·ï¼Ÿ</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NSUInteger n = (<span class="name">NSUInteger</span> (<span class="name">*</span>)(<span class="name">id</span>, SEL))objc_msgSend(<span class="name">array</span>,  @selector(<span class="name">count</span>))<span class="comment">;</span></div><div class="line">id obj = (<span class="name">id</span> (<span class="name">*</span>)(<span class="name">id</span>, SEL, NSUInteger))objc_msgSend(<span class="name">array</span>, @selector(<span class="name">objectAtIndex</span>:), <span class="number">6</span>)<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸‹å¯ä»¥ç¼–è¯‘é€šè¿‡äº†ï¼Œè™½ç„¶çœ‹èµ·æ¥ä¸ç›´è§‚ã€‚ã€‚ã€‚  </p>
<p><code>objc_msgSend</code>æ˜¯ä¸€ä¸ªPublicçš„å‡½æ•°ï¼Œåœ¨<code>&lt;objc/message.h&gt;</code>é‡Œå£°æ˜ï¼Œå¦‚æœä½ æƒ³ç›´æ¥è°ƒç”¨å®ƒï¼Œå°±å¿…é¡»æŒ‰ç…§ä¸Šé¢çš„æ ¼å¼åŠ ä¸Šå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè¦ä¸ç„¶æ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡çš„ã€‚ä½†æ˜¯<code>objc_msgSend</code>åˆ°åº•æ˜¯å¦‚ä½•å®ç°ï¼Œæ¥æ”¯æŒå„ç§è¿”å›ç±»å‹çš„ï¼Ÿæœ¬æ–‡åé¢ä¼šè®²åˆ°ã€‚</p>
<h2 id="THE-IMP-æ–¹æ³•å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆ"><a href="#THE-IMP-æ–¹æ³•å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆ" class="headerlink" title="THE IMP - æ–¹æ³•å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆ"></a>THE IMP - æ–¹æ³•å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆ</h2><p><code>objc_msgSend</code>å‡½æ•°çš„æœ¬è´¨å¾ˆç®€å•ï¼Œä¼ å…¥ä¸€ä¸ªæ¥å—è€…å¯¹è±¡å®ä¾‹<code>receiver</code>å’Œæ–¹æ³•å<code>selector</code>ï¼Œå®ƒå°±ä¼šæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ‰§è¡Œï¼šï¼ˆè¯‘è€…æ³¨ï¼šåªæ˜¯æœ€ç²—ç•¥çš„æ­¥éª¤=ã€‚=ï¼‰</p>
<ul>
<li>è·å–<code>receiver</code>å¾—ç±»Class</li>
<li>åœ¨Classçš„æ–¹æ³•åˆ—è¡¨method tableé‡Œé¢æŸ¥æ‰¾å¯¹åº”<code>selector</code>çš„æ–¹æ³•å®ç°</li>
<li>æ‰¾åˆ°çš„è¯å°±è°ƒç”¨ï¼Œè¿”å›</li>
<li>æ‰¾ä¸åˆ°å°±åœ¨å…¶çˆ¶ç±»ä¸­æ‰¾ï¼Œé‡å¤å‰é¢çš„æ­¥éª¤ï¼ˆç›´åˆ°æ²¡æœ‰çˆ¶ç±»ä¸ºæ­¢ï¼‰</li>
</ul>
<p>æ•´ä¸ªæµç¨‹å¾ˆç®€å•ï¼Œæ²¿ç€ç»§æ‰¿é“¾ï¼Œå‘ä¸Šæ‰¾åˆ°æ–¹æ³•<code>selector</code>å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆå³å¯ï¼Œä¹Ÿå°±æ˜¯<code>IMP</code>ã€‚åŒæ—¶ï¼Œåœ¨æ¯å±‚Classä¸­éƒ½æœ‰ç¼“å­˜ï¼ŒåŠ å¿«åç»­çš„æ–¹æ³•æŸ¥æ‰¾ã€‚ä½†æ˜¯ï¼Œè¿™ä¹Ÿåªæ˜¯<code>objc_msgSend</code>çš„å®ç°ç»†èŠ‚ï¼Œæ‰€ä»¥ï¼Œæ¥ç€å¾€ä¸‹çœ‹ã€‚</p>
<h2 id="THE-ARG-TYPES-AND-COUNT-å‚æ•°ç±»å‹å’Œæ•°é‡"><a href="#THE-ARG-TYPES-AND-COUNT-å‚æ•°ç±»å‹å’Œæ•°é‡" class="headerlink" title="THE ARG TYPES AND COUNT - å‚æ•°ç±»å‹å’Œæ•°é‡"></a>THE ARG TYPES AND COUNT - å‚æ•°ç±»å‹å’Œæ•°é‡</h2><p>ç®€å•æ¥è¯´ï¼Œå½“<code>objc_msgSend</code>æ‰¾åˆ°å¯¹åº”çš„å‡½æ•°æŒ‡é’ˆåï¼Œåªè¦ç”¨ä¼ å…¥çš„å‚æ•°è°ƒç”¨è¿™ä¸ªå‡½æ•°å³å¯ã€‚å‰©ä¸‹æ¥çš„å°±æ˜¯æ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥è°ƒç”¨ä»»æ„å‚æ•°ç±»å‹ã€æ•°é‡çš„ä»»æ„å‡½æ•°ã€‚  </p>
<p>å‚æ•°çš„æ•°é‡å¾ˆå®¹æ˜“è®¡ç®—ã€‚ç„¶åæˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰çš„å‚æ•°éƒ½æ”¾å…¥<code>varargs</code>ï¼Œç„¶åè°ƒç”¨å‡½æ•°æ—¶ä¼ å…¥å³å¯ã€‚ä½†æ˜¯è¿™æ ·çš„è¯ï¼Œæ¯ä¸ªObjective-Cçš„æ–¹æ³•éƒ½å¿…é¡»åœ¨å…¶<code>prologue</code>ï¼ˆè¯‘è€…æ³¨ï¼šå‡½æ•°æ‰§è¡Œå…·ä½“çš„â€œä»»åŠ¡â€å‰ï¼Œæ‰€åšçš„å‡†å¤‡ç¯èŠ‚ï¼‰é‡Œé¢æŠŠæ‰€æœ‰çš„å‚æ•°ä»<code>varargs</code>é‡Œé¢æå–å‡ºæ¥ã€‚  </p>
<p>è¿™ç§æŠŠå‚æ•°æ‰“åŒ…åˆ°<code>varargs</code>é‡Œé¢ç„¶ååˆå–å‡ºæ¥çš„åŠæ³•æ˜¾ç„¶æ˜¯éå¸¸ç³Ÿç³•çš„ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸å¿…è¦çš„ã€‚</p>
<p>åœ¨Cè¯­è¨€ä¸­ï¼Œè°ƒç”¨ä¸€ä¸ªå‡½æ•°ä¼šè¢«ç¼–è¯‘æˆå¯¹åº”çš„æ±‡ç¼–è¯­è¨€æŒ‡ä»¤ï¼Œé¦–å…ˆæ˜¯è®¾ç½®å‚æ•°ï¼ˆæŠŠå‚æ•°æ”¾åˆ°å¯„å­˜å™¨ã€æ ˆä¸Šï¼‰ï¼Œç„¶åç”¨å¦‚<code>jump</code>æˆ–è€…<code>call</code>çš„æŒ‡ä»¤ï¼Œè·³åˆ°å…·ä½“çš„å‡½æ•°ä»£ç åœ°å€å¤„ã€‚å¦‚æœæˆ‘ä»¬æƒ³æ”¯æŒä»»æ„ç±»å‹çš„å‡½æ•°ç±»å‹ï¼Œæˆ‘ä»¬å°±å¿…é¡»å†™ä¸€ä¸ª<code>switch</code>è¯­å¥ï¼ŒæŠŠæ‰€æœ‰çš„å‚æ•°ç»„åˆæƒ…å†µéƒ½åŒ…å«èµ·æ¥ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®çš„ä¸ºä»»ä½•å½¢å¼çš„å‡½æ•°è®¾ç½®å‚æ•°ï¼ˆè¯‘è€…æ³¨ï¼šå³æŒ‰ç…§æŸç§<strong>â€œè§„èŒƒâ€ã€â€œçº¦å®šâ€</strong>ï¼ŒæŠŠå‚æ•°ä¾æ¬¡å­˜æ”¾åˆ°â€œçº¦å®šâ€çš„å¯„å­˜å™¨ã€æ ˆä¸Šï¼‰ï¼Œè¿™æ˜¾ç„¶æ˜¯æ²¡æœ‰æ‰©å±•æ€§çš„ï¼Œæ›´æ˜¯ä¸å¯èƒ½çš„ã€‚</p>
<h2 id="UNWINDING-THE-CALL-æ‹†è§£è°ƒç”¨"><a href="#UNWINDING-THE-CALL-æ‹†è§£è°ƒç”¨" class="headerlink" title="UNWINDING THE CALL - æ‹†è§£è°ƒç”¨"></a>UNWINDING THE CALL - æ‹†è§£è°ƒç”¨</h2><p><code>objc_msgSend</code>çš„è§£å†³åŠæ³•ï¼Œä¸»è¦ä¾æ®çš„æ˜¯ï¼š<strong>å½“objc_msgSendè¢«è°ƒç”¨æ—¶ï¼Œæ‰€æœ‰çš„å‚æ•°å·²ç»è¢«è®¾ç½®å¥½äº†</strong>ã€‚  </p>
<p>æ¢ä¸€ç§æ–¹å¼æ¥è¯´ï¼Œå°±æ˜¯ï¼š<strong>åœ¨objc_msgSendå¼€å§‹æ‰§è¡Œæ—¶ï¼Œæ ˆå¸§ï¼ˆstack frameï¼‰çš„çŠ¶æ€ã€æ•°æ®ï¼Œå’Œå„ä¸ªå¯„å­˜å™¨çš„ç»„åˆå½¢å¼ã€æ•°æ®ï¼Œè·Ÿè°ƒç”¨å…·ä½“çš„å‡½æ•°æŒ‡é’ˆï¼ˆIMPï¼‰æ—¶æ‰€éœ€çš„çŠ¶æ€ã€æ•°æ®ï¼Œæ˜¯å®Œå…¨ä¸€è‡´çš„ï¼</strong></p>
<p>å¦‚ä¸‹è¿™è¡Œä»£ç ï¼š</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">id obj = objc_msgSend(<span class="name">array</span>, @selector(<span class="name">objectAtIndex</span>:), <span class="number">6</span>)<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>åœ¨è°ƒç”¨<code>objc_msgSend</code>æ—¶ï¼Œéœ€è¦è®¾ç½®ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯è¢«è°ƒç”¨æ–¹<code>receiver</code>ã€æ–¹æ³•å<code>selector</code>å’Œæœ€åä¸€ä¸ªæ•´å‹å‚æ•°6ã€‚è¿™å’Œå…·ä½“çš„æ–¹æ³•å‡½æ•°IMPçš„å‚æ•°é¡ºåºã€ç±»å‹æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>è°ƒç”¨<code>objc_msgSend</code>å‰ï¼Œè®¾ç½®çš„æ ˆã€å¯„å­˜å™¨çš„çŠ¶æ€ã€æ•°æ®æ­£æ˜¯è°ƒç”¨å…·ä½“çš„æ–¹æ³•å‡½æ•°æ—¶éœ€è¦çš„çŠ¶æ€ï¼</strong>  </p>
<p>æ‰€ä»¥ï¼Œå½“<code>objc_msgSend</code>æ‰¾åˆ°è¦è°ƒç”¨çš„å‡½æ•°å®ç°IMPåï¼Œåªéœ€è¦æŠŠæ‰€æœ‰çš„å¯¹æ ˆã€å¯„å­˜å™¨çš„æ“ä½œâ€œå€’â€å›åˆ°<code>objc_msgSend</code>æ‰§è¡Œå¼€å§‹çš„çŠ¶æ€ï¼ˆç±»ä¼¼äºå‡½æ•°æ‰§è¡Œå®Œæˆreturnè¿”å›å‰ï¼Œåšçš„â€œæ”¶å°¾å¤„ç†â€å·¥ä½œä¸€æ ·ï¼Œå³epilogueï¼‰ï¼Œç›´æ¥<code>jump/call</code>åˆ°IMPå‡½æ•°æŒ‡é’ˆå¯¹åº”çš„åœ°å€ï¼Œæ‰§è¡ŒæŒ‡ä»¤å³å¯ï¼Œå› ä¸ºæ‰€æœ‰çš„å‚æ•°å·²ç»è¢«è®¾ç½®å¥½äº†ã€‚</p>
<p>åŒæ—¶ï¼Œå½“<code>selector</code>å¯¹åº”çš„IMPæ‰§è¡Œå®Œæˆåï¼Œè¿”å›å€¼ä¹Ÿè¢«æ­£ç¡®çš„è®¾ç½®å¥½äº†ï¼ˆåœ¨x86å¹³å°ä¸Šï¼Œè¿”å›å€¼è¢«è®¾ç½®åˆ°äº†æŒ‡å®šçš„å¯„å­˜å™¨<code>eax/rax</code>é‡Œï¼Œåœ¨armä¸Šï¼Œåˆ™æ˜¯<code>r0</code>å¯„å­˜å™¨ï¼‰ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä¹Ÿä¸å¿…æ‹…å¿ƒå‰æ–‡æåˆ°çš„ä¸åŒç±»å‹çš„è¿”å›å€¼é—®é¢˜äº†ã€‚</p>
<h2 id="WRAP-UP-æ€»ç»“"><a href="#WRAP-UP-æ€»ç»“" class="headerlink" title="WRAP UP - æ€»ç»“"></a>WRAP UP - æ€»ç»“</h2><p>æŠŠä¸Šé¢æåˆ°çš„æ‰€æœ‰è§£é‡Šç»¼åˆèµ·æ¥ï¼Œå°±æ˜¯ï¼šåœ¨Cè¯­è¨€é‡Œé¢è°ƒç”¨å‡½æ•°ï¼Œå¿…é¡»åœ¨ç¼–è¯‘æ—¶å°±çŸ¥é“è°ƒç”¨çš„â€œçŠ¶æ€â€ï¼›è€Œè¿™äº›â€œçŠ¶æ€â€åœ¨è¿è¡Œæ—¶æ˜¯æ— æ³•å¾—å‡ºæˆ–æ­£ç¡®å¤„ç†çš„ï¼Œæ‰€ä»¥å¿…é¡»å¾€åº•å±‚èµ°ï¼Œç”¨æ±‡ç¼–å¤„ç†ã€‚ï¼ˆè¯‘è€…æ³¨ï¼šè¿™é‡Œä¸çŸ¥é“å’‹ç¿»è¯‘å¥½=ã€‚=ï¼ŒåŸæ–‡æ˜¯ï¼šcalling a function in C requires the signature to be known for each call-site at compile-timeï¼›doing so at run-time is not possible and so one must drop down into assembly and party there instead.ï¼‰</p>
<h2 id="UPDATE-åç»­"><a href="#UPDATE-åç»­" class="headerlink" title="UPDATE - åç»­"></a>UPDATE - åç»­</h2><p>æœ‰äººæŒ‡å‡º<code>objc_msgSend</code>æœ‰å¯èƒ½æ˜¯ç”¨GCCçš„æ‰©å±•æ–¹æ³•<code>__builtin_apply_args</code>ï¼Œ<code>__builtin_apply</code>ï¼Œå’Œ<code>__builtin_return</code>å®ç°çš„ã€‚è¿™ä¹Ÿæ­£æŒ‡å‡ºäº†ä¸€ä¸ªäº‹å®ï¼Œå°±æ˜¯è¿™äº›builtinsæ–¹æ³•æ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œå› ä¸ºå•é è¯­è¨€æœ¬èº«æ— æ³•å®ç°è¿™äº›åŠŸèƒ½ã€‚å®ç°<code>objc_msgSend</code>æ‰€éœ€è¦çš„æŠ€å·§ï¼Œä¹Ÿæ­£æ˜¯å®ç°è¿™äº›builtinsæ–¹æ³•æ‰€éœ€è¦çš„æŠ€å·§ã€‚æœ¬æ–‡çš„ç›®çš„å¹¶ä¸æ˜¯éè¦å°†ä»€ä¹ˆæ˜¯çœŸæ­£çš„Cã€ä»€ä¹ˆä¸æ˜¯çœŸæ­£çš„Cåˆ†ä¸ªæ¸…æ¥šï¼Œåªæ˜¯ä¸ºäº†æŒ‡å‡º<code>objc_msgSend</code>ç‰¹æ®Šç½¢äº†ã€‚</p>
<h2 id="è¯‘è€…æ€»ç»“"><a href="#è¯‘è€…æ€»ç»“" class="headerlink" title="è¯‘è€…æ€»ç»“"></a>è¯‘è€…æ€»ç»“</h2><p>å¼€å¤´ä¹Ÿè¯´äº†ï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼šç”¨æ±‡ç¼–å®ç°ï¼Œæ˜¯ä¸ºäº†åº”å¯¹ä¸åŒçš„â€œ<a href="https://en.wikipedia.org/wiki/Calling_convention" target="_blank" rel="external">Calling convention</a>â€ï¼ŒæŠŠå‡½æ•°è°ƒç”¨å‰çš„æ ˆå’Œå¯„å­˜å™¨çš„å‚æ•°ã€çŠ¶æ€è®¾ç½®ï¼Œäº¤ç»™ç¼–è¯‘å™¨å»å¤„ç†ã€‚  </p>
<p>å—¯ï¼Œä»¥åä¸è¦å†è¯´ç”¨æ±‡ç¼–å®ç°åªæ˜¯ä¸ºäº†å¿«äº†=ã€‚=</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è¯‘è€…å‰è¨€&quot;&gt;&lt;a href=&quot;#è¯‘è€…å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;è¯‘è€…å‰è¨€&quot;&gt;&lt;/a&gt;è¯‘è€…å‰è¨€&lt;/h2&gt;&lt;p&gt;æ€»æ˜¯çœ‹åˆ°æœ‰äººè¯´ç”¨æ±‡ç¼–å®ç°&lt;code&gt;objc_msgSend&lt;/code&gt;æ˜¯ä¸ºäº†é€Ÿåº¦å¿«ï¼Œå½“ç„¶è¿™ä¸ªä¸å¯å¦è®¤ã€‚ä½†æ˜¯éš¾é“æ²¡æœ‰åˆ«çš„åŸå› ï¼Ÿäºæ˜¯å°±çœ‹åˆ°äº†è¿™ç¯‡æ–‡ç« ï¼Œé‚ç¿»è¯‘ä¹‹ï¼=ã€‚=  &lt;/p&gt;
&lt;p&gt;æˆ‘è‡ªå·±çš„ç†è§£å°±æ˜¯ï¼Œç”¨æ±‡ç¼–å®ç°ï¼Œæ˜¯ä¸ºäº†åº”å¯¹ä¸åŒçš„â€œ&lt;a href=&quot;https://en.wikipedia.org/wiki/Calling_convention&quot;&gt;Calling convention&lt;/a&gt;â€ï¼ŒæŠŠå‡½æ•°è°ƒç”¨å‰çš„æ ˆå’Œå¯„å­˜å™¨çš„å‚æ•°ã€çŠ¶æ€è®¾ç½®ï¼Œäº¤ç»™ç¼–è¯‘å™¨å»å¤„ç†ã€‚&lt;br&gt;å…ˆçœ‹çœ‹åŸæ–‡å§ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åŸä½œè€…: &lt;a href=&quot;https://www.linkedin.com/in/ari-grant-789a1015&quot;&gt;Ari Grant&lt;/a&gt;&lt;br&gt;åŸæ–‡é“¾æ¥: &lt;a href=&quot;http://arigrant.com/blog/2014/2/12/why-objcmsgsend-must-be-written-in-assembly&quot;&gt;Why objc_msgSend Must be Written in Assembly&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="ç¿»è¯‘" scheme="http://tutuge.me/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>APIè¿”å›ç»“æœè®¾è®¡ç»éªŒä¸æ€»ç»“</title>
    <link href="http://tutuge.me/2016/05/02/design-json-api-respoense/"/>
    <id>http://tutuge.me/2016/05/02/design-json-api-respoense/</id>
    <published>2016-05-02T02:44:49.000Z</published>
    <updated>2016-05-03T09:09:07.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>RESTful APIçš„è®¾è®¡å·²ç»å¾ˆæˆç†Ÿäº†ï¼Œå¤§å®¶ä¹Ÿéƒ½æ¯”è¾ƒè®¤å¯ã€‚æœ¬æ–‡ä¹Ÿä¸å†è¿‡å¤šä»‹ç»RESTful APIç›¸å…³çš„çŸ¥è¯†ï¼Œè€Œæ˜¯é’ˆå¯¹JSONå‹APIçš„è¿”å›ç»“æœè®¾è®¡ï¼Œæ€»ç»“ä¸‹è‡ªå·±çš„ç»éªŒã€‚</p>
<h2 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h2><p>å…ˆæ¥çœ‹çœ‹è¿”å›ç»“æœçš„ç»“æ„ç¤ºä¾‹ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attribute">data </span>: &#123; <span class="comment">// è¯·æ±‚æ•°æ®ï¼Œå¯¹è±¡æˆ–æ•°ç»„å‡å¯</span></div><div class="line">        <span class="attribute">user_id</span>: <span class="number">123</span>,</div><div class="line">        <span class="attribute">user_name</span>: <span class="string">"tutuge"</span>,</div><div class="line">        <span class="attribute">user_avatar_url</span>: <span class="string">"http://tutuge.me/avatar.jpg"</span></div><div class="line">        ...</div><div class="line">    &#125;,</div><div class="line">    <span class="attribute">msg </span>: <span class="string">"done"</span>, <span class="comment">// è¯·æ±‚çŠ¶æ€æè¿°ï¼Œè°ƒè¯•ç”¨</span></div><div class="line">    <span class="attribute">code</span>: <span class="number">1001</span>, <span class="comment">// ä¸šåŠ¡è‡ªå®šä¹‰çŠ¶æ€ç </span></div><div class="line">    <span class="attribute">extra </span>: &#123; <span class="comment">// å…¨å±€é™„åŠ æ•°æ®ï¼Œå­—æ®µã€å†…å®¹ä¸å®š</span></div><div class="line">        <span class="attribute">type</span>: <span class="number">1</span>,</div><div class="line">        <span class="attribute">desc</span>: <span class="string">"ç­¾åˆ°æˆåŠŸï¼"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="dataå­—æ®µ-è¯·æ±‚æ•°æ®"><a href="#dataå­—æ®µ-è¯·æ±‚æ•°æ®" class="headerlink" title="dataå­—æ®µ - è¯·æ±‚æ•°æ®"></a>dataå­—æ®µ - è¯·æ±‚æ•°æ®</h3><p>é¦–å…ˆæ˜¯æœ¬æ¬¡è¯·æ±‚ç»“æœçš„æ•°æ®<code>data</code>å­—æ®µï¼Œå…¶å€¼ä¸ºå¯¹è±¡ï¼ˆå­—å…¸ï¼‰æˆ–æ•°ç»„å‡å¯ä»¥ï¼Œæ ¹æ®ä¸šåŠ¡è€Œå®šã€‚</p>
<p>å¦‚è¯·æ±‚çš„æ˜¯æŸä¸ªç”¨æˆ·çš„ä¸ªäººprofileä¿¡æ¯ï¼Œå°±å¯ä»¥æ˜¯å¯¹è±¡ï¼Œå¯¹è±¡é‡Œé¢æ˜¯ç”¨æˆ·profileçš„é”®å€¼å¯¹æ•°æ®ï¼Œå¦‚<code>user_id: 123</code>ã€<code>user_name: &quot;tutuge&quot;</code>ç­‰ã€‚</p>
<p>å¦‚æœè¯·æ±‚çš„æ˜¯åˆ—è¡¨æ•°æ®ï¼Œå°±å¯ä»¥æ˜¯æ•°ç»„ï¼Œå¦‚è¯·æ±‚ç”¨æˆ·åˆ—è¡¨ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">data:</span> [</div><div class="line">    &#123;<span class="string">user_id:</span> <span class="number">123</span>, <span class="string">user_name:</span> <span class="string">"tutuge"</span>&#125;,</div><div class="line">    &#123;<span class="string">user_id:</span> <span class="number">321</span>, <span class="string">user_name:</span> <span class="string">"zekunyan"</span>&#125;,</div><div class="line">    ...</div><div class="line">]</div></pre></td></tr></table></figure>
<p>æ•°ç»„ã€å¯¹è±¡ï¼Œç›¸äº’åµŒå¥—ï¼Œçµæ´»ç»„åˆå³å¯ã€‚</p>
<p>å¯¹äºiOSæ¥è¯´ï¼Œè§£æ<code>data</code>å­—æ®µæ˜¯å¯¹è±¡è¿˜æ˜¯æ•°ç»„ä¹Ÿå¾ˆå®¹æ˜“ï¼Œåœ¨æ¥æ”¶åˆ°JSONæ•°æ®å­—å…¸åï¼Œå¦‚AFNetworkingçš„è¿”å›ç»“æœï¼Œå¯¹<code>data</code>åˆ¤æ–­å…¶ç±»å‹å³å¯ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([jsonDict[@<span class="string">"data"</span>] <span class="string">isKindOfClass:</span>[NSDictionary <span class="class"><span class="keyword">class</span>]]) &#123;</span></div><div class="line">    <span class="comment">// JSONå¯¹è±¡</span></div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> ([jsonDict[@<span class="string">"data"</span>] <span class="string">isKindOfClass:</span>[NSArray <span class="class"><span class="keyword">class</span>]]) &#123;</span></div><div class="line">    <span class="comment">// JSONæ•°ç»„</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="msgå­—æ®µ-è¯·æ±‚çŠ¶æ€æè¿°ï¼Œè°ƒè¯•ç”¨"><a href="#msgå­—æ®µ-è¯·æ±‚çŠ¶æ€æè¿°ï¼Œè°ƒè¯•ç”¨" class="headerlink" title="msgå­—æ®µ - è¯·æ±‚çŠ¶æ€æè¿°ï¼Œè°ƒè¯•ç”¨"></a>msgå­—æ®µ - è¯·æ±‚çŠ¶æ€æè¿°ï¼Œè°ƒè¯•ç”¨</h3><p><code>msg</code>å­—æ®µæ˜¯æœ¬æ¬¡è¯·æ±‚çš„ä¸šåŠ¡ã€çŠ¶æ€æè¿°ä¿¡æ¯ï¼Œä¸»è¦ç”¨äºè°ƒè¯•ã€æµ‹è¯•ç­‰ã€‚</p>
<p>å¦‚â€œdoneâ€ã€â€œè¯·æ±‚ç¼ºå°‘å‚æ•°ï¼â€</p>
<p>æœåŠ¡ç«¯å¯ä»¥è‡ªç”±å‘æŒ¥ï¼Œå¼€å‘äººå‘˜çœ‹å¾—æ‡‚å°±å¥½ã€‚ -_-|||</p>
<h3 id="codeå­—æ®µ-ä¸šåŠ¡è‡ªå®šä¹‰çŠ¶æ€ç "><a href="#codeå­—æ®µ-ä¸šåŠ¡è‡ªå®šä¹‰çŠ¶æ€ç " class="headerlink" title="codeå­—æ®µ - ä¸šåŠ¡è‡ªå®šä¹‰çŠ¶æ€ç "></a>codeå­—æ®µ - ä¸šåŠ¡è‡ªå®šä¹‰çŠ¶æ€ç </h3><p><code>code</code>å­—æ®µï¼Œä¸šåŠ¡è‡ªå®šä¹‰çš„çŠ¶æ€ç ã€‚</p>
<p>å…¶å®æ˜¯å¦è¦åœ¨APIé‡Œé¢è‡ªå®šä¹‰ä¸šåŠ¡çŠ¶æ€ç ï¼Œ<strong>éå¸¸æœ‰äº‰è®®</strong>=ã€‚=ï¼Œå› ä¸ºHttpè¯·æ±‚æœ¬èº«å·²ç»æœ‰äº†å®Œå¤‡çš„çŠ¶æ€ç ï¼Œå†å®šä¹‰ä¸€å¥—çŠ¶æ€ç ç›´è§‚ä¸Šæ„Ÿå—å´æ˜¯ä¸å¯¹åŠ²ã€‚ä½†æ˜¯å®é™…å¼€å‘ä¸­ï¼Œç¡®å®å‘ç°è‡ªå®šä¹‰ä¸šåŠ¡çŠ¶æ€ç çš„å¿…è¦æ€§ï¼Œå¦‚ä¸€æ¬¡æˆåŠŸçš„Http status 200çš„è¯·æ±‚ï¼Œå¯èƒ½ç”±äºç”¨æˆ·æœªç™»å½•ã€ç™»å½•è¿‡æœŸè€Œæœ‰ä¸åŒçš„è¿”å›ç»“æœå’Œå¤„ç†æ–¹å¼ï¼Œæ‰€ä»¥è¿˜æ˜¯ä¿ç•™äº†<code>code</code>ã€‚</p>
<p>çŠ¶æ€ç çš„å®šä¹‰ä¹Ÿæœ€å¥½æœ‰ä¸€å¥—è§„èŒƒï¼Œå¦‚æŒ‰ç…§ç”¨æˆ·ç›¸å…³ã€æˆæƒç›¸å…³ã€å„ç§ä¸šåŠ¡ï¼Œåšç®€å•çš„åˆ†ç±»ï¼š</p>
<figure class="highlight ldif"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">// Code ä¸šåŠ¡è‡ªå®šä¹‰çŠ¶æ€ç å®šä¹‰ç¤ºä¾‹</div><div class="line"></div><div class="line">// æˆæƒç›¸å…³</div><div class="line"><span class="attribute">1001</span>: æ— æƒé™è®¿é—®</div><div class="line"><span class="attribute">1002</span>: access_tokenè¿‡æœŸ</div><div class="line"><span class="attribute">1003</span>: unique_tokenæ— æ•ˆ</div><div class="line">...</div><div class="line"></div><div class="line">// ç”¨æˆ·ç›¸å…³</div><div class="line"><span class="attribute">2001</span>: æœªç™»å½•</div><div class="line"><span class="attribute">2002</span>: ç”¨æˆ·ä¿¡æ¯é”™è¯¯</div><div class="line"><span class="attribute">2003</span>: ç”¨æˆ·ä¸å­˜åœ¨</div><div class="line"></div><div class="line">// ä¸šåŠ¡1</div><div class="line"><span class="attribute">3001</span>: ä¸šåŠ¡1XXX</div><div class="line"><span class="attribute">3002</span>: ä¸šåŠ¡1XXX</div><div class="line"></div><div class="line">// ...</div></pre></td></tr></table></figure>
<p><code>Code</code>ä¸šåŠ¡çŠ¶æ€ç æœ€å¥½æ˜¯ç”¨å¸¸é‡å®šä¹‰çš„ï¼Œå½“ç„¶æœ‰èƒ½åŠ›çš„åŠ¨æ€é…ç½®æ›´æ–°æ›´å¥½ï¼Œè¿™é‡Œå°±ä¸å†è¯¦ç»†è¯´æ˜ã€‚</p>
<p>Httpçš„çŠ¶æ€ç å‚è€ƒï¼š<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes" target="_blank" rel="external">List of HTTP status codes</a></p>
<h3 id="extraå­—æ®µ-å…¨å±€é™„åŠ æ•°æ®"><a href="#extraå­—æ®µ-å…¨å±€é™„åŠ æ•°æ®" class="headerlink" title="extraå­—æ®µ - å…¨å±€é™„åŠ æ•°æ®"></a>extraå­—æ®µ - å…¨å±€é™„åŠ æ•°æ®</h3><p><code>extra</code>å­—æ®µï¼Œç”¨æ¥è¡¨ç¤ºå…¨å±€çš„é™„åŠ æ•°æ®ã€‚</p>
<p>è¿™ä¸ªå­—æ®µæ¥æºäºä¹‹å‰åšé¡¹ç›®æ—¶ï¼Œç”¨æˆ·çš„æ“ä½œï¼ˆæ•°æ®è¯·æ±‚ï¼‰ï¼Œä¼šå¯¼è‡´ç”¨æˆ·çš„ç­‰çº§ã€ç»éªŒå˜åŒ–ï¼Œè€Œå…·ä½“ä»€ä¹ˆæ—¶å€™äº§ç”Ÿä¸ç¡®å®šï¼Œç”±æœåŠ¡ç«¯çš„è§„åˆ™å†³å®šï¼Œå¹¶ä¸”å®¢æˆ·ç«¯è¦åŠæ—¶å‘ç”¨æˆ·å±•ç¤ºå˜åŒ–ï¼Œæ‰€ä»¥åŠ ä¸Šäº†<code>extra</code>å­—æ®µã€‚</p>
<p>åœ¨è®¾è®¡<code>extra</code>å­—æ®µçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰å¯¹å…¶ç»“æ„å†…å®¹åšé™åˆ¶ï¼Œæ‰€ä»¥æ¯”è¾ƒçµæ´»ï¼Œä½†æ˜¯è¿˜æ˜¯è¦æœ‰ä¸ª<code>type</code>å­—æ®µï¼Œæ¥åšçº¦æŸï¼Œå¦‚ï¼š</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‡çº§</span></div><div class="line"><span class="symbol">type:</span> <span class="number">1</span>,</div><div class="line"><span class="symbol">show_msg:</span> <span class="string">"æ­å–œæ‚¨å‡çº§åˆ°XXX"</span></div><div class="line"></div><div class="line"><span class="comment">// å®Œæˆä»»åŠ¡</span></div><div class="line"><span class="symbol">type:</span> <span class="number">2</span>,</div><div class="line"><span class="symbol">task_desc:</span> <span class="string">"è¾¾æˆXXXæˆå°±"</span></div></pre></td></tr></table></figure>
<p>æ€»çš„æ¥è¯´å°±æ˜¯è‡ªç”±å‘æŒ¥ï¼Œåªè¦æœåŠ¡ç«¯ã€å®¢æˆ·ç«¯ç›¸äº’æ²Ÿé€šå¥½å³å¯ã€‚å½“ç„¶ï¼Œä¹Ÿè¦é¿å…ä¹±ç”¨ï¼Œä¿è¯çœŸçš„éœ€è¦å…¨å±€é™„åŠ æ•°æ®æ‰ä½¿ç”¨è¿™ä¸ªå­—æ®µã€‚</p>
<h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><p>æ€»ç»“å‡ ç‚¹æœ€ä½³å®è·µã€‚</p>
<h3 id="è§„èŒƒç»Ÿä¸€çš„å‘½å"><a href="#è§„èŒƒç»Ÿä¸€çš„å‘½å" class="headerlink" title="è§„èŒƒç»Ÿä¸€çš„å‘½å"></a>è§„èŒƒç»Ÿä¸€çš„å‘½å</h3><p><strong>å‘½åé£æ ¼ç»Ÿä¸€</strong></p>
<p>ä¸ç®¡æ˜¯é©¼å³°å¼è¿˜æ˜¯ä¸‹åˆ’çº¿å¼ï¼Œç»Ÿä¸€å°±å¥½ã€‚å½“ç„¶ï¼ŒæŒ‰ç…§ç›®å‰çš„â€œå¤§ä¼—è§„èŒƒâ€ï¼Œè¿˜æ˜¯ç»Ÿä¸€å°å†™åŠ ä¸‹åˆ’çº¿æ¯”è¾ƒå¥½=ã€‚=<br>å¦‚ï¼š<code>user_id</code>ï¼Œ<code>user_name</code>ï¼Œ<code>user_age</code>ç­‰ã€‚</p>
<p><strong>è¯­ä¹‰æ¸…æ™°ï¼Œéµå®ˆå¸¸ç”¨ç¼©å†™</strong></p>
<p>å­—æ®µçš„åå­—æœ€å¥½èƒ½ä½“ç°å­—æ®µçš„ç±»å‹ï¼Œéµå®ˆä¸€äº›â€œå¸¸ç”¨â€çš„ç¼©å†™ï¼Œå¦‚ï¼š</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å­—ç¬¦ä¸²</span></div><div class="line">user<span class="number">_n</span>ame, task<span class="number">_</span>desc, date<span class="number">_</span>str, article<span class="number">_</span>title, feed<span class="number">_</span>content ç­‰</div><div class="line"></div><div class="line"><span class="comment">// æ•°å­—</span></div><div class="line">user<span class="number">_</span>id, users<span class="number">_</span>count, task<span class="number">_n</span>um, xxx<span class="number">_</span>offset ç­‰</div><div class="line"></div><div class="line"><span class="comment">// æ—¥æœŸ</span></div><div class="line">login<span class="number">_</span>at, create<span class="number">_</span>date, logout<span class="number">_</span>time ç­‰</div><div class="line"></div><div class="line"><span class="comment">// å¸ƒå°”</span></div><div class="line"><span class="keyword">is</span><span class="number">_</span>done, <span class="keyword">is</span><span class="number">_</span>vip, protected, can<span class="number">_</span>read ç­‰</div><div class="line"></div><div class="line"><span class="comment">// URL</span></div><div class="line">user<span class="number">_</span>avatar<span class="number">_u</span>rl, thumb<span class="number">_u</span>rl ç­‰</div><div class="line"></div><div class="line"><span class="comment">// æ•°ç»„</span></div><div class="line">users, profiles, thumb<span class="number">_</span>imgs ç­‰</div></pre></td></tr></table></figure>
<h3 id="ç©ºå€¼ã€ç©ºå­—æ®µçš„å¤„ç†"><a href="#ç©ºå€¼ã€ç©ºå­—æ®µçš„å¤„ç†" class="headerlink" title="ç©ºå€¼ã€ç©ºå­—æ®µçš„å¤„ç†"></a>ç©ºå€¼ã€ç©ºå­—æ®µçš„å¤„ç†</h3><p>ç©ºå€¼ã€ç©ºå­—æ®µçš„å¤„ç†ä¹Ÿæ˜¯æ¯”è¾ƒå®¹æ˜“å‡ºé—®é¢˜ã€‚</p>
<p><strong>ç»Ÿä¸€ç©ºå€¼ç”¨null</strong></p>
<p>é™¤äº†å¸ƒå°”ç±»å‹çš„ï¼Œå…¶ä½™çš„ç©ºå€¼ç»Ÿä¸€ç”¨<code>null</code>è¡¨ç¤ºï¼Œå®¢æˆ·ç«¯ä¿è¯æ¯ç§å­—æ®µçš„<code>null</code>å¯ä»¥è¢«æ­£å¸¸å¤„ç†ã€‚</p>
<p><strong>ç»™ä¸åŒç±»å‹è®¾ç½®é»˜è®¤ç©ºå€¼</strong></p>
<p>é™¤äº†<code>null</code>ï¼Œè¿˜å¯ä»¥å¯¹å­—æ®µè®¾ç½®â€œé»˜è®¤å€¼â€ï¼Œå¦‚æ•°å­—å°±æ˜¯<code>0</code>ï¼Œå­—ç¬¦ä¸²å°±æ˜¯ç©ºå­—ç¬¦ä¸²<code>&quot;&quot;</code>ï¼Œæ•°ç»„å°±æ˜¯ç©ºæ•°ç»„<code>[]</code>ï¼Œå¯¹è±¡å°±æ˜¯ç©ºå¯¹è±¡<code>{}</code>ï¼Œè¿™æ ·æœ‰ä¸ªå¥½å¤„å°±æ˜¯å¯ä»¥é¿å…å¾ˆå¤šå®¢æˆ·ç«¯ï¼ˆJavaã€OCï¼‰å¤„ç†ç©ºå€¼ï¼ˆNullã€nilã€nullï¼‰äº§ç”Ÿçš„å¼‚å¸¸ã€‚ä½†æ˜¯å±å®³å°±æ˜¯å®¹æ˜“è¯­ä¹‰ä¸æ˜ã€‚è¿˜æ˜¯è¦æ ¹æ®å…·ä½“ä¸šåŠ¡ã€å‰åç«¯çº¦å®šè€Œå®šã€‚</p>
<p>ä»¥å‰å†™è¿‡ä¸€ç¯‡<a href="http://tutuge.me/2015/07/08/fill-nil-property-of-object/">ç”¨Runtimeçš„æ‰‹æ®µå¡«å……ä»»æ„NSObjectå¯¹è±¡çš„nilå±æ€§</a>ï¼Œå…¶å®å°±æ˜¯ä¸ºå¯¹è±¡ç©ºå€¼ç»Ÿä¸€è®¾ç½®é»˜è®¤å€¼çš„=ã€‚=ï¼Œå¯ä»¥å‚è€ƒã€‚</p>
<h3 id="å¸ƒå°”booleanå€¼çš„å¤„ç†"><a href="#å¸ƒå°”booleanå€¼çš„å¤„ç†" class="headerlink" title="å¸ƒå°”booleanå€¼çš„å¤„ç†"></a>å¸ƒå°”booleanå€¼çš„å¤„ç†</h3><p>è¯´å®è¯ï¼Œæˆ‘è§è¿‡å„ç§å¸ƒå°”å€¼è¡¨ç¤ºæ–¹å¼ï¼Œå¦‚ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="string">is_login:</span> <span class="literal">true</span>,</div><div class="line"><span class="string">is_login:</span> <span class="string">"true"</span>,</div><div class="line"><span class="string">is_login:</span> <span class="number">1</span></div><div class="line"><span class="string">is_login:</span> <span class="string">"TRUE"</span></div><div class="line"><span class="string">is_login:</span> <span class="string">"YES"</span></div><div class="line"><span class="comment">// ...å¤©å•Š</span></div></pre></td></tr></table></figure>
<p>ç”±äºè¯­è¨€æœ¬èº«çš„é™åˆ¶ã€æ¡†æ¶çš„å¤„ç†æ–¹å¼ï¼Œä¸å¯¹å¸ƒå°”ç±»å‹çš„å€¼åšé™åˆ¶æ€»è§‰å¾—ä¸è¸å®ï¼ŒåƒCã€C++ã€Objective-Cé‡Œé¢çš„å¸ƒå°”å°±æ˜¯æ•°å­—0å’Œ1ï¼Œå…¶å®ƒè¯­è¨€ä¹Ÿéƒ½å„è‡ªä¸ä¸€æ ·ï¼Œè¿˜æœ‰ä»æ•°æ®åº“è¯»å†™å¯¼è‡´çš„å¸ƒå°”å€¼ç±»å‹ä¸ä¸€è‡´ç­‰ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œæœ€å¥½ä¸€å¼€å§‹å°±å¯¹æ‰€æœ‰è¯·æ±‚å‚æ•°ã€ç»“æœçš„å¸ƒå°”å€¼ç±»å‹åšé™å®šï¼Œä¸ªäººè§‰å¾—<strong>ç»Ÿä¸€æˆæ•°å­—0å’Œ1</strong>æœ€å¥½ã€‚</p>
<p>ç„¶ååœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç»Ÿä¸€è®¾ç½®å¸¸é‡ã€å®å®šä¹‰ï¼Œå®šä¹‰å¸ƒå°”çš„ç±»å‹ï¼Œæ‰€æœ‰çš„å‚æ•°ã€ç»“æœçš„å¸ƒå°”å­—æ®µå…¨éƒ¨åšå¼ºåˆ¶çº¦æŸã€‚</p>
<h3 id="æ—¶é—´ã€æ—¥æœŸå­—æ®µ"><a href="#æ—¶é—´ã€æ—¥æœŸå­—æ®µ" class="headerlink" title="æ—¶é—´ã€æ—¥æœŸå­—æ®µ"></a>æ—¶é—´ã€æ—¥æœŸå­—æ®µ</h3><p>æ—¶é—´çš„å¤„ç†ä¹Ÿæ˜¯éå¸¸å®¹æ˜“å‡ºé”™çš„ï¼Œç‰¹åˆ«æ˜¯é‡ä¸Šæ—¶åŒºè½¬æ¢çš„æ—¶å€™ã€‚</p>
<p><strong>å¼ºåˆ¶GMT/UTCæ—¶é—´æˆ³</strong></p>
<p>ä¸€ç§åšæ³•å°±æ˜¯å¼ºåˆ¶æ‰€æœ‰æ—¶é—´å‚æ•°åªèƒ½ä¼ Unixæ—¶é—´æˆ³ï¼Œä¹Ÿå°±æ˜¯æ ‡å‡†GMT/UTCæ—¶é—´æˆ³ï¼Œç„¶åç”±å„è‡ªçš„å®¢æˆ·ç«¯æ ¹æ®è‡ªå·±çš„æ—¶åŒºã€æ˜¾ç¤ºè¦æ±‚åšå¤„ç†åæ˜¾ç¤ºã€‚</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä»æœåŠ¡å™¨æ¥æ”¶çš„æ—¶é—´æ•°æ®</span></div><div class="line"><span class="symbol">login_at:</span> <span class="number">1462068610</span></div><div class="line"></div><div class="line"><span class="comment">// æ ¹æ®æ—¶åŒºã€æ˜¾ç¤ºè¦æ±‚è½¬æ¢ï¼Œå¦‚åŒ—äº¬æ—¶é—´</span></div><div class="line">æ˜¾ç¤ºï¼š<span class="number">2016</span>å¹´<span class="number">5</span>æœˆ<span class="number">1</span>æ—¥ä¸‹åˆ<span class="number">1</span>ç‚¹ã€<span class="number">1</span>å¤©å‰ç­‰</div></pre></td></tr></table></figure>
<p>è¿™æ ·çš„è¯ï¼Œå®¢æˆ·ç«¯ã€æœåŠ¡ç«¯å­˜å‚¨ã€è¯»å–æ—¶é—´éƒ½ç›¸å½“äºå¤„ç†çº¯æ•°å­—ã€‚</p>
<p><strong>ä½¿ç”¨ISO 8601å¸¦æ—¶åŒºçš„æ—¶é—´æ—¥æœŸå­—ç¬¦ä¸²</strong></p>
<p>ä½¿ç”¨Unixæ—¶é—´æˆ³æœ‰ä¸ªåå¤„ï¼Œå°±æ˜¯ï¼š</p>
<ul>
<li>æœ€æ—©åªèƒ½åˆ°<code>1970/1/1 0:0:0</code>GMTæ—¶é—´ï¼Œä¸€æ—¦éœ€æ±‚æ—©äºè¿™ä¸ªæ—¶é—´ï¼Œæ—¶é—´æˆ³å°±æˆäº†è´Ÿæ•°=ã€‚=</li>
<li>ä¸æ–¹ä¾¿äººé˜…è¯»ã€‚è°ƒè¯•APIçš„æ—¶å€™ï¼Œå¼€å‘äººå‘˜ä¸èƒ½ç›´è§‚çœ‹å‡ºå…·ä½“æ—¶é—´ï¼Œå¾ˆä¸æ–¹ä¾¿</li>
</ul>
<p>æ‰€ä»¥ï¼Œå¯ä»¥æŒ‰ç…§<a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank" rel="external">ISO 8601</a>æ ‡å‡†ï¼Œç”¨å­—ç¬¦ä¸²ä¿å­˜ã€ä¼ è¾“æ—¶é—´ã€‚</p>
<p>å¦‚æœä»¥<code>YYYY-MM-DDThh:mm:ssTZD</code>æ ¼å¼ä¸ºå‡†, æ—¶é—´çš„å½¢å¼å°±æ˜¯<code>1997-07-16T19:20:30+01:00</code>ï¼Œä¿å­˜äº†æ—¶åŒºä¿¡æ¯ï¼Œä¹Ÿæ–¹ä¾¿é˜…è¯»ã€‚</p>
<h3 id="typeç±»å‹çš„å¤„ç†"><a href="#typeç±»å‹çš„å¤„ç†" class="headerlink" title="typeç±»å‹çš„å¤„ç†"></a>typeç±»å‹çš„å¤„ç†</h3><p>APIæ•°æ®ä¸­å…ä¸äº†å„ç§ç±»å‹å­—æ®µï¼Œå¦‚ç”¨æˆ·ç±»å‹<code>user_type</code>ã€ç™»å½•ç±»å‹<code>login_type</code>ç­‰ï¼Œç±»å‹çš„è¡¨ç¤ºä¹Ÿå¯ä»¥åˆ†ä¸ºæ•°å­—ã€å­—ç¬¦ä¸²ä¸¤ç§ã€‚</p>
<p><strong>æ•°å­—è¡¨ç¤ºç±»å‹</strong></p>
<p>è¿™ä¸ªåº”è¯¥æ˜¯æœ€ç›´æ¥çš„æ–¹å¼äº†ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å…±åŒç»´æŠ¤æŸä¸ªAPIä¸‹ã€æŸä¸ªæ•°æ®ç±»å‹ä¸­çš„typeå¸¸é‡ï¼Œé æ–‡æ¡£çº¦æŸã€‚</p>
<p><strong>å­—ç¬¦ä¸²è¡¨ç¤ºç±»å‹</strong></p>
<p>æ•°å­—çš„ç±»å‹æ¯•ç«Ÿä¸åˆ©äºç›´è§‚é˜…è¯»ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œç”¨å­—ç¬¦ä¸²ä¹Ÿæ˜¯ä¸é”™çš„ï¼Œå½“ç„¶åå¤„å°±æ˜¯ä»£ç é‡Œé¢å°±ä¸èƒ½ç”¨<code>Switch</code>è¯­å¥äº†ï¼ˆé™¤äº†å¼ºå¤§çš„Swift=ã€‚=ï¼‰</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¦‚ç™»å½•ç±»å‹ï¼ŒQQã€å¾®ä¿¡ã€å¾®åšç­‰</span></div><div class="line"><span class="symbol">login_type:</span> <span class="string">"qq"</span>,</div><div class="line"><span class="symbol">login_type:</span> <span class="string">"wechat"</span>,</div><div class="line"><span class="symbol">login_type:</span> <span class="string">"sina_weibo"</span>,</div></pre></td></tr></table></figure>
<h3 id="å®Œæ•´çš„URL"><a href="#å®Œæ•´çš„URL" class="headerlink" title="å®Œæ•´çš„URL"></a>å®Œæ•´çš„URL</h3><p>APIé‡Œé¢çš„æ•°æ®ä¹Ÿä¼šæœ‰URLç±»å‹çš„ï¼Œä¸€èˆ¬æ¥è¯´å¦‚ç”¨æˆ·çš„å¤´åƒã€å„ç§å›¾ç‰‡ã€éŸ³é¢‘ç­‰èµ„æºï¼Œéƒ½æ˜¯ä»¥URLé“¾æ¥çš„å½¢å¼è¿”å›çš„ã€‚</p>
<p>è¿”å›çš„URLä¸€å®šè¦â€œå®Œæ•´â€ï¼Œä¸»è¦æŒ‡çš„æ˜¯ä¸è¦å¿˜è®°URLé‡Œé¢çš„<strong>åè®®</strong>éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯<code>scheme</code>éƒ¨åˆ†ã€‚</p>
<p>åƒ<code>tutuge.me/imgs/1.jpg</code>è¿™ç§URLå€¼ï¼Œå°±æ˜¯ä¸å®Œæ•´çš„ï¼Œæ²¡æœ‰æŒ‡æ˜ç½‘ç»œåè®®ï¼Œéš¾é“é çŒœ=ã€‚=<br>åº”è¯¥æ˜¯<code>http://tutuge.me/imgs/1.jpg</code>ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å—¯ï¼Œè§„èŒƒéå¸¸é‡è¦ã€‚:-D</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;RESTful APIçš„è®¾è®¡å·²ç»å¾ˆæˆç†Ÿäº†ï¼Œå¤§å®¶ä¹Ÿéƒ½æ¯”è¾ƒè®¤å¯ã€‚æœ¬æ–‡ä¹Ÿä¸å†è¿‡å¤šä»‹ç»RESTful APIç›¸å…³çš„çŸ¥è¯†ï¼Œè€Œæ˜¯é’ˆå¯¹JSONå‹APIçš„è¿”å›ç»“æœè®¾è®¡ï¼Œæ€»ç»“ä¸‹è‡ªå·±çš„ç»éªŒã€‚&lt;/p&gt;
&lt;h2 id=&quot;ç»“æ„&quot;&gt;&lt;a href=&quot;#ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;ç»“æ„&quot;&gt;&lt;/a&gt;ç»“æ„&lt;/h2&gt;&lt;p&gt;å…ˆæ¥çœ‹çœ‹è¿”å›ç»“æœçš„ç»“æ„ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight less&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;data &lt;/span&gt;: &amp;#123; &lt;span class=&quot;comment&quot;&gt;// è¯·æ±‚æ•°æ®ï¼Œå¯¹è±¡æˆ–æ•°ç»„å‡å¯&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;attribute&quot;&gt;user_id&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;attribute&quot;&gt;user_name&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;tutuge&quot;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;attribute&quot;&gt;user_avatar_url&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;http://tutuge.me/avatar.jpg&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        ...&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;msg &lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;done&quot;&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// è¯·æ±‚çŠ¶æ€æè¿°ï¼Œè°ƒè¯•ç”¨&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;code&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;1001&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;// ä¸šåŠ¡è‡ªå®šä¹‰çŠ¶æ€ç &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;attribute&quot;&gt;extra &lt;/span&gt;: &amp;#123; &lt;span class=&quot;comment&quot;&gt;// å…¨å±€é™„åŠ æ•°æ®ï¼Œå­—æ®µã€å†…å®¹ä¸å®š&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;attribute&quot;&gt;type&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;attribute&quot;&gt;desc&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;ç­¾åˆ°æˆåŠŸï¼&quot;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="æœåŠ¡ç«¯" scheme="http://tutuge.me/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
  </entry>
  
  <entry>
    <title>ç»“åˆè®¿é—®Out Parameterså‡ºç°EXC_BAD_ACCESSçš„ä¾‹å­ï¼Œåç¼–è¯‘æ±‡ç¼–è§£è¯»__autoreleasing</title>
    <link href="http://tutuge.me/2016/04/30/autoreleasing-meet-autoreleasepool/"/>
    <id>http://tutuge.me/2016/04/30/autoreleasing-meet-autoreleasepool/</id>
    <published>2016-04-30T11:19:23.000Z</published>
    <updated>2016-08-07T06:06:35.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>2016-05-01: è¡¥å……äº†ä¸€ç‚¹æœ¬æ–‡æ¶‰åŠçš„æ±‡ç¼–çŸ¥è¯†</p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡ç»“åˆä¸€æ®µè®¿é—®<code>Out Parameters</code>å‡ºç°äº†<code>EXC_BAD_ACCESS</code>é”™è¯¯çš„ä»£ç ï¼Œé€šè¿‡åç¼–è¯‘ç­‰æ‰‹æ®µéªŒè¯Objective-Cä¸­<code>__autoreleasing</code>çš„ä¸€äº›ç‰¹ç‚¹ã€‚</p>
<a id="more"></a>
<h2 id="2016-05-01æ›´æ–°-å…³äºæœ¬æ–‡çš„åç¼–è¯‘æ±‡ç¼–ä»£ç "><a href="#2016-05-01æ›´æ–°-å…³äºæœ¬æ–‡çš„åç¼–è¯‘æ±‡ç¼–ä»£ç " class="headerlink" title="2016-05-01æ›´æ–° - å…³äºæœ¬æ–‡çš„åç¼–è¯‘æ±‡ç¼–ä»£ç "></a>2016-05-01æ›´æ–° - å…³äºæœ¬æ–‡çš„åç¼–è¯‘æ±‡ç¼–ä»£ç </h2><p>æœ¬æ–‡çš„åç¼–è¯‘åŸºäºMachO 64bitsï¼Œå³System V X86_64ï¼Œè¯»æ‡‚æœ¬æ–‡éœ€è¦çš„æœ€ç®€å•Calling conventionå¦‚ä¸‹ï¼š</p>
<p>å‡½æ•°å‚æ•°é¡ºåºï¼š</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">rdi, rsi, rdx, rcxç­‰å¯„å­˜å™¨</div><div class="line">å¯¹åº”åˆ°</div><div class="line">id objc_msgSend ( id object, SEL <span class="keyword">cmd</span><span class="bash">, arg1, arg2 ... );</span></div><div class="line">å°±æ˜¯</div><div class="line">rdi = object <span class="comment"># è¢«è°ƒç”¨å¯¹è±¡</span></div><div class="line">rsi = <span class="keyword">cmd</span><span class="bash"> <span class="comment"># æ–¹æ³•selector</span></span></div><div class="line">rdx = arg1 <span class="comment"># æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°</span></div><div class="line">rcx = arg2 <span class="comment"># æ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°</span></div></pre></td></tr></table></figure>
<p>å‡½æ•°è¿”å›å€¼ï¼š</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">æœ¬æ–‡åªæ¶‰åŠ: <span class="built_in">rax</span>å¯„å­˜å™¨</div></pre></td></tr></table></figure>
<p>è¯¦ç»†å¯å‚è€ƒï¼š</p>
<ul>
<li><a href="https://developer.apple.com/library/ios/documentation/Xcode/Conceptual/iPhoneOSABIReference/Introduction/Introduction.html" target="_blank" rel="external">iOS ABI Function Call Guide</a></li>
<li><a href="https://developer.apple.com/library/mac/documentation/DeveloperTools/Conceptual/LowLevelABI/000-Introduction/introduction.html#//apple_ref/doc/uid/TP40002437-SW1" target="_blank" rel="external">OS X ABI Function Call Guide</a></li>
<li><a href="http://wiki.osdev.org/Calling_Conventions" target="_blank" rel="external">OS DEV Calling Conventions</a></li>
</ul>
<h2 id="Out-Parameters-æŒ‡é’ˆçš„æŒ‡é’ˆ"><a href="#Out-Parameters-æŒ‡é’ˆçš„æŒ‡é’ˆ" class="headerlink" title="Out Parameters - æŒ‡é’ˆçš„æŒ‡é’ˆ"></a>Out Parameters - æŒ‡é’ˆçš„æŒ‡é’ˆ</h2><p>æ‰€è°“<code>Out Parameters</code>ï¼Œå…¶å®å°±æ˜¯<strong>æŒ‡é’ˆçš„æŒ‡é’ˆ</strong>ï¼Œç†Ÿæ‚‰C/C++çš„æœ‹å‹åº”è¯¥ä¸é™Œç”Ÿï¼Œé€šè¿‡æŒ‡é’ˆçš„æŒ‡é’ˆå¯ä»¥æ”¹å˜æŒ‡é’ˆçš„å€¼ï¼Œåœ¨Objective-Cé‡Œé¢å¾ˆå¤šåœ°æ–¹ç”¨åˆ°äº†è¿™ç§æ–¹æ³•ï¼Œæ¥åœ¨å‡½æ•°ã€æ–¹æ³•å†…éƒ¨æ”¹å˜å‚æ•°çš„åŸå§‹å€¼ï¼Œå¦‚ï¼š</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// NSFileManagerçš„æ–¹æ³•</span></div><div class="line">- (<span class="keyword">BOOL</span>)removeItemAtURL:(NSURL *)URL <span class="built_in">error</span>:(NSError **)<span class="built_in">error</span></div></pre></td></tr></table></figure>
<p>ç¬¬äºŒä¸ªå‚æ•°<code>(NSError **)error</code>ï¼Œå°±æ˜¯<code>Out Parameters</code>ï¼Œè°ƒç”¨æ—¶ä¼ é€’NSErrorç±»å‹æŒ‡é’ˆçš„åœ°å€å³å¯ï¼š</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">NSError *<span class="built_in">error</span> = nil;</div><div class="line">[[NSFileManager defaultManager] removeItemAtURL:url <span class="built_in">error</span>:&amp;<span class="built_in">error</span>];</div><div class="line"><span class="comment">// å¤„ç†error...</span></div></pre></td></tr></table></figure>
<h2 id="å‡ºç°EXC-BAD-ACCESSçš„ä»£ç ç¤ºä¾‹"><a href="#å‡ºç°EXC-BAD-ACCESSçš„ä»£ç ç¤ºä¾‹" class="headerlink" title="å‡ºç°EXC_BAD_ACCESSçš„ä»£ç ç¤ºä¾‹"></a>å‡ºç°EXC_BAD_ACCESSçš„ä»£ç ç¤ºä¾‹</h2><p>å‡è®¾æœ‰å¦‚ä¸‹éå†æ•°ç»„æ£€æŸ¥æ•°å€¼é›¶çš„æ–¹æ³•ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)checkZeroInArray:(<span class="built_in">NSArray</span> &lt;<span class="built_in">NSNumber</span> *&gt; *)array error:(<span class="built_in">NSError</span> **)error &#123;</div><div class="line">    <span class="comment">// éå†</span></div><div class="line">    [array enumerateObjectsUsingBlock:^(<span class="built_in">NSNumber</span> * _Nonnull number, <span class="built_in">NSUInteger</span> index, <span class="built_in">BOOL</span> * _Nonnull stop) &#123;</div><div class="line">        <span class="keyword">if</span> (number.integerValue == <span class="number">0</span>) &#123; <span class="comment">// æ£€æŸ¥</span></div><div class="line">            <span class="keyword">if</span> (error) &#123; <span class="comment">// æŒ‡é’ˆæ˜¯å¦æœ‰æ•ˆ</span></div><div class="line">                *error = [<span class="built_in">NSError</span> errorWithDomain:<span class="string">@"me.tutuge"</span> code:<span class="number">100</span> userInfo:<span class="literal">nil</span>]; <span class="comment">// åˆ›å»ºNSErrorå®ä¾‹</span></div><div class="line">            &#125;</div><div class="line">            *stop = <span class="literal">TRUE</span>; <span class="comment">// åœæ­¢éå†</span></div><div class="line">        &#125;</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è°ƒç”¨çš„æ—¶å€™å¦‚ä¸‹ï¼š</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">NSError *<span class="keyword">error</span> = nil;</div><div class="line">[self checkZeroInArray:numbers <span class="keyword">error</span>:&amp;<span class="keyword">error</span>]; <span class="comment">// å–åœ°å€</span></div><div class="line"><span class="keyword">if</span> (<span class="keyword">error</span>) &#123;</div><div class="line">    NSLog(@<span class="string">"Error: %@"</span>, <span class="keyword">error</span>); <span class="comment">// EXC_BAD_ACCESSé”™è¯¯</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥å¾—å‡ºï¼Œ<code>NSLog(@&quot;Error: %@&quot;, error)</code>è®¿é—®<code>error</code>çš„æ—¶å€™ï¼Œ<code>error</code>çš„åœ°å€æŒ‡å‘çš„å†…å­˜ç©ºé—´å·²ç»è¢«é‡Šæ”¾ï¼Œæ‰€ä»¥æ‰ä¼šå‡ºç°<code>EXC_BAD_ACCESS</code>é”™è¯¯ã€‚</p>
<p>ä½†æ˜¯ä¸ºä»€ä¹ˆä¼šè¢«é‡Šæ”¾ï¼Ÿä»€ä¹ˆæ—¶å€™è¢«é‡Šæ”¾çš„ï¼Ÿç»è¿‡ä¸€ç•ªæŸ¥è¯ï¼Œå‘ç°è·Ÿ<code>__autoreleasing</code>å’Œ<code>@autoreleasepool</code>æœ‰å…³ã€‚</p>
<p>ä¸‹é¢å…ˆå¯¹<code>__autoreleasing</code>åšç‚¹ç ”ç©¶=ã€‚=</p>
<h2 id="autoreleasing-å˜é‡æ‰€æœ‰æƒ-ownership-ä¿®é¥°ç¬¦"><a href="#autoreleasing-å˜é‡æ‰€æœ‰æƒ-ownership-ä¿®é¥°ç¬¦" class="headerlink" title="__autoreleasing - å˜é‡æ‰€æœ‰æƒ(ownership)ä¿®é¥°ç¬¦"></a>__autoreleasing - å˜é‡æ‰€æœ‰æƒ(ownership)ä¿®é¥°ç¬¦</h2><p>å…ˆçœ‹çœ‹<code>__autoreleasing</code>çš„å®šä¹‰åŠä¸€äº›ç‰¹ç‚¹ã€‚</p>
<p><code>__autoreleasing</code>æ˜¯å˜é‡æ‰€æœ‰æƒä¿®é¥°ç¬¦çš„ä¸€ç§ï¼Œé™¤äº†å®ƒï¼Œè¿˜æœ‰<code>__strong</code>ã€<code>__weak</code>å’Œ<code>__unsafe_unretained</code>ï¼Œè¯¦ç»†çš„è¯´æ˜å¯ä»¥å‚è€ƒï¼š<a href="http://clang.llvm.org/docs/AutomaticReferenceCounting.html#ownership-qualification" target="_blank" rel="external">Clangæ–‡æ¡£-Objective-C Automatic Reference Counting (ARC)</a></p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯è¢«<code>__autoreleasing</code>ä¿®é¥°çš„å˜é‡ä¼šè¢«åŠ å…¥åˆ°å½“å‰çš„autoreleasepoolä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºå¦‚ä¸‹ä¸¤æ®µåˆ†åˆ«åœ¨ARCå’ŒMRCä¸­çš„ä»£ç ç­‰ä»·ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ARC</span></div><div class="line"><span class="keyword">id</span> __autoreleasing obj = someObj;</div><div class="line"></div><div class="line"><span class="comment">// MRC</span></div><div class="line"><span class="keyword">id</span> obj = [[someObj <span class="keyword">retain</span>] autorelease];</div></pre></td></tr></table></figure>
<p>å†è¿›ä¸€æ­¥ï¼Œé™¤å¼€å„ç§å½±å“å› ç´ ï¼Œå‡è®¾æœ‰å¦‚ä¸‹å‡½æ•°ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)funcWithObj:(<span class="keyword">id</span>)someObj &#123;</div><div class="line">    <span class="keyword">id</span> __autoreleasing obj = someObj;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç”¨Hopper Disassembleråç¼–è¯‘åä¸ºå¦‚ä¸‹æ±‡ç¼–ä»£ç (MachO 64bits)ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/autoreleasing-meet-autoreleasepool_1.jpg" alt="funcWithObj:åæ±‡ç¼–"></p>
<p><strong><code>var_18</code>å°±æ˜¯objå˜é‡ï¼š</strong></p>
<p><code>lea rax, qword [ss:rbp+var_18]</code>å’Œ<code>mov rdi, rax</code>å–äº†var_18çš„åœ°å€æ”¾åœ¨<code>rdi</code>å¯„å­˜å™¨ä¸­ï¼Œ<code>mov rsi, rdx</code>å°†<code>someObj</code>å€¼æ”¾åˆ°äº†rsiå¯„å­˜å™¨ä¸­ï¼Œç„¶åè°ƒç”¨<code>id objc_storeStrong(id *object, id value)</code>å‡½æ•°æœ€ç»ˆå°†<code>someObj</code>å€¼ä¿å­˜åœ¨<code>var_18</code>å˜é‡ä¸­ã€‚</p>
<p><strong><code>__autoreleasing</code>å¯¼è‡´äº†<code>id objc_retainAutorelease(id value)</code>å‡½æ•°çš„è°ƒç”¨ï¼š</strong></p>
<p><code>call imp___stubs__objc_retainAutorelease</code>ï¼Œå°±æ˜¯å¯¹<code>obj</code>å˜é‡ï¼Œä¹Ÿå°±æ˜¯<code>var_18</code>ï¼Œè°ƒç”¨äº†<code>objc_retainAutorelease</code>å‡½æ•°ï¼Œå…ˆretainç„¶åautoreleaseäº†ä¸€æ¬¡ï¼Œå…¶å®ç°å¤§è‡´å¦‚ä¸‹ï¼š</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function">id <span class="title">objc_retainAutorelease</span>(<span class="params">id <span class="keyword">value</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> objc_autorelease(objc_retain(<span class="keyword">value</span>));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>objc_storeStrong</code>å’Œ<code>objc_retainAutorelease</code>å¯å‚è€ƒï¼š<a href="http://clang.llvm.org/docs/AutomaticReferenceCounting.html#arc-runtime-objc-retainautorelease" target="_blank" rel="external">Clangæ–‡æ¡£-Objective-C Automatic Reference Counting (ARC)</a></p>
<p>å¯éªŒè¯ï¼Œç”¨<code>__autoreleasing</code>ä¿®é¥°çš„å˜é‡ä¼šè¢«æ·»åŠ åˆ°å½“å‰çš„autoreleasepoolä¸­ã€‚</p>
<h2 id="æ–¹æ³•çš„Out-Parameterså‚æ•°ä¼šè‡ªåŠ¨æ·»åŠ -autoreleasingå±æ€§"><a href="#æ–¹æ³•çš„Out-Parameterså‚æ•°ä¼šè‡ªåŠ¨æ·»åŠ -autoreleasingå±æ€§" class="headerlink" title="æ–¹æ³•çš„Out Parameterså‚æ•°ä¼šè‡ªåŠ¨æ·»åŠ __autoreleasingå±æ€§"></a>æ–¹æ³•çš„Out Parameterså‚æ•°ä¼šè‡ªåŠ¨æ·»åŠ __autoreleasingå±æ€§</h2><p>å½“æ–¹æ³•å‚æ•°é‡Œé¢æœ‰Out Parameterså‚æ•°æ—¶ï¼Œå°±æ˜¯æœ‰æŒ‡é’ˆçš„æŒ‡é’ˆç±»å‹æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºå‚æ•°åŠ ä¸Š<code>__autoreleasing</code>å±æ€§ï¼Œå¦‚ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)generateError1:(NSError **)<span class="keyword">error</span> &#123;</div><div class="line">    *<span class="keyword">error</span> = [NSError <span class="keyword">new</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)generateError2:(NSError * __autoreleasing *)<span class="keyword">error</span> &#123;</div><div class="line">    *<span class="keyword">error</span> = [NSError <span class="keyword">new</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘æ—¶ï¼Œ<code>generateError1:</code>ä¼šå¯¹å‚æ•°<code>error</code>è‡ªåŠ¨æ·»åŠ <code>__autoreleasing</code>ï¼Œç„¶åå°±è·Ÿ<code>generateError2:</code>çš„å®ç°å®Œå…¨ä¸€è‡´äº†ã€‚</p>
<p>é€šè¿‡åæ±‡ç¼–ä¹Ÿå¯çœ‹å‡ºä¸¤è€…å®Œå…¨ä¸€è‡´ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/autoreleasing-meet-autoreleasepool_2.jpg" alt="Out Parameterså‚æ•°ä¼šè‡ªåŠ¨æ·»åŠ __autoreleasingå±æ€§"></p>
<p>åœ¨<code>call imp___stubs__objc_msgSend</code>å®Œæˆåï¼Œ<code>rax</code>å¯„å­˜å™¨ä¿å­˜äº†<code>[NSError new]</code>çš„å¯¹è±¡ï¼Œç„¶å<code>mov rdi, rax</code>ï¼Œè½¬ç§»åˆ°<code>rdi</code>å¯„å­˜å™¨ï¼Œä½œä¸º<code>objc_autorelease</code>å‡½æ•°çš„å‚æ•°è¢«è°ƒç”¨ï¼Œ<code>*error</code>è¢«åŠ åˆ°äº†å½“å‰çš„autoreleasepoolä¸­ã€‚</p>
<h2 id="å¦‚æœä¼ ç»™Out-Parameterså‚æ•°çš„å˜é‡æ²¡æœ‰ç”¨-autoreleasingä¿®é¥°ï¼Œç¼–è¯‘å™¨ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶å˜é‡å¹¶ä»¥-autoreleasingä¿®é¥°å†ä¼ å…¥"><a href="#å¦‚æœä¼ ç»™Out-Parameterså‚æ•°çš„å˜é‡æ²¡æœ‰ç”¨-autoreleasingä¿®é¥°ï¼Œç¼–è¯‘å™¨ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶å˜é‡å¹¶ä»¥-autoreleasingä¿®é¥°å†ä¼ å…¥" class="headerlink" title="å¦‚æœä¼ ç»™Out Parameterså‚æ•°çš„å˜é‡æ²¡æœ‰ç”¨__autoreleasingä¿®é¥°ï¼Œç¼–è¯‘å™¨ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶å˜é‡å¹¶ä»¥__autoreleasingä¿®é¥°å†ä¼ å…¥"></a>å¦‚æœä¼ ç»™Out Parameterså‚æ•°çš„å˜é‡æ²¡æœ‰ç”¨__autoreleasingä¿®é¥°ï¼Œç¼–è¯‘å™¨ä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶å˜é‡å¹¶ä»¥__autoreleasingä¿®é¥°å†ä¼ å…¥</h2><p>æ ¹æ®è‹¹æœçš„<a href="https://developer.apple.com/library/mac/releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html" target="_blank" rel="external">Transitioning to ARC Release Notes</a>æ–‡æ¡£å¯çŸ¥ï¼Œå¦‚æœæœ‰å¦‚ä¸‹è°ƒç”¨:</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">NSError *<span class="built_in">error</span>; <span class="comment">// é»˜è®¤__strongç±»å‹</span></div><div class="line">[self generateError1:&amp;<span class="built_in">error</span>]ï¼›</div></pre></td></tr></table></figure>
<p>ç¼–è¯‘å™¨æ£€æµ‹åˆ°<code>generateError1:</code>æ–¹æ³•çš„Out Parametersç±»å‹å‚æ•°ï¼Œä½†æ˜¯è°ƒç”¨æ—¶çš„<code>error</code>åˆä¸æ˜¯<code>__autoreleasing</code>ä¿®é¥°çš„ï¼Œå°±ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª<code>__autoreleasing</code>ä¿®é¥°çš„ä¸´æ—¶å˜é‡ï¼Œç”¨æ¥ä»£æ›¿<code>error</code>ä¼ å…¥ï¼Œç¼–è¯‘å™¨é‡å†™åå¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSError</span> * error; <span class="comment">// é»˜è®¤__strongç±»å‹</span></div><div class="line"><span class="built_in">NSError</span> * __autoreleasing tmp = error;</div><div class="line">[<span class="keyword">self</span> generateError1:&amp;tmp]ï¼›</div></pre></td></tr></table></figure>
<p>é€šè¿‡æ±‡ç¼–æ¥éªŒè¯ä¸€ä¸‹ï¼š</p>
<p>å‡å¦‚æœ‰å¦‚ä¸‹è°ƒç”¨ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)runTest &#123;</div><div class="line">    <span class="built_in">NSError</span> *error = <span class="literal">nil</span>;</div><div class="line">    [<span class="keyword">self</span> generateError1:&amp;error]; <span class="comment">// å°±æ˜¯ä¸Šé¢çš„å®ç°</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åæ±‡ç¼–åï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/autoreleasing-meet-autoreleasepool_3.jpg" alt="è‡ªåŠ¨æ·»åŠ __autoreleasingä¸´æ—¶å˜é‡"></p>
<p>ä»£ç æœ‰ç‚¹å¤š=ã€‚=ï¼Œä»å›¾ä¸­æ±‡ç¼–å¯çŸ¥ï¼š<code>var_20</code>å°±æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ä¸´æ—¶å˜é‡ï¼Œ<code>var_18</code>æ˜¯æˆ‘ä»¬å®šä¹‰çš„<code>error</code>å˜é‡ã€‚</p>
<p><code>mov qword [ss:rbp+var_18], 0x0</code>å¯¹<code>var_18</code>åšåˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯èµ‹<code>nil</code>å€¼ï¼Œç„¶å<code>mov rdi, qword [ss:rbp+var_18]</code>å’Œ<code>mov qword [ss:rbp+var_20], rdi</code>å°±æ˜¯ç”¨<code>var_18</code>åˆå§‹åŒ–äº†<code>var_20</code>ä¸´æ—¶å˜é‡ã€‚</p>
<p><code>lea rdx, qword [ss:rbp+var_20]</code>å°†<code>var_20</code>ä¸´æ—¶å˜é‡çš„åœ°å€å­˜åˆ°äº†<code>rdx</code>å¯„å­˜å™¨ä¸­ï¼Œä½œä¸º<code>objc_msgSend</code>å®ç°<code>generateError1:</code>è°ƒç”¨æ—¶çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯<code>(NSError **):error</code>å‚æ•°ï¼Œå®Œæˆè°ƒç”¨ã€‚</p>
<p>è°ƒç”¨å®Œæˆåï¼Œé€šè¿‡å¦‚ä¸‹è°ƒç”¨ï¼Œå°†ä¸´æ—¶å˜é‡<code>var_20</code>çš„å€¼ä¿å­˜åˆ°<code>var_18</code>ï¼Œå³<code>error</code>å˜é‡ä¸­ã€‚</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">lea</span> <span class="built_in">rdx</span>, <span class="built_in">qword</span> [<span class="built_in">ss</span>:<span class="built_in">rbp</span>+var_18] # var_18ä¸ºobjc_storeStrongç¬¬ä¸€ä¸ªå‚æ•°</div><div class="line"><span class="keyword">mov</span> <span class="built_in">rsi</span>, <span class="built_in">qword</span> [<span class="built_in">ss</span>:<span class="built_in">rbp</span>+var_20] # var_20ä¸ºobjc_storeStrongç¬¬äºŒä¸ªå‚æ•°</div><div class="line"><span class="keyword">mov</span> <span class="built_in">rdi</span>, <span class="built_in">rdx</span></div><div class="line"><span class="keyword">call</span> imp___stubs__objc_storeStrong</div></pre></td></tr></table></figure>
<h2 id="å¼€å¤´ä¾‹å­å‡ºç°EXC-BAD-ACCESSé”™è¯¯çš„åŸå› "><a href="#å¼€å¤´ä¾‹å­å‡ºç°EXC-BAD-ACCESSé”™è¯¯çš„åŸå› " class="headerlink" title="å¼€å¤´ä¾‹å­å‡ºç°EXC_BAD_ACCESSé”™è¯¯çš„åŸå› "></a>å¼€å¤´ä¾‹å­å‡ºç°EXC_BAD_ACCESSé”™è¯¯çš„åŸå› </h2><p>ç»è¿‡ä¸Šé¢ä¸€ç•ªå¯¹<code>__autoreleasing</code>çš„æ€»ç»“ï¼Œå†æ¥çœ‹çœ‹å¼€å¤´ä¾‹å­çš„é”™è¯¯åŸå› å°±æ¯”è¾ƒå®¹æ˜“æ‡‚äº†ã€‚</p>
<p><strong>enumerateObjectsUsingBlockä¼šåœ¨å¾ªç¯å†…éƒ¨è‡ªåŠ¨æ·»åŠ autoreleasepool</strong></p>
<p>é¦–å…ˆåº”è¯¥æ˜ç¡®çš„å°±æ˜¯<code>enumerateObjectsUsingBlock:</code>åœ¨ç”¨blockè¿­ä»£éå†NSArrayçš„å…ƒç´ æ—¶ï¼Œä¼šè‡ªåŠ¨æ·»åŠ autoreleasepoolï¼Œå¯¹äºä¾‹å­æ¥è¯´ï¼Œç›¸å½“äºï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æšä¸¾éå†</span></div><div class="line">[array enumerateObjectsUsingBlock:^(<span class="built_in">NSNumber</span> * _Nonnull number, <span class="built_in">NSUInteger</span> index, <span class="built_in">BOOL</span> * _Nonnull stop) &#123;</div><div class="line">    <span class="keyword">if</span> (number.integerValue == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (error) &#123;</div><div class="line">            *error = [<span class="built_in">NSError</span> errorWithDomain:<span class="string">@"me.tutuge"</span> code:<span class="number">100</span> userInfo:<span class="literal">nil</span>];</div><div class="line">        &#125;</div><div class="line">        *stop = <span class="literal">TRUE</span>;</div><div class="line">    &#125;</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>ç»“åˆ<code>__autoreleasing</code>åï¼Œé‡å†™ä¸ºï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSNumber</span> *number = <span class="literal">nil</span>;</div><div class="line"><span class="built_in">BOOL</span> stop = <span class="literal">FALSE</span>;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="built_in">NSUInteger</span> index = <span class="number">0</span>; index &lt; array.count &amp;&amp; !stop; index++) &#123;</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123; <span class="comment">// è‡ªåŠ¨æ·»åŠ </span></div><div class="line">        number = array[index];</div><div class="line">        <span class="keyword">if</span> (error) &#123;</div><div class="line">            *error = [[<span class="built_in">NSError</span> errorWithDomain:<span class="string">@"me.tutuge"</span> code:<span class="number">100</span> userInfo:<span class="literal">nil</span>] autorelease]; <span class="comment">// æ³¨æ„è¿™ä¸ªautorelease !</span></div><div class="line">        &#125;</div><div class="line">        stop = <span class="literal">TRUE</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è€Œ<code>autorelease</code>å¯¹åº”çš„å‡½æ•°<code>id objc_autorelease(id value)</code>çš„å®˜æ–¹è§£é‡Šï¼š</p>
<blockquote>
<p>If value is null, this call has no effect. Otherwise, it adds the object to the innermost autorelease pool exactly as if the object had been sent the autorelease message.</p>
</blockquote>
<p>å…¶ä¸­çš„<strong>innermost autorelease pool</strong>è¡¨ç¤ºçš„å°±æ˜¯â€œæœ€å†…å±‚â€çš„autoreleasepoolï¼Œå¯¹äºä¾‹å­æ¥è¯´å°±æ˜¯<code>*error</code>è¢«æ·»åŠ åˆ°äº†å¾ªç¯å†…çš„autoreleasepoolä¸­ï¼Œå½“ç„¶ï¼Œå¯¼è‡´çš„ç»“æœå°±æ˜¯æœ¬æ¬¡å¾ªç¯ç»“æŸåï¼Œ<code>*error</code>ä¹Ÿéšç€ä¸€èµ·è¢«é‡Šæ”¾äº†ã€‚</p>
<p>æœ€ç»ˆå¯¼è‡´äº†å¤–éƒ¨è®¿é—®äº†å·²ç»è¢«é‡Šæ”¾çš„<code>*error</code>ï¼Œå‡ºç°äº†EXC_BAD_ACCESSé”™è¯¯ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¾ˆå¤šæ—¶å€™ä¸èƒ½æƒ³å½“ç„¶çš„å†™ä»£ç =ã€‚=ï¼Œè¦ä¸ç„¶å‡ºäº†é—®é¢˜æ‰¾éƒ½æ‰¾ä¸åˆ°ï¼Œæ¯ä¸ªç»†èŠ‚éƒ½å¾ˆé‡è¦ã€‚<br>å—¯ï¼Œç°åœ¨è¯»æ±‡ç¼–å¿«å¤šäº†ã€‚ã€‚ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="http://clang.llvm.org/docs/AutomaticReferenceCounting.html" target="_blank" rel="external">Clang document: Objective-C Automatic Reference Counting (ARC)</a></li>
<li><a href="https://developer.apple.com/library/mac/releasenotes/ObjectiveC/RN-TransitioningToARC/Introduction/Introduction.html" target="_blank" rel="external">Transitioning to ARC Release Notes</a></li>
<li><a href="http://blog.sunnyxx.com/2014/10/15/behind-autorelease/" target="_blank" rel="external">é»‘å¹•èƒŒåçš„Autorelease</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;p&gt;2016-05-01: è¡¥å……äº†ä¸€ç‚¹æœ¬æ–‡æ¶‰åŠçš„æ±‡ç¼–çŸ¥è¯†&lt;/p&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡ç»“åˆä¸€æ®µè®¿é—®&lt;code&gt;Out Parameters&lt;/code&gt;å‡ºç°äº†&lt;code&gt;EXC_BAD_ACCESS&lt;/code&gt;é”™è¯¯çš„ä»£ç ï¼Œé€šè¿‡åç¼–è¯‘ç­‰æ‰‹æ®µéªŒè¯Objective-Cä¸­&lt;code&gt;__autoreleasing&lt;/code&gt;çš„ä¸€äº›ç‰¹ç‚¹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>æ€»ç»“ä¸€äº›iOSé¡¹ç›®ä¸­ç»„ç»‡ä»£ç çš„æ–¹æ³•</title>
    <link href="http://tutuge.me/2016/04/10/summary-of-code-organization/"/>
    <id>http://tutuge.me/2016/04/10/summary-of-code-organization/</id>
    <published>2016-04-10T12:10:56.000Z</published>
    <updated>2016-08-07T06:16:22.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ€»ç»“ä¸€äº›ç»„ç»‡ä»£ç çš„æ–¹æ³•ï¼Œå¤§åˆ°å„ä¸ªå­é¡¹ç›®æ¨¡å—ä¹‹é—´ï¼Œå°åˆ°å•ä¸ªæ–‡ä»¶å†…éƒ¨ï¼Œæ¶‰åŠåˆ°äº†CocoaPodsç§æœ‰åº“ã€Carthageæ„å»ºç§æœ‰Frameworkã€é¡¹ç›®å†…Groupå’Œæ–‡ä»¶å¤¹ã€ç±»å†…ç”¨Categoryç»„ç»‡ã€æ–‡ä»¶å†…çš„#pragam markã€// MARK -ã€‚è™½ç„¶æœ‰äº›è€ç”Ÿå¸¸è°ˆï¼Œå°±å½“æ˜¯é‡æ–°æ¢³ç†ä¸€éå§=ã€‚=ã€‚</p>
<a id="more"></a>
<h2 id="å¤šä¸ªå­é¡¹ç›®-CocoaPodsåŠ ç§æœ‰ä»“åº“"><a href="#å¤šä¸ªå­é¡¹ç›®-CocoaPodsåŠ ç§æœ‰ä»“åº“" class="headerlink" title="å¤šä¸ªå­é¡¹ç›® - CocoaPodsåŠ ç§æœ‰ä»“åº“"></a>å¤šä¸ªå­é¡¹ç›® - CocoaPodsåŠ ç§æœ‰ä»“åº“</h2><p>æ„Ÿè§‰ç›®å‰CocoaPodså·²ç»æˆäº†æiOSå¼€å‘çš„æ ‡é…äº†ï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰çš„ç¬¬ä¸‰æ–¹åº“å’Œç»„ä»¶éƒ½å¯ä»¥é€šè¿‡CocoaPodsæ¥é›†æˆç®¡ç†ã€‚ä½†æ˜¯CocoaPodsçš„åŠŸèƒ½å…¶å®ä¸æ­¢ç®¡ç†ç¬¬ä¸‰æ–¹åº“å’Œç»„ä»¶ï¼Œå›¢é˜Ÿå†…éƒ¨çš„æ‹†åˆ†å‡ºæ¥çš„å­é¡¹ç›®å’Œå­æ¨¡å—ï¼ŒåŒæ ·å¯ä»¥ç”¨CocoaPodsæ¥é›†æˆç®¡ç†ã€‚</p>
<p>å…ˆçœ‹çœ‹å¦‚ä¸‹Podfileçš„ç¤ºä¾‹ï¼š</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"># æºé…ç½® #</div><div class="line">source <span class="string">'git@gitlab.xxx.com:cocoapods/specs.git'</span> # å›¢é˜Ÿå†…éƒ¨Gitlabæº</div><div class="line">source <span class="string">'https://git.coding.net/xxx/specs.git'</span> # Codingç­‰ç§æœ‰Gitæ‰˜ç®¡å¹³å°</div><div class="line"></div><div class="line"># iOSç‰ˆæœ¬æ”¯æŒ #</div><div class="line">platform :ios, <span class="string">'7.0'</span></div><div class="line"></div><div class="line"># å¼€å‘ä¸­çš„å­é¡¹ç›® #</div><div class="line">pod <span class="string">'XXXCommonUI'</span>, :path=&gt; <span class="string">'/Users/tutuge/projects/Xcode/XXXCommonUI'</span> # æœ¬åœ°è·¯å¾„</div><div class="line"></div><div class="line"># ä¾èµ–çš„å†…éƒ¨å­é¡¹ç›® #</div><div class="line">pod <span class="string">'XXXModuleA'</span>, :git=&gt; <span class="string">'git@gitlab.xxx.com:cocoapods/XXXModuleA'</span>, :branch=&gt;<span class="string">'develop'</span></div><div class="line">pod <span class="string">'XXXModuleB'</span>, <span class="string">'1.0.1'</span></div><div class="line"></div><div class="line"># ä¾èµ–çš„å¼€æºç¬¬ä¸‰æ–¹åº“ #</div><div class="line">pod <span class="string">'AFNetworking'</span>,<span class="string">'3.0.0'</span></div><div class="line">pod <span class="string">'DTCoreText'</span></div><div class="line"></div><div class="line"># é¢å¤–çš„è„šæœ¬ #</div><div class="line"># ...</div></pre></td></tr></table></figure>
<p><strong>ç§æœ‰Gitä»“åº“</strong>  </p>
<p>è™½ç„¶æˆ‘ä»¬æœ‰ä¸‡èƒ½çš„Githubäº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰äº›ä»£ç æ˜¯ä¸èƒ½å…¬å¼€çš„=ã€‚=ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªç§æœ‰çš„Gitä»“åº“ã€‚  </p>
<p>æœ‰è‡ªå·±æœåŠ¡å™¨çš„ï¼Œå®Œå…¨å¯ä»¥ç”¨<a href="https://about.gitlab.com/" target="_blank" rel="external">Gitlab</a>(æˆ–è€…<a href="https://gogs.io/" target="_blank" rel="external">Gogs</a>)æ­å»ºä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç§æœ‰Gitä»“åº“ï¼Œç®¡ç†é¡¹ç›®ä»£ç ï¼Œæ­å»ºCocoaPodsç§æœ‰æºéƒ½å¾ˆä¸é”™ã€‚  </p>
<p>å½“ç„¶ï¼Œæ‡’å¾—æŠ˜è…¾çš„ï¼Œä¹Ÿå¯ä»¥ç”¨ç¬¬ä¸‰æ–¹çš„ç§æœ‰GitæœåŠ¡ï¼Œå¦‚ï¼š<a href="https://bitbucket.org/" target="_blank" rel="external">Bitbucket</a>ã€<a href="https://coding.net/" target="_blank" rel="external">Coding</a>ç­‰ã€‚</p>
<p><strong>ç§æœ‰CocoaPodsæº</strong></p>
<p>æ­å»ºä¸€ä¸ªç§æœ‰CocoaPodsæºå…¶å®å°±æ˜¯åˆ›å»ºä¸€ä¸ªç§æœ‰çš„<code>Spec Repo</code>ï¼Œè¯´ç™½äº†å°±æ˜¯ä¸€ä¸ªå­˜æ”¾äº†æ‰€æœ‰ç§æœ‰Podsçš„<code>Podspec</code>æ–‡ä»¶çš„ï¼ŒæŒ‰ç…§ç‰¹å®šç»“æ„ç»„ç»‡çš„ç›®å½•ï¼Œç„¶åæŠŠè¿™ä¸ªç›®å½•æ¨åˆ°ç§æœ‰Gitä»“åº“å°±æˆäº†ä¸€ä¸ªç§æœ‰çš„CocoaPodsæºã€‚  </p>
<p><code>Spec Repo</code>çš„ç›®å½•ç»“æ„ç¤ºä¾‹å¦‚ä¸‹ï¼š  </p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">â”œâ”€â”€ <span class="selector-tag">Specs</span></div><div class="line">    â””â”€â”€ <span class="selector-attr">[XXXModuleA]</span></div><div class="line">        â””â”€â”€ <span class="selector-attr">[0.0.1]</span></div><div class="line">            â””â”€â”€ <span class="selector-attr">[XXXModuleA]</span><span class="selector-class">.podspec</span><span class="selector-class">.json</span></div><div class="line">        â””â”€â”€ <span class="selector-attr">[0.0.2]</span></div><div class="line">            â””â”€â”€ <span class="selector-attr">[XXXModuleA]</span><span class="selector-class">.podspec</span><span class="selector-class">.json</span></div></pre></td></tr></table></figure>
<p>ç„¶åæ·»åŠ ç§æœ‰æºå³å¯ï¼š  </p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pod repo add XXXSpecRepo https:<span class="regexp">//gi</span>t.coding.net<span class="regexp">/xxx/</span>specs.git</div></pre></td></tr></table></figure>
<p><strong>åˆ›å»ºç§æœ‰CocoaPodsé¡¹ç›®çš„å…·ä½“æ­¥éª¤</strong>  </p>
<p>è‡³äºå…·ä½“çš„åˆ›å»ºæ­¥éª¤ï¼ŒCocoaPodsçš„å®˜æ–¹æ–‡æ¡£å’Œä¸€äº›ä¼˜ç§€çš„åšå®¢å·²ç»è¯´å¾—å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘å°±ä¸å†é‡å¤äº†ã€‚æ¨èé˜…è¯»ï¼š<a href="https://guides.cocoapods.org/" target="_blank" rel="external">CocoaPods Guides</a>ï¼Œè¿˜æœ‰<a href="http://blog.wtlucky.com/blog/2015/02/26/create-private-podspec/" target="_blank" rel="external">ä½¿ç”¨Cocoapodsåˆ›å»ºç§æœ‰podspec</a>ï¼Œè¿™ç¯‡å¾ˆè¯¦ç»†ï¼</p>
<p><strong>å¼•ç”¨æ­£åœ¨æœ¬åœ°å¼€å‘çš„å­é¡¹ç›®</strong></p>
<p>ä¸»å·¥ç¨‹ä¾èµ–çš„å­é¡¹ç›®ä¹Ÿæ˜¯å¯ä»¥åŒæ—¶å¼€å‘çš„ï¼Œç”¨<code>path</code>æŒ‡å®šè·¯å¾„å³å¯ï¼Œå¦‚<code>pod &#39;XXXCommonUI&#39;, :path=&gt; &#39;/Users/tutuge/projects/Xcode/XXXCommonUI&#39;</code>ï¼Œç„¶å<code>pod install</code>ä¸€ä¸‹ï¼Œä¾èµ–çš„æœ¬åœ°å·¥ç¨‹å°±ä¼šé›†æˆåˆ°ä¸»å·¥ç¨‹çš„<code>Development Pods</code>ç›®å½•ä¸‹ï¼Œå¼€å‘æ—¶ï¼Œå°±å¯ä»¥åŒæ—¶ä¿®æ”¹ä¸»é¡¹ç›®å’Œå­é¡¹ç›®äº†ã€‚</p>
<h2 id="æ„å»ºç§æœ‰Framework-Carthage"><a href="#æ„å»ºç§æœ‰Framework-Carthage" class="headerlink" title="æ„å»ºç§æœ‰Framework - Carthage"></a>æ„å»ºç§æœ‰Framework - Carthage</h2><p>é™¤äº†æŠ½ç¦»å‡ºå­é¡¹ç›®ï¼Œç”¨Frameworkçš„æ–¹å¼æ¥ç®¡ç†å…¬å…±ä»£ç ä¹Ÿæ˜¯ä¸é”™çš„é€‰æ‹©ï¼ŒFrameworkçš„å¥½å¤„ä¹Ÿæ˜¯å¤šå¤šçš„:</p>
<ul>
<li>æœ¬è´¨ä¸Šæ˜¯ä¸ªbundleï¼Œä¸ä»…å¯ä»¥æ‰“åŒ…ä»£ç ï¼Œè¿˜å¯ä»¥æ‰“åŒ…èµ„æºAssetsã€è§†å›¾XIBç­‰</li>
<li>å¯ä»¥æœ‰é€‰æ‹©çš„å¼€æ”¾å¤´æ–‡ä»¶ã€æ¥å£ï¼Œé¿å…äº†ç”¨CocoaPodsé›†æˆå­é¡¹ç›®æ—¶ï¼Œæ‰€æœ‰ä»£ç å…¨éƒ¨æš´éœ²çš„é—®é¢˜ï¼Œåªæš´éœ²éœ€è¦çš„ï¼Œä»£ç æ›´åŠ æ¸…æ™°ã€‚</li>
<li>ä»iOS 8å¼€å§‹æ”¯æŒçš„Cocoa Touch Frameworkå¯ä»¥æ”¯æŒåŠ¨æ€Frameworkï¼Œèƒ½åœ¨ä¸»Appå’Œå„ç§Extensionä¹‹é—´å…±äº«ä¸€ä»½äºŒè¿›åˆ¶ç›®æ ‡ä»£ç ï¼ŒåŠ å¿«åº”ç”¨åŠ è½½é€Ÿåº¦ï¼Œå‡å°ä½“ç§¯ï¼ŒåŠ å¿«ç¼–è¯‘é€Ÿåº¦ç­‰ã€‚</li>
</ul>
<p>åŸºäºCocoa Touch FrameworkåŠ¨æ€æ¡†æ¶çš„ç§ç§ä¼˜ç‚¹ï¼Œâ€œå»ä¸­å¿ƒåŒ–â€çš„è½»é‡çº§ä¾èµ–åŒ…ç®¡ç†å·¥å…·<a href="https://github.com/Carthage/Carthage" target="_blank" rel="external">Carthage</a>ä¹Ÿè¶Šæ¥è¶Šå—æ¬¢è¿ã€‚ </p>
<p>æ€»çš„æ¥è¯´ï¼ŒCarthageæ²¡æœ‰CocoaPodsé‚£æ ·çš„<code>Spec Repo</code>ä¸­å¿ƒï¼Œä¸ä¼šå¯¹ç°æœ‰é¡¹ç›®å·¥ç¨‹ä¿®æ”¹ï¼Œåªæ˜¯å®Œæˆäº†æ‹‰å–ä»£ç ã€æ„å»ºFrameworkçš„å·¥ä½œï¼Œéå¸¸çš„è½»é‡çº§ï¼Œæ‰€ä»¥ç”¨æ¥æ„å»ºå›¢é˜Ÿå†…å…¬ç”¨çš„Frameworkéå¸¸ä¸é”™~</p>
<p><strong>åˆ›å»ºFramework</strong>  </p>
<p>è¿™é‡Œçš„FrameworkæŒ‡çš„æ˜¯Cocoa Touch FrameworkåŠ¨æ€æ¡†æ¶ï¼Œé™æ€Frameworkçš„ç¼ºç‚¹ä¸å°‘(å¦‚ä¸èƒ½å…±äº«å·²åŠ è½½åˆ°å†…å­˜çš„äºŒè¿›åˆ¶ç›®æ ‡ä»£ç ã€æ„å»ºéº»çƒ¦ç­‰)ï¼Œå¦‚æœé¡¹ç›®å¯ä»¥ä»iOS 8å¼€å§‹æ”¯æŒï¼Œä¸ºå•¥ä¸ç”¨åŠ¨æ€æ¡†æ¶å‘¢~</p>
<p>åˆ›å»ºFrameworkçš„è¿‡ç¨‹éå¸¸ç®€å•ï¼ŒXcode 6ä»¥åå°±æœ‰äº†Frameworké¡¹ç›®æ¨¡æ¿ï¼Œç›´æ¥é€‰ä¸­â€Cocoa Touch Frameworkâ€æ¨¡æ¿ï¼ŒæŒ‰ç…§æç¤ºæ¥å³å¯ã€‚è®°å¾—åœ¨<code>TARGETS-&gt;Build Phases-&gt;Headers-&gt;Public&quot;</code>åŠ å…¥è¦æš´éœ²çš„å¤´æ–‡ä»¶ï¼ˆSwiftçš„è¯ï¼Œå°†è¦æš´éœ²çš„ç±»ã€æ–¹æ³•æ ‡è®°publicï¼‰å°±å¥½ã€‚</p>
<p><strong>ç”¨Carthageæ„å»ºFramework</strong></p>
<p>Carthageåªæ”¯æŒæ„å»ºæ ‡è®°ä¸ºâ€œSharedâ€çš„é¡¹ç›®Targetï¼Œæ‰€ä»¥åˆ›å»ºå¥½äº†Frameworkå·¥ç¨‹åï¼Œè¿˜è¦è®¾ç½®Schemeä¸ºâ€œSharedâ€ï¼Œå¯ä»¥åœ¨å½“å‰Schemeçš„<code>Edit Scheme</code>é‡Œé¢è®¾ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨Xcodeçš„èœå•<code>Product-&gt;Scheme-&gt;Manage Schemes</code>é‡Œé¢è®¾ç½®ã€‚</p>
<p>ç„¶åå°±å¯ä»¥å°†Frameworkå·¥ç¨‹æ¨é€åˆ°Gitä»“åº“ä¸­ï¼Œå¯ä»¥æ˜¯Githubï¼Œä¹Ÿå¯ä»¥æ˜¯ç§æœ‰Gitä»“åº“ï¼Œå¦‚ä¸Šä¸€èŠ‚æåˆ°çš„Codingã€Bitbucketç­‰ï¼Œåªè¦æœ¬æœºå¯ä»¥æ­£å¸¸è®¿é—®å³å¯ã€‚è®°ä½æ‰“ä¸Šç‰ˆæœ¬å·tagã€‚</p>
<p>ç„¶åå°±å¯ä»¥åœ¨ä¸€ä¸ªæµ‹è¯•å·¥ç¨‹ä¸­åˆ›å»ºä¸€ä¸ª<code>Cartfile</code>æ–‡ä»¶ï¼Œè¾“å…¥Frameworkçš„Gitè·¯å¾„ï¼ŒæŒ‰ç…§å®˜æ–¹æ–‡æ¡£è®¾ç½®ä¸€ä¸‹â€Run Scriptâ€ï¼Œè¿è¡Œ<code>carthage update</code>ç”Ÿæˆå¯¹åº”çš„Frameworkï¼Œå°±å¯ä»¥é›†æˆæµ‹è¯•ã€‚</p>
<p><strong>æœ€ç»ˆçš„Cartfile</strong></p>
<p>ç”±äºCarthageçš„å»ä¸­å¿ƒåŒ–ï¼Œç”¨Carthageç®¡ç†é¡¹ç›®çš„Frameworkä¾èµ–å°±éå¸¸çµæ´»ï¼Œä¸€ä¸ªç®€å•çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># å¼€å‘ä¸­çš„æœ¬åœ°Framework</span></div><div class="line">git <span class="string">"file:///directory/to/project"</span> <span class="string">"develop"</span></div><div class="line"></div><div class="line"><span class="meta"># ä¾èµ–çš„ç§æœ‰Framework</span></div><div class="line">git <span class="string">"git@gitlab.xxx.com:cocoapods/XXXFramework.git"</span> <span class="string">"development"</span></div><div class="line"></div><div class="line"><span class="meta"># ç¬¬ä¸‰æ–¹å¼€æºåº“</span></div><div class="line">github <span class="string">"Mantle/Mantle"</span> ~&gt; <span class="number">1.0</span></div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼ŒCarthageå¯ä»¥æ–¹ä¾¿çš„ç®¡ç†æ„å»ºæœ¬åœ°ã€ç§æœ‰ã€ç¬¬ä¸‰æ–¹çš„Frameworkåº“ï¼Œè€Œä¸”æ›´åŠ æ–¹ä¾¿~  </p>
<p>è¯¦ç»†çš„åˆ›å»ºæµç¨‹Googleä¸€ä¸‹å°±æœ‰å¾ˆå¤šï¼Œå¦‚<a href="https://medium.com/@PyBaig/build-your-own-cocoa-touch-frameworks-in-swift-d4ea3d1f9ca3#.z38fy8psd" target="_blank" rel="external">Build your own Cocoa Touch Frameworks, in pure Swift</a>ã€<a href="https://robots.thoughtbot.com/creating-your-first-ios-framework" target="_blank" rel="external">Creating your first iOS Framework</a>ã€<a href="http://blog.mat.tc/how-to-make-a-carthage-compatible-framework/" target="_blank" rel="external">How to Make a Carthage-compatible Framework in Swift</a>ã€‚ </p>
<p><strong>å’ŒCocoaPodsæ··ç”¨</strong></p>
<p>Carthageæ˜¯æ²¡æœ‰ä»»ä½•ä¾µå…¥æ€§çš„ï¼Œä¸ä¼šå¯¹é¡¹ç›®å·¥ç¨‹æœ‰ä¿®æ”¹ï¼Œåªæ˜¯æ„å»ºå‡ºäº†Frameworkæ–‡ä»¶ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥æŠŠCarthageå½“åšçº¯ç²¹çš„Frameworkæ„å»ºå·¥å…·ï¼Œè·ŸCocoaPodsä¸€èµ·æ„‰å¿«çš„ä½¿ç”¨=ã€‚=</p>
<h2 id="é¡¹ç›®å†…æ–‡ä»¶ç»„ç»‡-Groupå’Œæ–‡ä»¶å¤¹"><a href="#é¡¹ç›®å†…æ–‡ä»¶ç»„ç»‡-Groupå’Œæ–‡ä»¶å¤¹" class="headerlink" title="é¡¹ç›®å†…æ–‡ä»¶ç»„ç»‡ - Groupå’Œæ–‡ä»¶å¤¹"></a>é¡¹ç›®å†…æ–‡ä»¶ç»„ç»‡ - Groupå’Œæ–‡ä»¶å¤¹</h2><p>é¡¹ç›®å†…çš„ä»£ç ç»„ç»‡ï¼Œå…¶å®å°±æ˜¯ä»£ç æ–‡ä»¶çš„ç»„ç»‡ï¼Œæ€»çš„æ¥è¯´ï¼Œå…¶å®æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š</p>
<ol>
<li>å…·æœ‰ç‰©ç†æ–‡ä»¶å¤¹ç»“æ„çš„Folder reference</li>
<li>ä»Xcodeåˆ›å»ºçš„é€»è¾‘ä¸Šçš„Group</li>
<li>å…·æœ‰ç‰©ç†æ–‡ä»¶å¤¹ç»“æ„çš„Group</li>
</ol>
<p><strong>æ’é™¤Folder reference</strong></p>
<p>Folder referenceè¯´ç™½äº†å°±æ˜¯ç¡¬ç›˜ä¸Šä¸€ä¸ªæ–‡ä»¶å¤¹çš„é€»è¾‘å¼•ç”¨ï¼Œæœ‰ç‚¹åƒLinuxæ–‡ä»¶ç³»ç»Ÿé‡Œé¢çš„è½¯è¿æ¥=ã€‚=ï¼Œå›¾æ ‡æ˜¯è“è‰²çš„ï¼Œå°†ä¸€ä¸ªæ–‡ä»¶å¤¹æ‹–åˆ°Xcodeä¸­æ—¶ï¼Œ<code>Create folder references</code>é€‰é¡¹åˆ›å»ºçš„å°±æ˜¯ã€‚  </p>
<p>è™½ç„¶ç¼–è¯‘æ—¶ä¹Ÿä¼šè¢«æ‰“åŒ…åˆ°ç¨‹åºä¸­ï¼Œæ›´èƒ½åŒæ­¥çœŸæ­£æ–‡ä»¶å¤¹å†…éƒ¨çš„ä¿®æ”¹ï¼Œä½†æ˜¯é—æ†¾æ˜¯çš„é‡Œé¢çš„ä»£ç æ–‡ä»¶æ˜¯ä¸èƒ½è‡ªåŠ¨çš„åŠ å…¥åˆ°Xcodeçš„ç¼–è¯‘ä¸­çš„ï¼Œè¦æ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªåŠ ï¼Œè€Œä¸”å›¾ç‰‡èµ„æºä¹Ÿä¸èƒ½åœ¨IBé‡Œé¢ä½¿ç”¨ï¼Œä»£ç é‡Œé¢ä½¿ç”¨ä¹Ÿè¦åŠ ä¸Šè·¯å¾„ï¼Œæ‰€ä»¥ä¸€èˆ¬æ˜¯çº¯èµ„æºæ–‡ä»¶å¤¹ç”¨Folder referenceçš„æ–¹å¼å¼•ç”¨ï¼Œå¯¹äºç»„ç»‡ä»£ç æ–‡ä»¶ï¼Œå°±å¯ä»¥æ’é™¤Folder referenceçš„æ–¹å¼ã€‚</p>
<p><strong>çº¯é€»è¾‘Groupæ–‡ä»¶å¹³é“ºï¼Œè„±ç¦»Xcodeä¸æ–¹ä¾¿æŸ¥çœ‹</strong></p>
<p>é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯ï¼ŒGroupæ˜¯Xcodeå¯¹æ–‡ä»¶çš„ä¸€ç§é€»è¾‘ä¸Šçš„å¼•ç”¨ï¼Œå¹¶ä¸”åœ¨ç¼–è¯‘æ—¶Xcodeä¼šæŠŠæ‰€æœ‰çš„Groupå±•å¼€ï¼Œæ‰€ä»¥ä»£ç é‡Œé¢ä¹Ÿå°±ä¸ç”¨åƒFolder referenceä¸€æ ·åŠ ä¸Šè·¯å¾„ï¼Œè¿˜å¯ä»¥é’ˆå¯¹Targetä½œåŒºåˆ†ï¼Œå¾ˆæ–¹ä¾¿ã€‚  </p>
<p>ä½†æ˜¯Xcodeä¸­åˆ›å»ºçš„Groupå¹¶æ²¡æœ‰å¯¹åº”åˆ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å¤¹ï¼Œå¯¼è‡´ä¸€æ—¦è„±ç¦»Xcodeçœ‹ä»£ç ï¼Œæ‰€æœ‰çš„æ–‡ä»¶éƒ½å¹³é“ºåœ¨äº†æ ¹ç›®å½•ä¸‹ï¼Œéå¸¸ä¸æ–¹ä¾¿ã€‚</p>
<p>éš¾é“æ²¡æœ‰åŠæ³•äº†ï¼Ÿ</p>
<p><strong>æœ‰ç‰©ç†æ–‡ä»¶å¤¹ç»“æ„çš„Groupæœ€å¥½</strong></p>
<p>è¿˜æœ‰ä¸€ç§Groupæ˜¯å¯ä»¥æœ‰ç‰©ç†æ–‡ä»¶å¤¹ç»“æ„çš„ï¼Œå…¶å®å°†ä¸€ä¸ªæ–‡ä»¶å¤¹æ‹–åˆ°Xcodeä¸­ï¼Œé€‰æ‹©<code>Create groups for any added folders</code>åˆ›å»ºçš„Groupå°±æ˜¯æ—¢æœ‰Groupçš„æœ‰ç‚¹ï¼Œåˆå¯ä»¥ä¿æŒç‰©ç†æ–‡ä»¶å¤¹ç»“æ„ã€‚è¿™æ ·æ— æ„æ˜¯æœ€å¥½çš„~</p>
<p>æ‰‹åŠ¨åˆ›å»º:<br>å¯ä»¥<code>Add Files To XXXX</code>ï¼Œç„¶åé€‰æ‹©<code>New Folder</code>åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œç„¶åæŠŠä»£ç æ–‡ä»¶æ‹–è¿›å»ï¼Œå†æ·»åŠ å›Xcodeã€‚</p>
<p>è‡ªåŠ¨åˆ›å»ºï¼š<br>å¯¹äºç°æœ‰çš„å¤§é‡çš„Groupï¼Œæ‰‹åŠ¨ä¸€ä¸ªä¸€ä¸ªåˆ›å»ºå®åœ¨ä¸æ–¹ä¾¿ï¼Œè¿˜å¥½æœ‰ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼š<a href="https://github.com/venmo/synx" target="_blank" rel="external">synx</a>ï¼Œç›´æ¥åœ¨å·¥ç¨‹æ ¹ç›®å½•è¿è¡Œ<code>synx XXX.xcodeproj</code>å°±å¯ä»¥è‡ªåŠ¨ä¸ºGroupåˆ›å»ºç‰©ç†æ–‡ä»¶å¤¹ã€‚<br>å½“ç„¶ï¼ŒCocoaPodsç®¡ç†çš„åº“è¦é‡æ–°<code>pod install</code>ä¸€æ¬¡ï¼Œæ‰‹åŠ¨æ·»åŠ çš„Frameworkä¹Ÿè¦é‡æ–°æ·»åŠ ã€‚</p>
<h2 id="ç±»å†…ä»£ç ç»„ç»‡-Category"><a href="#ç±»å†…ä»£ç ç»„ç»‡-Category" class="headerlink" title="ç±»å†…ä»£ç ç»„ç»‡ - Category"></a>ç±»å†…ä»£ç ç»„ç»‡ - Category</h2><p>Objective-Cä¸­çš„Categoryå®åœ¨æ˜¯å¤ªæ–¹ä¾¿äº†ï¼Œå¯ä»¥çµæ´»çš„ä¸ºç°æœ‰çš„ç±»å¢åŠ æ–¹æ³•ï¼Œç”šè‡³æ˜¯ç³»ç»Ÿçš„ç±»ã€‚  </p>
<p>ä½†æ˜¯å…¶å®Categoryä¹Ÿå¯ä»¥æ‹¿æ¥ç»„ç»‡ä¸€ä¸ªç±»çš„å®ç°ï¼Œå°†ç±»çš„Propertyã€æ–¹æ³•æŒ‰ç…§ä¸šåŠ¡ã€åŠŸèƒ½æ‹†åˆ†åˆ°ä¸åŒçš„Categoryé‡Œé¢ï¼Œä½¿ç±»çš„ç»“æ„æ›´åŠ æ¸…æ™°ã€‚ </p>
<p>ç³»ç»ŸAPIæœ¬èº«å°±æœ‰å¤§é‡çš„ä¾‹å­ï¼Œå¦‚UIViewControllerçš„ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@interface</span> UIViewController (UIContainerViewControllerCallbacks)</div><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="variable">@end</span></div><div class="line"></div><div class="line"><span class="variable">@interface</span> UIViewController(UIViewControllerTransitioning)</div><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>å®ç°çš„æ—¶å€™è¿˜å¯ä»¥æ¯ä¸ªCategoryå¯¹åº”ä¸€ä¸ªå¤´æ–‡ä»¶å’Œ.mæ–‡ä»¶ï¼Œç±»çš„ç»“æ„æ›´åŠ æ¸…æ™°ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">XXXClass<span class="selector-class">.h</span></div><div class="line">XXXClass<span class="selector-class">.m</span></div><div class="line">XXXClass+XXXModuleA<span class="selector-class">.h</span></div><div class="line">XXXClass+XXXModuleA<span class="selector-class">.m</span></div><div class="line">XXXClass+XXXModuleB<span class="selector-class">.h</span></div><div class="line">XXXClass+XXXModuleB.m</div></pre></td></tr></table></figure>
<h2 id="æ–‡ä»¶å†…ä»£ç ç»„ç»‡-pragam-markã€-MARK"><a href="#æ–‡ä»¶å†…ä»£ç ç»„ç»‡-pragam-markã€-MARK" class="headerlink" title="æ–‡ä»¶å†…ä»£ç ç»„ç»‡ - #pragam markã€// MARK -"></a>æ–‡ä»¶å†…ä»£ç ç»„ç»‡ - #pragam markã€// MARK -</h2><p>æ•´ç†æ–‡ä»¶å†…çš„ä»£ç æ—¶ï¼Œæœ€å¥½çš„æ‰‹æ®µå°±æ˜¯ç”¨<code>#pragam mark</code>å®å®šä¹‰ï¼ŒSwiftçš„è¯å°±æ˜¯<code>// MARK -</code>ã€‚  </p>
<p>Objective-Cå†—é•¿çš„è¯­æ³•æ³¨å®šäº†ä¸€ä¸ªä»£ç æ–‡ä»¶çš„è¡Œæ•°ä¸ä¼šå°‘=ã€‚=ï¼Œå¦‚æœæ²¡æœ‰ä¸€å®šçš„è§„èŒƒï¼Œå®åœ¨æ˜¯éš¾ä»¥è¿­ä»£ï¼Œæ‰€ä»¥æœ€å¥½å°±æ˜¯å¼€å‘å‰çº¦å®šä¸€ç§è§„åˆ™ï¼Œå¯¹ä¸»è¦çš„ç±»çš„å®ç°éƒ½çº¦å®šå‡ºä¸€å¥—è§„èŒƒï¼Œå¦‚UIViewControllerçš„å­ç±»ã€UIViewçš„å­ç±»ã€UITableViewCellçš„å­ç±»ç­‰ï¼Œç„¶åå¼€å‘äººå‘˜æŒ‰ç…§è¿™ä¸ªè§„èŒƒå†™ä»£ç ï¼Œè¿™æ ·æ‰èƒ½ä½¿ä»£ç æ›´å¥½ç»´æŠ¤ã€‚</p>
<p>å¦‚ï¼ŒUIViewControllerçš„å­ç±»å®ç°æ—¶ï¼Œå¯ä»¥æŒ‰ç…§å¦‚ä¸‹é¡ºåºç»„ç»‡ä»£ç ï¼š</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">@implementation XXXViewController</div><div class="line"></div><div class="line"><span class="comment">// å†…å­˜ç›¸å…³</span></div><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Memory manager</span></div><div class="line"></div><div class="line">- (instancetype)init</div><div class="line">- (<span class="keyword">void</span>)dealloc</div><div class="line"></div><div class="line"><span class="comment">// ç±»ç”Ÿå‘½å‘¨æœŸç›¸å…³çš„</span></div><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Life cycle</span></div><div class="line"></div><div class="line">(<span class="keyword">void</span>)viewDidLoad</div><div class="line"></div><div class="line"><span class="comment">// ç±»çš„Publicæ–¹æ³•</span></div><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Public methods</span></div><div class="line"></div><div class="line"><span class="comment">// æ‰€æœ‰çš„Actions</span></div><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Actions</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)didTapCancelButton:(UIButton *button)</div><div class="line"></div><div class="line"><span class="comment">// é€šçŸ¥å›è°ƒï¼Œå…·ä½“å¯ä»¥ç»†åˆ†</span></div><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Notifications - XXX</span></div><div class="line"></div><div class="line"><span class="comment">// ç³»ç»Ÿçš„Delegate</span></div><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - UITableViewDelegate</span></div><div class="line"></div><div class="line"><span class="comment">// è‡ªå®šä¹‰ç±»çš„Delegate</span></div><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - XXXDelegate</span></div><div class="line"></div><div class="line"><span class="comment">// è‡ªå®šä¹‰Viewã€åˆå§‹åŒ–ç­‰</span></div><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Custom views</span></div><div class="line"></div><div class="line"><span class="comment">// ç±»ç§æœ‰æ–¹æ³•</span></div><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - Private methods</span></div><div class="line"></div><div class="line">@<span class="built_in">end</span></div></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œå…·ä½“çš„ç»„ç»‡æ–¹æ³•è¿˜è¦æ ¹æ®é¡¹ç›®æœ¬èº«çš„æ¶æ„ã€æ¨¡å¼å†³å®šï¼Œä¸Šé¢çš„åªæ˜¯å‚è€ƒã€‚</p>
<p><strong>è¿›ä¸€æ­¥ï¼šåˆ›å»ºé¡¹ç›®ä¸“å±æ–‡ä»¶æ¨¡æ¿</strong></p>
<p>æ—¢ç„¶å®šä¸‹äº†æ–‡ä»¶å†…çš„ç»„ç»‡é¡ºåºï¼Œæ¯æ¬¡å†™ä»£ç æ‰‹å·¥è¾“å…¥ä¹Ÿè¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œæ‰€ä»¥æ›´è¿›ä¸€æ­¥çš„è¯å°±æ˜¯åˆ›å»ºè‡ªå®šä¹‰çš„Xcodeæ–‡ä»¶æ¨¡æ¿ï¼ŒæŠŠä¸åŒç±»çš„<code>#pragma mark</code>é¡ºåºè§„åˆ™ç›´æ¥å†™åˆ°æ¨¡æ¿é‡Œé¢ï¼Œä»¥åå¼€å‘äººå‘˜åˆ›å»ºæ–‡ä»¶æ—¶ç›´æ¥ç”¨é¡¹ç›®ä¸“å±çš„æ¨¡æ¿å°±å¯ä»¥äº†~</p>
<p>å…·ä½“çš„åˆ›å»ºXcodeæ¨¡æ¿çš„æ­¥éª¤ä¸åœ¨æœ¬æ–‡èŒƒç•´=ã€‚=ï¼Œä¸è¿‡å€’æ˜¯å‘ç°äº†ä¸€ä¸ªXcodeæ’ä»¶ï¼Œä¸“é—¨ç”¨æ¥åˆ›å»ºæ¨¡æ¿çš„ï¼š<a href="https://github.com/samdods/Stencil" target="_blank" rel="external">Stencil: A plugin for Xcode allowing you to easily create custom file templates</a>ï¼Œä»¥åŠå¯¹åº”çš„æ–‡ç« ï¼š<a href="http://sam.dods.co/blog/2015/05/02/stencil-xcode-plugin/" target="_blank" rel="external">Introducing Stencil</a>ï¼Œè¿˜æœ‰ä¸€äº›æ•™ç¨‹ï¼š<a href="http://www.telerik.com/blogs/how-to-create-custom-project-templates-in-xcode-7" target="_blank" rel="external">How to Create Custom Project Templates in Xcode 7</a>ï¼Œ<a href="https://robots.thoughtbot.com/creating-custom-xcode-templates" target="_blank" rel="external">Creating Custom Xcode Templates</a>ï¼Œè¯»è€…å¯è‡ªè¡Œé˜…è¯»~</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ä¸€åˆ‡ä¸ºäº†æ›´åŠ å¹²å‡€æ•´æ´çš„ä»£ç ï¼Œâ€œMay the clean code be with youâ€</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://cocoapods.org/" target="_blank" rel="external">CocoaPods</a></li>
<li><a href="https://github.com/Carthage/Carthage" target="_blank" rel="external">Carthage</a></li>
<li><a href="http://vocaro.com/trevor/blog/2012/10/21/xcode-groups-vs-folder-references/" target="_blank" rel="external">Xcode Groups vs. Folder References</a></li>
<li><a href="http://www.knowstack.com/framework-vs-library-cocoa-ios/" target="_blank" rel="external">Framework vs Library (Static &amp; Shared) in (Cocoa/OSX, Cocoa Touch/iOS)</a></li>
<li><a href="https://onevcat.com/2016/01/create-framework/" target="_blank" rel="external">onevcat-å¦‚ä½•æ‰“é€ ä¸€ä¸ªè®©äººæ„‰å¿«çš„æ¡†æ¶</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æ€»ç»“ä¸€äº›ç»„ç»‡ä»£ç çš„æ–¹æ³•ï¼Œå¤§åˆ°å„ä¸ªå­é¡¹ç›®æ¨¡å—ä¹‹é—´ï¼Œå°åˆ°å•ä¸ªæ–‡ä»¶å†…éƒ¨ï¼Œæ¶‰åŠåˆ°äº†CocoaPodsç§æœ‰åº“ã€Carthageæ„å»ºç§æœ‰Frameworkã€é¡¹ç›®å†…Groupå’Œæ–‡ä»¶å¤¹ã€ç±»å†…ç”¨Categoryç»„ç»‡ã€æ–‡ä»¶å†…çš„#pragam markã€// MARK -ã€‚è™½ç„¶æœ‰äº›è€ç”Ÿå¸¸è°ˆï¼Œå°±å½“æ˜¯é‡æ–°æ¢³ç†ä¸€éå§=ã€‚=ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>å¯¹ç»„ä»¶åŒ–ä¸æ¨¡å—åŒ–çš„æ€è€ƒä¸æ€»ç»“</title>
    <link href="http://tutuge.me/2016/03/29/modular-and-component-summary/"/>
    <id>http://tutuge.me/2016/03/29/modular-and-component-summary/</id>
    <published>2016-03-29T14:19:54.000Z</published>
    <updated>2016-08-07T06:13:42.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰æ®µæ—¶é—´åå¤ç ”è¯»äº†<a href="http://limboy.me/ios/2016/03/10/mgj-components.html" target="_blank" rel="external">è˜‘è‡è¡— App çš„ç»„ä»¶åŒ–ä¹‹è·¯</a>ã€<a href="http://limboy.me/ios/2016/03/14/mgj-components-continued.html" target="_blank" rel="external">è˜‘è‡è¡— App çš„ç»„ä»¶åŒ–ä¹‹è·¯Â·ç»­</a>å’Œ<a href="http://casatwy.com/iOS-Modulization.html" target="_blank" rel="external">iOSåº”ç”¨æ¶æ„è°ˆ ç»„ä»¶åŒ–æ–¹æ¡ˆ</a>ï¼Œç„¶ååˆæ‰¾åˆ°äº†å…¶å®ƒä¸€äº›ç ”ç©¶ç»„ä»¶åŒ–ã€æ¨¡å—åŒ–æ–¹æ¡ˆçš„æ–‡ç« ï¼Œä½†æ˜¯æ€»è§‰å¾—å·®ç‚¹ä»€ä¹ˆï¼Œæ‰€ä»¥è¿˜æ˜¯å†³å®šä»å¤´å¼€å§‹æ€è€ƒã€‚æ–‡ç« çš„æ ‡é¢˜èµ·çš„å¥½å®½æ³›ï¼Œæ„Ÿè§‰ç»™è‡ªå·±æŒ–äº†ä¸ªæ·±å‘-ã€‚-ï¼Œå…¶å®åªæ˜¯è‡ªå·±å¯¹ç»„ä»¶åŒ–ã€æ¨¡å—åŒ–çš„ä¸€äº›çœ‹æ³•ã€æ€»ç»“ã€‚</p>
<a id="more"></a>
<h2 id="ä¸ºä»€ä¹ˆ"><a href="#ä¸ºä»€ä¹ˆ" class="headerlink" title="ä¸ºä»€ä¹ˆ"></a>ä¸ºä»€ä¹ˆ</h2><p>å…ˆæ€»ç»“ä¸‹ä¸ºä»€ä¹ˆè¦å¤§åŠ¨å¹²æˆˆçš„å¯¹ä»£ç åˆ†æ¨¡å—ã€æ‹†ç»„ä»¶ã€‚   </p>
<p><strong>ä»£ç é‡è†¨èƒ€ï¼Œä¸åˆ©äºç»´æŠ¤ï¼Œæ›´ä¸åˆ©äºæ–°åŠŸèƒ½çš„å¼€å‘</strong>  </p>
<p> ç°åœ¨éšä¾¿å¼€å‘ä¸€ä¸ªAppçš„ä»£ç è¡Œæ•°éƒ½æ˜¯æ•°ä»¥ä¸‡è®¡çš„ï¼Œå¦‚æœä¸å¯¹ä»£ç åšåˆç†çš„æ‹†åˆ†ï¼Œé‚£ç®€ç›´å°±æ˜¯ç¾éš¾æ€§çš„ï¼Œä¼°è®¡åªæœ‰æœ€åˆçš„å¼€å‘äººå‘˜çŸ¥é“å¦‚ä½•ç»´æŠ¤ä¿®æ”¹ï¼Œå¦‚æœæ¢äººå¼€å‘çš„è¯ï¼Œéš¾ä»¥ä¸‹æ‰‹ï¼Œæ›´ä¸ç”¨è¯´å¼€å‘æ–°åŠŸèƒ½äº†ã€‚</p>
<p><strong>ä¸åŒä¸šåŠ¡ä»£ç è€¦åˆä¸¥é‡ï¼Œéš¾ä»¥å¤šäººåˆä½œï¼ŒèŒè´£ä¸åˆ†æ˜</strong>  </p>
<p>å¤šäººä¸€èµ·å¼€å‘æ—¶ï¼Œå¦‚æœä»£ç ç»“æ„ã€æ¨¡å—åŒ–çš„ä¸å¥½ï¼Œå°±å¾ˆéš¾å¯¹ä¸åŒä¸šåŠ¡åˆ’åˆ†å‡ºåˆ†ç•Œçº¿ï¼Œéš¾ä»¥æ˜ç¡®å„è‡ªçš„èŒè´£ï¼Œç‰µä¸€å‘åŠ¨å…¨èº«ï¼Œå‡ºäº†é—®é¢˜æ›´æ˜¯å®¹æ˜“ç›¸äº’æ‰¯çš®ï¼ˆè¿™ä¸ªæ—¶å€™åªèƒ½è¯´ä¸€å¥â€œæ€ªæˆ‘å’¯o(â•¯â–¡â•°)oâ€ï¼‰ï¼Œæ›´ä¸ç”¨æåˆå¹¶ä»£ç æ—¶çš„å†²çªäº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œåˆç†çš„ç»„ç»‡ä»£ç ï¼Œåˆ’åˆ†æ¨¡å—ã€æ‹†åˆ†ç»„ä»¶æ˜¯é¡¹ç›®å¯ä»¥é«˜æ•ˆè¿­ä»£çš„åŸºç¡€ã€‚</p>
<h2 id="ç–‘é—®"><a href="#ç–‘é—®" class="headerlink" title="ç–‘é—®"></a>ç–‘é—®</h2><p>é‚£åˆ°åº•ä»€ä¹ˆæ˜¯æ¨¡å—åŒ–ã€ç»„ä»¶åŒ–ï¼ŸæŸ¥èµ„æ–™çš„æ—¶å€™ä¸€ä¼šå„¿æ¨¡å—ï¼Œä¸€ä¼šå„¿ç»„ä»¶ï¼Œæœ‰ä»€ä¹ˆè”ç³»ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæœ‰äººè¯´è¿™åªæ˜¯å«æ³•ä¹ æƒ¯é—®é¢˜ï¼ŒçŸ¥é“å¤§æ¦‚æ„æ€å°±å¥½ï¼Œä¸ç”¨å’¬æ–‡åš¼å­—ï¼Œä½†æ˜¯æ€»è§‰å¾—æ²¡æœ‰ä¸ªâ€œå®šä¹‰â€æ„Ÿè§‰ä¸è¸å®ï¼Œæ‰€ä»¥è¿˜æ˜¯æ±‚åŠ©äº†ä¸‡èƒ½çš„ç»´åŸºç™¾ç§‘=ã€‚=</p>
<h2 id="æ¨¡å—åŒ–"><a href="#æ¨¡å—åŒ–" class="headerlink" title="æ¨¡å—åŒ–"></a>æ¨¡å—åŒ–</h2><p>ç»´åŸºç™¾ç§‘çš„<a href="https://en.wikipedia.org/wiki/Modular_programming" target="_blank" rel="external">Modular programming</a>çš„å¼€å¤´å®šä¹‰å¦‚ä¸‹:</p>
<blockquote>
<p>Modular programming is a software design technique that emphasizes separating the functionality of a program into independent, interchangeable modules, such that each contains everything necessary to execute only one aspect of the desired functionality.</p>
</blockquote>
<p>æ¥ç€ï¼Œåœ¨<strong>Key aspects</strong>éƒ¨åˆ†çš„å¼€å¤´ä¹Ÿè¯´äº†:</p>
<blockquote>
<p>With modular programming, concerns are separated such that modules perform logically discrete functions, interacting through well-defined interfaces. </p>
</blockquote>
<p>å¯ä»¥æ€»ç»“ä¸ºï¼šæ¨¡å—åŒ–çš„ç›®çš„åœ¨äºå°†ä¸€ä¸ªç¨‹åºæŒ‰ç…§å…¶åŠŸèƒ½åšæ‹†åˆ†ï¼Œåˆ†æˆç›¸äº’ç‹¬ç«‹çš„æ¨¡å—ï¼Œä»¥ä¾¿äºæ¯ä¸ªæ¨¡å—åªåŒ…å«ä¸å…¶åŠŸèƒ½ç›¸å…³çš„å†…å®¹ï¼Œæ¨¡å—ä¹‹é—´é€šè¿‡æ¥å£è°ƒç”¨ã€‚</p>
<p>å½“ç„¶ï¼Œæ¨¡å—åŒ–ç¼–ç¨‹çš„å…·ä½“æ¦‚å¿µæ˜¯åŒ…å«äº†å¾ˆå¤šå†…å®¹çš„ï¼Œè¯»è€…å¯ä»¥è¯¦ç»†é˜…è¯»ä¸‹ç»´åŸºç™¾ç§‘çš„å®šä¹‰ã€‚</p>
<h2 id="ç»„ä»¶åŒ–"><a href="#ç»„ä»¶åŒ–" class="headerlink" title="ç»„ä»¶åŒ–"></a>ç»„ä»¶åŒ–</h2><p>å…³äºç»„ä»¶åŒ–ï¼Œèƒ½æ‰¾åˆ°çš„æ¯”è¾ƒæ¥è¿‘çš„å°±æ˜¯ç»´åŸºç™¾ç§‘çš„<a href="https://en.wikipedia.org/wiki/Component-based_software_engineering" target="_blank" rel="external">Component-based software engineering</a>ï¼Œå…¶å¼€å¤´å†…å®¹å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>Component-based software engineering (CBSE), also known as component-based development (CBD), is a branch of software engineering that emphasizes the separation of concerns in respect of the wide-ranging functionality available throughout a given software system. It is a reuse-based approach to defining, implementing and composing loosely coupled independent components into systems.</p>
</blockquote>
<p>ä¹ä¸€çœ‹ï¼Œè¿™ä¸æ˜¯è·Ÿæ¨¡å—åŒ–<strong>Modular programming</strong>çš„å®šä¹‰å¾ˆç›¸ä¼¼å˜›=ã€‚=<br>çš„ç¡®ï¼Œæ–‡ä¸­ä¹Ÿæåˆ°ç»„ä»¶åŒ–è·Ÿæ¨¡å—åŒ–æ˜¯å¾ˆç±»ä¼¼çš„ï¼Œéƒ½æ˜¯ä¸»è¦ä¸ºäº†å¯¹ä¸€ä¸ªç³»ç»Ÿåšæ‹†åˆ†ï¼Œæ¯”å¦‚æ–‡ä¸­æåˆ°ï¼š  </p>
<blockquote>
<p>All system processes are placed into separate components so that all of the data and functions inside each component are semantically related (just as with the contents of classes). Because of this principle, it is often said that components are modular and cohesive.</p>
</blockquote>
<p>åŒæ—¶ï¼Œç»„ä»¶è¿˜å…·æœ‰å…¶ä»–å±æ€§ï¼Œå¦‚å¯æ›¿ä»£æ€§(substitutable)ï¼Œé€šè¿‡æ¥å£(interface)è®¿é—®ï¼Œå¯é‡ç”¨æ€§(Reusability)ç­‰ï¼Œè¯»è€…å¯è‡ªè¡Œé˜…è¯»ã€‚</p>
<h2 id="å¯¹æ¯”"><a href="#å¯¹æ¯”" class="headerlink" title="å¯¹æ¯”"></a>å¯¹æ¯”</h2><p>éš¾é“æ¨¡å—åŒ–è·Ÿç»„ä»¶åŒ–çœŸçš„æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Ÿçš„ç¡®ï¼Œå¾ˆå¤šæ—¶å€™ä¸¤è€…çš„æ¦‚å¿µå®Œå…¨å¯ä»¥ç›¸äº’æ›¿æ¢ï¼Œåœ¨å®è·µä¸­æ›´æ˜¯ç»å¸¸æ··ç”¨ã€‚  </p>
<p>åœ¨æ±‚åŠ©è°·æ­Œï¼Œç”šè‡³é˜…è¯»äº†å¤§é‡çš„å‰ç«¯æŠ€æœ¯ç­‰å…¶å®ƒæŠ€æœ¯é¢†åŸŸçš„ç»„ä»¶åŒ–ã€æ¨¡å—åŒ–çš„æ–‡ç« åï¼Œæˆ‘è§‰å¾—å¦‚æœçœŸè¦å°†å®ƒä»¬ä¸¤è€…åšä¸ªå¯¹æ¯”ï¼Œå¤§æ¦‚æ€»ç»“å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ¨¡å—åŒ–å¼ºè°ƒçš„æ˜¯<strong>æ‹†åˆ†</strong>ï¼Œæ— è®ºæ˜¯ä»ä¸šåŠ¡è§’åº¦è¿˜æ˜¯ä»æ¶æ„ã€æŠ€æœ¯è§’åº¦ï¼Œæ¨¡å—åŒ–é¦–å…ˆæ„å‘³ç€å°†ä»£ç ã€æ•°æ®ç­‰å†…å®¹æŒ‰ç…§å…¶èŒè´£ä¸åŒåˆ†ç¦»ï¼Œä½¿å…¶å˜å¾—æ›´åŠ å®¹æ˜“ç»´æŠ¤ã€è¿­ä»£ï¼Œä½¿å¼€å‘äººå‘˜å¯ä»¥åˆ†è€Œæ²»ä¹‹ã€‚</li>
<li>ç»„ä»¶åŒ–åˆ™ç€é‡äº<strong>å¯é‡ç”¨æ€§</strong>ï¼Œä¸ç®¡æ˜¯ç•Œé¢ä¸Šåå¤ä½¿ç”¨çš„ç”¨æˆ·å¤´åƒæŒ‰é’®ï¼Œè¿˜æ˜¯å¤„ç†æ•°æ®çš„æµç¨‹ä¸­çš„æŸä¸ªéƒ¨ä»¶ï¼Œåªè¦å¯ä»¥è¢«åå¤ä½¿ç”¨ï¼Œå¹¶ä¸”è¿›è¡Œäº†é«˜åº¦å°è£…ï¼Œåªèƒ½é€šè¿‡æ¥å£è®¿é—®ï¼Œå°±å¯ä»¥ç§°å…¶ä¸ºâ€œç»„ä»¶â€ã€‚</li>
</ul>
<p>å½“ç„¶ï¼Œå¹¶ä¸æ˜¯è¯´æ¨¡å—å°±ä¸èƒ½è¢«å¤ç”¨ï¼Œè¿˜æ˜¯è¦æ ¹æ®å®é™…æƒ…å†µæ¥çœ‹ï¼Œä½¿ç³»ç»Ÿæ›´åŠ å®¹æ˜“ç»´æŠ¤ï¼Œå¼€å‘æ›´åŠ æ–¹ä¾¿ï¼Œæ‰æ˜¯æœ€ç»ˆç›®çš„ã€‚</p>
<h2 id="å¦‚ä½•æ‹†åˆ†"><a href="#å¦‚ä½•æ‹†åˆ†" class="headerlink" title="å¦‚ä½•æ‹†åˆ†"></a>å¦‚ä½•æ‹†åˆ†</h2><p>æ— è®ºæ˜¯æ¨¡å—åŒ–è¿˜æ˜¯ç»„ä»¶åŒ–ï¼Œé¦–å…ˆè‚¯å®šæ˜¯åšæ‹†åˆ†ï¼Œä½†æ˜¯å¦‚ä½•æ‹†åˆ†ï¼Ÿæ€ä¹ˆä¸‹æ‰‹ï¼Ÿä¾ç…§ä»€ä¹ˆæ ‡å‡†ï¼Ÿ<br>ä¸‹é¢ç®€å•æ€»ç»“ä¸€äº›æ–¹æ³•ã€‚</p>
<h4 id="æ¨ªå‘æ‹†åˆ†ä¸šåŠ¡ã€åŠŸèƒ½æ¨¡å—"><a href="#æ¨ªå‘æ‹†åˆ†ä¸šåŠ¡ã€åŠŸèƒ½æ¨¡å—" class="headerlink" title="æ¨ªå‘æ‹†åˆ†ä¸šåŠ¡ã€åŠŸèƒ½æ¨¡å—"></a>æ¨ªå‘æ‹†åˆ†ä¸šåŠ¡ã€åŠŸèƒ½æ¨¡å—</h4><p>å¾ˆå¤šæ—¶å€™ï¼Œä¸€ä¸ªå®Œæ•´çš„è½¯ä»¶ç¨‹åºæ˜¯åŒæ—¶ä¸ºå¤šç§ä¸šåŠ¡æœåŠ¡çš„ï¼Œæ‰€æœ‰å¯ä»¥ä¼˜å…ˆæŒ‰ç…§ä¸šåŠ¡çš„ä¸åŒï¼Œå°†æ•´ä¸ªç³»ç»Ÿè¿›è¡Œæ‹†åˆ†ã€‚  </p>
<p>å¦‚ä¸€ä¸ªç”µå•†ç±»å‹çš„Appï¼Œå°±å¯ä»¥åˆ†å‡ºå•†å“æµè§ˆæ¨¡å—ã€è®¢å•æ¨¡å—ã€è´­ç‰©è½¦æ¨¡å—ã€æ¶ˆæ¯æ¨¡å—ã€æ”¯ä»˜æ¨¡å—ç­‰ã€‚åˆå¦‚å¾®ä¿¡è¿™ç§ç¤¾äº¤å‹åº”ç”¨ï¼Œå¯ä»¥æ‹†åˆ†å‡ºè”ç³»äººæ¨¡å—ã€æœ‹å‹åœˆæ¨¡å—ã€èŠå¤©æ¨¡å—ã€æ¶ˆæ¯æ¨¡å—ç­‰ã€‚  </p>
<p>å…¶å®å°±æ˜¯ä»ç”¨æˆ·ä½¿ç”¨çš„è§’åº¦ï¼ŒæŒ‰ç…§åŠŸèƒ½çš„ä¸åŒåˆ’åˆ†æ¨¡å—ï¼Œå½“ç„¶ï¼Œè¿™ç§ä¸šåŠ¡æ¨¡å—æ˜¯è¦ç”±å„ç§æŠ€æœ¯æ¨¡å—ä½œæ”¯æ’‘çš„ã€‚</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/modular_and_component_summary_1.jpg" alt="æ¨ªå‘æ‹†åˆ†ä¸šåŠ¡æ¨¡å—ç¤ºä¾‹"></p>
<h4 id="çºµå‘æ‹†åˆ†æŠ€æœ¯ã€æ¶æ„æ¨¡å—"><a href="#çºµå‘æ‹†åˆ†æŠ€æœ¯ã€æ¶æ„æ¨¡å—" class="headerlink" title="çºµå‘æ‹†åˆ†æŠ€æœ¯ã€æ¶æ„æ¨¡å—"></a>çºµå‘æ‹†åˆ†æŠ€æœ¯ã€æ¶æ„æ¨¡å—</h4><p>å¦‚æœè„±ç¦»ä¸šåŠ¡ï¼Œåªä»æŠ€æœ¯è§’åº¦æ¥çœ‹ï¼Œåˆ™å¯ä»¥å°è¯•çºµå‘å¯¹ç³»ç»Ÿæ‹†åˆ†æ¨¡å—ã€‚</p>
<p>å…¶å®è¿™é‡Œçš„çºµå‘æ‹†åˆ†è·Ÿå¯¹ç³»ç»Ÿçš„æ¶æ„åšåˆ†å±‚æœ‰ç‚¹åƒ=ã€‚=ï¼Œç°å¦‚ä»Šåªè¦éœ€è¦è”ç½‘è¯·æ±‚APIçš„Appéƒ½å…ä¸äº†æœ‰ç½‘ç»œè¯·æ±‚ã€æ•°æ®ç¼“å­˜ã€æ•°æ®åŠ å·¥å¤„ç†ã€æ•°æ®å±•ç¤ºã€åé¦ˆç”¨æˆ·æ“ä½œç­‰è¡Œä¸ºï¼Œæ‰€æœ‰è¿™äº›ç¯èŠ‚å±‚å±‚é€’è¿›æ‰èƒ½å®Œæˆä¸€ä¸ªåŠŸèƒ½ã€‚  </p>
<p>å½“å¼€å§‹ç€æ‰‹è§„åˆ’ä¸€ä¸ªå®Œæ•´è½¯ä»¶ç³»ç»Ÿï¼Œæˆ–è€…è¯´Appæ—¶ï¼Œå°±å¯ä»¥æŒ‰ç…§è¿™äº›ç¯èŠ‚åˆ’åˆ†æ¨¡å—ï¼Œçºµå‘åˆ†å±‚æ¬¡çš„ç»„åˆï¼Œæ­å»ºå‡ºä¸€ä¸ªä»¥æŠ€æœ¯æ¨¡å—ç»„æˆçš„ç®€æ˜“ç³»ç»Ÿæ¶æ„å›¾ï¼Œæ–¹ä¾¿åç»­çš„å¼€å‘ï¼Œå¦‚ä¸‹å›¾ã€‚</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/modular_and_component_summary_2.jpg" alt="çºµå‘æ‹†åˆ†æŠ€æœ¯æ¨¡å—ç¤ºä¾‹"></p>
<p>å¤§ä½“ä¸Šçš„æŠ€æœ¯æ¨¡å—åˆ’åˆ†å¥½ä»¥åï¼Œå°±å¯ä»¥æŒ‰ç…§å…·ä½“çš„éœ€æ±‚ï¼Œå®ç°æ¯ä¸ªæŠ€æœ¯æ¨¡å—ï¼Œä¹ƒè‡³ç»†åˆ†å‡ºæ›´å¤šçš„å­æ¨¡å—ï¼Œå¦‚ç¼“å­˜æ¨¡å—å¯èƒ½ç”±é”®å€¼å¯¹ç¼“å­˜ï¼ˆNSUserDefaultsï¼‰ã€æ•°æ®åº“ç¼“å­˜ï¼ˆSQLiteã€Realmï¼‰ã€å›¾ç‰‡ç¼“å­˜ç­‰å­æ¨¡å—ç»„æˆï¼Œæ ¹æ®å…·ä½“æƒ…å†µè€Œå®šã€‚</p>
<h4 id="ä»ç•Œé¢å…¥æ‰‹ï¼Œæ‹†åˆ†å¯è§†åŒ–ç»„ä»¶"><a href="#ä»ç•Œé¢å…¥æ‰‹ï¼Œæ‹†åˆ†å¯è§†åŒ–ç»„ä»¶" class="headerlink" title="ä»ç•Œé¢å…¥æ‰‹ï¼Œæ‹†åˆ†å¯è§†åŒ–ç»„ä»¶"></a>ä»ç•Œé¢å…¥æ‰‹ï¼Œæ‹†åˆ†å¯è§†åŒ–ç»„ä»¶</h4><p>ç°åœ¨å†æ¥çœ‹çœ‹å¦‚ä½•ä»ç•Œé¢å…¥æ‰‹æ‹†åˆ†å¯å¤ç”¨çš„ç»„ä»¶ã€‚å‡å¦‚æœ‰å¦‚ä¸‹å¸ƒå±€çš„ç•Œé¢ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/modular_and_component_summary_3.jpg" alt="ä»ç•Œé¢å…¥æ‰‹æ‹†åˆ†å¯è§†åŒ–ç»„ä»¶"></p>
<p>å¾ˆå¤šæ—¶å€™ï¼Œåƒç•Œé¢é‡Œé¢çš„â€œæœç´¢æ¡†â€ã€â€œå¤´åƒæŒ‰é’®â€ã€â€œå†…å®¹æ¡†â€å’Œæ˜¾ç¤ºæç¤ºç”¨çš„â€œåŠ è½½ä¸­â€HUDï¼Œç”šè‡³æ•´ä¸ªå†…å®¹çš„Cellï¼Œéƒ½æ˜¯å¯èƒ½åœ¨å¾ˆå¤šåœ°æ–¹å‡ºç°çš„ï¼Œè€Œä¸”æœ¬èº«çš„æ ·å¼ã€åŠŸèƒ½æ¯”è¾ƒé›†ä¸­ã€‚<br>å¦‚å¤´åƒå¯èƒ½è¦æ”¯æŒç‚¹å‡»è·³è½¬ï¼Œå¤´åƒå›¾ç‰‡åœ†è§’ï¼Œå†…å®¹æ¡†æœ‰ç‰¹å®šçš„Paddingå’Œå­—ä½“å¤§å°ç­‰ï¼Œæ‰€ä»¥å¯ä»¥å°†è¿™äº›ç•Œé¢ä¸Šçš„å…ƒç´ â€œæâ€å‡ºæ¥ï¼Œå•ç‹¬å°è£…æˆä¸€ä¸ªç»„ä»¶ï¼Œä¾›æ•´ä¸ªAppå¤ç”¨ã€‚æˆ–è€…ç›´æ¥ç”¨ç¬¬ä¸‰æ–¹çš„ç»„ä»¶ï¼Œå¦‚å›¾ä¸­çš„â€œåŠ è½½ä¸­â€HUDï¼Œå°±å¯ä»¥ç”¨SVProgressHUDã€MBProgressHUDç­‰å¼€æºåº“ã€‚</p>
<p>å…¶å®è¿™é‡Œçš„ç»„ä»¶æœ‰ç§sunnyxxå¤§å¤§æåˆ°è¿‡çš„â€œSelf-Managerâ€çš„å‘³é“=ã€‚=ï¼Œç»„ä»¶æœ¬èº«è´Ÿè´£è‡ªå·±çš„æ‰€æœ‰åŠŸèƒ½ã€æ ·å¼ï¼Œå‚è€ƒï¼š<a href="http://blog.sunnyxx.com/2015/12/19/self-manager-pattern-in-ios/" target="_blank" rel="external">iOS å¼€å‘ä¸­çš„ Self-Manager æ¨¡å¼</a>ã€‚å½“ç„¶è·Ÿå‰ç«¯çš„ç»„ä»¶åŒ–ä¹ŸæŒºåƒçš„ï¼Œå¦‚Reacté‡Œé¢çš„componentï¼Œæ ·å¼ã€åŠŸèƒ½éƒ½å°è£…åˆ°componenté‡Œé¢ï¼Œä»¥ä¾¿æ›´å¥½åœ°è§£è€¦å¤ç”¨ã€‚</p>
<h4 id="ä»æ•°æ®å…¥æ‰‹ï¼Œæ‹†åˆ†æ•°æ®åŠ å·¥ç»„ä»¶"><a href="#ä»æ•°æ®å…¥æ‰‹ï¼Œæ‹†åˆ†æ•°æ®åŠ å·¥ç»„ä»¶" class="headerlink" title="ä»æ•°æ®å…¥æ‰‹ï¼Œæ‹†åˆ†æ•°æ®åŠ å·¥ç»„ä»¶"></a>ä»æ•°æ®å…¥æ‰‹ï¼Œæ‹†åˆ†æ•°æ®åŠ å·¥ç»„ä»¶</h4><p>å†æ¥çœ‹çœ‹ä»æ•°æ®å…¥æ‰‹ï¼Œæ‹†åˆ†å¯å¤ç”¨çš„ç»„ä»¶ã€‚å‡å¦‚æœ‰å¦‚ä¸‹æ•°æ®å¤„ç†æµç¨‹ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/modular_and_component_summary_4.jpg" alt="ä¸€æ•°æ®å¤„ç†æµç¨‹ç¤ºä¾‹"></p>
<p>å…¶å®å¤§éƒ¨åˆ†æ—¶å€™ï¼Œæ‹†åˆ†æ¨¡å—ã€ç»„ä»¶éƒ½æ˜¯ä»¥æ¸…æ™°çš„æµç¨‹ã€é€»è¾‘ä¸ºåŸºç¡€çš„ï¼Œå°±å¦‚ä¸Šå›¾çš„è¿‡ç¨‹ï¼Œå½“æµç¨‹æ¸…æ™°åï¼Œå¯ä»¥æ‹†åˆ†å¤ç”¨çš„ç»„ä»¶ä¹Ÿå°±â€œå‡ºæ¥äº†â€ã€‚ </p>
<p>å¦‚ä»JSONæ•°æ®å®ä¾‹åŒ–å‡ºå¯¹åº”çš„Entityå¯¹è±¡ï¼Œè¿™ä¸ªåŠŸèƒ½å°±æ˜¯ä¸€ä¸ªå®Œæ•´ç‹¬ç«‹çš„ç»„ä»¶ï¼Œå½“ç„¶å®é™…å¼€å‘ä¸­ä¼šç”¨Mantleã€JSONModelç­‰åº“å®ç°ã€‚  </p>
<p>ä»¥æ­¤ç±»æ¨ï¼Œæ ¡éªŒã€æ ¼å¼åŒ–æ—¥æœŸï¼ˆå¦‚â€œå‡ ç§’é’Ÿå‰ã€å‡ å¤©å‰â€ï¼‰ã€å¤šè¯­è¨€ç­‰ç¯èŠ‚ï¼Œéƒ½å¯ä»¥ç‹¬ç«‹æˆä¸€ä¸ªä¸ªçš„ç»„ä»¶ã€‚  </p>
<p>å½“ç„¶ï¼Œè¿™é‡Œçš„ç»„ä»¶ä¸€èˆ¬æ˜¯æŒ‡èƒ½åœ¨å¤šä¸ªæ¨¡å—ä½¿ç”¨çš„åŠŸèƒ½ç»„ä»¶ï¼Œå¦‚æœåªæ˜¯åœ¨æŸä¸ªç•Œé¢ä¸Šæ‰ç”¨çš„ï¼Œå€’ä¸å¦‚æ”¾åˆ°ViewModelã€Presenterç­‰è¿™äº›ç›´æ¥è·Ÿç•Œé¢æœ‰å…³çš„ç±»é‡Œé¢ã€‚</p>
<h4 id="å°èŠ‚"><a href="#å°èŠ‚" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h4><p>ä¸Šé¢çš„å‡ ç§æ–¹æ³•æ¯”è¾ƒé€‚åˆä¸çŸ¥é“å¦‚ä½•ä¸‹æ‰‹æ—¶ä½¿ç”¨=ã€‚=ï¼ŒçœŸæ­£çš„å¼€å‘ä¸­ï¼Œè¿˜æ˜¯è¦æ ¹æ®å®é™…æƒ…å†µè€ƒè™‘ï¼Œæƒ…å†µä¹Ÿä¼šå¤æ‚äº›ã€‚ä¸è¿‡å€’æ˜¯å¯ä»¥æ€»ç»“å‡ ç‚¹åŸåˆ™ï¼š</p>
<ul>
<li><strong>å•ä¸€èŒè´£</strong>ï¼Œæ„å‘³ç€ä¸€ä¸ªæ¨¡å—ã€ä¸€ä¸ªç»„ä»¶åªåšä¸€ä»¶äº‹ï¼Œç»ä¸å¤šåšã€‚</li>
<li><strong>æ­£äº¤æ€§</strong>ï¼Œæ„æ€æ˜¯ä¸é‡å¤ï¼Œä¸€ä¸ªæ¨¡å—è·Ÿå¦ä¸€ä¸ªæ¨¡å—çš„èŒè´£æ˜¯æ­£äº¤çš„ï¼Œæ²¡æœ‰é‡å ï¼Œç»„ä»¶ä¹Ÿæ˜¯ä¸€æ ·ã€‚</li>
<li><strong>å•å‘ä¾èµ–</strong>ï¼Œæ¨¡å—ä¹‹é—´æœ€å¤šæ˜¯å•å‘çš„ä¾èµ–ï¼Œå¦‚æœå‡ºç°Aä¾èµ–Bï¼ŒBä¹Ÿä¾èµ–Aï¼Œé‚£ä¹ˆè¦ä¹ˆæ˜¯Aã€Båº”è¯¥å±äºä¸€ä¸ªæ¨¡å—ï¼Œè¦ä¹ˆå°±æ˜¯æ•´ä½“çš„æ‹†åˆ†æœ‰é—®é¢˜ã€‚ä¸€ä¸ªå®Œæ•´çš„è½¯ä»¶ç³»ç»Ÿçš„æ¨¡å—ä¾èµ–åº”è¯¥æ˜¯ä¸€å¼ æœ‰å‘æ— ç¯å›¾ã€‚ï¼ˆå½“ç„¶è¿™æ˜¯æœ€ç»ˆç†æƒ³=ã€‚=ï¼‰</li>
<li><strong>ç´§å‡‘æ€§</strong>ï¼Œæ¨¡å—ã€ç»„ä»¶å¯¹å¤–æš´éœ²çš„æ¥å£ã€å±æ€§åº”è¯¥å°½å¯èƒ½çš„å°‘ï¼Œæ¥å£çš„å‚æ•°ä¸ªæ•°ä¹Ÿè¦å°‘ã€‚</li>
<li><strong>é¢å‘æ¥å£</strong>ï¼Œæ¨¡å—ã€ç»„ä»¶å¯¹å¤–æä¾›æœåŠ¡æ—¶æœ€å¥½æ˜¯é¢å‘æ¥å£çš„ï¼Œä»¥ä¾¿åæœŸå¯ä»¥çµæ´»çš„å˜æ›´å®ç°ã€‚</li>
</ul>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ä¸€åˆ‡ä¸ºäº†æ›´åŠ å¹²å‡€æ•´æ´çš„ä»£ç ï¼Œâ€œMay the clean code be with youâ€</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://en.wikipedia.org/wiki/Component-based_software_engineering" target="_blank" rel="external">Component-based software engineering</a></li>
<li><a href="https://en.wikipedia.org/wiki/Modular_programming" target="_blank" rel="external">Modular programming</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å‰æ®µæ—¶é—´åå¤ç ”è¯»äº†&lt;a href=&quot;http://limboy.me/ios/2016/03/10/mgj-components.html&quot;&gt;è˜‘è‡è¡— App çš„ç»„ä»¶åŒ–ä¹‹è·¯&lt;/a&gt;ã€&lt;a href=&quot;http://limboy.me/ios/2016/03/14/mgj-components-continued.html&quot;&gt;è˜‘è‡è¡— App çš„ç»„ä»¶åŒ–ä¹‹è·¯Â·ç»­&lt;/a&gt;å’Œ&lt;a href=&quot;http://casatwy.com/iOS-Modulization.html&quot;&gt;iOSåº”ç”¨æ¶æ„è°ˆ ç»„ä»¶åŒ–æ–¹æ¡ˆ&lt;/a&gt;ï¼Œç„¶ååˆæ‰¾åˆ°äº†å…¶å®ƒä¸€äº›ç ”ç©¶ç»„ä»¶åŒ–ã€æ¨¡å—åŒ–æ–¹æ¡ˆçš„æ–‡ç« ï¼Œä½†æ˜¯æ€»è§‰å¾—å·®ç‚¹ä»€ä¹ˆï¼Œæ‰€ä»¥è¿˜æ˜¯å†³å®šä»å¤´å¼€å§‹æ€è€ƒã€‚æ–‡ç« çš„æ ‡é¢˜èµ·çš„å¥½å®½æ³›ï¼Œæ„Ÿè§‰ç»™è‡ªå·±æŒ–äº†ä¸ªæ·±å‘-ã€‚-ï¼Œå…¶å®åªæ˜¯è‡ªå·±å¯¹ç»„ä»¶åŒ–ã€æ¨¡å—åŒ–çš„ä¸€äº›çœ‹æ³•ã€æ€»ç»“ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
  </entry>
  
  <entry>
    <title>å¼€æºé¡¹ç›®-TTGTagCollectionView</title>
    <link href="http://tutuge.me/2015/12/31/TTGTagCollectionView/"/>
    <id>http://tutuge.me/2015/12/31/TTGTagCollectionView/</id>
    <published>2015-12-31T13:56:04.000Z</published>
    <updated>2017-02-26T18:05:28.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><ul>
<li>2017-02-27: å¢åŠ ä¸¤ç§Alignmentå¸ƒå±€ç±»å‹ï¼›å¢åŠ ç‚¹å‡»å‰çš„å›è°ƒåˆ¤æ–­ï¼›å¢åŠ é€‰ä¸­Tagä¸Šé™</li>
<li>2016-12-25: ä¸å†ä¾èµ–UICollectionViewï¼Œå‡å°‘äº†ä½ç½®åˆ·æ–°æ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ï¼›å¢åŠ äº†alignmentå±æ€§ï¼Œå¯ä»¥é å·¦ä¸­å³æ’åˆ—</li>
<li>2016-10-29: å¢åŠ Tagçš„é˜´å½±å’ŒContentInsetçš„è®¾ç½®ï¼Œæ›´æ–°äº†Demo</li>
<li>2016-10-17: å¢åŠ äº†æ°´å¹³æ»‘åŠ¨ï¼›Autolayouté€‚é…ï¼›UITableViewCellä¾‹å­ç­‰</li>
<li>2016-02-18: ä¿®å¤äº†è¶…é•¿æ ‡ç­¾å¯¼è‡´æ’ç‰ˆé”™è¯¯çš„Bug</li>
</ul>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ®µæ—¶é—´åšé¡¹ç›®çš„æ—¶å€™ï¼Œæ€»æ˜¯éœ€è¦æ˜¾ç¤ºä¸€äº›â€œæ ‡ç­¾â€æ ·å¼çš„å†…å®¹ï¼Œä½†æ˜¯åˆæ‰¾ä¸åˆ°ç”¨çš„é¡ºæ‰‹çš„åº“ï¼Œæ‰€ä»¥ç¢ç£¨äº†å‡ å¤©ï¼Œè‡ªå·±å®ç°äº†å‡ºæ¥ï¼Œå°±æœ‰äº†è¿™ä¸ªåº“ï¼šTTGTagCollectionViewã€‚å¦‚æœåªéœ€è¦æ˜¾ç¤ºæ–‡å­—æ ‡ç­¾çš„è¯ï¼Œç›´æ¥ä½¿ç”¨<code>TTGTextTagCollectionView</code>ï¼Œéœ€è¦è‡ªå·±å®šä¹‰æ ‡ç­¾çš„è¯ï¼Œå°±ç”¨<code>TTGTagCollectionView</code>ï¼Œæ•ˆæœå¦‚ä¸‹:</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGTagCollectionView_screenshot.png" alt="ScreenShot"></p>
<p>æ”¯æŒäº”ç§å¸ƒå±€æ’ç‰ˆï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/TTGTagCollectionView_alignment_type_1.png" alt="Alignment"></p>
<p>CocoaPods: <code>pod &quot;TTGTagCollectionView&quot;</code><br>Carthage: <code>github &quot;zekunyan/TTGTagCollectionView&quot;</code></p>
<p>Githubåœ°å€: <a href="https://github.com/zekunyan/TTGTagCollectionView" target="_blank" rel="external">https://github.com/zekunyan/TTGTagCollectionView</a></p>
<a id="more"></a>
<h2 id="åªæ˜¾ç¤ºæ–‡å­—æ ‡ç­¾-TTGTextTagCollectionView"><a href="#åªæ˜¾ç¤ºæ–‡å­—æ ‡ç­¾-TTGTextTagCollectionView" class="headerlink" title="åªæ˜¾ç¤ºæ–‡å­—æ ‡ç­¾ - TTGTextTagCollectionView"></a>åªæ˜¾ç¤ºæ–‡å­—æ ‡ç­¾ - TTGTextTagCollectionView</h2><h3 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h3><p>åªæ˜¾ç¤ºæ–‡å­—æ ‡ç­¾çš„è¯ï¼Œç›´æ¥ç”¨<code>TTGTextTagCollectionView</code>ç±»å°±å¯ä»¥äº†ï¼š</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">TTGTextTagCollectionView</span> *tagCollectionView = [[<span class="symbol">TTGTextTagCollectionView</span> alloc] initWithFrame:<span class="symbol">CGRectMake</span>(<span class="number">20</span>, <span class="number">20</span>, <span class="number">200</span>, <span class="number">200</span>)];</div><div class="line">[self.view addSubview:tagCollectionView];</div><div class="line">[tagCollectionView addTags:@[@<span class="string">"TTG"</span>, @<span class="string">"Tag"</span>, @<span class="string">"collection"</span>, @<span class="string">"view"</span>]];</div></pre></td></tr></table></figure>
<h3 id="æ¥æ”¶ç‚¹å‡»äº‹ä»¶-å®ç°Delegate"><a href="#æ¥æ”¶ç‚¹å‡»äº‹ä»¶-å®ç°Delegate" class="headerlink" title="æ¥æ”¶ç‚¹å‡»äº‹ä»¶ - å®ç°Delegate"></a>æ¥æ”¶ç‚¹å‡»äº‹ä»¶ - å®ç°Delegate</h3><p>å¦‚æœæƒ³åœ¨æ ‡ç­¾è¢«ç‚¹å‡»æ—¶å¾—åˆ°é€šçŸ¥ï¼Œå®ç°å¯¹åº”çš„Protocolå³å¯ï¼Œå®šä¹‰å¦‚ä¸‹:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@protocol</span> TTGTextTagCollectionViewDelegate &lt;NSObject&gt;</div><div class="line"><span class="variable">@optional</span></div><div class="line"><span class="comment">// æ˜¯å¦å¯ä»¥ç‚¹å‡»æŸä¸ªTag</span></div><div class="line">- (BOOL)<span class="attribute">textTagCollectionView</span>:(TTGTextTagCollectionView *)textTagCollectionView <span class="attribute">canTapTag</span>:(NSString *)tagText <span class="attribute">atIndex</span>:(NSUInteger)index <span class="attribute">currentSelected</span>:(BOOL)currentSelected;</div><div class="line"></div><div class="line"><span class="comment">// ç‚¹å‡»äº†æŸä¸ªTag</span></div><div class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">textTagCollectionView</span><span class="selector-pseudo">:(TTGTextTagCollectionView</span> *)<span class="selector-tag">textTagCollectionView</span> <span class="selector-tag">didTapTag</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">tagText</span> <span class="selector-tag">atIndex</span><span class="selector-pseudo">:(NSUInteger)index</span> <span class="selector-tag">selected</span><span class="selector-pseudo">:(BOOL)selected</span>;</div><div class="line"></div><div class="line"><span class="comment">// å†…å®¹å¤§å°æ›´æ–°</span></div><div class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">textTagCollectionView</span><span class="selector-pseudo">:(TTGTextTagCollectionView</span> *)<span class="selector-tag">textTagCollectionView</span> <span class="selector-tag">updateContentSize</span><span class="selector-pseudo">:(CGSize)contentSize</span>;</div><div class="line">@<span class="selector-tag">end</span></div></pre></td></tr></table></figure>
<h3 id="è‡ªå®šä¹‰æ–‡å­—æ ‡ç­¾æ ·å¼"><a href="#è‡ªå®šä¹‰æ–‡å­—æ ‡ç­¾æ ·å¼" class="headerlink" title="è‡ªå®šä¹‰æ–‡å­—æ ‡ç­¾æ ·å¼"></a>è‡ªå®šä¹‰æ–‡å­—æ ‡ç­¾æ ·å¼</h3><p>å¦‚æœæƒ³å¯¹æ ‡ç­¾çš„æ ·å¼åšå®šåˆ¶ï¼Œå¯ä»¥è®¾ç½®ä»¥ä¸‹å±æ€§ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ ‡ç­¾æ˜¯å¦å¯ä»¥è¢«é€‰ä¸­</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> enableTagSelection;</div><div class="line"></div><div class="line"><span class="comment">// å­—ä½“</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIFont</span> *tagTextFont;</div><div class="line"></div><div class="line"><span class="comment">// æ–‡å­—é¢œè‰²</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIColor</span> *tagTextColor;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIColor</span> *tagSelectedTextColor;</div><div class="line"></div><div class="line"><span class="comment">// æ ‡ç­¾èƒŒæ™¯é¢œè‰²</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIColor</span> *tagBackgroundColor;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIColor</span> *tagSelectedBackgroundColor;</div><div class="line"></div><div class="line"><span class="comment">// åœ†è§’å€¼</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> tagCornerRadius;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> tagSelectedCornerRadius;</div><div class="line"></div><div class="line"><span class="comment">// è¾¹æ¡†</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> tagBorderWidth;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> tagSelectedBorderWidth;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIColor</span> *tagBorderColor;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIColor</span> *tagSelectedBorderColor;</div><div class="line"></div><div class="line"><span class="comment">// é˜´å½±</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">copy</span>) <span class="built_in">UIColor</span> *tagShadowColor;    <span class="comment">// Default is [UIColor black]</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGSize</span> tagShadowOffset;   <span class="comment">// Default is (2, 2)</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> tagShadowRadius;  <span class="comment">// Default is 2f</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">CGFloat</span> tagShadowOpacity; <span class="comment">// Default is 0.3f</span></div><div class="line"></div><div class="line"><span class="comment">// æ»šåŠ¨æ–¹å‘ï¼Œé»˜è®¤å‚ç›´æ–¹å‘</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) TTGTagCollectionScrollDirection scrollDirection;</div><div class="line"></div><div class="line"><span class="comment">// å¸ƒå±€ç±»å‹ï¼Œé»˜è®¤é å·¦</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) TTGTagCollectionAlignment alignment;</div><div class="line"></div><div class="line"><span class="comment">// è¡Œæ•°ï¼Œé»˜è®¤0ï¼Œä¸é™åˆ¶</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">NSUInteger</span> numberOfLines;</div><div class="line"></div><div class="line"><span class="comment">// é€‰ä¸­çš„æ•°é‡é™åˆ¶</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">NSUInteger</span> selectionLimit;</div><div class="line"></div><div class="line"><span class="comment">// æ ‡ç­¾å®½é«˜çš„æ‰©å±•å€¼ï¼Œå¯ä»¥ç†è§£ä¸ºpadding</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGSize</span> extraSpace;</div><div class="line"></div><div class="line"><span class="comment">// æ°´å¹³é—´éš”</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> horizontalSpacing;</div><div class="line"><span class="comment">// è¡Œè·</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> verticalSpacing;</div><div class="line"></div><div class="line"><span class="comment">// æ•´ä½“çš„Inset</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">UIEdgeInsets</span> contentInset;</div><div class="line"></div><div class="line"><span class="comment">// æ‰€æœ‰æ ‡ç­¾å¤§å°</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readonly</span>) <span class="built_in">CGSize</span> contentSize;</div><div class="line"></div><div class="line"><span class="comment">// æ˜¯å¦æ˜¾ç¤ºæ»šåŠ¨æ¡</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> showsHorizontalScrollIndicator;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> showsVerticalScrollIndicator;</div></pre></td></tr></table></figure>
<h3 id="å¢åŠ ã€åˆ é™¤æ ‡ç­¾"><a href="#å¢åŠ ã€åˆ é™¤æ ‡ç­¾" class="headerlink" title="å¢åŠ ã€åˆ é™¤æ ‡ç­¾"></a>å¢åŠ ã€åˆ é™¤æ ‡ç­¾</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¢åŠ ä¸€ä¸ªæ ‡ç­¾</span></div><div class="line">- (<span class="keyword">void</span>)addTag:(<span class="built_in">NSString</span> *)tag;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)addTags:(<span class="built_in">NSArray</span> &lt;<span class="built_in">NSString</span> *&gt; *)tags;</div><div class="line"></div><div class="line"><span class="comment">/// åˆ é™¤æ ‡ç­¾</span></div><div class="line">- (<span class="keyword">void</span>)removeTag:(<span class="built_in">NSString</span> *)tag;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)removeTagAtIndex:(<span class="built_in">NSUInteger</span>)index;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)removeAllTags;</div></pre></td></tr></table></figure>
<h3 id="åœ¨ä»£ç é‡Œæ§åˆ¶æ ‡ç­¾çš„é€‰ä¸­çŠ¶æ€"><a href="#åœ¨ä»£ç é‡Œæ§åˆ¶æ ‡ç­¾çš„é€‰ä¸­çŠ¶æ€" class="headerlink" title="åœ¨ä»£ç é‡Œæ§åˆ¶æ ‡ç­¾çš„é€‰ä¸­çŠ¶æ€"></a>åœ¨ä»£ç é‡Œæ§åˆ¶æ ‡ç­¾çš„é€‰ä¸­çŠ¶æ€</h3><figure class="highlight erlang"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- <span class="params">(void)</span>setTagAtIndex:<span class="params">(NSUInteger)</span>index selected:<span class="params">(BOOL)</span>selected;</div></pre></td></tr></table></figure>
<h3 id="è·å–æ‰€æœ‰ã€é€‰ä¸­ã€æœªé€‰ä¸­æ ‡ç­¾"><a href="#è·å–æ‰€æœ‰ã€é€‰ä¸­ã€æœªé€‰ä¸­æ ‡ç­¾" class="headerlink" title="è·å–æ‰€æœ‰ã€é€‰ä¸­ã€æœªé€‰ä¸­æ ‡ç­¾"></a>è·å–æ‰€æœ‰ã€é€‰ä¸­ã€æœªé€‰ä¸­æ ‡ç­¾</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- (<span class="name">NSArray</span> &lt;NSString *&gt; *)allTags<span class="comment">;</span></div><div class="line"></div><div class="line">- (<span class="name">NSArray</span> &lt;NSString *&gt; *)allSelectedTags<span class="comment">;</span></div><div class="line"></div><div class="line">- (<span class="name">NSArray</span> &lt;NSString *&gt; *)allNotSelectedTags<span class="comment">;</span></div></pre></td></tr></table></figure>
<h3 id="é‡æ–°åŠ è½½-Reload"><a href="#é‡æ–°åŠ è½½-Reload" class="headerlink" title="é‡æ–°åŠ è½½ - Reload"></a>é‡æ–°åŠ è½½ - Reload</h3><p>ç”¨<code>- (void)reload</code>æ–¹æ³•é‡æ–°åŠ è½½æ‰€æœ‰æ ‡ç­¾ã€‚</p>
<h2 id="æ˜¾ç¤ºè‡ªå®šä¹‰çš„æ ‡ç­¾æ§ä»¶View-TTGTagCollectionView"><a href="#æ˜¾ç¤ºè‡ªå®šä¹‰çš„æ ‡ç­¾æ§ä»¶View-TTGTagCollectionView" class="headerlink" title="æ˜¾ç¤ºè‡ªå®šä¹‰çš„æ ‡ç­¾æ§ä»¶View - TTGTagCollectionView"></a>æ˜¾ç¤ºè‡ªå®šä¹‰çš„æ ‡ç­¾æ§ä»¶View - TTGTagCollectionView</h2><p>å¦‚æœæƒ³è‡ªå·±å®šä¹‰æ ‡ç­¾Viewï¼Œå¦‚åŒæ—¶æ˜¾ç¤ºå›¾åƒã€æ–‡å­—ã€æŒ‰é’®ï¼Œå¯ä»¥ç”¨<code>TTGTagCollectionView</code>ç±»å®ç°ã€‚</p>
<h3 id="åŸºæœ¬è¦æ±‚-å®ç°DataSourceå’ŒDelegate"><a href="#åŸºæœ¬è¦æ±‚-å®ç°DataSourceå’ŒDelegate" class="headerlink" title="åŸºæœ¬è¦æ±‚ - å®ç°DataSourceå’ŒDelegate"></a>åŸºæœ¬è¦æ±‚ - å®ç°DataSourceå’ŒDelegate</h3><p>DataSourceçš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@protocol</span> TTGTagCollectionViewDataSource &lt;NSObject&gt;</div><div class="line"><span class="variable">@required</span></div><div class="line"><span class="comment">// è¿”å›æ ‡ç­¾æ•°é‡</span></div><div class="line">- (NSUInteger)<span class="attribute">numberOfTagsInTagCollectionView</span>:(TTGTagCollectionView *)tagCollectionView;</div><div class="line"></div><div class="line"><span class="comment">// è¿”å›å¯¹åº”æ ‡ç­¾View</span></div><div class="line"><span class="selector-tag">-</span> (UIView *)<span class="selector-tag">tagCollectionView</span><span class="selector-pseudo">:(TTGTagCollectionView</span> *)<span class="selector-tag">tagCollectionView</span> <span class="selector-tag">tagViewForIndex</span><span class="selector-pseudo">:(NSUInteger)index</span>;</div><div class="line">@<span class="selector-tag">end</span></div></pre></td></tr></table></figure>
<p>Delegateçš„å®šä¹‰å¦‚ä¸‹:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@protocol</span> TTGTagCollectionViewDelegate &lt;NSObject&gt;</div><div class="line"><span class="variable">@required</span></div><div class="line"><span class="comment">// å¿…é¡»å®ç°ï¼šè¿”å›å¯¹åº”çš„æ ‡ç­¾Size</span></div><div class="line">- (CGSize)<span class="attribute">tagCollectionView</span>:(TTGTagCollectionView *)tagCollectionView <span class="attribute">sizeForTagAtIndex</span>:(NSUInteger)index;</div><div class="line"></div><div class="line"><span class="variable">@optional</span></div><div class="line"><span class="comment">// æ˜¯å¦å¯ä»¥ç‚¹å‡»Tag</span></div><div class="line">- (BOOL)<span class="attribute">tagCollectionView</span>:(TTGTagCollectionView *)tagCollectionView <span class="attribute">shouldSelectTag</span>:(UIView *)tagView <span class="attribute">atIndex</span>:(NSUInteger)index;</div><div class="line"></div><div class="line"><span class="comment">// ç‚¹å‡»æ ‡ç­¾æ—¶å›è°ƒ</span></div><div class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">tagCollectionView</span><span class="selector-pseudo">:(TTGTagCollectionView</span> *)<span class="selector-tag">tagCollectionView</span> <span class="selector-tag">didSelectTag</span><span class="selector-pseudo">:(UIView</span> *)<span class="selector-tag">tagView</span> <span class="selector-tag">atIndex</span><span class="selector-pseudo">:(NSUInteger)index</span>;</div><div class="line"></div><div class="line"><span class="comment">// æ‰€æœ‰æ ‡ç­¾æ€»ä½“Sizeæ›´æ–°</span></div><div class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">tagCollectionView</span><span class="selector-pseudo">:(TTGTagCollectionView</span> *)<span class="selector-tag">tagCollectionView</span> <span class="selector-tag">updateContentSize</span><span class="selector-pseudo">:(CGSize)contentSize</span>;</div><div class="line">@<span class="selector-tag">end</span></div></pre></td></tr></table></figure>
<p>è·ŸUITableViewçš„æ€è·¯ä¸€è‡´~</p>
<h3 id="è®¾ç½®æ ‡ç­¾çš„è¡Œè·ã€é—´éš”"><a href="#è®¾ç½®æ ‡ç­¾çš„è¡Œè·ã€é—´éš”" class="headerlink" title="è®¾ç½®æ ‡ç­¾çš„è¡Œè·ã€é—´éš”"></a>è®¾ç½®æ ‡ç­¾çš„è¡Œè·ã€é—´éš”</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ»šåŠ¨æ–¹å‘</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) TTGTagCollectionScrollDirection scrollDirection;</div><div class="line"></div><div class="line"><span class="comment">// å¸ƒå±€æ–¹å¼ï¼Œé»˜è®¤é å·¦</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) TTGTagCollectionAlignment alignment;</div><div class="line"></div><div class="line"><span class="comment">// è¡Œæ•°ï¼Œé»˜è®¤0ï¼Œä¸é™åˆ¶</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">NSUInteger</span> numberOfLines;</div><div class="line"></div><div class="line"><span class="comment">// æ°´å¹³é—´éš”</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> horizontalSpacing;</div><div class="line"><span class="comment">// è¡Œè·</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> verticalSpacing;</div><div class="line"></div><div class="line"><span class="comment">// æ•´ä½“Inset</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">UIEdgeInsets</span> contentInset;</div><div class="line"></div><div class="line"><span class="comment">// æ‰€æœ‰æ ‡ç­¾æ€»ä½“Size</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>, <span class="keyword">readonly</span>) <span class="built_in">CGSize</span> contentSize;</div><div class="line"></div><div class="line"><span class="comment">// æ˜¯å¦æ˜¾ç¤ºæ»šåŠ¨æ¡</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> showsHorizontalScrollIndicator;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">assign</span>) <span class="built_in">BOOL</span> showsVerticalScrollIndicator;</div></pre></td></tr></table></figure>
<h3 id="é‡æ–°åŠ è½½-Reload-1"><a href="#é‡æ–°åŠ è½½-Reload-1" class="headerlink" title="é‡æ–°åŠ è½½ - Reload"></a>é‡æ–°åŠ è½½ - Reload</h3><p>ç”¨<code>- (void)reload</code>æ–¹æ³•é‡æ–°åŠ è½½æ‰€æœ‰æ ‡ç­¾ã€‚</p>
<h2 id="End"><a href="#End" class="headerlink" title="End"></a>End</h2><p>2015æœ€åä¸€å¤©~<br>æ–°å¹´å¿«ä¹~</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2017-02-27: å¢åŠ ä¸¤ç§Alignmentå¸ƒå±€ç±»å‹ï¼›å¢åŠ ç‚¹å‡»å‰çš„å›è°ƒåˆ¤æ–­ï¼›å¢åŠ é€‰ä¸­Tagä¸Šé™&lt;/li&gt;
&lt;li&gt;2016-12-25: ä¸å†ä¾èµ–UICollectionViewï¼Œå‡å°‘äº†ä½ç½®åˆ·æ–°æ¬¡æ•°ï¼Œæé«˜æ€§èƒ½ï¼›å¢åŠ äº†alignmentå±æ€§ï¼Œå¯ä»¥é å·¦ä¸­å³æ’åˆ—&lt;/li&gt;
&lt;li&gt;2016-10-29: å¢åŠ Tagçš„é˜´å½±å’ŒContentInsetçš„è®¾ç½®ï¼Œæ›´æ–°äº†Demo&lt;/li&gt;
&lt;li&gt;2016-10-17: å¢åŠ äº†æ°´å¹³æ»‘åŠ¨ï¼›Autolayouté€‚é…ï¼›UITableViewCellä¾‹å­ç­‰&lt;/li&gt;
&lt;li&gt;2016-02-18: ä¿®å¤äº†è¶…é•¿æ ‡ç­¾å¯¼è‡´æ’ç‰ˆé”™è¯¯çš„Bug&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è¿™æ®µæ—¶é—´åšé¡¹ç›®çš„æ—¶å€™ï¼Œæ€»æ˜¯éœ€è¦æ˜¾ç¤ºä¸€äº›â€œæ ‡ç­¾â€æ ·å¼çš„å†…å®¹ï¼Œä½†æ˜¯åˆæ‰¾ä¸åˆ°ç”¨çš„é¡ºæ‰‹çš„åº“ï¼Œæ‰€ä»¥ç¢ç£¨äº†å‡ å¤©ï¼Œè‡ªå·±å®ç°äº†å‡ºæ¥ï¼Œå°±æœ‰äº†è¿™ä¸ªåº“ï¼šTTGTagCollectionViewã€‚å¦‚æœåªéœ€è¦æ˜¾ç¤ºæ–‡å­—æ ‡ç­¾çš„è¯ï¼Œç›´æ¥ä½¿ç”¨&lt;code&gt;TTGTextTagCollectionView&lt;/code&gt;ï¼Œéœ€è¦è‡ªå·±å®šä¹‰æ ‡ç­¾çš„è¯ï¼Œå°±ç”¨&lt;code&gt;TTGTagCollectionView&lt;/code&gt;ï¼Œæ•ˆæœå¦‚ä¸‹:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7nj2iz.com1.z0.glb.clouddn.com/TTGTagCollectionView_screenshot.png&quot; alt=&quot;ScreenShot&quot;&gt;&lt;/p&gt;
&lt;p&gt;æ”¯æŒäº”ç§å¸ƒå±€æ’ç‰ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://zorrochen.qiniudn.com/TTGTagCollectionView_alignment_type_1.png&quot; alt=&quot;Alignment&quot;&gt;&lt;/p&gt;
&lt;p&gt;CocoaPods: &lt;code&gt;pod &amp;quot;TTGTagCollectionView&amp;quot;&lt;/code&gt;&lt;br&gt;Carthage: &lt;code&gt;github &amp;quot;zekunyan/TTGTagCollectionView&amp;quot;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Githubåœ°å€: &lt;a href=&quot;https://github.com/zekunyan/TTGTagCollectionView&quot;&gt;https://github.com/zekunyan/TTGTagCollectionView&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="å¼€æº" scheme="http://tutuge.me/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰è¶£çš„Autolayoutç¤ºä¾‹3-Masonryå®ç°</title>
    <link href="http://tutuge.me/2015/12/14/autolayout-example-with-masonry3/"/>
    <id>http://tutuge.me/2015/12/14/autolayout-example-with-masonry3/</id>
    <published>2015-12-14T13:36:08.000Z</published>
    <updated>2016-08-09T16:49:51.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><ul>
<li>2016-06-02: æ„Ÿè°¢<a href="http://weibo.com/u/2953626141" target="_blank" rel="external">æˆ‘ä¸æ˜¯èœ¡ç¬”å°æ–°ä½†æ˜¯æˆ‘æœ‰å°ç™½</a>ï¼Œå‘ç°äº†Case 2çš„æœ€åä¸¤ä¸ªcellå±•å¼€åŠ¨ç”»é—®é¢˜ï¼ŒåŸæ¥æ˜¯tableViewçš„<code>estimatedRowHeight</code>ä¼šè·Ÿå±•å¼€åŠ¨ç”»å†²çªçš„ç¼˜æ•…ã€‚  </li>
<li>2015-12-23: æ„Ÿè°¢<a href="https://github.com/XVXVXXX" target="_blank" rel="external">XVXVXXX</a>çš„PR,Case 1ä¸å†éœ€è¦Fake Header Viewï¼Œç›´æ¥ç”¨contentInsetå°±å¥½~  </li>
<li>2015-12-17ï¼šCase3çš„ç­‰é—´è·ï¼Œç”¨UIStackViewå®ç°æœ€ä¼˜é›…ï¼Œä½†æ˜¯æ— å¥ˆåªæœ‰iOS9ä»¥ä¸Šæ”¯æŒã€‚å…¼å®¹æ–¹æ¡ˆå¦‚OAStackViewä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯åœ¨UITableViewCellé‡Œé¢ç”¨ï¼Œæˆ–è€…éœ€è¦é¢‘ç¹çš„å¢å‡å†…éƒ¨Viewçš„æ•°é‡æ—¶ï¼Œæ€§èƒ½æŸè€—æœ‰ç‚¹å‰å®³ï¼Œä¼šå¡ã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯è¦çœ‹éœ€æ±‚=ã€‚=</li>
</ul>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¬¬ä¸‰ç¯‡æ¥äº†ã€‚<br>ä¾ç„¶æ˜¯3ä¸ªå°ä¾‹å­ï¼Œä¸»è¦éƒ¨åˆ†ç”¨Masonryæ‰‹å†™ä»£ç å®ç°ï¼Œå…¶å®ƒçš„çº¦æŸåœ¨storyboardé‡Œé¢ç›´æ¥æ‹–æ‹½æ­å»ºã€‚<br>è‡³äºä¸ºå•¥ä¸ç”¨VFLï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„â€œæè¿°æ€§â€çš„å†™æ³•å¾ˆå®¹æ˜“å‡ºé”™ï¼Œæ²¡æœ‰è¡¥å…¨ã€ä¸å¥½è°ƒè¯•ï¼Œå†™èµ·æ¥æ²¡æœ‰â€œä»£ç â€çš„æ„Ÿè§‰=ã€‚=ã€‚å½“ç„¶ï¼Œè¿™ä¸ªä»è€…è§ä»æ™ºè€…è§æ™º~<br>ä¸‰ä¸ªä¾‹å­åˆ†åˆ«æ˜¯ï¼š<strong>Parallax Header</strong>ï¼Œ<strong>åŠ¨æ€å˜é«˜åº¦çš„UITableViewCell</strong>ï¼Œä»¥åŠ<strong>ä¸¤ç§æ–¹å¼å®ç°ç­‰é—´è·</strong>ã€‚åŸç†å…¶å®éƒ½å¾ˆç®€å•ï¼Œä¾‹å­ä¹Ÿéƒ½æ˜¯å¹³æ—¶ç§¯ç´¯èµ·æ¥çš„ã€‚</p>
<p>å‰ä¸¤ç¯‡ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç¯‡ï¼š<a href="http://tutuge.me/2015/05/23/autolayout-example-with-masonry/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹-Masonryå®ç°</a></li>
<li>ç¬¬äºŒç¯‡ï¼š<a href="http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°</a></li>
<li>ç¬¬å››ç¯‡ï¼š<a href="http://tutuge.me/2016/08/06/autolayout-example-with-masonry4/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹4-Masonryå®ç°</a></li>
</ul>
<p>Githubåœ°å€ï¼š<br><a href="https://github.com/zekunyan/AutolayoutExampleWithMasonry" target="_blank" rel="external">https://github.com/zekunyan/AutolayoutExampleWithMasonry</a></p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry3_1.gif" alt="Gifç¤ºä¾‹"></p>
<a id="more"></a>
<h2 id="Case-1-Parallax-Header"><a href="#Case-1-Parallax-Header" class="headerlink" title="Case 1: Parallax Header"></a>Case 1: Parallax Header</h2><p>Parallaxç¿»è¯‘è¿‡æ¥å°±æ˜¯â€œè§†å·®â€ï¼Œæˆ‘ä¸ªäººè§‰å¾—å°±æ˜¯ä¸€ç§â€œè”åŠ¨â€çš„æ•ˆæœï¼Œåœ¨è®¸å¤šåº”ç”¨é‡Œé¢éƒ½èƒ½è§åˆ°ã€‚å½“å‰è¿™ä¸ªä¾‹å­ï¼Œå°±æ˜¯æœ€ç®€å•çš„ä¸€ç§ã€‚</p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åŸç†å…¶å®å°±æ˜¯æ ¹æ®UITableViewå½“å‰ä¸‹æ‹‰çš„ä½ç§»å€¼ï¼ŒåŒæ­¥æ”¹å˜Parallax Headerçš„é«˜åº¦ï¼Œå³<code>NSLayoutConstraint</code>çš„<code>constant</code>å±æ€§ï¼Œå¯¹åº”åˆ°Masonryé‡Œé¢å°±æ˜¯é‡æ–°è®©çº¦æŸ<code>equalTo()</code>ä¸€æ¬¡ã€‚</p>
<h3 id="ä¸»è¦æ­¥éª¤"><a href="#ä¸»è¦æ­¥éª¤" class="headerlink" title="ä¸»è¦æ­¥éª¤"></a>ä¸»è¦æ­¥éª¤</h3><p>ä¸»è¦çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>è®¾ç½®UITableViewèƒŒæ™¯é€æ˜ã€‚</li>
<li>åœ¨UITableViewæ­£ä¸‹æ–¹æ”¾ç½®ä¸€ä¸ªUIImageViewï¼Œä½œä¸ºæˆ‘ä»¬çš„Parallax Headerï¼Œè®¾ç½®<code>contentMode</code>ä¸º<code>UIViewContentModeScaleAspectFill</code>ï¼Œå¹¶åŠ ä¸Š<strong>ä¸Šå·¦å³</strong>çš„å›ºå®šçº¦æŸï¼Œä½¿å…¶ä¸UITableViewå¯¹å…¶ï¼Œç„¶ååŠ ä¸Šä¸€ä¸ªå›ºå®šé«˜åº¦çš„çº¦æŸï¼Œå¹¶åœ¨ä»£ç é‡Œé¢ä¿å­˜ã€‚</li>
<li>è®¾ç½®UITableViewçš„<code>contentInset</code>è·ŸParallax Headerç­‰é«˜ï¼Œä½¿UITableViewçš„å¤´éƒ¨â€œæ’‘å¼€â€ï¼Œè®©åé¢çš„Parallax Headeréœ²å‡ºæ¥ã€‚</li>
<li>åœ¨ä»£ç é‡Œé¢ç›‘å¬UITableViewçš„<code>contentOffset</code>å±æ€§ï¼Œå½“yå°äº0æ—¶ï¼Œå¢åŠ Parallax Headeré«˜åº¦ï¼Œä½¿å…¶äº§ç”Ÿè”åŠ¨æ•ˆæœã€‚</li>
</ol>
<p>çº¦æŸç¤ºæ„å›¾å¦‚ä¸‹ï¼š<br><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry3_6.png" alt="Parallax Header"></p>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>åˆ›å»ºParallax Headerçš„ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="variable">_parallaxHeaderView</span> = [UIImageView new];</div><div class="line"><span class="comment">// æŠŠParallax Headeræ”¾åœ¨UITableViewçš„ä¸‹é¢</span></div><div class="line">[self.view insertSubview:<span class="variable">_parallaxHeaderView</span> belowSubview:<span class="variable">_tableView</span>];</div><div class="line"></div><div class="line"><span class="comment">// è®¾ç½®contentMode</span></div><div class="line"><span class="variable">_parallaxHeaderView</span>.contentMode = UIViewContentModeScaleAspectFill;</div><div class="line"><span class="variable">_parallaxHeaderView</span>.<span class="built_in">image</span> = [UIImage imageNamed:@<span class="string">"parallax_header_back"</span>];</div><div class="line"></div><div class="line"><span class="comment">// æ·»åŠ çº¦æŸ</span></div><div class="line">[<span class="variable">_parallaxHeaderView</span> mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.left.<span class="built_in">and</span>.right.equalTo(self.view);</div><div class="line">    make.top.equalTo(self.mas_topLayoutGuideBottom);</div><div class="line">    <span class="comment">// ä¿å­˜é«˜åº¦çº¦æŸ</span></div><div class="line">    <span class="variable">_parallaxHeaderHeightConstraint</span> = make.height.equalTo(@(ParallaxHeaderHeight));</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>è®¾ç½®UITableViewçš„<code>contentInset</code></p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">_tableView.contentInset = UIEdgeInsetsMake(ParallaxHeaderHeight, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<h3 id="ç›‘å¬contentOffsetå±æ€§çš„ä¸¤ç§æ–¹æ³•"><a href="#ç›‘å¬contentOffsetå±æ€§çš„ä¸¤ç§æ–¹æ³•" class="headerlink" title="ç›‘å¬contentOffsetå±æ€§çš„ä¸¤ç§æ–¹æ³•"></a>ç›‘å¬<code>contentOffset</code>å±æ€§çš„ä¸¤ç§æ–¹æ³•</h3><h4 id="æ–¹æ³•1ï¼šç›´æ¥å®ç°scrollViewDidScroll"><a href="#æ–¹æ³•1ï¼šç›´æ¥å®ç°scrollViewDidScroll" class="headerlink" title="æ–¹æ³•1ï¼šç›´æ¥å®ç°scrollViewDidScroll:"></a>æ–¹æ³•1ï¼šç›´æ¥å®ç°<code>scrollViewDidScroll:</code></h4><p>è¿™ç§æ–¹æ³•åº”è¯¥æ˜¯æœ€ç›´æ¥çš„ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">scrollViewDidScroll</span><span class="selector-pseudo">:(UIScrollView</span> *)<span class="selector-tag">scrollView</span> &#123;</div><div class="line">    <span class="selector-tag">if</span> (scrollView.contentOffset.y &lt; <span class="number">0</span>) &#123;</div><div class="line">        <span class="comment">// å¢åŠ Parallax Headerå¯¹åº”çš„é«˜åº¦ï¼Œyæ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥å‡å»</span></div><div class="line">        <span class="selector-tag">_parallaxHeaderHeightConstraint</span><span class="selector-class">.equalTo</span>(@(ParallaxHeaderHeight - scrollView.contentOffset.y));</div><div class="line">    &#125; <span class="selector-tag">else</span> &#123;</div><div class="line">        <span class="selector-tag">_parallaxHeaderHeightConstraint</span><span class="selector-class">.equalTo</span>(@(ParallaxHeaderHeight));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="æ–¹æ³•2ï¼šKVOç›‘å¬contentOffsetå˜åŒ–"><a href="#æ–¹æ³•2ï¼šKVOç›‘å¬contentOffsetå˜åŒ–" class="headerlink" title="æ–¹æ³•2ï¼šKVOç›‘å¬contentOffsetå˜åŒ–"></a>æ–¹æ³•2ï¼šKVOç›‘å¬<code>contentOffset</code>å˜åŒ–</h4><p>ç”¨KVOçš„å¥½å¤„å°±æ˜¯ä¸ç”¨è¦æ±‚å½“å‰ç±»å®ç°UITableViewçš„delegateï¼Œå¯¹äºä»£ç çš„æ‹†åˆ†æœ‰å¥½å¤„ã€‚</p>
<p>å¢åŠ KVOï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[_tableView <span class="string">addObserver:</span>self <span class="string">forKeyPath:</span>@<span class="string">"contentOffset"</span> <span class="string">options:</span>NSKeyValueObservingOptionNew <span class="string">context:</span>nil];</div></pre></td></tr></table></figure>
<p>å®ç°ç›‘å¬:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)observeValueForKeyPath:(<span class="built_in">NSString</span> *)keyPath ofObject:(<span class="keyword">id</span>)object change:(<span class="built_in">NSDictionary</span>&lt;<span class="built_in">NSString</span> *,<span class="keyword">id</span>&gt; *)change context:(<span class="keyword">void</span> *)context &#123;</div><div class="line">    <span class="keyword">if</span> ([keyPath isEqualToString:<span class="string">@"contentOffset"</span>]) &#123;</div><div class="line">        <span class="comment">// å–å‡ºcontentOffsetå€¼</span></div><div class="line">        <span class="built_in">CGPoint</span> contentOffset = ((<span class="built_in">NSValue</span> *)change[<span class="built_in">NSKeyValueChangeNewKey</span>]).CGPointValue;</div><div class="line"></div><div class="line">        <span class="comment">// æ”¹å˜é«˜åº¦</span></div><div class="line">        <span class="keyword">if</span> (contentOffset.y &lt; <span class="number">0</span>) &#123;</div><div class="line">            _parallaxHeaderHeightConstraint.equalTo(@(ParallaxHeaderHeight - contentOffset.y));</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            _parallaxHeaderHeightConstraint.equalTo(@(ParallaxHeaderHeight));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ€ååˆ«å¿˜äº†å–æ¶ˆKVO:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)dealloc &#123;</div><div class="line">    [_tableView <span class="string">removeObserver:</span>self <span class="string">forKeyPath:</span>@<span class="string">"contentOffset"</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å°èŠ‚"><a href="#å°èŠ‚" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h3><p><code>NSLayoutConstraint</code>çš„<code>constant</code>å±æ€§éå¸¸æœ‰ç”¨ï¼Œæ—¢å¯ä»¥åšåŠ¨ç”»ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿çš„è°ƒæ•´ç°æœ‰å¸ƒå±€ï¼Œå¤§å®¶å¤šå¤šæŒ–æ˜å“ˆ~</p>
<h2 id="Case-2-åŠ¨æ€å˜é«˜åº¦çš„UITableViewCell"><a href="#Case-2-åŠ¨æ€å˜é«˜åº¦çš„UITableViewCell" class="headerlink" title="Case 2: åŠ¨æ€å˜é«˜åº¦çš„UITableViewCell"></a>Case 2: åŠ¨æ€å˜é«˜åº¦çš„UITableViewCell</h2><p>å—¯ï¼Œåˆæ˜¯UITableViewCell=ã€‚=<br>åªä¸è¿‡è¿™æ¬¡çš„æ˜¯â€œåŠ¨æ€æ”¹å˜é«˜åº¦â€ï¼Œå°±æ˜¯ç±»ä¼¼äºå¾®ä¿¡æœ‹å‹åœˆé‡Œé¢çš„â€œå…¨æ–‡â€é‚£ç§æ•ˆæœã€‚</p>
<p>å•çº¯çš„ä¸å®šé«˜UITableViewCellä¸æ˜¯æœ¬ä¾‹å­çš„é‡ç‚¹ï¼Œè¯¦ç»†è¯·çœ‹<a href="http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°</a>é‡Œé¢çš„Case1ã€‚</p>
<p>å…ˆè¯´ä¸€ç‚¹æˆ‘è§‰å¾—åœ¨ä»£ç è®¾è®¡ä¸Šæ¯”è¾ƒé‡è¦çš„åœ°æ–¹ï¼š<strong>Cellåªè´Ÿè´£æ˜¾ç¤ºå†…å®¹ï¼Œä¸åº”è¯¥ä¿å­˜å…·ä½“çš„çŠ¶æ€ä¿¡æ¯</strong>ã€‚  </p>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒUITableViewCellæ˜¯ä¼šè¢«é‡ç”¨çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸èƒ½ä¿è¯UITableViewé‡Œé¢çš„å“ªä¸€è¡Œä¸€å®šç”±å“ªä¸€ä¸ªUITableViewCellå®ä¾‹å±•ç¤ºã€‚<br>åŠ¨æ€å±•å¼€ã€æ”¶å›Cellçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªBOOLå˜é‡ï¼Œç”¨äºä¿å­˜å½“å‰Cellçš„å±•å¼€ã€æ”¶å›çš„çŠ¶æ€ã€‚è¿™ä¸ªBOOLå˜é‡å°±æ˜¯æ‰€è°“çš„â€œ<strong>çŠ¶æ€</strong>â€ï¼Œè¿™ä¸ªçŠ¶æ€åº”è¯¥ä¿å­˜åœ¨å½“å‰Cellçš„æ•°æ®é‡Œé¢ï¼Œå¦‚Entityã€ViewModelé‡Œé¢ã€‚å¯¹Cellå¡«å……æ•°æ®çš„æ—¶å€™ï¼Œå†æ ¹æ®è¿™ä¸ªâ€œçŠ¶æ€â€ï¼Œä¿®æ”¹å¯¹åº”çš„çº¦æŸã€‚</p>
<h3 id="ä¸»è¦æ­¥éª¤-1"><a href="#ä¸»è¦æ­¥éª¤-1" class="headerlink" title="ä¸»è¦æ­¥éª¤"></a>ä¸»è¦æ­¥éª¤</h3><p>å…ˆçœ‹çœ‹å¤§è‡´çš„æ­¥éª¤ï¼š</p>
<ol>
<li>é€šè¿‡ç‚¹å‡»çš„Cellæ‰¾åˆ°å¯¹åº”çš„æ•°æ®Entityã€‚</li>
<li>æ”¹å˜è¿™ä¸€è¡Œæ•°æ®Entityç”¨äºä¿å­˜çŠ¶æ€çš„BOOLå˜é‡çš„å€¼ã€‚</li>
<li>è®©UITableViewåˆ·æ–°è¿™ä¸€è¡Œã€‚</li>
<li>åˆ·æ–°çš„æ—¶å€™ï¼ŒCellæ ¹æ®è¿™ä¸ªBOOLå˜é‡é‡æ–°è°ƒæ•´çº¦æŸã€å¡«å……æ•°æ®ï¼Œå¾—åˆ°æ–°çš„é«˜åº¦ã€‚</li>
<li>æœ€åå°±æ˜¯Cellçš„é«˜åº¦å˜åŒ–ã€‚ï¼ˆæ­¤æ—¶çš„è¿™ä¸€è¡Œçš„Cellå®ä¾‹å¹¶ä¸ä¸€å®šæ˜¯ä¹‹å‰çš„é‚£ä¸ªå®ä¾‹ï¼‰</li>
</ol>
<h3 id="å¸ƒå±€"><a href="#å¸ƒå±€" class="headerlink" title="å¸ƒå±€"></a>å¸ƒå±€</h3><p>ä¸ºäº†å°½é‡ç®€å•ï¼Œä¾‹å­é‡Œé¢çš„Cellåªæœ‰ä¸‰ä¸ªå­æ§ä»¶ï¼Œç¬¬ä¸€ä¸ªUILabelæ˜¯æ ‡é¢˜ç­‰è°ƒè¯•ä¿¡æ¯ï¼Œç¬¬äºŒä¸ªUILabelç”¨æ¥æ˜¾ç¤ºå¤šè¡Œæ–‡æœ¬ï¼Œæœ€åä¸€ä¸ªUIButtonç”¨æ¥åˆ‡æ¢å±•å¼€ã€æ”¶å›çš„çŠ¶æ€ã€‚å¤§è‡´çš„å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry3_3.png" alt="Case2 UITableViewCellå¸ƒå±€ç¤ºæ„"></p>
<h4 id="å¸ƒå±€çš„ä»£ç "><a href="#å¸ƒå±€çš„ä»£ç " class="headerlink" title="å¸ƒå±€çš„ä»£ç "></a>å¸ƒå±€çš„ä»£ç </h4><p><strong>æ ‡é¢˜UIlabel</strong></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="attr">_titleLabel</span> = [UILabel new];</div><div class="line"><span class="section">[self.contentView addSubview:_titleLabel]</span><span class="comment">;</span></div><div class="line"><span class="section"></span></div><div class="line">[_titleLabel mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.height.equalTo(@21);</div><div class="line">    make.left.and.right.and.top.equalTo(self.contentView).with.insets(UIEdgeInsetsMake(4, 8, 4, 8));</div><div class="line">&#125;]<span class="comment">;</span></div></pre></td></tr></table></figure>
<p><strong>åº•éƒ¨â€œMoreâ€æŒ‰é’®</strong></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">_moreButton = [UIButton <span class="string">buttonWithType:</span>UIButtonTypeSystem];</div><div class="line">[_moreButton <span class="string">setTitle:</span>@<span class="string">"More"</span> <span class="string">forState:</span>UIControlStateNormal];</div><div class="line">[_moreButton <span class="string">addTarget:</span>self <span class="string">action:</span><span class="meta">@selector</span>(<span class="string">switchExpandedState:</span>) <span class="string">forControlEvents:</span>UIControlEventTouchUpInside];</div><div class="line">[self.contentView <span class="string">addSubview:</span>_moreButton];</div><div class="line"></div><div class="line">[_moreButton <span class="string">mas_makeConstraints:</span>^(MASConstraintMaker *make) &#123;</div><div class="line">    make.height.equalTo(@<span class="number">32</span>);</div><div class="line">    make.left.and.right.and.bottom.equalTo(self.contentView);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p><strong>æ­£æ–‡UIlabel</strong></p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">CGFloat preferredMaxWidth = [UIScreen mainScreen].bounds.<span class="built_in">size</span>.width - <span class="number">16</span>;</div><div class="line"></div><div class="line"><span class="comment">// Content - å¤šè¡Œ</span></div><div class="line"><span class="variable">_contentLabel</span> = [UILabel new];</div><div class="line"><span class="variable">_contentLabel</span>.numberOfLines = <span class="number">0</span>;</div><div class="line"><span class="variable">_contentLabel</span>.lineBreakMode = NSLineBreakByCharWrapping;</div><div class="line"><span class="variable">_contentLabel</span>.clipsToBounds = YES;</div><div class="line"><span class="variable">_contentLabel</span>.preferredMaxLayoutWidth = preferredMaxWidth; <span class="comment">// å¤šè¡Œæ—¶å¿…é¡»è®¾ç½®</span></div><div class="line">[self.contentView addSubview:<span class="variable">_contentLabel</span>];</div><div class="line"></div><div class="line">[<span class="variable">_contentLabel</span> mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.left.<span class="built_in">and</span>.right.equalTo(self.contentView).<span class="keyword">with</span>.insets(UIEdgeInsetsMake(<span class="number">4</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">8</span>));</div><div class="line">    make.top.equalTo(<span class="variable">_titleLabel</span>.mas_bottom).<span class="keyword">with</span>.offset(<span class="number">4</span>);</div><div class="line">    make.bottom.equalTo(<span class="variable">_moreButton</span>.mas_top).<span class="keyword">with</span>.offset(-<span class="number">4</span>);</div><div class="line">    <span class="comment">// å…ˆåŠ ä¸Šé«˜åº¦çš„é™åˆ¶</span></div><div class="line">    <span class="variable">_contentHeightConstraint</span> = make.height.equalTo(@<span class="number">64</span>).<span class="keyword">with</span>.priorityHigh(); <span class="comment">// ä¼˜å…ˆçº§åªè®¾ç½®æˆHigh,æ¯”æ­£å¸¸çš„é«˜åº¦çº¦æŸä½ä¸€äº›,é˜²æ­¢å†²çª</span></div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h4 id="ä¸ºä»€ä¹ˆè¦åŠ æ­£æ–‡UIlabelé«˜åº¦çº¦æŸ"><a href="#ä¸ºä»€ä¹ˆè¦åŠ æ­£æ–‡UIlabelé«˜åº¦çº¦æŸ" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åŠ æ­£æ–‡UIlabelé«˜åº¦çº¦æŸ"></a>ä¸ºä»€ä¹ˆè¦åŠ æ­£æ–‡UIlabelé«˜åº¦çº¦æŸ</h4><p><a href="http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°</a>é‡Œé¢çš„Case1ä¹Ÿè®²è¿‡ï¼Œè·å–Cellçš„é«˜åº¦çš„æ–¹æ³•æ˜¯<code>systemLayoutSizeFittingSize:</code>ï¼Œå¦‚æœä¸å¯¹æ­£æ–‡UILabelåŠ ä¸Šé«˜åº¦çº¦æŸï¼Œè·å–çš„é«˜åº¦å°±æ˜¯æ ¹æ®æ­£æ–‡çš„å†…å®¹è®¡ç®—å‡ºæ¥çš„ï¼Œè¿™ä¸ä¹‹å‰çš„ä¾‹å­é‡Œé¢ä¸€è‡´ã€‚</p>
<p>ä¸ºäº†ä½¿é«˜åº¦å›ºå®šï¼Œå°±éœ€è¦åŠ ä¸Šä¸€ä¸ªé«˜åº¦çº¦æŸï¼Œä½¿å¾—<code>systemLayoutSizeFittingSize:</code>è®¡ç®—æ—¶æŒ‰ç…§è¿™ä¸ªçº¦æŸå»è®¡ç®—ã€‚</p>
<h4 id="ä¸ºä»€ä¹ˆæ­£æ–‡UILabelçš„é«˜åº¦çº¦æŸçš„ä¼˜å…ˆçº§è¦è°ƒæ•´ä¸ºHigh"><a href="#ä¸ºä»€ä¹ˆæ­£æ–‡UILabelçš„é«˜åº¦çº¦æŸçš„ä¼˜å…ˆçº§è¦è°ƒæ•´ä¸ºHigh" class="headerlink" title="ä¸ºä»€ä¹ˆæ­£æ–‡UILabelçš„é«˜åº¦çº¦æŸçš„ä¼˜å…ˆçº§è¦è°ƒæ•´ä¸ºHigh"></a>ä¸ºä»€ä¹ˆæ­£æ–‡UILabelçš„é«˜åº¦çº¦æŸçš„ä¼˜å…ˆçº§è¦è°ƒæ•´ä¸º<code>High</code></h4><p>åœ¨UITableViewåˆ·æ–°æ—¶ï¼Œä¼šå…ˆè®¡ç®—é«˜åº¦ï¼Œå³å…ˆè°ƒç”¨<code>tableView: heightForRowAtIndexPath:</code>æ–¹æ³•ï¼Œå¦‚æœé«˜åº¦çº¦æŸä¸ºé»˜è®¤çš„1000æœ€é«˜çš„è¯ï¼Œä¼šäº§ç”Ÿå†²çªã€‚</p>
<p>å› ä¸ºåœ¨è®¡ç®—çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„é«˜åº¦æ˜¯ç”±ä¸€ä¸ªâ€œtemplate cellâ€å¡«å……å†…å®¹åè®¡ç®—å¾—æ¥ï¼Œè¿™ä¸ªæ—¶å€™çš„é«˜åº¦å·²ç»æ˜¯å±•å¼€ä»¥åçš„é«˜åº¦ï¼Œå½“å‰çš„Cellè¿˜æ¥ä¸åŠè°ƒæ•´çº¦æŸï¼ˆç”šè‡³ä¸ä¼šè°ƒæ•´ï¼Œå¦‚æœåªç”¨<code>beginUpdateså’ŒendUpdates</code>æ›´æ–°çš„è¯ï¼ŒCellä¸ä¼šreloadï¼‰ï¼Œæ‰€ä»¥é™ä½è¿™ä¸ªé«˜åº¦çº¦æŸçš„ä¼˜å…ˆçº§ï¼Œå»æ‰å†²çªã€‚</p>
<h3 id="ä½¿ç”¨installå’Œuninstallæ§åˆ¶çº¦æŸ"><a href="#ä½¿ç”¨installå’Œuninstallæ§åˆ¶çº¦æŸ" class="headerlink" title="ä½¿ç”¨installå’Œuninstallæ§åˆ¶çº¦æŸ"></a>ä½¿ç”¨installå’Œuninstallæ§åˆ¶çº¦æŸ</h3><p>ä¸ºäº†èƒ½å¾—æ­£ç¡®é«˜åº¦ï¼ŒCelléœ€è¦æ ¹æ®å…·ä½“çš„æ•°æ®ã€çŠ¶æ€æ›´æ–°çº¦æŸã€‚<br>è¿™é‡Œå¯ä»¥ä½¿ç”¨<code>install</code>å’Œ<code>uninstall</code>æ¥æ§åˆ¶æ­£æ–‡UILabelé«˜åº¦çº¦æŸæ˜¯å¦ç”Ÿæ•ˆã€‚åœ¨å¡«å……Cellçš„æ•°æ®æ—¶ï¼Œå°±å¯ä»¥æ ¹æ®çŠ¶æ€BOOLå€¼æ¥é€‰æ‹©è°ƒç”¨ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">setEntity</span><span class="selector-pseudo">:(Case8DataEntity</span> *)<span class="selector-tag">entity</span> <span class="selector-tag">indexPath</span><span class="selector-pseudo">:(NSIndexPath</span> *)<span class="selector-tag">indexPath</span> &#123;</div><div class="line">    <span class="comment">// è®¾ç½®æ•°æ®...</span></div><div class="line"></div><div class="line">    <span class="comment">// æ”¹å˜çº¦æŸ</span></div><div class="line">    <span class="selector-tag">if</span> (_entity.expanded) &#123;</div><div class="line">        <span class="selector-attr">[_contentHeightConstraint uninstall]</span>;</div><div class="line">    &#125; <span class="selector-tag">else</span> &#123;</div><div class="line">        <span class="selector-attr">[_contentHeightConstraint install]</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºDelegateï¼Œä½¿å¾—Cellçš„äº‹ä»¶å¾—ä»¥å›ä¼ åˆ°ViewController"><a href="#åˆ›å»ºDelegateï¼Œä½¿å¾—Cellçš„äº‹ä»¶å¾—ä»¥å›ä¼ åˆ°ViewController" class="headerlink" title="åˆ›å»ºDelegateï¼Œä½¿å¾—Cellçš„äº‹ä»¶å¾—ä»¥å›ä¼ åˆ°ViewController"></a>åˆ›å»ºDelegateï¼Œä½¿å¾—Cellçš„äº‹ä»¶å¾—ä»¥å›ä¼ åˆ°ViewController</h3><p>åœ¨ç‚¹å‡»Cellçš„â€œMoreâ€æŒ‰é’®æ—¶ï¼Œéœ€è¦æ”¹å˜å½“å‰çš„å±•å¼€æ”¶å›çŠ¶æ€BOOLå€¼ï¼Œè¿˜éœ€è¦è®©UITableViewåˆ·æ–°ã€‚<br>ç›´æ¥åœ¨Cellé‡Œé¢ä¿®æ”¹Entityæ•°æ®ï¼Œæˆ–è€…æŒæœ‰UITableViewå®ä¾‹éƒ½æ˜¯ä¸æ°å½“çš„ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨Delegateæ¨¡å¼å®ç°ã€‚</p>
<p>Delegateå¦‚ä¸‹ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@protocol</span> Case8CellDelegate &lt;NSObject&gt;</div><div class="line">- (<span class="keyword">void</span>)<span class="string">case8Cell:</span>(Case8Cell *)cell <span class="string">switchExpandedStateWithIndexPath:</span>(NSIndexPath *)index;</div><div class="line"><span class="meta">@end</span></div></pre></td></tr></table></figure>
<p>ç„¶åViewControllerå®ç°è¿™ä¸ªProtocol</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)<span class="keyword">case</span><span class="number">8</span>Cell:(Case<span class="number">8</span>Cell *)cell switchExpandedStateWithIndexPath:(NSIndexPath *)index &#123;</div><div class="line">    <span class="comment">// å–å‡ºå¯¹åº”æ•°æ®</span></div><div class="line">    Case<span class="number">8</span>DataEntity *<span class="keyword">case</span><span class="number">8</span>DataEntity = <span class="number">_</span>data[(NSUInteger) index.row];</div><div class="line">    <span class="comment">// ä¿®æ”¹çŠ¶æ€</span></div><div class="line">    <span class="keyword">case</span><span class="number">8</span>DataEntity.expanded = !<span class="keyword">case</span><span class="number">8</span>DataEntity.expanded; <span class="comment">// åˆ‡æ¢å±•å¼€è¿˜æ˜¯æ”¶å›</span></div><div class="line">    <span class="keyword">case</span><span class="number">8</span>DataEntity.cellHeight = <span class="number">0</span>; <span class="comment">// é‡ç½®é«˜åº¦ç¼“å­˜</span></div><div class="line"></div><div class="line">    <span class="comment">// åˆ·æ–°UITableView</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Cellä¿å­˜ViewControllerè¿™ä¸ªdelegateï¼Œç„¶ååœ¨æŒ‰é’®ç‚¹å‡»æ—¶å›è°ƒ</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Cellbä¿å­˜delegateï¼Œæ³¨æ„weak</span></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">id</span> &lt;Case8CellDelegate&gt; delegate;</div><div class="line"></div><div class="line"><span class="comment">// Cellçš„â€œMoreâ€æŒ‰é’®ç‚¹å‡»</span></div><div class="line">- (<span class="keyword">void</span>)switchExpandedState:(<span class="built_in">UIButton</span> *)button &#123;</div><div class="line">    [_delegate case8Cell:<span class="keyword">self</span> switchExpandedStateWithIndexPath:_indexPath];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="åˆ·æ–°çš„æ–¹å¼"><a href="#åˆ·æ–°çš„æ–¹å¼" class="headerlink" title="åˆ·æ–°çš„æ–¹å¼"></a>åˆ·æ–°çš„æ–¹å¼</h3><p>UITableViewçš„åˆ·æ–°å¯ä»¥ç”¨ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š</p>
<h4 id="1-reloadData"><a href="#1-reloadData" class="headerlink" title="1. reloadData"></a>1. reloadData</h4><p>ç”¨<code>reloadData</code>åˆ·æ–°ï¼Œå…¶å®å°±æ˜¯æŠŠæ‰€æœ‰Celléƒ½åˆ·æ–°äº†ä¸€æ¬¡ï¼Œä»£ä»·æœ‰ç‚¹å¤§ï¼Œä¸æ¨èã€‚</p>
<h4 id="2-reloadRowsAtIndexPaths-withRowAnimation"><a href="#2-reloadRowsAtIndexPaths-withRowAnimation" class="headerlink" title="2. reloadRowsAtIndexPaths:withRowAnimation:"></a>2. reloadRowsAtIndexPaths:withRowAnimation:</h4><p>è¿™ä¸ªæ–¹æ³•çš„å¥½å¤„å°±æ˜¯å¯ä»¥æŒ‡å®šè¦åˆ·æ–°çš„å“ªå‡ è¡Œï¼Œè€Œä¸”å¯ä»¥æŒ‡å®šåˆ·æ–°æ—¶çš„åŠ¨ç”»å½¢å¼ï¼Œä¸€èˆ¬æ¥è¯´ç”¨<code>UITableViewRowAnimationFade</code>å°±ä¸é”™ã€‚<br>åˆ·æ–°çš„æ—¶å€™ï¼Œ<code>tableView:cellForRowAtIndexPath:</code>ä¼šè¢«è°ƒç”¨ï¼ŒåŸæ¥çš„Cellå®ä¾‹ä¼šè¢«æ›¿æ¢ã€‚</p>
<h4 id="3-beginUpdateså’ŒendUpdates"><a href="#3-beginUpdateså’ŒendUpdates" class="headerlink" title="3. beginUpdateså’ŒendUpdates"></a>3. beginUpdateså’ŒendUpdates</h4><p>è¿™ä¸¤ä¸ªæ–¹æ³•ä¸€èˆ¬éƒ½æ˜¯æˆå¯¹ä½¿ç”¨çš„ï¼Œåœ¨ä¸­é—´å¯ä»¥æ‰§è¡Œæ’å…¥ã€åˆ é™¤ç­‰è°ƒæ•´Cellçš„æ“ä½œï¼Œæ”¹å˜Cellçš„é«˜åº¦ä¹Ÿå¯ä»¥ç”¨å®ƒã€‚<br>ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•å¹¶ä¸ä¼šé‡æ–°åŠ è½½Cellï¼Œåªæ˜¯å•çº¯çš„æ”¹å˜äº†é«˜åº¦ï¼Œæ‰€ä»¥å¦‚æœCellåŸæ¥çš„çº¦æŸé‡Œé¢æœ‰é«˜åº¦çº¦æŸè¿™ç§ï¼Œè€Œåˆä¿æŒé»˜è®¤çš„ä¼˜å…ˆçº§ï¼Œå°±ä¼šäº§ç”Ÿçº¦æŸå†²çªã€‚</p>
<p>ä»æ•ˆæœä¸Šæ¥è®²ï¼Œæˆ‘ä¸ªäººè§‰å¾—ç”¨<code>reloadRowsAtIndexPaths:withRowAnimation:</code>ä¼šæ›´å¥½ä¸€äº›~</p>
<h3 id="å°èŠ‚-1"><a href="#å°èŠ‚-1" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h3><p>æƒ³ç”¨å¥½Autolayoutä¸å®¹æ˜“å•Šï¼Œè¦ä»”ç»†ç ”ç©¶UITableViewçš„æœºåˆ¶=ã€‚=</p>
<h2 id="Case-3-ä¸¤ç§æ–¹å¼å®ç°ç­‰é—´è·"><a href="#Case-3-ä¸¤ç§æ–¹å¼å®ç°ç­‰é—´è·" class="headerlink" title="Case 3: ä¸¤ç§æ–¹å¼å®ç°ç­‰é—´è·"></a>Case 3: ä¸¤ç§æ–¹å¼å®ç°ç­‰é—´è·</h2><p>ç­‰é—´è·ï¼Œä¹Ÿå°±æ˜¯Viewä¹‹é—´çš„Xæˆ–Yè½´ä¸Šçš„åæ ‡ç­‰å·®ï¼Œåœ¨è¿™é‡Œæˆ‘åªä¸¾å‡ºæ°´å¹³æ–¹å‘ä¸Šçš„ç­‰é—´è·ï¼Œå‚ç›´æ–¹å‘ä¸Šä¸€ä¸ªé“ç†ã€‚</p>
<h3 id="æ–¹æ³•1ï¼šåˆ©ç”¨é€æ˜ç­‰å®½çš„å ä½Viewå¡«å……ç©ºç™½å¤„ï¼Œå®ç°ç­‰é—´è·"><a href="#æ–¹æ³•1ï¼šåˆ©ç”¨é€æ˜ç­‰å®½çš„å ä½Viewå¡«å……ç©ºç™½å¤„ï¼Œå®ç°ç­‰é—´è·" class="headerlink" title="æ–¹æ³•1ï¼šåˆ©ç”¨é€æ˜ç­‰å®½çš„å ä½Viewå¡«å……ç©ºç™½å¤„ï¼Œå®ç°ç­‰é—´è·"></a>æ–¹æ³•1ï¼šåˆ©ç”¨é€æ˜ç­‰å®½çš„å ä½Viewå¡«å……ç©ºç™½å¤„ï¼Œå®ç°ç­‰é—´è·</h3><p>æ­¥éª¤å¾ˆç®€å•ï¼Œå°±æ˜¯å¾ªç¯åˆ›å»ºçœŸæ­£è¦å±•ç¤ºçš„Viewå’Œå ä½Viewï¼Œå¸ƒå±€å¦‚ä¸‹ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry3_4.png?refresh" alt="åˆ©ç”¨å ä½Viewå®ç°ç­‰é—´è·"></p>
<p>è¯´æ˜ä¸€ä¸‹ï¼š</p>
<ul>
<li>å ä½Viewçš„å®½åº¦ä¸èƒ½å®šæ­»ï¼Œè¿™æ ·å¤–éƒ¨çš„çˆ¶çº§Viewå®½åº¦å˜åŒ–æ—¶ï¼Œå†…éƒ¨çš„Viewä»ç„¶å¯ä»¥ä¿æŒç­‰é—´è·ã€‚</li>
<li>æ—¢ç„¶å ä½Viewå®½åº¦ä¸å®šï¼Œæ€»å¾—æœ‰ä¸ªå®½åº¦çš„å‚ç…§ï¼Œè¿™ä¸ªå‚ç…§å°±æ˜¯å…¶å®ƒçš„å ä½Viewï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦ç»™å ä½ViewåŠ ä¸Šä¸¤ä¸¤å®½åº¦ç›¸ç­‰çš„çº¦æŸã€‚</li>
</ul>
<p>ä»£ç å¦‚ä¸‹:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å…ˆåˆ›å»ºç¬¬ä¸€ä¸ªå ä½View</span></div><div class="line">UIView *lastSpaceView = [UIView <span class="built_in">new</span>];</div><div class="line">lastSpaceView.backgroundColor = [UIColor greenColor]; <span class="comment">// ç”¨ç»¿è‰²æ ‡å‡º</span></div><div class="line">[_containerView1 addSubview:lastSpaceView];</div><div class="line"></div><div class="line"><span class="comment">// æ·»åŠ ä¸Šå·¦ä¸‹ä¸‰ä¸ªçº¦æŸ</span></div><div class="line">[lastSpaceView mas_makeConstraints:^(MASConstraintMaker *<span class="built_in">make</span>) &#123;</div><div class="line">    <span class="built_in">make</span>.left.and.top.and.bottom.equalTo(_containerView1);</div><div class="line">&#125;];</div><div class="line"></div><div class="line"><span class="comment">// å¾ªç¯åˆ›å»º</span></div><div class="line"><span class="keyword">for</span> (NSUInteger i = <span class="number">0</span>; i &lt; ITEM_COUNT; i++) &#123;</div><div class="line">    <span class="comment">// åˆ›å»ºItemViewï¼Œå³çœŸæ­£æ˜¾ç¤ºå†…å®¹çš„View</span></div><div class="line">    UIView *itemView = [self getItemViewWithIndex:i];</div><div class="line">    [_containerView1 addSubview:itemView];</div><div class="line"></div><div class="line">    <span class="comment">// å›ºå®šå®½é«˜ï¼Œå·¦è¾¹ã€å‚ç›´æ–¹å‘ä¸­å¿ƒä¸ä¸Šä¸€ä¸ªå ä½Viewå¯¹é½ã€‚</span></div><div class="line">    [itemView mas_makeConstraints:^(MASConstraintMaker *<span class="built_in">make</span>) &#123;</div><div class="line">        <span class="built_in">make</span>.height.and.width.equalTo(@(ITEM_SIZE));</div><div class="line">        <span class="built_in">make</span>.left.equalTo(lastSpaceView.mas_right);</div><div class="line">        <span class="built_in">make</span>.centerY.equalTo(_containerView1.mas_centerY);</div><div class="line">    &#125;];</div><div class="line"></div><div class="line">    <span class="comment">// åˆ›å»ºä¸‹ä¸€ä¸ªå ä½View</span></div><div class="line">    UIView *spaceView = [UIView <span class="built_in">new</span>];</div><div class="line">    spaceView.backgroundColor = [UIColor greenColor];</div><div class="line">    [_containerView1 addSubview:spaceView];</div><div class="line"></div><div class="line">    <span class="comment">// å·¦è¾¹ä¸å½“å‰ItemViewå¯¹é½ï¼Œä¸Šä¸‹ä¸è¾¹ç•Œå¯¹é½ï¼Œå®½åº¦ä¸ä¸Šä¸€ä¸ªå ä½Viewç›¸ç­‰ï¼</span></div><div class="line">    <span class="comment">// ä½†æ˜¯å³è¾¹çš„çº¦æŸä¸èƒ½åŠ ï¼Œå› ä¸ºè¦ç•™ç»™ä¸‹ä¸€æ¬¡å¾ªç¯ä¸ä¸‹ä¸€ä¸ªItemViewçš„å·¦è¾¹ç•Œæ·»åŠ </span></div><div class="line">    [spaceView mas_makeConstraints:^(MASConstraintMaker *<span class="built_in">make</span>) &#123;</div><div class="line">        <span class="built_in">make</span>.left.equalTo(itemView.mas_right).with.priorityHigh(); <span class="comment">// é™ä½ä¼˜å…ˆçº§ï¼Œé˜²æ­¢å®½åº¦ä¸å¤Ÿå‡ºç°çº¦æŸå†²çª</span></div><div class="line">        <span class="built_in">make</span>.top.and.bottom.equalTo(_containerView1);</div><div class="line">        <span class="built_in">make</span>.width.equalTo(lastSpaceView.mas_width);</div><div class="line">    &#125;];</div><div class="line"></div><div class="line">    <span class="comment">// æ›´æ–°</span></div><div class="line">    lastSpaceView = spaceView;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ä¸ºæœ€åä¸€ä¸ªå ä½Viewæ·»åŠ å³è¾¹çº¦æŸ</span></div><div class="line">[lastSpaceView mas_makeConstraints:^(MASConstraintMaker *<span class="built_in">make</span>) &#123;</div><div class="line">    <span class="built_in">make</span>.right.equalTo(_containerView1.mas_right);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>åƒè¿™ç§é‡å¤æ·»åŠ Viewå’Œçº¦æŸï¼Œåˆç†ä½¿ç”¨å˜é‡ä¿å­˜â€œä¸Šä¸€æ¬¡å¾ªç¯â€åˆ›å»ºçš„å ä½Viewï¼Œå°±å¯ä»¥å¤§å¤§ç®€åŒ–ä»£ç ï¼Œè€Œä¸”å¯ä»¥ä»»æ„è°ƒæ•´æ•°é‡~</p>
<h3 id="æ–¹æ³•2ï¼šç›´æ¥æŒ‰æ¯”ä¾‹è®¾ç½®multiplier"><a href="#æ–¹æ³•2ï¼šç›´æ¥æŒ‰æ¯”ä¾‹è®¾ç½®multiplier" class="headerlink" title="æ–¹æ³•2ï¼šç›´æ¥æŒ‰æ¯”ä¾‹è®¾ç½®multiplier"></a>æ–¹æ³•2ï¼šç›´æ¥æŒ‰æ¯”ä¾‹è®¾ç½®multiplier</h3><p>ç­‰é—´è·ï¼Œå…¶å®å°±æ˜¯æŒ‰æ¯”ä¾‹ï¼Œå†è¿›ä¸€æ­¥å°±æ˜¯xåæ ‡æ˜¯æŒ‰æ¯”ä¾‹çš„ã€‚<br>å»¶ä¼¸åˆ°Viewä¸Šï¼Œå¯ä»¥ç†è§£ä¸ºcenterXçš„å€¼ä¸çˆ¶çº§Viewçš„å®½åº¦æŒ‰æ¯”ä¾‹å¢å‡ã€‚  </p>
<p>ä½†æ˜¯ï¼Œè¯»è€…å¯ä»¥å°è¯•ä¸€ä¸‹ï¼Œç›´æ¥è®¾ç½®ä¸€ä¸ªViewçš„è¾¹ç•Œã€ä½ç½®å±æ€§ï¼Œå¦‚centerXï¼Œç­‰äºå…¶çˆ¶çº§Viewçš„å®½åº¦æ˜¯ä¼šæŠ¥é”™çš„ã€‚</p>
<p>éš¾é“å°±æ²¡æœ‰åŠæ³•äº†ï¼Ÿå½“ç„¶ä¸æ˜¯ã€‚</p>
<p><strong>å§‹ç»ˆåœ¨åæ ‡ç³»ä¸Šè€ƒè™‘çº¦æŸ</strong></p>
<p>åœ¨ä¸Šä¸€ç¯‡<a href="http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°</a>çš„å¼€å¤´æˆ‘ä¹Ÿæåˆ°è¿‡ï¼ŒAutolayoutæœ€ç»ˆéƒ½æ˜¯ä½“ç°åœ¨åæ ‡ç³»ä¸Šï¼Œä¸€åˆ‡éƒ½ä¼šæŒ‰ç…§<code>viewA-attribute = viewB-attribute * multiplier + constant</code>è¿™ç§å…¬å¼å»è®¡ç®—ï¼Œæ—¢ç„¶centerXä¸èƒ½è·Ÿçˆ¶çº§çš„Widthå®½åº¦ä¸€èµ·åŠ çº¦æŸï¼Œé‚£å°±æ¢ä¸€ä¸ªï¼Œå¦‚çˆ¶çº§çš„<strong>å³è¾¹ç•Œ</strong>ï¼Œçˆ¶çº§Viewçš„<strong>å³è¾¹ç•Œ</strong>åœ¨çˆ¶çº§æœ¬èº«çš„å‚ç…§ç³»ä¸‹çš„Yåæ ‡å€¼ä¸å°±ç­‰äºå…¶å®½åº¦å—~</p>
<p>æ‰€ä»¥ï¼Œå¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼åŠ çº¦æŸï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry3_5.png" alt="æŒ‰æ¯”ä¾‹è®¾ç½®multiplierå®ç°ç­‰é—´è·"></p>
<p>å¯¹åº”çš„ä»£ç ä¹Ÿä¼šå¼‚å¸¸ç®€å•ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¾ªç¯åˆ›å»º</span></div><div class="line"><span class="keyword">for</span> (<span class="built_in">NSUInteger</span> i = <span class="number">0</span>; i &lt; ITEM_COUNT; i++) &#123;</div><div class="line">    <span class="built_in">UIView</span> *itemView = [<span class="keyword">self</span> getItemViewWithIndex:i];</div><div class="line">    [_containerView2 addSubview:itemView];</div><div class="line"></div><div class="line">    [itemView mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">        <span class="comment">// å®½é«˜ä¸€å®š</span></div><div class="line">        make.width.and.height.equalTo(@(ITEM_SIZE));</div><div class="line">        <span class="comment">// ç¡®å®šYåæ ‡</span></div><div class="line">        make.centerY.equalTo(_containerView2.mas_centerY);</div><div class="line">        <span class="comment">// ç¡®å®šXåæ ‡ï¼Œæ³¨æ„åˆ†å­åˆ†æ¯éƒ½è¦åŠ 1</span></div><div class="line">        make.centerX.equalTo(_containerView2.mas_right).multipliedBy(((<span class="built_in">CGFloat</span>)i + <span class="number">1</span>) / ((<span class="built_in">CGFloat</span>)ITEM_COUNT + <span class="number">1</span>));</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å°èŠ‚-2"><a href="#å°èŠ‚-2" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h3><p>å¾ˆå¤šæ—¶å€™ï¼Œçµæ´»çš„ä½¿ç”¨multiplierèƒ½å¤§å¤§ç®€åŒ–å¼€å‘~</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸‰ä¸ªä¾‹å­è¯´å®Œäº†ï¼Œä½ æœ‰å•¥æ”¶è·å‘¢~ï¼Ÿ:-D</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2016-06-02: æ„Ÿè°¢&lt;a href=&quot;http://weibo.com/u/2953626141&quot;&gt;æˆ‘ä¸æ˜¯èœ¡ç¬”å°æ–°ä½†æ˜¯æˆ‘æœ‰å°ç™½&lt;/a&gt;ï¼Œå‘ç°äº†Case 2çš„æœ€åä¸¤ä¸ªcellå±•å¼€åŠ¨ç”»é—®é¢˜ï¼ŒåŸæ¥æ˜¯tableViewçš„&lt;code&gt;estimatedRowHeight&lt;/code&gt;ä¼šè·Ÿå±•å¼€åŠ¨ç”»å†²çªçš„ç¼˜æ•…ã€‚  &lt;/li&gt;
&lt;li&gt;2015-12-23: æ„Ÿè°¢&lt;a href=&quot;https://github.com/XVXVXXX&quot;&gt;XVXVXXX&lt;/a&gt;çš„PR,Case 1ä¸å†éœ€è¦Fake Header Viewï¼Œç›´æ¥ç”¨contentInsetå°±å¥½~  &lt;/li&gt;
&lt;li&gt;2015-12-17ï¼šCase3çš„ç­‰é—´è·ï¼Œç”¨UIStackViewå®ç°æœ€ä¼˜é›…ï¼Œä½†æ˜¯æ— å¥ˆåªæœ‰iOS9ä»¥ä¸Šæ”¯æŒã€‚å…¼å®¹æ–¹æ¡ˆå¦‚OAStackViewä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯åœ¨UITableViewCellé‡Œé¢ç”¨ï¼Œæˆ–è€…éœ€è¦é¢‘ç¹çš„å¢å‡å†…éƒ¨Viewçš„æ•°é‡æ—¶ï¼Œæ€§èƒ½æŸè€—æœ‰ç‚¹å‰å®³ï¼Œä¼šå¡ã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯è¦çœ‹éœ€æ±‚=ã€‚=&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸‰ç¯‡æ¥äº†ã€‚&lt;br&gt;ä¾ç„¶æ˜¯3ä¸ªå°ä¾‹å­ï¼Œä¸»è¦éƒ¨åˆ†ç”¨Masonryæ‰‹å†™ä»£ç å®ç°ï¼Œå…¶å®ƒçš„çº¦æŸåœ¨storyboardé‡Œé¢ç›´æ¥æ‹–æ‹½æ­å»ºã€‚&lt;br&gt;è‡³äºä¸ºå•¥ä¸ç”¨VFLï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„â€œæè¿°æ€§â€çš„å†™æ³•å¾ˆå®¹æ˜“å‡ºé”™ï¼Œæ²¡æœ‰è¡¥å…¨ã€ä¸å¥½è°ƒè¯•ï¼Œå†™èµ·æ¥æ²¡æœ‰â€œä»£ç â€çš„æ„Ÿè§‰=ã€‚=ã€‚å½“ç„¶ï¼Œè¿™ä¸ªä»è€…è§ä»æ™ºè€…è§æ™º~&lt;br&gt;ä¸‰ä¸ªä¾‹å­åˆ†åˆ«æ˜¯ï¼š&lt;strong&gt;Parallax Header&lt;/strong&gt;ï¼Œ&lt;strong&gt;åŠ¨æ€å˜é«˜åº¦çš„UITableViewCell&lt;/strong&gt;ï¼Œä»¥åŠ&lt;strong&gt;ä¸¤ç§æ–¹å¼å®ç°ç­‰é—´è·&lt;/strong&gt;ã€‚åŸç†å…¶å®éƒ½å¾ˆç®€å•ï¼Œä¾‹å­ä¹Ÿéƒ½æ˜¯å¹³æ—¶ç§¯ç´¯èµ·æ¥çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‰ä¸¤ç¯‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ç¯‡ï¼š&lt;a href=&quot;http://tutuge.me/2015/05/23/autolayout-example-with-masonry/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹-Masonryå®ç°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒç¯‡ï¼š&lt;a href=&quot;http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç¬¬å››ç¯‡ï¼š&lt;a href=&quot;http://tutuge.me/2016/08/06/autolayout-example-with-masonry4/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹4-Masonryå®ç°&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Githubåœ°å€ï¼š&lt;br&gt;&lt;a href=&quot;https://github.com/zekunyan/AutolayoutExampleWithMasonry&quot;&gt;https://github.com/zekunyan/AutolayoutExampleWithMasonry&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry3_1.gif&quot; alt=&quot;Gifç¤ºä¾‹&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="Autolayout" scheme="http://tutuge.me/tags/Autolayout/"/>
    
      <category term="Masonry" scheme="http://tutuge.me/tags/Masonry/"/>
    
  </entry>
  
  <entry>
    <title>Swiftå¼€æºé¡¹ç›®: TTGEmojiRateçš„å®ç°</title>
    <link href="http://tutuge.me/2015/10/25/ttgemojirate-lib/"/>
    <id>http://tutuge.me/2015/10/25/ttgemojirate-lib/</id>
    <published>2015-10-25T11:32:42.000Z</published>
    <updated>2016-08-07T06:18:41.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰æ®µæ—¶é—´åœ¨Dribbbleä¸Šå‘ç°äº†ä¸€ä¸ª<a href="https://dribbble.com/shots/2211556-Rating-Version-A" target="_blank" rel="external">Ratingæ§ä»¶</a>çš„æ¼”ç¤ºåŠ¨ç”»ï¼Œæ§ä»¶ä»¥Emojiè¡¨æƒ…ä¸ºåŸºç¡€ï¼Œç»“åˆäº†ä¸Šä¸‹æ»‘åŠ¨æ‰‹åŠ¿ï¼Œæ­£å¥½æœ€è¿‘æ­£åœ¨æ·±å…¥å­¦ä¹ iOSåŠ¨ç”»ã€ç»˜å›¾ç›¸å…³çš„çŸ¥è¯†ï¼Œå°±å°è¯•ç€ç”¨<code>UIBezierPath</code>å®ç°äº†å‡ºæ¥ã€‚æœ¬æ–‡å°±æ˜¯TTGEmojiRateçš„å®ç°è¿‡ç¨‹ã€‚</p>
<p>Github: <a href="https://github.com/zekunyan/TTGEmojiRate" target="_blank" rel="external">https://github.com/zekunyan/TTGEmojiRate</a></p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGEmojiRate_screenshot2.gif" alt="TTGEmojiRate Example"></p>
<a id="more"></a>
<h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>å…ˆçœ‹çœ‹åŸæœ¬çš„æ•ˆæœï¼š<a href="https://dribbble.com/shots/2211556-Rating-Version-A" target="_blank" rel="external">Rating Version A - Hoang Nguyen</a></p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGEmojiRate_Dribbble.gif" alt="Rating Version A - Hoang Nguyen"></p>
<p>å¯ä»¥çœ‹å‡ºæ¥ï¼Œä¸»è¦çš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯ä»¥ä¸Šä¸‹æ‹–åŠ¨ï¼Œæ”¹å˜Emojiè¡¨æƒ…å˜´çš„å¼§åº¦ã€‚</li>
<li>æ‹–åŠ¨çš„æ—¶å€™Rateçš„å€¼ä¹Ÿä¼šéšä¹‹å˜åŒ–ï¼Œä»0åˆ°5ï¼Œå¹¶ä¸”è·Ÿè¡¨æƒ…çš„â€œå–œæ€’â€ç›¸å¯¹åº”ã€‚</li>
<li>é¢œè‰²ä¹Ÿä¼šå˜åŒ–ï¼Œä»ç»¿è‰²åˆ°è“è‰²å†åˆ°çº¢è‰²ï¼Œä¹Ÿå¯¹åº”è¡¨æƒ…çš„â€œå–œæ€’â€ã€‚</li>
</ul>
<p>å®é™…å®ç°çš„æ—¶å€™ï¼Œå¢åŠ äº†çœ¼ç›å…ƒç´ ï¼Œå¹¶ä¸”å¢å¼ºäº†è‡ªå®šä¹‰ï¼Œå¦‚é¢œè‰²çš„å˜åŒ–èŒƒå›´ã€çº¿æ¡çš„ç²—ç»†ç­‰éƒ½å¯ä»¥è®¾å®šï¼ŒåŸºæœ¬çš„æ€è·¯è¿˜æ˜¯ä¸å˜çš„ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>å¼€å§‹å†™ä»£ç ä¹‹å‰ï¼Œå…ˆç†ç†æ€è·¯ã€‚</p>
<p>æ‹–åŠ¨çš„æ—¶å€™ï¼Œç›´æ¥å½±å“çš„åº”è¯¥æ˜¯Rateå€¼ï¼Œç„¶ååœ¨Rateå€¼æ”¹å˜çš„æ—¶å€™åˆ·æ–°æ•´ä¸ªæ§ä»¶ï¼Œåˆ·æ–°çš„æ—¶å€™é‡ç»˜ã€‚é‡ç»˜çš„æ—¶å€™ï¼Œå˜´ã€çœ¼ç›çš„å¼§åº¦ï¼Œé¢œè‰²çš„å€¼éƒ½è¦æ ¹æ®Rateå€¼é‡æ–°è®¡ç®—ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_ttgemojirate_1.png" alt="Image"></p>
<h3 id="æ‹–åŠ¨æ”¹å˜Rateå€¼"><a href="#æ‹–åŠ¨æ”¹å˜Rateå€¼" class="headerlink" title="æ‹–åŠ¨æ”¹å˜Rateå€¼"></a>æ‹–åŠ¨æ”¹å˜Rateå€¼</h3><p>è¿™ä¸ªè¿˜æ˜¯å¾ˆå®¹æ˜“å®ç°çš„ï¼Œç›´æ¥é‡å†™<code>UIView</code>çš„touchç›¸å…³çš„ä¸‰ä¸ªæ–¹æ³•ï¼Œåœ¨é‡Œé¢è®°å½•æ‹–åŠ¨åœ¨Yè½´ä¸Šçš„å˜åŒ–å€¼ï¼Œç„¶åæ˜ å°„åˆ°Rateå€¼ä¸Šå°±å¯ä»¥äº†ã€‚</p>
<p>å…ˆå£°æ˜ä¸€ä¸ªCGPointå±æ€§ï¼Œç”¨æ¥ä¿å­˜æ‰‹æŒ‡æŒ‰ä¸‹æ—¶çš„ç‚¹ä½ç½®ï¼š<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">var</span> touchPoint: CGPoint? = <span class="keyword">nil</span></div></pre></td></tr></table></figure></p>
<p>åœ¨æ‰‹æŒ‡ç§»åŠ¨çš„æ—¶å€™ï¼Œåœ¨<code>touchesMoved</code>æ–¹æ³•é‡Œé¢è®¡ç®—å½“å‰ç‚¹è·Ÿä¸Šä¸€æ¬¡è§¦æ‘¸ç‚¹çš„Yè½´ä¸Šçš„<strong>å·®å€¼</strong>ï¼Œç„¶åæ˜ å°„åˆ°Rateå€¼ä¸Šã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">touchesMoved</span><span class="params">(touches: Set&lt;UITouch&gt;, withEvent event: UIEvent?)</span></span> &#123;</div><div class="line">    <span class="comment">// è·å–å½“å‰è§¦æ‘¸ç‚¹</span></div><div class="line">    <span class="keyword">let</span> currentPoint = touches.first?.locationInView(<span class="keyword">self</span>)</div><div class="line">    <span class="comment">// æ”¹å˜Rateå€¼</span></div><div class="line">    rateValue = rateValue + <span class="type">Float</span>((currentPoint!.y - touchPoint!.y) / <span class="type">CGRectGetHeight</span>(<span class="keyword">self</span>.bounds) * rateDragSensitivity)</div><div class="line">    <span class="comment">// ä¿å­˜å½“å‰è§¦æ‘¸ç‚¹</span></div><div class="line">    touchPoint = currentPoint</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>è®¡ç®—Yè½´å·®å€¼çš„æ—¶å€™ï¼Œé™¤ä»¥äº†å½“å‰æ§ä»¶çš„é«˜åº¦ï¼Œè¿™æ˜¯ä¸ºäº†ä¿è¯Rateå€¼æŒ‰æ¯”ä¾‹å¢å‡ã€‚</li>
<li>å¢åŠ äº†ä¸€ä¸ª<code>rateDragSensitivity</code>å±æ€§ï¼Œç”¨æ¥è°ƒèŠ‚æ”¹å˜Rateå€¼çš„â€œçµæ•åº¦â€</li>
</ul>
<h3 id="UIBezierPath-è´å¡å°”æ›²çº¿"><a href="#UIBezierPath-è´å¡å°”æ›²çº¿" class="headerlink" title="UIBezierPath - è´å¡å°”æ›²çº¿"></a>UIBezierPath - è´å¡å°”æ›²çº¿</h3><p>æ§ä»¶çš„ä¸»è¦å†…å®¹éƒ½æ˜¯ç”¨<code>UIBezierPath</code>ç»˜åˆ¶å‡ºæ¥çš„ã€‚ç½‘ä¸Šå…³äº<code>UIBezierPath</code>çš„è®²è§£å¾ˆå¤šï¼Œåœ¨è¿™é‡Œå°±ä¸è¯¦ç»†è¯´äº†ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œ<code>UIBezierPath</code>ç”¨æ¥ç»˜åˆ¶çŸ¢é‡è·¯å¾„ï¼Œæ˜¯ä¸€ç§å‚æ•°æ›²çº¿ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦å…ˆè®¾å®šå¥½é”šç‚¹ã€æ§åˆ¶ç‚¹ï¼Œç³»ç»Ÿå°±å¯ä»¥æ ¹æ®è´å¡å°”æ›²çº¿çš„ç®—æ³•ï¼Œç»˜åˆ¶å‡ºå¯¹åº”çš„çº¿ï¼Œå¹¶ä¸”ä¿è¯é”šç‚¹å’Œå¯¹åº”çš„æ§åˆ¶ç‚¹çš„è¿çº¿ä¸æ›²çº¿ç›¸åˆ‡ã€‚</p>
<p>è¿™é‡Œæœ‰ä¸€ä¸ªæ¼”ç¤ºç»˜åˆ¶è´å¡å°”æ›²çº¿è¿‡ç¨‹çš„ç½‘ç«™ï¼š<a href="http://myst729.github.io/bezier-curve/" target="_blank" rel="external">BÃ©zier curve</a></p>
<h3 id="è„¸"><a href="#è„¸" class="headerlink" title="è„¸"></a>è„¸</h3><p>è„¸æ˜¯æœ€ç®€å•çš„ï¼Œå°±æ˜¯ä¸€ä¸ªåœ†ï¼Œç›´æ¥ç”¨ä¸€ä¸ªæ–¹æ³•å°±å¯ä»¥ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">drawFaceWithRect</span><span class="params">(rect: CGRect)</span></span> &#123;</div><div class="line">    <span class="keyword">let</span> facePath = <span class="type">UIBezierPath</span>(ovalInRect: rect)</div><div class="line">    rateColor.setStroke()</div><div class="line">    facePath.lineWidth = rateLineWidth <span class="comment">// çº¿ç²—ç»†</span></div><div class="line">    facePath.stroke()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®é™…å®ç°çš„æ—¶å€™å¯ä»¥åŠ ä¸ŠMarginï¼Œé˜²æ­¢çº¿ç”»åˆ°Viewçš„è¾¹ç•Œä¹‹å¤–ã€‚</p>
<h3 id="å˜´ã€çœ¼ç›"><a href="#å˜´ã€çœ¼ç›" class="headerlink" title="å˜´ã€çœ¼ç›"></a>å˜´ã€çœ¼ç›</h3><p>å…ˆçœ‹çœ‹<code>UIBezierPath</code>æä¾›çš„å¯ä»¥ç”¨æ¥ç»˜åˆ¶æ›²çº¿çš„æ–¹æ³•ï¼š<br><code>addCurveToPoint(_:controlPoint1:controlPoint2:)</code>å’Œ<code>addQuadCurveToPoint(_:controlPoint:)</code>ï¼Œå¦‚ä¸‹å›¾:</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_ttgemojirate_2.png" alt="UIBezierPath"></p>
<p>ç›´è§‚ä¸Šæ¥è®²ï¼Œå˜´ã€çœ¼ç›çš„ç»˜åˆ¶è·Ÿ<code>addQuadCurveToPoint</code>æ–¹æ³•ç»˜åˆ¶çš„æ•ˆæœåŸºæœ¬ä¸€è‡´ï¼Œä½†æ˜¯è¿™æ ·çš„æ•ˆæœæ²¡æ³•è°ƒæ•´ï¼Œå› ä¸ºåªèƒ½æ§åˆ¶å”¯ä¸€çš„ä¸€ä¸ªæ§åˆ¶ç‚¹ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦ç”¨<code>addCurveToPoint</code>æ–¹æ³•ï¼Œå¯¹ç§°çš„ç»˜åˆ¶ä¸¤æ¡æ›²çº¿ï¼Œæ‹¼æ¥èµ·æ¥ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_ttgemojirate_3.png" alt="Curveæ‹¼æ¥"></p>
<p>è¿™æ ·çš„è¯ï¼Œå°±å¯ä»¥é€šè¿‡è°ƒæ•´ä¸¤ä¸ªæ§åˆ¶ç‚¹ï¼Œæ¥æ§åˆ¶å˜´ã€çœ¼ç›çš„å¼¯æ›²å®½åº¦ã€å½¢çŠ¶ã€‚</p>
<p>ä»¥ç»˜åˆ¶å˜´ä¸ºä¾‹ï¼š</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> func drawMouthWithRect(<span class="built_in">rect</span>: CGRect) &#123;</div><div class="line">    let <span class="built_in">width</span> = CGRectGetWidth(<span class="built_in">rect</span>)</div><div class="line">    let <span class="built_in">height</span> = CGRectGetWidth(<span class="built_in">rect</span>)</div><div class="line"></div><div class="line">    <span class="comment">// å·¦ç«¯ç‚¹</span></div><div class="line">    let leftPoint = CGPointMake(</div><div class="line">        <span class="built_in">width</span> * (<span class="number">1</span> - rateMouthWidth) / <span class="number">2</span>,</div><div class="line">        <span class="built_in">height</span> * (<span class="number">1</span> - rateMouthVerticalPosition))</div><div class="line"></div><div class="line">    <span class="comment">// å³ç«¯ç‚¹</span></div><div class="line">    let rightPoint = CGPointMake(</div><div class="line">        <span class="built_in">width</span> - leftPoint.x,</div><div class="line">        leftPoint.y)</div><div class="line"></div><div class="line">    <span class="comment">// ä¸­é—´ç‚¹ - Yå€¼æ ¹æ®å½“å‰çš„Rateå€¼è®¡ç®—ï¼Œ0.3ä¸ºç³»æ•°</span></div><div class="line">    let centerPoint = CGPointMake(</div><div class="line">        <span class="built_in">width</span> / <span class="number">2</span>,</div><div class="line">        leftPoint.y + <span class="built_in">height</span> * <span class="number">0.3</span> * (CGFloat(rateValue) - <span class="number">2.5</span>) / <span class="number">5</span>)</div><div class="line"></div><div class="line">    <span class="comment">// æ§åˆ¶ç‚¹è·Ÿä¸­é—´ç‚¹åœ¨Xè½´ä¸Šçš„è·ç¦»</span></div><div class="line">    let halfLipWidth = <span class="built_in">width</span> * rateMouthWidth * rateLipWidth / <span class="number">2</span></div><div class="line"></div><div class="line">    <span class="comment">// åˆ›å»ºè´å¡å°”æ›²çº¿</span></div><div class="line">    let mouthPath = UIBezierPath()</div><div class="line"></div><div class="line">    <span class="comment">// ç§»åŠ¨åˆ°èµ·å§‹ç‚¹</span></div><div class="line">    mouthPath.moveToPoint(leftPoint)</div><div class="line"></div><div class="line">    <span class="comment">// æ·»åŠ å·¦åŠè¾¹æ›²çº¿è·¯å¾„</span></div><div class="line">    mouthPath.addCurveToPoint(</div><div class="line">        centerPoint,</div><div class="line">        controlPoint1: leftPoint,</div><div class="line">        controlPoint2: CGPointMake(centerPoint.x - halfLipWidth, centerPoint.y))</div><div class="line"></div><div class="line">    <span class="comment">// æ·»åŠ å³åŠè¾¹æ›²çº¿è·¯å¾„</span></div><div class="line">    mouthPath.addCurveToPoint(</div><div class="line">        rightPoint,</div><div class="line">        controlPoint1: CGPointMake(centerPoint.x + halfLipWidth, centerPoint.y),</div><div class="line">        controlPoint2: rightPoint)</div><div class="line"></div><div class="line">    <span class="comment">// è®¾å®šæ ·å¼</span></div><div class="line">    mouthPath.lineCapStyle = CGLineCap.Round;</div><div class="line">    rateColor.setStroke()</div><div class="line">    mouthPath.lineWidth = rateLineWidth</div><div class="line">    mouthPath.<span class="built_in">stroke</span>()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>æ‰€æœ‰çš„è·ç¦»ã€åæ ‡éƒ½æ˜¯æ ¹æ®å½“å‰æ§ä»¶çš„å¤§å°è®¡ç®—å‡ºæ¥çš„ã€‚</li>
<li><code>rateMouthWidth</code>ä¸ºå˜´çš„å®½åº¦ä¸æ•´ä¸ªæ§ä»¶å®½åº¦çš„æ¯”å€¼ï¼Œå³ç›¸å¯¹å€¼ã€‚</li>
<li><code>rateMouthVerticalPosition</code>ä¸ºå˜´çš„å·¦å³ä¸¤ä¸ªç«¯ç‚¹çš„Yè½´åæ ‡å€¼ï¼Œä¹Ÿä¸ºç›¸å¯¹å€¼ã€‚</li>
<li><code>rateLipWidth</code>ä¸ºä¸­å¿ƒç‚¹çš„ä¸¤ä¸ªæ§åˆ¶ç‚¹çš„è·ç¦»ä¸å˜´å®½åº¦çš„æ¯”å€¼ï¼Œä¹Ÿæ˜¯ç›¸å¯¹å€¼ã€‚</li>
</ul>
<p>çœ¼ç›çš„ç»˜åˆ¶è·Ÿå˜´åŸç†ä¸€è‡´ï¼Œå°±ä¸å†è¯´æ˜ã€‚</p>
<h3 id="é¢œè‰²çš„æ¸å˜"><a href="#é¢œè‰²çš„æ¸å˜" class="headerlink" title="é¢œè‰²çš„æ¸å˜"></a>é¢œè‰²çš„æ¸å˜</h3><p>Dribbbleçš„æ¼”ç¤ºä¸­ï¼Œæ§ä»¶çš„çº¿æ¡é¢œè‰²ä¹Ÿæ˜¯ä¼šå˜åŒ–çš„ï¼Œä»çº¢è‰²åˆ°è“è‰²å†åˆ°ç»¿è‰²ï¼Œæ˜¯è¿ç»­å˜åŒ–çš„ã€‚è¿™ä¸ªæ—¶å€™ç”¨å¸¸è§çš„<strong>RGBè‰²å½©æ¨¡å¼</strong>æ˜¯ä¸å¥½æ§åˆ¶çš„ï¼Œæ•ˆæœä¹Ÿä¸å¥½ã€‚</p>
<p>æ‰€ä»¥è¿™ä¸ªæ—¶å€™è¦ç”¨<strong>HSBè‰²å½©æ¨¡å¼</strong></p>
<blockquote>
<p>HSB è‰²å½©æ¨¡å¼æ˜¯åŸºäºäººçœ¼çš„ä¸€ç§é¢œè‰²æ¨¡å¼ã€‚æ˜¯æ™®åŠå‹è®¾è®¡è½¯ä»¶ä¸­å¸¸è§çš„è‰²å½©æ¨¡å¼ï¼Œå…¶ä¸­Hä»£è¡¨è‰²ç›¸ï¼›Sä»£è¡¨é¥±å’Œåº¦ï¼›Bä»£è¡¨äº®åº¦ã€‚- <a href="http://baike.baidu.com/view/1006662.htm" target="_blank" rel="external">ç™¾åº¦ç™¾ç§‘</a></p>
</blockquote>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_ttgemojirate_4.jpg?imageView2/1/w/240/h/192" alt="HSBè‰²å½©æ¨¡å¼"></p>
<p>å¯¹åº”åˆ°<code>UIColor</code>ç±»ï¼Œå°±æ˜¯ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åˆ›å»ºUIColor</span></div><div class="line">init(<span class="built_in">hue</span> <span class="built_in">hue</span>: CGFloat, <span class="built_in">saturation</span> <span class="built_in">saturation</span>: CGFloat, <span class="built_in">brightness</span> <span class="built_in">brightness</span>: CGFloat, <span class="built_in">alpha</span> <span class="built_in">alpha</span>: CGFloat)</div><div class="line"><span class="comment">// è·å–HSBå€¼ï¼Œæ³¨æ„å‚æ•°</span></div><div class="line">func getHue(_ <span class="built_in">hue</span>: UnsafeMutablePointer&lt;CGFloat&gt;, <span class="built_in">saturation</span> <span class="built_in">saturation</span>: UnsafeMutablePointer&lt;CGFloat&gt;, <span class="built_in">brightness</span> <span class="built_in">brightness</span>: UnsafeMutablePointer&lt;CGFloat&gt;, <span class="built_in">alpha</span> <span class="built_in">alpha</span>: UnsafeMutablePointer&lt;CGFloat&gt;) -&gt; Bool</div></pre></td></tr></table></figure>
<p>å®ç°çš„æ—¶å€™ï¼Œä¸ºäº†å¢åŠ å¯å®šåˆ¶æ€§ï¼Œæ§ä»¶é¢œè‰²çš„å˜åŒ–èŒƒå›´æ˜¯å¯ä»¥è®¾ç½®çš„ï¼Œç”¨ä»¥ä¸‹å±æ€§ä¿å­˜ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> var <span class="string">rateColorRange:</span> (<span class="string">from:</span> UIColor, <span class="string">to:</span> UIColor)</div></pre></td></tr></table></figure>
<p>åˆ·æ–°æ—¶ï¼Œå°±å¯ä»¥æ ¹æ®å½“å‰çš„Rateå€¼ï¼Œé‡æ–°è®¡ç®—é¢œè‰²çš„HSBå’Œalphaå€¼ï¼š</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">let rate: CGFloat = CGFloat(rateValue / <span class="number">5</span>) <span class="comment">// Rateå€¼å½’ä¸€åŒ–</span></div><div class="line"></div><div class="line">self.rateColor = UIColor.init(</div><div class="line"><span class="symbol">    hue:</span> hueFrom + hueDelta * rate, <span class="comment">// è‰²ç›¸</span></div><div class="line"><span class="symbol">    saturation:</span> saturationFrom + saturationDelta * rate, <span class="comment">// é¥±å’Œåº¦</span></div><div class="line"><span class="symbol">    brightness:</span> brightnessFrom + brightnessDelta * rate, <span class="comment">// äº®åº¦</span></div><div class="line"><span class="symbol">    alpha:</span> alphaFrom + alphaDelta * rate <span class="comment">// é€æ˜åº¦</span></div><div class="line">)</div></pre></td></tr></table></figure>
<p>è¯´æ˜ï¼š</p>
<ul>
<li>æ‰€æœ‰çš„é¢œè‰²å‚æ•°éƒ½æ˜¯æ ¹æ®Rateå€¼åšçº¿æ€§å¢å‡ã€‚</li>
<li><code>xxxFrom</code>ã€<code>xxxDelta</code>åˆ†åˆ«æŒ‡HSBå’Œalphaçš„èµ·å§‹å€¼ä¸å˜åŒ–èŒƒå›´ï¼Œåœ¨è®¾ç½®<code>rateColorRange</code>æ—¶è®¡ç®—ä¿å­˜ä¸‹æ¥ã€‚</li>
</ul>
<p>è¿™æ ·ï¼Œé¢œè‰²å°±èƒ½åšåˆ°è·ŸRateå€¼åšè¿ç»­çš„çº¿æ€§å˜åŒ–ã€‚</p>
<h3 id="å–„äºä½¿ç”¨didSet"><a href="#å–„äºä½¿ç”¨didSet" class="headerlink" title="å–„äºä½¿ç”¨didSet"></a>å–„äºä½¿ç”¨didSet</h3><p>å®ç°æ§ä»¶çš„æ—¶å€™ï¼Œå¯¹å¤–æš´éœ²äº†å¾ˆå¤šå±æ€§ï¼Œå¦‚çº¿çš„å®½åº¦<code>rateLineWidth</code>ã€å˜´çš„å®½åº¦<code>rateMouthWidth</code>ç­‰ã€‚ä¸ºäº†å¯¹è¿™äº›å±æ€§åšæ ¡éªŒï¼Œå¹¶ä¸”åœ¨è®¾ç½®ååˆ·æ–°æ§ä»¶ï¼Œå°±è¦ç”¨åˆ°<code>didSet</code>ã€‚</p>
<p><code>didSet</code>åœ¨Swifté‡Œé¢ï¼Œè·Ÿç±»çš„å±æ€§æ˜¯ä¸€ä¸€ç»‘å®šçš„ï¼Œåœ¨å¯¹å±æ€§èµ‹å€¼åä¼šè¢«è°ƒç”¨ã€‚</p>
<p>æ§ä»¶çš„å¤§éƒ¨åˆ†å±æ€§éƒ½åšäº†æ ¡éªŒã€åˆ·æ–°ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// Mouth width. From 0.2 to 0.7.</span></div><div class="line"><span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> rateMouthWidth: <span class="type">CGFloat</span> = <span class="number">0.6</span> &#123;</div><div class="line">    <span class="keyword">didSet</span> &#123;</div><div class="line">        <span class="comment">// åˆ¤æ–­ä¸Šé™</span></div><div class="line">        <span class="keyword">if</span> rateMouthWidth &gt; <span class="number">0.7</span> &#123;</div><div class="line">            rateMouthWidth = <span class="number">0.7</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">// åˆ¤æ–­ä¸‹é™</span></div><div class="line">        <span class="keyword">if</span> rateMouthWidth &lt; <span class="number">0.2</span> &#123;</div><div class="line">            rateMouthWidth = <span class="number">0.2</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">// åˆ·æ–°ã€é‡ç»˜</span></div><div class="line">        <span class="keyword">self</span>.setNeedsDisplay()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="IBDesignableã€-IBInspectable"><a href="#IBDesignableã€-IBInspectable" class="headerlink" title="@IBDesignableã€@IBInspectable"></a>@IBDesignableã€@IBInspectable</h3><p>ä¸ºäº†èƒ½åœ¨XIBã€StoryBoardé‡Œé¢ä½¿ç”¨ã€ç¼–è¾‘æ§ä»¶ï¼Œå°±è¦ç”¨åˆ°<code>@IBDesignable</code>å’Œ<code>@IBInspectable</code>è¿™ä¸¤ä¸ªå…³é”®å­—ã€‚</p>
<p>åœ¨ç±»çš„å‰é¢åŠ ä¸Š<code>@IBDesignable</code>å…³é”®å­—ï¼Œä½¿IBå¯ä»¥é¢„è§ˆæ§ä»¶ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBDesignable</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmojiRateView</span>: <span class="type">UIView &#123;</span></span></div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨å±æ€§å‰é¢åŠ ä¸Š<code>@IBInspectable</code>ï¼Œå°±å¯ä»¥åœ¨IBé‡Œé¢ç¼–è¾‘å±æ€§ï¼Œå®æ—¶é¢„è§ˆï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBInspectable</span> <span class="keyword">public</span> var <span class="string">rateLineWidth:</span> CGFloat = <span class="number">14</span> &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¯¦ç»†çš„ä½¿ç”¨å¯ä»¥å‚è€ƒNSHipsterä¸Šçš„æ–‡ç« ï¼š<a href="http://nshipster.cn/ibinspectable-ibdesignable/" target="_blank" rel="external">IBInspectable / IBDesignable</a></p>
<p>æœ€åï¼Œåœ¨IBé‡Œé¢å°±æ˜¯ä¸‹é¢è¿™æ ·ï¼š<br><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGEmojiRate_IBExample.png?imageView2/0/w/640" alt="IB example"></p>
<p><strong>By the way =ã€‚=</strong><br>å±æ€§åå­—å¤ªé•¿ï¼Œåœ¨IBé‡Œé¢æ˜¾ç¤ºä¸å®Œæ•´ï¼Œå’‹åŠã€‚ã€‚ã€‚</p>
<h3 id="å›è°ƒ"><a href="#å›è°ƒ" class="headerlink" title="å›è°ƒ"></a>å›è°ƒ</h3><p>æ‹–åŠ¨æ”¹å˜Rateå€¼çš„æ—¶å€™ï¼Œè‚¯å®šè¦æœ‰å›è°ƒï¼Œå¦‚ä¸‹å®šä¹‰ï¼š</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">var</span> rateValueChangeCallback: <span class="type"></span>((<span class="keyword">new</span><span class="type">RateValue</span>: <span class="keyword">Float</span>) -&gt; <span class="keyword">Void</span>)? = nil</div></pre></td></tr></table></figure>
<p>åœ¨<code>rateValue</code>çš„<code>didSet</code>é‡Œé¢å›è°ƒï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@IBInspectable</span> <span class="keyword">public</span> <span class="keyword">var</span> rateValue: <span class="type">Float</span> = <span class="number">2.5</span> &#123;</div><div class="line">    <span class="keyword">didSet</span> &#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">        <span class="comment">// å›è°ƒ</span></div><div class="line">        <span class="keyword">self</span>.rateValueChangeCallback?(newRateValue: rateValue)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>çœ‹ä¼¼ç®€å•çš„ä¸€ä¸ªRatingæ§ä»¶ï¼Œä»æ„æ€åˆ°å®ç°ï¼Œå†åˆ°å®Œå–„ï¼Œä¸€ç‚¹ä¸€ç‚¹æœç€å®Œç¾å»åšï¼Œæ”¶è·ä¸å°‘~</p>
<p>æœ€åï¼ŒDribbbleæ˜¯ä¸ªå¥½åœ°æ–¹ï¼Œè´å¡å°”æ›²çº¿å¥½å¼ºå¤§ï¼ŒXCode 7.1å†™Swiftè¿˜æ˜¯æœ‰ç‚¹å¡=ã€‚=</p>
<p>ä»¥ä¸Šã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://zh.wikipedia.org/wiki/%E8%B2%9D%E8%8C%B2%E6%9B%B2%E7%B7%9A" target="_blank" rel="external">ç»´åŸºç™¾ç§‘ - è´å¡å°”æ›²çº¿</a></li>
<li><a href="https://developer.apple.com/library/ios/documentation/2DDrawing/Conceptual/DrawingPrintingiOS/BezierPaths/BezierPaths.html" target="_blank" rel="external">Drawing Shapes Using BÃ©zier Paths</a></li>
<li><a href="http://baike.baidu.com/view/1006662.htm" target="_blank" rel="external">HSBè‰²å½©æ¨¡å¼</a></li>
<li><a href="http://nshipster.cn/ibinspectable-ibdesignable/" target="_blank" rel="external">IBInspectable / IBDesignable</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å‰æ®µæ—¶é—´åœ¨Dribbbleä¸Šå‘ç°äº†ä¸€ä¸ª&lt;a href=&quot;https://dribbble.com/shots/2211556-Rating-Version-A&quot;&gt;Ratingæ§ä»¶&lt;/a&gt;çš„æ¼”ç¤ºåŠ¨ç”»ï¼Œæ§ä»¶ä»¥Emojiè¡¨æƒ…ä¸ºåŸºç¡€ï¼Œç»“åˆäº†ä¸Šä¸‹æ»‘åŠ¨æ‰‹åŠ¿ï¼Œæ­£å¥½æœ€è¿‘æ­£åœ¨æ·±å…¥å­¦ä¹ iOSåŠ¨ç”»ã€ç»˜å›¾ç›¸å…³çš„çŸ¥è¯†ï¼Œå°±å°è¯•ç€ç”¨&lt;code&gt;UIBezierPath&lt;/code&gt;å®ç°äº†å‡ºæ¥ã€‚æœ¬æ–‡å°±æ˜¯TTGEmojiRateçš„å®ç°è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;Github: &lt;a href=&quot;https://github.com/zekunyan/TTGEmojiRate&quot;&gt;https://github.com/zekunyan/TTGEmojiRate&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7nj2iz.com1.z0.glb.clouddn.com/TTGEmojiRate_screenshot2.gif&quot; alt=&quot;TTGEmojiRate Example&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="å¼€æº" scheme="http://tutuge.me/tags/%E5%BC%80%E6%BA%90/"/>
    
      <category term="Swift" scheme="http://tutuge.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>Swiftå†™çš„åº“-TTGSnackbar</title>
    <link href="http://tutuge.me/2015/10/09/ttgsnackbar-lib/"/>
    <id>http://tutuge.me/2015/10/09/ttgsnackbar-lib/</id>
    <published>2015-10-09T11:49:09.000Z</published>
    <updated>2016-12-25T14:26:57.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><ul>
<li>2016-12-25: å¢åŠ å¤šè¡Œæ–‡æœ¬çš„æ”¯æŒï¼Œå¢åŠ é˜´å½±</li>
<li>2016-10-20: å¢åŠ ContentInsetï¼Œä¹Ÿå°±æ˜¯Paddingçš„å±æ€§ï¼›å¢åŠ è‡ªå®šä¹‰å†…å®¹View; ç‰ˆæœ¬1.3.0</li>
<li>2016-10-17: æ”¯æŒSwift3ï¼›å¢åŠ çš„é¡¶éƒ¨Topä½ç½®åŠ¨ç”»ï¼›å¢åŠ åŒæ—¶ä¸¤ä¸ªActionæŒ‰é’®ï¼›å¢åŠ å¸¦å›¾ç‰‡iconæ˜¾ç¤º</li>
<li>2016-03-25: ç‰ˆæœ¬æ›´æ–°åˆ°äº†0.5.1ï¼Œè¡¥å……äº›è¯´æ˜ã€ç¤ºä¾‹</li>
</ul>
<h2 id="TTGSnackbar"><a href="#TTGSnackbar" class="headerlink" title="TTGSnackbar"></a>TTGSnackbar</h2><p>ç”¨Swiftå†™äº†ä¸ªç®€å•çš„æ§ä»¶åº“ï¼šTTGSnackbarï¼Œæ¨¡ä»¿Androidçš„Snackbarã€‚ç›®å‰æ›´æ–°åˆ°äº†ç‰ˆæœ¬1.3.0ã€‚æ”¯æŒå¤šç§åŠ¨ç”»ï¼Œå¢å¼ºäº†è‡ªå®šä¹‰ã€‚</p>
<p>Github: <a href="https://github.com/zekunyan/TTGSnackbar" target="_blank" rel="external">https://github.com/zekunyan/TTGSnackbar</a></p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGSnackbar_screen_shot.png" alt="Screenshot"></p>
<p><strong>Gif</strong></p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGSnackbar_example.gif?imageView2/2/w/400/q/100" alt="Screenshot"></p>
<a id="more"></a>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>éœ€è¦Swift3, Xcode8, iOS 8+  </p>
<h3 id="CocoaPods"><a href="#CocoaPods" class="headerlink" title="CocoaPods"></a>CocoaPods</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">platform <span class="symbol">:ios</span>, <span class="string">'8.0'</span></div><div class="line">use_frameworks!</div><div class="line"></div><div class="line">pod <span class="string">"TTGSnackbar"</span></div></pre></td></tr></table></figure>
<h3 id="Carthage"><a href="#Carthage" class="headerlink" title="Carthage"></a>Carthage</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">github</span> <span class="string">"zekunyan/TTGSnackbar"</span></div></pre></td></tr></table></figure>
<h2 id="ç®€å•çš„ä½¿ç”¨æ¡ˆä¾‹"><a href="#ç®€å•çš„ä½¿ç”¨æ¡ˆä¾‹" class="headerlink" title="ç®€å•çš„ä½¿ç”¨æ¡ˆä¾‹"></a>ç®€å•çš„ä½¿ç”¨æ¡ˆä¾‹</h2><h3 id="åªæ˜¾ç¤ºæ–‡å­—"><a href="#åªæ˜¾ç¤ºæ–‡å­—" class="headerlink" title="åªæ˜¾ç¤ºæ–‡å­—"></a>åªæ˜¾ç¤ºæ–‡å­—</h3><p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGSnackbar_2.png" alt="Example"></p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> snackbar = TTGSnackbar.init(message: <span class="string">"Message"</span>, duration: .Short)</div><div class="line">snackbar.<span class="keyword">show</span>()</div></pre></td></tr></table></figure>
<h3 id="æ˜¾ç¤ºæ–‡å­—å’Œä¸€ä¸ªåŠ¨ä½œæŒ‰é’®"><a href="#æ˜¾ç¤ºæ–‡å­—å’Œä¸€ä¸ªåŠ¨ä½œæŒ‰é’®" class="headerlink" title="æ˜¾ç¤ºæ–‡å­—å’Œä¸€ä¸ªåŠ¨ä½œæŒ‰é’®"></a>æ˜¾ç¤ºæ–‡å­—å’Œä¸€ä¸ªåŠ¨ä½œæŒ‰é’®</h3><p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGSnackbar_3.png" alt="Example"></p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> snackbar = TTGSnackbar.init(message: <span class="string">"Message"</span>, duration: .Middle, actionText: <span class="string">"Action"</span>)</div><div class="line">&#123; <span class="function"><span class="params">(snackbar)</span> -&gt;</span> Void <span class="keyword">in</span></div><div class="line">    NSLog(<span class="string">"Click action!"</span>)</div><div class="line">&#125;      </div><div class="line">snackbar.show()</div></pre></td></tr></table></figure>
<h3 id="æ˜¾ç¤ºæ–‡å­—å’Œä¸€ä¸ªè€—æ—¶æ“ä½œæŒ‰é’®"><a href="#æ˜¾ç¤ºæ–‡å­—å’Œä¸€ä¸ªè€—æ—¶æ“ä½œæŒ‰é’®" class="headerlink" title="æ˜¾ç¤ºæ–‡å­—å’Œä¸€ä¸ªè€—æ—¶æ“ä½œæŒ‰é’®"></a>æ˜¾ç¤ºæ–‡å­—å’Œä¸€ä¸ªè€—æ—¶æ“ä½œæŒ‰é’®</h3><p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGSnackbar_5.png" alt="Example"></p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> snackbar = TTGSnackbar.init(message: <span class="string">"Message"</span>, <span class="built_in">duration</span>: .Forever, actionText: <span class="string">"Action"</span>)</div><div class="line">&#123; (snackbar) -&gt; <span class="literal">Void</span> <span class="keyword">in</span></div><div class="line">    NSLog(<span class="string">"Click action!"</span>)</div><div class="line">    <span class="comment">// Dismiss manually after 3 seconds</span></div><div class="line">    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, Int64(<span class="number">3</span> * Double(NSEC_PER_SEC))), dispatch_get_main_queue()) &#123; () -&gt; <span class="literal">Void</span> <span class="keyword">in</span></div><div class="line">        snackbar.dismiss()</div><div class="line">    &#125;</div><div class="line">&#125;      </div><div class="line">snackbar.show()</div></pre></td></tr></table></figure>
<h3 id="æ˜¾ç¤ºæ–‡å­—å’Œä¸¤ä¸ªåŠ¨ä½œæŒ‰é’®"><a href="#æ˜¾ç¤ºæ–‡å­—å’Œä¸¤ä¸ªåŠ¨ä½œæŒ‰é’®" class="headerlink" title="æ˜¾ç¤ºæ–‡å­—å’Œä¸¤ä¸ªåŠ¨ä½œæŒ‰é’®"></a>æ˜¾ç¤ºæ–‡å­—å’Œä¸¤ä¸ªåŠ¨ä½œæŒ‰é’®</h3><p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/TTGSnackbar_9.png" alt="Example"></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">let snackbar: TTGSnackbar = TTGSnackbar.init(message: <span class="string">"Two actions !"</span>, duration: .Long)</div><div class="line"></div><div class="line"><span class="comment">// Action 1</span></div><div class="line">snackbar<span class="selector-class">.actionText</span> = <span class="string">"Yes"</span></div><div class="line">snackbar<span class="selector-class">.actionTextColor</span> = UIColor.greenColor()</div><div class="line">snackbar<span class="selector-class">.actionBlock</span> = &#123; (snackbar) <span class="keyword">in</span> NSLog(<span class="string">"Click Yes !"</span>) &#125;</div><div class="line"></div><div class="line"><span class="comment">// Action 2</span></div><div class="line">snackbar<span class="selector-class">.secondActionText</span> = <span class="string">"No"</span></div><div class="line">snackbar<span class="selector-class">.secondActionTextColor</span> = UIColor.yellowColor()</div><div class="line">snackbar<span class="selector-class">.secondActionBlock</span> = &#123; (snackbar) <span class="keyword">in</span> NSLog(<span class="string">"Click No !"</span>) &#125;</div><div class="line"></div><div class="line">snackbar.show()</div></pre></td></tr></table></figure>
<h2 id="æ˜¾ç¤ºæ–‡å­—å’Œå›¾ç‰‡ICON"><a href="#æ˜¾ç¤ºæ–‡å­—å’Œå›¾ç‰‡ICON" class="headerlink" title="æ˜¾ç¤ºæ–‡å­—å’Œå›¾ç‰‡ICON"></a>æ˜¾ç¤ºæ–‡å­—å’Œå›¾ç‰‡ICON</h2><p><img src="https://github.com/zekunyan/TTGSnackbar/raw/master/Resources/snackbar_5.jpg" alt="Example"></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">let <span class="string">snackbar:</span> TTGSnackbar = TTGSnackbar.init(<span class="string">message:</span> <span class="string">"Two actions !"</span>, <span class="string">duration:</span> .Long)</div><div class="line"></div><div class="line"><span class="comment">// Add icon image</span></div><div class="line">snackbar.icon = UIImage.init(<span class="string">named:</span> <span class="string">"emoji_cool_small"</span>)</div><div class="line"></div><div class="line">snackbar.show()</div></pre></td></tr></table></figure>
<h2 id="è‡ªå®šä¹‰"><a href="#è‡ªå®šä¹‰" class="headerlink" title="è‡ªå®šä¹‰"></a>è‡ªå®šä¹‰</h2><p>å¯ä»¥è‡ªå®šä¹‰æ–‡å­—çš„å­—ä½“ã€é¢œè‰²ï¼ŒåŠ¨ä½œæŒ‰é’®çš„å­—ä½“ã€é¢œè‰²ï¼Œå›è°ƒç­‰ç­‰ï¼Œè¯¦ç»†çš„è¯·çœ‹Githubçš„READMEè¯´æ˜ã€‚ğŸ˜Š</p>
<h2 id="æ€»ä¹‹"><a href="#æ€»ä¹‹" class="headerlink" title="æ€»ä¹‹"></a>æ€»ä¹‹</h2><p>ä¸€æ—¶å…´èµ·å†™äº†ä¸ªç®€å•çš„åº“ï¼Œåæ¥å‘ç°å±…ç„¶æœ‰äººæäº¤PRã€issueï¼Œä¸æ•¢æ€ æ…¢å•Šï¼Œä¹Ÿå°±åšæŒäº†ä¸‹æ¥ï¼Œæ–­æ–­ç»­ç»­æ›´æ–°äº†10ä¸ªå°ç‰ˆæœ¬äº†=ã€‚=ï¼ˆ2016å¹´3æœˆ25å·ï¼Œ25å‘¨å²å‰ä¸€å¤©-_-|||ï¼‰</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2016-12-25: å¢åŠ å¤šè¡Œæ–‡æœ¬çš„æ”¯æŒï¼Œå¢åŠ é˜´å½±&lt;/li&gt;
&lt;li&gt;2016-10-20: å¢åŠ ContentInsetï¼Œä¹Ÿå°±æ˜¯Paddingçš„å±æ€§ï¼›å¢åŠ è‡ªå®šä¹‰å†…å®¹View; ç‰ˆæœ¬1.3.0&lt;/li&gt;
&lt;li&gt;2016-10-17: æ”¯æŒSwift3ï¼›å¢åŠ çš„é¡¶éƒ¨Topä½ç½®åŠ¨ç”»ï¼›å¢åŠ åŒæ—¶ä¸¤ä¸ªActionæŒ‰é’®ï¼›å¢åŠ å¸¦å›¾ç‰‡iconæ˜¾ç¤º&lt;/li&gt;
&lt;li&gt;2016-03-25: ç‰ˆæœ¬æ›´æ–°åˆ°äº†0.5.1ï¼Œè¡¥å……äº›è¯´æ˜ã€ç¤ºä¾‹&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;TTGSnackbar&quot;&gt;&lt;a href=&quot;#TTGSnackbar&quot; class=&quot;headerlink&quot; title=&quot;TTGSnackbar&quot;&gt;&lt;/a&gt;TTGSnackbar&lt;/h2&gt;&lt;p&gt;ç”¨Swiftå†™äº†ä¸ªç®€å•çš„æ§ä»¶åº“ï¼šTTGSnackbarï¼Œæ¨¡ä»¿Androidçš„Snackbarã€‚ç›®å‰æ›´æ–°åˆ°äº†ç‰ˆæœ¬1.3.0ã€‚æ”¯æŒå¤šç§åŠ¨ç”»ï¼Œå¢å¼ºäº†è‡ªå®šä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;Github: &lt;a href=&quot;https://github.com/zekunyan/TTGSnackbar&quot;&gt;https://github.com/zekunyan/TTGSnackbar&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7nj2iz.com1.z0.glb.clouddn.com/TTGSnackbar_screen_shot.png&quot; alt=&quot;Screenshot&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Gif&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7nj2iz.com1.z0.glb.clouddn.com/TTGSnackbar_example.gif?imageView2/2/w/400/q/100&quot; alt=&quot;Screenshot&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="å¼€æº" scheme="http://tutuge.me/tags/%E5%BC%80%E6%BA%90/"/>
    
      <category term="Swift" scheme="http://tutuge.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°</title>
    <link href="http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/"/>
    <id>http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/</id>
    <published>2015-08-07T16:55:52.000Z</published>
    <updated>2016-08-09T16:49:36.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Masonryå†™çš„Autolayoutç¤ºä¾‹åˆæ¥äº†ï¼Œä»ç„¶æ˜¯ä¸‰ä¸ªå°ä¾‹å­ï¼Œåˆ†åˆ«æ˜¯<strong>å˜é«˜åº¦çš„UITableViewCellã€topLayoutGuideä¸bottomLayoutGuideï¼Œè¿˜æœ‰è‡ªå®šä¹‰çš„baseline</strong>ï¼Œå¤–åŠ ä¸¤ä¸ªåŸºæœ¬çš„çŸ¥è¯†ç‚¹è®²è§£ï¼Œè¯´ä¸ä¸Šâ€œæœ‰è¶£â€=ã€‚=ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œå†™äº†å¾ˆå¤šï¼Œå„ä½éšæ„çœ‹çœ‹å§~</p>
<ul>
<li>ç¬¬ä¸€ç¯‡: <a href="http://tutuge.me/2015/05/23/autolayout-example-with-masonry/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹-Masonryå®ç°</a>  </li>
<li>ç¬¬ä¸‰ç¯‡: <a href="http://tutuge.me/2015/12/14/autolayout-example-with-masonry3/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹3-Masonryå®ç°</a></li>
<li>ç¬¬å››ç¯‡: <a href="http://tutuge.me/2016/08/06/autolayout-example-with-masonry4/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹4-Masonryå®ç°</a></li>
</ul>
<p>Githubåœ°å€ï¼š<br><a href="https://github.com/zekunyan/AutolayoutExampleWithMasonry" target="_blank" rel="external">https://github.com/zekunyan/AutolayoutExampleWithMasonry</a></p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry2_1.gif" alt="Gifç¤ºä¾‹"></p>
<a id="more"></a>
<h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><p>å…ˆè®²è®²ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼Œå¾ˆåŸºç¡€ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“è¢«å¿½ç•¥ã€‚</p>
<h3 id="åæ ‡ç³»ã€topã€rightã€offset"><a href="#åæ ‡ç³»ã€topã€rightã€offset" class="headerlink" title="åæ ‡ç³»ã€topã€rightã€offset"></a>åæ ‡ç³»ã€topã€rightã€offset</h3><p>å…ˆçœ‹çœ‹Masonryçš„Githubä¸»é¡µçš„ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">UIEdgeInsets padding = UIEdgeInsetsMake(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</div><div class="line"></div><div class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.<span class="built_in">top</span>.equalTo(superview.mas_top).<span class="built_in">with</span>.offset(padding.<span class="built_in">top</span>);</div><div class="line">    make.<span class="built_in">left</span>.equalTo(superview.mas_left).<span class="built_in">with</span>.offset(padding.<span class="built_in">left</span>);</div><div class="line">    make.<span class="built_in">bottom</span>.equalTo(superview.mas_bottom).<span class="built_in">with</span>.offset(-padding.<span class="built_in">bottom</span>);</div><div class="line">    make.<span class="built_in">right</span>.equalTo(superview.mas_right).<span class="built_in">with</span>.offset(-padding.<span class="built_in">right</span>);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>ä»£ç çš„æ„æ€å¾ˆç®€å•ï¼Œå°±æ˜¯view1çš„ä¸Šä¸‹å·¦å³è¾¹è·ä¸ºpaddingå¯¹åº”çš„å€¼ã€‚</p>
<p>ä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆbottomã€rightçš„offsetæ˜¯<strong>è´Ÿæ•°</strong>å‘¢ï¼Ÿ</p>
<p>å…¶å®æ— è®ºæ˜¯Autolayoutè¿˜æ˜¯ç›´æ¥å†™frameï¼Œæœ€ç»ˆçš„ç»“æœéƒ½æ˜¯è¦æŠŠæˆ‘ä»¬çš„æ§ä»¶æŒ‰ç…§æ­£ç¡®çš„ä½ç½®ç»˜åˆ¶åœ¨å±å¹•ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªç»Ÿä¸€çš„åæ ‡ç³»ä¸‹ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry2_2.png" alt="åæ ‡ç³»"></p>
<p>è€Œåœ¨Masonryé‡Œé¢ï¼Œoffsetåªæ˜¯åšäº†â€œåŠ æ³•â€è¿ç®—ï¼Œä¸¾ä¸ªä¾‹ï¼Œä¸Šé¢çš„ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">make</span><span class="selector-class">.top</span><span class="selector-class">.equalTo</span>(<span class="selector-tag">superview</span><span class="selector-class">.mas_top</span>)<span class="selector-class">.with</span><span class="selector-class">.offset</span>(<span class="selector-tag">padding</span><span class="selector-class">.top</span>);</div></pre></td></tr></table></figure>
<p>å…¶å®ç­‰äºä¸‹é¢çš„å¼å­ï¼š</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">view1.<span class="built_in">top</span> = superview.<span class="built_in">top</span> + padding.<span class="built_in">top</span>;</div></pre></td></tr></table></figure>
<p>è½¬æ¢åˆ°åæ ‡ç³»é‡Œé¢ï¼Œå³æ˜¯ï¼š</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">view1é¡¶éƒ¨çš„yåæ ‡ = superviewé¡¶éƒ¨çš„yåæ ‡ + padding.<span class="built_in">top</span>;</div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬æƒ³view1çš„bottomè·åº•éƒ¨é—´è·ä¸º10ï¼ŒæŒ‰ç…§offsetçš„â€œåŠ æ³•è¿ç®—â€ï¼Œåº”è¯¥æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight fix"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">view1åº•éƒ¨çš„yåæ ‡ </span>=<span class="string"> superviewåº•éƒ¨çš„yåæ ‡ + (-10);</span></div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œä»£ç é‡Œé¢çš„bottomçš„offsetæ˜¯è´Ÿæ•°ã€‚rightä¹Ÿæ˜¯ä¸€ä¸ªé“ç†ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯å¸ƒå±€çš„æ—¶å€™ï¼Œå§‹ç»ˆè¦åœ¨åæ ‡ç³»ä¸‹è€ƒè™‘ã€‚</p>
<h3 id="çº¦æŸçš„â€œç­‰ä»·â€æ€§"><a href="#çº¦æŸçš„â€œç­‰ä»·â€æ€§" class="headerlink" title="çº¦æŸçš„â€œç­‰ä»·â€æ€§"></a>çº¦æŸçš„â€œç­‰ä»·â€æ€§</h3><p>è¯­æ–‡ä¸å¥½ï¼Œè¿˜æ˜¯ç”¨å…¬å¼è¯´æ˜å§=ã€‚=<br>å…ˆçœ‹çœ‹Autolayoutçš„åŸºæœ¬å…¬å¼ï¼š</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">viewA-<span class="keyword">attribute</span> = viewB-<span class="keyword">attribute</span> * multiplier + <span class="keyword">constant</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå…¬å¼ï¼Œè·Ÿä¸‹é¢çš„æ˜¯ç­‰ä»·çš„ï¼š</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">viewB-<span class="keyword">attribute</span> = (viewA-<span class="keyword">attribute</span> - <span class="keyword">constant</span>) / multiplier</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªè½¬æ¢æ˜¯å¦‚æ­¤çš„ç®€å•ï¼Œå°å­¦ç”Ÿéƒ½ä¼š=ã€‚=ï¼Œåªæ˜¯ä¸ºäº†è¯´æ˜ï¼Œæˆ‘ä»¬åœ¨è®¾ç½®çº¦æŸçš„æ—¶å€™ï¼Œæ—¢å¯ä»¥ä»ViewAçš„è§’åº¦è€ƒè™‘ï¼Œä¹Ÿå¯ä»¥ä»ViewBçš„è§’åº¦ï¼Œä¸¤è€…å®Œå…¨<strong>ç­‰ä»·</strong>ï¼ã€‚</p>
<p>è¯´ç™½äº†å°±æ˜¯ï¼šâ€œViewAè·ŸViewBç›¸è·10â€å’Œâ€œViewBè·ŸViewAç›¸è·10â€æ˜¯ä¸€æ ·çš„ï¼Œå¦‚ä¸‹ä¸¤æ®µä»£ç ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ï¼ˆæ³¨æ„æ­£è´Ÿæ•°ï¼‰ï¼š</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// View2çš„é¡¶éƒ¨è·ç¦»View1çš„åº•éƒ¨10</span></div><div class="line">[view2 mas_makeConstraints:^(MASConstraintMaker *<span class="built_in">make</span>) &#123;</div><div class="line">    <span class="built_in">make</span>.top.equalTo(view1.mas_bottom).with.offset(<span class="number">10</span>);</div><div class="line">&#125;];</div><div class="line"></div><div class="line"><span class="comment">// View1çš„åº•éƒ¨è·ç¦»View2çš„é¡¶éƒ¨10</span></div><div class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *<span class="built_in">make</span>) &#123;</div><div class="line">    <span class="built_in">make</span>.bottom.equalTo(view2.mas_top).with.offset(<span class="number">-10</span>);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>æ›´è¿›ä¸€æ­¥è¯´ï¼Œå°±æ˜¯çº¦æŸåªæ˜¯ä¸¤ä¸ªViewä¹‹é—´çš„å…³ç³»ï¼Œå¯¹äºç³»ç»Ÿæ¥è¯´ï¼ŒViewAå’ŒViewBçš„åœ°ä½æ˜¯<strong>å¹³ç­‰</strong>çš„ï¼Œæˆ‘ä»¬è®¾ç½®çº¦æŸçš„æ—¶å€™ï¼Œæ²¡æœ‰<strong>ä¸»æ¬¡</strong>ä¹‹åˆ†ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨è®¾ç½®çº¦æŸçš„æ—¶å€™ï¼Œè¦ä»â€œ<strong>æ•´ä½“</strong>â€ã€â€œ<strong>å®è§‚</strong>â€ä¸Šè€ƒè™‘ï¼Œæ›´å¥½åœ°æŠŠæ¡å¸ƒå±€ï¼Œé¿å…é‡å¤çº¦æŸã€‚</p>
<h2 id="Case-1-å˜é«˜UITableViewCell"><a href="#Case-1-å˜é«˜UITableViewCell" class="headerlink" title="Case 1: å˜é«˜UITableViewCell"></a>Case 1: å˜é«˜UITableViewCell</h2><p>å˜é«˜çš„UITableViewCellï¼Œè¿™æ˜¯ä¸ªæ°¸æ’çš„è¯é¢˜=ã€‚=</p>
<p>ä¸ç”¨Autolayoutçš„è¯ï¼Œè®¡ç®—Cellçš„é«˜åº¦çš„æ—¶å€™ï¼Œå°±åªèƒ½ç”¨sizeThatFitsç­‰æ–¹æ³•ï¼ŒåŠ ä¸Šå„ç§â€œé­”é¬¼â€æ•°æ®çš„marginã€paddingæ¥æ‰‹åŠ¨æ‹¼å‡‘å‡ºCellçš„é«˜åº¦ã€‚è¿™ç§æ–¹æ³•éå¸¸è€—æ—¶ï¼Œå¹¶ä¸”éš¾ä»¥è°ƒè¯•ã€‚</p>
<p>æœ‰äº†Autolayoutï¼Œå°±å†ä¹Ÿä¸ç”¨æ‰‹åŠ¨ç®—é«˜åº¦äº†~</p>
<h3 id="UITableViewCell"><a href="#UITableViewCell" class="headerlink" title="UITableViewCell"></a>UITableViewCell</h3><p>å…ˆçœ‹çœ‹Cellçš„çº¦æŸã€‚</p>
<h4 id="â€œè‡ªæˆ‘çº¦æŸâ€çš„Cell"><a href="#â€œè‡ªæˆ‘çº¦æŸâ€çš„Cell" class="headerlink" title="â€œè‡ªæˆ‘çº¦æŸâ€çš„Cell"></a>â€œè‡ªæˆ‘çº¦æŸâ€çš„Cell</h4><p>æ—¢ç„¶è¦èƒ½è®©ç³»ç»Ÿè‡ªå·±è®¡ç®—å‡ºCellçš„é«˜åº¦ï¼Œæˆ‘ä»¬åœ¨è®¾ç½®çº¦æŸçš„æ—¶å€™ï¼Œå°±è¦è®©çº¦æŸæ•´ä½“æ˜¯â€œå®Œæ•´â€ã€â€œè‡ªæˆ‘çº¦æŸâ€çš„ã€‚ï¼ˆè¿™ä¸ªå¾ˆéš¾ç”¨è¯­è¨€æè¿°ã€‚ã€‚ã€‚ï¼‰Cellé‡Œé¢çš„æ¯ä¸€ä¸ªViewçš„å¤§å°ã€ä½ç½®ï¼Œéƒ½å¯ä»¥ä»çº¦æŸä¸­å¾—åˆ°ä½“ç°ï¼Œè€ŒCellçš„æ•´ä½“å¤§å°ï¼Œä¹Ÿæ˜¯ä»å­Viewçš„çº¦æŸç»¼åˆè®¡ç®—å¾—å‡ºçš„ã€‚</p>
<p>å¦‚ä¸‹é¢çš„Cellï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry2_3.png" alt="Cell"></p>
<ol>
<li>å·¦ä¸Šè§’çš„å›¾ç‰‡å›ºå®šå¤§å°ã€‚</li>
<li>æ ‡é¢˜çš„Labelåªæ˜¾ç¤ºä¸€è¡Œï¼Œå›ºå®šé«˜åº¦ã€‚</li>
<li>å†…å®¹çš„Labelæ ¹æ®å†…å®¹å†³å®šé«˜åº¦ã€‚</li>
<li>ä¸¤ä¸ªLabelå®½åº¦æ•´ä½“éšç€Cellçš„å®½åº¦å˜åŒ–ã€‚</li>
</ol>
<p>çº¦æŸçš„è®¾å®šå¦‚ä¸‹ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry2_4.png" alt="çº¦æŸç¤ºæ„"></p>
<p>å…³é”®ç‚¹:</p>
<ol>
<li>å†…å®¹Labelçš„bottomå’ŒCellçš„contentViewçš„çº¦æŸä¸å¯ä»¥çœï¼Œå› ä¸ºcellçš„é«˜åº¦è¦ç”±å†…éƒ¨çš„çº¦æŸå†³å®šï¼Œæ‰€ä»¥ä¸Šä¸‹å·¦å³çš„çº¦æŸä¸€ä¸ªä¸èƒ½å°‘ã€‚</li>
<li>å†…å®¹Labelçš„é«˜åº¦éšç€å†…å®¹å˜åŒ–ï¼Œå³cellçš„é«˜åº¦éšå†…å®¹å˜åŒ–ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥è®¾ç½®Labelçš„ContentHuggingçš„ä¼˜å…ˆçº§æœ€é«˜ã€‚</li>
</ol>
<h4 id="UILabelçš„preferredMaxLayoutWidth"><a href="#UILabelçš„preferredMaxLayoutWidth" class="headerlink" title="UILabelçš„preferredMaxLayoutWidth"></a>UILabelçš„preferredMaxLayoutWidth</h4><p>Autolayoutä¸‹ï¼ŒUILabelåœ¨å¤šè¡Œæ˜¾ç¤ºæ—¶ï¼Œæœ‰ä¸ªå¾ˆâ€œå‘â€çš„å±æ€§éœ€è¦è®¾å®šï¼Œå°±æ˜¯preferredMaxLayoutWidthã€‚</p>
<p>å®šä¹‰å¦‚ä¸‹:</p>
<blockquote>
<p>This property affects the size of the label when layout constraints are applied to it. During layout, if the text extends beyond the width specified by this property, the additional text is flowed to one or more new lines, thereby increasing the height of the label.</p>
</blockquote>
<p>å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨Autolayoutè‡ªåŠ¨è®¡ç®—å¤šè¡ŒUILabelçš„é«˜åº¦ï¼Œè¿™ä¸ªå±æ€§å°±å¿…é¡»åœ¨è¿è¡Œæ—¶æŒ‡å®šï¼Œè¦ä¸ç„¶ç³»ç»Ÿè®¡ç®—ä¸å‡ºUILabelçš„å®½åº¦ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è®¡ç®—UILabelçš„preferredMaxLayoutWidthå€¼ï¼Œå¤šè¡Œæ—¶å¿…é¡»è®¾ç½®è¿™ä¸ªå€¼ï¼Œå¦åˆ™ç³»ç»Ÿæ— æ³•å†³å®šLabelçš„å®½åº¦</span></div><div class="line"><span class="selector-tag">label</span><span class="selector-class">.preferredMaxWidth</span> = [UIScreen mainScreen]<span class="selector-class">.bounds</span><span class="selector-class">.size</span><span class="selector-class">.width</span> - <span class="attribute">margin</span> - padding;</div></pre></td></tr></table></figure>
<p>æ‰‹åŠ¨è®¡ç®—å®½åº¦ï¼Œæ„Ÿè§‰å›åˆ°äº†æ²¡æœ‰Autolayoutçš„æ—¶ä»£=ã€‚=</p>
<h4 id="Cellçš„å…³é”®ä»£ç "><a href="#Cellçš„å…³é”®ä»£ç " class="headerlink" title="Cellçš„å…³é”®ä»£ç "></a>Cellçš„å…³é”®ä»£ç </h4><figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Avatar - å¤´åƒ</span></div><div class="line"><span class="variable">_avatarImageView</span> = [UIImageView new];</div><div class="line">[self.contentView addSubview:<span class="variable">_avatarImageView</span>];</div><div class="line">[<span class="variable">_avatarImageView</span> mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.width.<span class="built_in">and</span>.height.equalTo(@<span class="number">44</span>); <span class="comment">// å®½é«˜å›ºå®š</span></div><div class="line">    make.left.<span class="built_in">and</span>.top.equalTo(self.contentView).<span class="keyword">with</span>.offset(<span class="number">4</span>);</div><div class="line">&#125;];</div><div class="line"></div><div class="line"><span class="comment">// Title - å•è¡Œ</span></div><div class="line"><span class="variable">_titleLabel</span> = [UILabel new];</div><div class="line">[self.contentView addSubview:<span class="variable">_titleLabel</span>];</div><div class="line">[<span class="variable">_titleLabel</span> mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.height.equalTo(@<span class="number">22</span>); <span class="comment">// å®½é«˜å›ºå®š</span></div><div class="line">    make.top.equalTo(self.contentView).<span class="keyword">with</span>.offset(<span class="number">4</span>);</div><div class="line">    make.left.equalTo(<span class="variable">_avatarImageView</span>.mas_right).<span class="keyword">with</span>.offset(<span class="number">4</span>);</div><div class="line">    make.right.equalTo(self.contentView).<span class="keyword">with</span>.offset(-<span class="number">4</span>);</div><div class="line">&#125;];</div><div class="line"></div><div class="line"><span class="comment">// è®¡ç®—UILabelçš„preferredMaxLayoutWidthå€¼ï¼Œå¤šè¡Œæ—¶å¿…é¡»è®¾ç½®è¿™ä¸ªå€¼ï¼Œå¦åˆ™ç³»ç»Ÿæ— æ³•å†³å®šLabelçš„å®½åº¦</span></div><div class="line">CGFloat preferredMaxWidth = [UIScreen mainScreen].bounds.<span class="built_in">size</span>.width - (<span class="number">16</span> + <span class="number">4</span>) * <span class="number">2</span> - <span class="number">44</span> - <span class="number">4</span>;</div><div class="line"></div><div class="line"><span class="comment">// Content - å¤šè¡Œ</span></div><div class="line"><span class="variable">_contentLabel</span> = [UILabel new];</div><div class="line"><span class="variable">_contentLabel</span>.numberOfLines = <span class="number">0</span>;</div><div class="line"><span class="variable">_contentLabel</span>.preferredMaxLayoutWidth = preferredMaxWidth; <span class="comment">// å¤šè¡Œæ—¶å¿…é¡»è®¾ç½®</span></div><div class="line">[self.contentView addSubview:<span class="variable">_contentLabel</span>];</div><div class="line"></div><div class="line">[<span class="variable">_contentLabel</span> mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.top.equalTo(<span class="variable">_titleLabel</span>.mas_bottom).<span class="keyword">with</span>.offset(<span class="number">4</span>);</div><div class="line">    make.left.equalTo(<span class="variable">_avatarImageView</span>.mas_right).<span class="keyword">with</span>.offset(<span class="number">4</span>);</div><div class="line">    make.right.equalTo(self.contentView).<span class="keyword">with</span>.offset(-<span class="number">4</span>);</div><div class="line">    make.bottom.equalTo(self.contentView).<span class="keyword">with</span>.offset(-<span class="number">4</span>);</div><div class="line">&#125;];</div><div class="line"><span class="comment">// è®¾ç½®é«˜åº¦çš„Content Hugging</span></div><div class="line">[<span class="variable">_contentLabel</span> setContentHuggingPriority:UILayoutPriorityRequired forAxis:UILayoutConstraintAxisVertical];</div></pre></td></tr></table></figure>
<h3 id="UITableView"><a href="#UITableView" class="headerlink" title="UITableView"></a>UITableView</h3><p>å†çœ‹çœ‹UITableViewã€‚</p>
<h4 id="ç”¨systemLayoutSizeFittingSize-è·å–Cellçš„é«˜åº¦"><a href="#ç”¨systemLayoutSizeFittingSize-è·å–Cellçš„é«˜åº¦" class="headerlink" title="ç”¨systemLayoutSizeFittingSize:è·å–Cellçš„é«˜åº¦"></a>ç”¨systemLayoutSizeFittingSize:è·å–Cellçš„é«˜åº¦</h4><p>åœ¨è®¾å®šå¥½Cellçš„çº¦æŸä»¥åï¼Œå°±å¯ä»¥ç”¨systemLayoutSizeFittingSize:æ–¹æ³•è·å–Cellçš„å®é™…é«˜åº¦ï¼Œå®ƒçš„å‚æ•°å¯ä»¥è®¾å®šä¸ºä¸¤ä¸ªç³»ç»Ÿå¸¸é‡ï¼Œå¦‚ä¸‹ï¼š</p>
<ol>
<li>UILayoutFittingCompressedSize: è¿”å›åˆé€‚çš„æœ€å°å¤§å°ã€‚</li>
<li>UILayoutFittingExpandedSize: è¿”å›åˆé€‚çš„æœ€å¤§å¤§å°ã€‚</li>
</ol>
<h4 id="æ¨¡æ¿Cell"><a href="#æ¨¡æ¿Cell" class="headerlink" title="æ¨¡æ¿Cell"></a>æ¨¡æ¿Cell</h4><p>ä¸ºäº†åœ¨<code>- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath</code>æ–¹æ³•ä¸­è®¡ç®—Cellçš„é«˜åº¦ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸“é—¨ç”¨äºè®¡ç®—é«˜åº¦çš„Cellå®ä¾‹ï¼Œå¯ä»¥è¯´ç®—æ˜¯Cellçš„â€œæ¨¡æ¿â€ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªå®ä¾‹å¯ä»¥è®¾ç½®æˆå‡½æ•°çš„staticå˜é‡ï¼Œå¹¶åªåœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶åˆå§‹åŒ–ä¸€æ¬¡ã€‚</p>
<h4 id="ç®€å•ç¼“å­˜é«˜åº¦"><a href="#ç®€å•ç¼“å­˜é«˜åº¦" class="headerlink" title="ç®€å•ç¼“å­˜é«˜åº¦"></a>ç®€å•ç¼“å­˜é«˜åº¦</h4><p>ä¸ºäº†é¿å…æ¯æ¬¡æ»‘åŠ¨æ—¶è®¡ç®—é«˜åº¦ï¼Œå¯ä»¥å°†Cellçš„é«˜åº¦ç¼“å­˜ä¸‹æ¥ã€‚å¦‚ï¼Œä¿å­˜åœ¨æ¯ä¸€è¡Œå¯¹åº”çš„æ•°æ®Model(Entity)ä¸­ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@interface</span> <span class="attribute">Entity </span>: NSObject</div><div class="line"><span class="comment">// Data</span></div><div class="line"><span class="variable">@property</span> (copy, nonatomic) NSString *title;</div><div class="line"><span class="comment">// ...</span></div><div class="line"><span class="comment">// Cache height</span></div><div class="line"><span class="variable">@property</span> (assign, nonatomic) CGFloat cellHeight;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>æ¯æ¬¡è¦è·å–é«˜åº¦æ—¶ï¼Œå°±å¯ä»¥å…ˆæ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æœ‰ç¼“å­˜ï¼Œå‡å°‘è®¡ç®—é‡ã€‚</p>
<h4 id="è®¾ç½®estimatedRowHeightä»¥å‡å°‘é¦–æ¬¡æ˜¾ç¤ºçš„è®¡ç®—é‡"><a href="#è®¾ç½®estimatedRowHeightä»¥å‡å°‘é¦–æ¬¡æ˜¾ç¤ºçš„è®¡ç®—é‡" class="headerlink" title="è®¾ç½®estimatedRowHeightä»¥å‡å°‘é¦–æ¬¡æ˜¾ç¤ºçš„è®¡ç®—é‡"></a>è®¾ç½®estimatedRowHeightä»¥å‡å°‘é¦–æ¬¡æ˜¾ç¤ºçš„è®¡ç®—é‡</h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œé¦–æ¬¡æ˜¾ç¤ºä¹‹å‰ï¼Œç³»ç»Ÿéƒ½ä¼šä¸€æ¬¡æ€§å…¨éƒ¨è®¡ç®—å‡ºæ‰€æœ‰Cellçš„é«˜åº¦ï¼Œè¿™ç®€ç›´ä¸èƒ½å¿å•Šï¼è¦æ˜¯æœ‰10000è¡Œï¼Œé‚£å²‚ä¸æ˜¯è¦å¡æ­»=ã€‚=</p>
<p>æ‰€ä»¥iOS 7ä»¥åï¼ŒUITableViewæœ‰äº†ä¸€ä¸ªæ–°çš„å±æ€§ï¼šestimatedRowHeightã€‚</p>
<p>ä»å±æ€§åä¸Šå°±å¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ªå±æ€§å¯ä»¥ä¸ºCellé¢„å…ˆæŒ‡å®šä¸€ä¸ªâ€œä¼°è®¡â€çš„é«˜åº¦å€¼ï¼Œè¿™æ ·çš„è¯ï¼Œç³»ç»Ÿå°±å¯ä»¥å…ˆæŒ‰ç…§ä¼°è®¡å€¼å¸ƒå±€ï¼Œç„¶ååªè·å–æ˜¾ç¤ºèŒƒå›´å†…çš„Cellçš„é«˜åº¦ï¼Œè¿™æ ·å°±ä¸ä¼šä¸€æ¬¡æ€§è®¡ç®—å…¨éƒ¨çš„äº†ã€‚</p>
<h4 id="å…³é”®ä»£ç "><a href="#å…³é”®ä»£ç " class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    <span class="keyword">static</span> Case4Cell *templateCell;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        templateCell = [tableView dequeueReusableCellWithIdentifier:<span class="built_in">NSStringFromClass</span>([Case4Cell <span class="keyword">class</span>])];</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="comment">// è·å–å¯¹åº”çš„æ•°æ®</span></div><div class="line">    Case4DataEntity *dataEntity = _data[(<span class="built_in">NSUInteger</span>) indexPath.row];</div><div class="line"></div><div class="line">    <span class="comment">// å¡«å……æ•°æ®</span></div><div class="line">    [templateCell setupData:dataEntity];</div><div class="line"></div><div class="line">    <span class="comment">// åˆ¤æ–­é«˜åº¦æ˜¯å¦å·²ç»è®¡ç®—è¿‡</span></div><div class="line">    <span class="keyword">if</span> (dataEntity.cellHeight &lt;= <span class="number">0</span>) &#123;</div><div class="line">        <span class="comment">// æ ¹æ®å½“å‰æ•°æ®ï¼Œè®¡ç®—Cellçš„é«˜åº¦ï¼Œæ³¨æ„+1</span></div><div class="line">        dataEntity.cellHeight = [templateCell.contentView systemLayoutSizeFittingSize:<span class="built_in">UILayoutFittingCompressedSize</span>].height + <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> dataEntity.cellHeight;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="iOS-8çš„æ–°ç‰¹æ€§"><a href="#iOS-8çš„æ–°ç‰¹æ€§" class="headerlink" title="iOS 8çš„æ–°ç‰¹æ€§"></a>iOS 8çš„æ–°ç‰¹æ€§</h3><p>iOS 8å¤§å¤§ç®€åŒ–äº†Cellçš„é«˜åº¦è®¡ç®—ï¼Œåªè¦è®¾ç½®å¥½Cellçš„çº¦æŸï¼Œæ·»åŠ ä¸‹é¢å‡ è¡Œä»£ç ï¼š</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">tableView.rowHeight = UITableViewAutomaticDimension<span class="comment">;</span></div><div class="line">tableView.estimatedRowHeight = <span class="number">80</span><span class="comment">;</span></div></pre></td></tr></table></figure>
<p>ç„¶åï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="built_in">CGFloat</span>)tableView:(<span class="built_in">UITableView</span> *)tableView heightForRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath &#123;</div><div class="line">    <span class="comment">// åªç”¨è¿”å›è¿™ä¸ªï¼</span></div><div class="line">    <span class="keyword">return</span> <span class="built_in">UITableViewAutomaticDimension</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯¹ï¼å°±åªç”¨è¿™ä¹ˆå‡ è¡Œä»£ç å°±è¡Œï¼</p>
<h2 id="Case-2-topLayoutGuideå’ŒbottomLayoutGuide"><a href="#Case-2-topLayoutGuideå’ŒbottomLayoutGuide" class="headerlink" title="Case 2: topLayoutGuideå’ŒbottomLayoutGuide"></a>Case 2: topLayoutGuideå’ŒbottomLayoutGuide</h2><h3 id="æ˜¯ä»€ä¹ˆ"><a href="#æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ˜¯ä»€ä¹ˆ"></a>æ˜¯ä»€ä¹ˆ</h3><p>topLayoutGuideå’ŒbottomLayoutGuideéƒ½æ˜¯iOS 7ä»¥åï¼ŒUIViewControllerçš„å±æ€§ã€‚</p>
<p>åœ¨æ–‡æ¡£ã€å¤´æ–‡ä»¶ä¸­ï¼ŒtopLayoutGuideå’ŒbottomLayoutGuideçš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">retain</span>) <span class="keyword">id</span>&lt;<span class="built_in">UILayoutSupport</span>&gt; topLayoutGuide <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">7</span>_0);</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">readonly</span>,<span class="keyword">retain</span>) <span class="keyword">id</span>&lt;<span class="built_in">UILayoutSupport</span>&gt; bottomLayoutGuide <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">7</span>_0);</div></pre></td></tr></table></figure>
<p>è€ŒUILayoutSupportçš„å®šä¹‰æ›´æ˜¯ç®€å•ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@protocol</span> UILayoutSupport &lt;NSObject&gt;</div><div class="line"><span class="variable">@property</span>(nonatomic,readonly) CGFloat length;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p><strong>ä»¥topLayoutGuideä¸ºä¾‹</strong>ï¼š</p>
<blockquote>
<p>The topLayoutGuide property comes into play when a view controller is frontmost onscreen. It indicates the highest vertical extent for content that you donâ€™t want to appear behind a translucent or transparent UIKit bar (such as a status or navigation bar). This property implements the UILayoutSupport protocol and you can employ it as a constraint item when using the NSLayoutConstraint class.</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼ŒtopLayoutGuideè¡¨ç¤ºå½“å‰é¡µé¢çš„ä¸Šæ–¹è¢«status barã€navigation baré®æŒ¡çš„éƒ¨åˆ†ã€‚åŒç†ï¼ŒbottomLayoutGuideè¡¨ç¤ºä¸‹æ–¹è¢«é®æŒ¡çš„éƒ¨åˆ†ã€‚</p>
<p>å¦‚ä¸‹å›¾:  </p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry2_5.jpg?imageView2/0/w/400/q/100" alt="topLayoutGuideå’ŒbottomLayoutGuide"></p>
<h3 id="è§£å†³çš„é—®é¢˜"><a href="#è§£å†³çš„é—®é¢˜" class="headerlink" title="è§£å†³çš„é—®é¢˜"></a>è§£å†³çš„é—®é¢˜</h3><p>æœ‰äº›æ—¶å€™ï¼Œä¸€ä¸ªViewControllerå¯èƒ½å•ç‹¬æ˜¾ç¤ºå‡ºæ¥ï¼Œä¹Ÿå¯èƒ½å†…åµŒåœ¨UINavigationControlleré‡Œé¢æ˜¾ç¤ºå‡ºæ¥ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œé¡µé¢çš„â€œ<strong>å¯è§†èŒƒå›´</strong>â€æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¾ˆæ˜æ˜¾ï¼ŒNavigationBarä¼šé®æŒ¡ä½ä¸€éƒ¨åˆ†ï¼Œç”¨äº†UITabBarControlleræ—¶ï¼ŒtabBarä¹Ÿä¼šé®æŒ¡ä½ä¸‹æ–¹ä¸€éƒ¨åˆ†ã€‚å†åŠ ä¸Šå„ç§Baréƒ½å¯ä»¥éšè—ï¼Œæƒ…å†µä¼šå˜å¾—æ›´å¤æ‚ã€‚</p>
<p>éš¾é“è¦ä¸ºæ¯ç§æƒ…å†µå»å†™ä¸€ä»½å¸ƒå±€ä»£ç ï¼Ÿ</p>
<h3 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨"></a>å¦‚ä½•ä½¿ç”¨</h3><p>ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå°±éœ€è¦åœ¨è®¾ç½®çº¦æŸæ—¶ï¼ŒåŠ è¿›topLayoutGuideå’ŒbottomLayoutGuideã€‚</p>
<h4 id="ç”¨æ³•1-å¼ºåˆ¶è½¬æ¢ä¸ºUIView"><a href="#ç”¨æ³•1-å¼ºåˆ¶è½¬æ¢ä¸ºUIView" class="headerlink" title="ç”¨æ³•1: å¼ºåˆ¶è½¬æ¢ä¸ºUIView"></a>ç”¨æ³•1: å¼ºåˆ¶è½¬æ¢ä¸ºUIView</h4><p>å®šä¹‰ä¸Šï¼ŒtopLayoutGuideå’ŒbottomLayoutGuideéƒ½æ˜¯idï¼Œä½†æ˜¯å®é™…ä¸­æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè·ŸUIViewæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ<br>çœ‹çœ‹å¦‚ä¸‹ä»£ç çš„è¿è¡Œç»“æœï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"%d"</span>, [<span class="keyword">self</span>.topLayoutGuide isKindOfClass:[<span class="built_in">UIView</span> <span class="keyword">class</span>]]);</div></pre></td></tr></table></figure>
<p>ç»“æœæ˜¯ï¼šâ€1â€</p>
<p><strong>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿è¡ŒæœŸé—´ï¼ŒtopLayoutGuideå’ŒbottomLayoutGuideå°±æ˜¯UIViewçš„å­ç±»</strong>ã€‚</p>
<p>æ‰€ä»¥ï¼Œç¬¬ä¸€ç§æ–¹æ³•å°±æ˜¯å¼ºåˆ¶è½¬æ¢æˆUIViewï¼Œç›´æ¥è¿ç”¨åœ¨Masonryçš„çº¦æŸé‡Œé¢ï¼Œæ­£å¦‚è¾ƒæ—§çš„Masonryå®˜æ–¹ç¤ºä¾‹ä¸­çš„ä¸€æ ·ï¼š</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[topView makeConstraints:^(<span class="name">MASConstraintMaker</span> *make) &#123;</div><div class="line">    // å¼ºåˆ¶è½¬æ¢</div><div class="line">    UIView *topLayoutGuide = (<span class="name">id</span>)self.topLayoutGuide;</div><div class="line">    make.top.equalTo(<span class="name">topLayoutGuide.mas_bottom</span>)<span class="comment">;</span></div><div class="line">    // ...</div><div class="line">&#125;]<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯è¿™æ ·å­˜åœ¨ç€é£é™©ï¼Œä¸‡ä¸€å“ªå¤©è‹¹æœæ”¹å˜äº†topLayoutGuideå’ŒbottomLayoutGuideçš„å®ç°æ–¹æ³•ï¼Œè¿™ä¹ˆç”¨å°±Crashäº†=ã€‚=</p>
<h4 id="ç”¨æ³•2-ç›´æ¥ä½¿ç”¨lengthå±æ€§"><a href="#ç”¨æ³•2-ç›´æ¥ä½¿ç”¨lengthå±æ€§" class="headerlink" title="ç”¨æ³•2: ç›´æ¥ä½¿ç”¨lengthå±æ€§"></a>ç”¨æ³•2: ç›´æ¥ä½¿ç”¨lengthå±æ€§</h4><p>ç¬¬äºŒç§æ–¹æ³•ï¼Œå°±æ˜¯ç›´æ¥ä½¿ç”¨UILayoutSupportå®šä¹‰çš„lengthå±æ€§ã€‚<br>è¿™ä¸ªæ—¶å€™å°±æœ‰ä¸ªåœ°æ–¹è¦ç‰¹åˆ«æ³¨æ„ï¼Œåœ¨è¿è¡Œåˆ°viewDidLoadçš„æ—¶å€™ï¼Œlengthçš„å€¼æ˜¯0ï¼Œå› ä¸ºè¿™ä¸ªæ—¶å€™ç•Œé¢è¿˜æ²¡æœ‰è¢«ç»˜åˆ¶ï¼Œæ‰€ä»¥ä¸€ä¸ªè§£å†³æ–¹æ³•å°±æ˜¯åœ¨ViewControllerçš„<strong>updateViewConstraints</strong>æ–¹æ³•é‡Œé¢å»ä½¿ç”¨lengthå€¼æ·»åŠ çº¦æŸã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight roboconf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (void)updateViewConstraints &#123;</div><div class="line">    [<span class="attribute">_topView mas_updateConstraints</span>:^(MASConstraintMaker *make) &#123;</div><div class="line">        // ç›´æ¥åˆ©ç”¨å…¶lengthå±æ€§</div><div class="line">        make<span class="variable">.top</span><span class="variable">.equalTo</span>(self<span class="variable">.view</span><span class="variable">.mas_top</span>)<span class="variable">.with</span><span class="variable">.offset</span>(self<span class="variable">.topLayoutGuide</span><span class="variable">.length</span>);</div><div class="line">    &#125;];</div><div class="line"></div><div class="line">    [super updateViewConstraints];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="ç”¨æ³•3-ä½¿ç”¨æ–°ç‰ˆçš„mas-topLayoutGuideå’Œmas-bottomLayoutGuide"><a href="#ç”¨æ³•3-ä½¿ç”¨æ–°ç‰ˆçš„mas-topLayoutGuideå’Œmas-bottomLayoutGuide" class="headerlink" title="ç”¨æ³•3: ä½¿ç”¨æ–°ç‰ˆçš„mas_topLayoutGuideå’Œmas_bottomLayoutGuide"></a>ç”¨æ³•3: ä½¿ç”¨æ–°ç‰ˆçš„mas_topLayoutGuideå’Œmas_bottomLayoutGuide</h4><p>åœ¨<a href="https://github.com/SnapKit/Masonry/commit/c99e65c2eb40a02106d87a1487f96c0f4b1b72c0" target="_blank" rel="external">Masonryçš„æ–°ç‰ˆ</a>ä¸­ï¼Œä¸ºUIViewControllerå¢åŠ äº†ä¸€ä¸ªæ–°çš„Category: <code>MASAdditions</code>ï¼Œå¢åŠ äº†<code>mas_topLayoutGuide</code>å’Œ<code>mas_bottomLayoutGuide</code>ä¸¤ä¸ªæ–¹æ³•ï¼Œè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¼˜é›…çš„ä½¿ç”¨topLayoutGuideå’ŒbottomLayoutGuideäº†~</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[_topView mas_makeConstraints:^(<span class="name">MASConstraintMaker</span> *make) &#123;</div><div class="line">    // ä¸ç”¨å¼ºåˆ¶è½¬æ¢ï¼Œä¹Ÿä¸ç”¨åœ¨updateViewConstraintsé‡Œé¢æ›´æ–°äº†</div><div class="line">    make.top.equalTo(<span class="name">self.mas_topLayoutGuide</span>)<span class="comment">;</span></div><div class="line">    // ...</div><div class="line">&#125;]<span class="comment">;</span></div></pre></td></tr></table></figure>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><p>ç›´æ¥çœ‹Demoå§ï¼Œæ¯”è¾ƒç®€å•ã€‚</p>
<h2 id="Case-3-è‡ªå®šä¹‰baseline"><a href="#Case-3-è‡ªå®šä¹‰baseline" class="headerlink" title="Case 3: è‡ªå®šä¹‰baseline"></a>Case 3: è‡ªå®šä¹‰baseline</h2><p>æœ€åä¸€ä¸ªCaseï¼Œè®²è®²baselineã€‚  </p>
<p>baselineï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯â€œåŸºçº¿â€ï¼Œåœ¨Autolayouté‡Œé¢å¯¹åº”ç€<strong><code>NSLayoutFormatAlignAllBaseline</code></strong>ï¼Œä¹Ÿæ˜¯ä¸€ç§å¯¹é½çš„æ ‡å‡†ã€‚ä¾‹å¦‚ï¼ŒUIButtonçš„baselineå°±æ˜¯å†…éƒ¨çš„æ–‡å­—ï¼Œå¦‚æœä¸€æ’buttonæŒ‰ç…§baselineå¯¹é½çš„è¯ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry2_6.jpg" alt="æŒ‰é’®æŒ‰ç…§baselineå¯¹å…¶"></p>
<p>å¯¹äºè‡ªå®šä¹‰çš„Viewæ¥è¯´ï¼Œbaselineé»˜è®¤å°±æ˜¯æ•´ä¸ªviewçš„åº•éƒ¨ï¼Œå¦‚æœæƒ³æ”¹å˜baselineçš„è¯ï¼Œå¯ä»¥é‡å†™UIViewçš„<strong>viewForBaselineLayout</strong>ï¼Œè¿”å›å½“æˆbaselineçš„viewå³å¯ã€‚</p>
<p>å¦‚ä¸‹é¢çš„è‡ªå®šä¹‰viewï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry2_7.jpg" alt="è‡ªå®šä¹‰baseline"></p>
<p>å¾ˆæ˜æ˜¾ï¼Œbaselineå°±æ˜¯æ˜¾ç¤ºå›¾ç‰‡çš„UIImageViewï¼Œä»£ç ä¹Ÿå¾ˆç®€å•:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è‡ªå®šä¹‰çš„Viewä¸­</span></div><div class="line"><span class="comment">// è¿”å›è‡ªå®šä¹‰çš„baselineçš„view</span></div><div class="line">- (UIView *)viewForBaselineLayout &#123;</div><div class="line">    <span class="keyword">return</span> _imageView;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>çµæ´»çš„ä½¿ç”¨baselineï¼Œå¯ä»¥æ›´åŠ æ–¹ä¾¿çš„è¿›è¡Œå¸ƒå±€ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å†™äº†å¥½é•¿ï¼Œèƒ½å…¨éƒ¨çœ‹å®Œçš„æœ‹å‹ï¼Œå—¯ï¼Œä½ æ˜¯ä¸ªä¼˜ç§€çš„ç¨‹åºå‘˜=ã€‚=</p>
<p>åé¢æ‰“ç®—ç”¨Swiftçš„SnapKitæŠŠæ‰€æœ‰çš„Caseå…¨éƒ¨å®ç°ä¸€æ¬¡ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="http://chun.tips/blog/2014/10/23/xi-shu-autolayoutyi-lai-uiviewhe-uiviewcontrollerxin-zeng-de-xiang-guan-api-uiviewpian/" target="_blank" rel="external">ç»†æ•°AutoLayoutä»¥æ¥UIViewå’ŒUIViewControlleræ–°å¢çš„ç›¸å…³API â€“ UIViewç¯‡</a></li>
<li><a href="https://developer.apple.com/library/ios/qa/qa1797/_index.html" target="_blank" rel="external">Preventing the Status Bar from Covering Your Views</a></li>
<li><a href="http://www.objc.io/issues/3-views/advanced-auto-layout-toolbox/#intrinsic-content-size" target="_blank" rel="external">Advanced Auto Layout Toolbox</a></li>
<li><a href="http://chun.tips/blog/2014/10/25/xi-shu-autolayoutyi-lai-uiviewhe-uiviewcontrollerxin-zeng-de-xiang-guan-api-uiviewcontrollerpian/" target="_blank" rel="external">ç»†æ•°AutoLayoutä»¥æ¥UIViewå’ŒUIViewControlleræ–°å¢çš„ç›¸å…³API â€“ UIViewControllerç¯‡</a></li>
<li><a href="http://www.wugaojun.com/blog/2015/05/24/autolayoutshi-zhan-cellgao-du-bu-gu-ding-de-uitableview/" target="_blank" rel="external">AutoLayoutå®æˆ˜:cellé«˜åº¦ä¸å›ºå®šçš„UITableView</a></li>
<li><a href="http://www.jianshu.com/p/d5d897ffe118" target="_blank" rel="external">AutoLayoutä¸‹å¤šè¡ŒUILabelæ— æ³•æ˜¾ç¤ºå¤šè¡Œæ–‡æœ¬çš„é—®é¢˜</a></li>
<li><a href="https://grayluo.github.io/WeiFocusIo/autolayout/2015/02/01/autolayout5/" target="_blank" rel="external">AutoLayoutæ·±å…¥æµ…å‡ºäº”-UITableViewåŠ¨æ€é«˜åº¦</a></li>
<li><a href="http://www.brynbodayle.com/faster-uitableviews-with-ios-7/" target="_blank" rel="external">Faster UITableViews with iOS 7</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;Masonryå†™çš„Autolayoutç¤ºä¾‹åˆæ¥äº†ï¼Œä»ç„¶æ˜¯ä¸‰ä¸ªå°ä¾‹å­ï¼Œåˆ†åˆ«æ˜¯&lt;strong&gt;å˜é«˜åº¦çš„UITableViewCellã€topLayoutGuideä¸bottomLayoutGuideï¼Œè¿˜æœ‰è‡ªå®šä¹‰çš„baseline&lt;/strong&gt;ï¼Œå¤–åŠ ä¸¤ä¸ªåŸºæœ¬çš„çŸ¥è¯†ç‚¹è®²è§£ï¼Œè¯´ä¸ä¸Šâ€œæœ‰è¶£â€=ã€‚=ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œå†™äº†å¾ˆå¤šï¼Œå„ä½éšæ„çœ‹çœ‹å§~&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ç¯‡: &lt;a href=&quot;http://tutuge.me/2015/05/23/autolayout-example-with-masonry/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹-Masonryå®ç°&lt;/a&gt;  &lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰ç¯‡: &lt;a href=&quot;http://tutuge.me/2015/12/14/autolayout-example-with-masonry3/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹3-Masonryå®ç°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ç¬¬å››ç¯‡: &lt;a href=&quot;http://tutuge.me/2016/08/06/autolayout-example-with-masonry4/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹4-Masonryå®ç°&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Githubåœ°å€ï¼š&lt;br&gt;&lt;a href=&quot;https://github.com/zekunyan/AutolayoutExampleWithMasonry&quot;&gt;https://github.com/zekunyan/AutolayoutExampleWithMasonry&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7nj2iz.com1.z0.glb.clouddn.com/blog_autolayout_example_with_masonry2_1.gif&quot; alt=&quot;Gifç¤ºä¾‹&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="Autolayout" scheme="http://tutuge.me/tags/Autolayout/"/>
    
      <category term="Masonry" scheme="http://tutuge.me/tags/Masonry/"/>
    
  </entry>
  
  <entry>
    <title>è§£å†³iOSé¡¹ç›®çš„ç‰ˆæœ¬å…¼å®¹é—®é¢˜-ç»“åˆå®ã€Categoryå’ŒRuntime</title>
    <link href="http://tutuge.me/2015/07/25/compatibility-with-macro-category-and-runtime/"/>
    <id>http://tutuge.me/2015/07/25/compatibility-with-macro-category-and-runtime/</id>
    <published>2015-07-24T16:39:03.000Z</published>
    <updated>2016-08-07T06:08:13.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><h3 id="2015-11-16"><a href="#2015-11-16" class="headerlink" title="2015-11-16"></a>2015-11-16</h3><p>æ„Ÿè°¢å¾®åšå¥½å‹<strong>@zyyy_000</strong>çš„è¯„è®ºï¼Œè¡¥å……äº†ä¸ºä»€ä¹ˆè¦åœ¨<code>+ (void)load</code>æ–¹æ³•é‡Œé¢åš<strong>Method Swizzling</strong>ã€‚</p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘ï¼Œåœ¨åšé¡¹ç›®æ—¶ï¼Œå› ä¸ºæŸç§åŸå› ï¼Œçªç„¶è¦â€œé€‚é…â€iOS6ï¼ˆä¹Ÿæ˜¯é†‰äº†ã€‚ã€‚ã€‚ï¼‰ï¼Œä¿è¯æå°‘æ•°çš„iOS6ç”¨æˆ·å¯ä»¥â€œç”¨ä¸Šâ€æ–°çš„ç‰ˆæœ¬ã€‚å“ªæ€•ç•Œé¢ä¸Šæœ‰ç‘•ç–µï¼Œåªè¦åŠŸèƒ½æ­£å¸¸å°±è¡Œã€‚äºæ˜¯å°±åªå¥½èŠ±å‡ å¤©æ—¶é—´å¯¹iOS6è¿›è¡Œç´§æ€¥é€‚é…ï¼ˆå¿ƒä¸­ä¸€ä¸‡å¤´é©¼ç¾Šå¥”è·‘è€Œè¿‡ã€‚ã€‚ã€‚ï¼‰</p>
<p>æœ¬æ–‡æ€»ç»“äº†ä¸€äº›å¸¸è§„çš„ï¼Œå’Œâ€œéå¸¸è§„â€çš„iOSé¡¹ç›®å‘è€ç‰ˆæœ¬å…¼å®¹çš„åŠæ³•ï¼Œç»“åˆäº†<strong>å®å®šä¹‰</strong>ã€<strong>Category</strong>å’Œ<strong>Runtime</strong>ï¼Œå¤§å®¶çœ‹ç€æ¶ˆé£ä¸€ä¸‹å°±å¥½å“ˆ~</p>
<a id="more"></a>
<h2 id="é‡ç‚¹æ¦‚å¿µ"><a href="#é‡ç‚¹æ¦‚å¿µ" class="headerlink" title="é‡ç‚¹æ¦‚å¿µ"></a>é‡ç‚¹æ¦‚å¿µ</h2><p>é¦–å…ˆå¼ºè°ƒä¸€äº›æ¦‚å¿µã€‚</p>
<h3 id="Deployment-Target-å’Œ-Base-SDK"><a href="#Deployment-Target-å’Œ-Base-SDK" class="headerlink" title="Deployment Target å’Œ Base SDK"></a>Deployment Target å’Œ Base SDK</h3><p><strong>Deployment Target</strong></p>
<p>æŒ‡çš„æ˜¯ä½ çš„APPèƒ½æ”¯æŒçš„æœ€ä½ç³»ç»Ÿç‰ˆæœ¬ï¼Œå¦‚è¦æ”¯æŒiOS6ä»¥ä¸Šï¼Œå°±è®¾ç½®æˆiOS6å³å¯ã€‚</p>
<p><strong>Base SDK</strong></p>
<p>æŒ‡çš„æ˜¯ç”¨æ¥ç¼–è¯‘APPçš„SDKï¼ˆSoftware Development Kitï¼‰çš„ç‰ˆæœ¬ï¼Œä¸€èˆ¬ä¿æŒå½“å‰XCodeæ”¯æŒçš„æœ€æ–°çš„å°±å¥½ï¼Œå¦‚iOS8.4ã€‚SDKå…¶å®å°±æ˜¯åŒ…å«äº†æ‰€æœ‰çš„ä½ è¦ç”¨åˆ°çš„å¤´æ–‡ä»¶ã€é“¾æ¥åº“çš„é›†åˆï¼Œä½ çš„APPé‡Œé¢ç”¨çš„å„ç§ç±»ã€å‡½æ•°ï¼Œèƒ½ç¼–è¯‘ã€é“¾æ¥æˆæœ€åçš„å®‰è£…åŒ…ï¼Œå°±è¦é å®ƒï¼Œè‹¹æœæ¯æ¬¡å‡çº§ç³»ç»Ÿï¼Œæ–°æ¨å‡ºçš„å„ç§APIï¼Œä¹Ÿæ˜¯åœ¨SDKé‡Œé¢ã€‚æ‰€ä»¥ä¸€èˆ¬Base SDKè‚¯å®šæ˜¯å¤§äºç­‰äºDeployment Targetçš„ç‰ˆæœ¬ã€‚</p>
<p><strong>åŒºåˆ†</strong></p>
<p>æ—¢ç„¶Base SDKçš„ç‰ˆæœ¬å¤§äºç­‰äºDeployment Targetçš„ç‰ˆæœ¬ï¼Œé‚£ä¹ˆå°±è¦å°å¿ƒäº†ï¼Œå› ä¸º<strong>â€œåªè¦ç”¨åˆ°çš„ç±»ã€æ–¹æ³•ï¼Œåœ¨å½“å‰çš„Base SDKç‰ˆæœ¬é‡Œé¢å­˜åœ¨ï¼Œå°±å¯ä»¥<em>ç¼–è¯‘é€šè¿‡</em>ï¼ä½†æ˜¯ä¸€æ—¦è¿è¡ŒAPPçš„æ‰‹æœºçš„ç³»ç»Ÿç‰ˆæœ¬ä½äºè¿™äº›ç±»ã€æ–¹æ³•çš„æœ€ä½ç‰ˆæœ¬è¦æ±‚ï¼ŒAPPå°±ä¼šCrashï¼â€</strong></p>
<p>æ‰€ä»¥å¹¶ä¸æ˜¯è¯´ï¼Œèƒ½ç¼–è¯‘é€šè¿‡çš„ï¼Œå°±ä¸€å®šèƒ½<em>è¿è¡ŒæˆåŠŸ</em>ï¼è¿˜è¦åœ¨<em>è¿è¡Œæ—¶æ£€æŸ¥</em>ï¼ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://7nj2iz.com1.z0.glb.clouddn.com/blog_compatibility-with-macro-category-and-runtime_1.png" alt="å…¼å®¹ç¤ºæ„å›¾"></p>
<h3 id="å®åªåœ¨ç¼–è¯‘æ—¶ç”Ÿæ•ˆï¼"><a href="#å®åªåœ¨ç¼–è¯‘æ—¶ç”Ÿæ•ˆï¼" class="headerlink" title="å®åªåœ¨ç¼–è¯‘æ—¶ç”Ÿæ•ˆï¼"></a>å®åªåœ¨ç¼–è¯‘æ—¶ç”Ÿæ•ˆï¼</h3><p>å®å®šä¹‰åªæ˜¯çº¯ç²¹çš„æ–‡æœ¬æ›¿æ¢ï¼Œåªåœ¨ç¼–è¯‘æ—¶èµ·ä½œç”¨ã€‚å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">if</span> __IPHONE_OS_VERSION_MIN_REQUIRED &gt;= 70000</span></div><div class="line">    NSLog(@<span class="string">"Tutuge"</span>);</div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div></pre></td></tr></table></figure>
<p>è¢«å®å®šä¹‰åŒ…èµ·æ¥çš„ä»£ç æ˜¯å¦ä¼šæ‰§è¡Œï¼Œåœ¨ç¼–è¯‘æ—¶å°±å†³å®šå¥½äº†ï¼Œæ— è®ºä½ æ˜¯ç”¨ä»€ä¹ˆç³»ç»Ÿè¿è¡Œï¼Œå®å®šä¹‰å†ä¹Ÿæ²¡æœ‰ä»€ä¹ˆåµç”¨=ã€‚=</p>
<h2 id="ç¼–è¯‘æ—¶æ£€æŸ¥SDKç‰ˆæœ¬ï¼Œè¿è¡Œæ—¶æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬"><a href="#ç¼–è¯‘æ—¶æ£€æŸ¥SDKç‰ˆæœ¬ï¼Œè¿è¡Œæ—¶æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬" class="headerlink" title="ç¼–è¯‘æ—¶æ£€æŸ¥SDKç‰ˆæœ¬ï¼Œè¿è¡Œæ—¶æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬"></a>ç¼–è¯‘æ—¶æ£€æŸ¥SDKç‰ˆæœ¬ï¼Œè¿è¡Œæ—¶æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬</h2><p>è¿™ä¸ªæ˜¯æœ€åŸºæœ¬çš„é€‚é…æ‰‹æ®µã€‚</p>
<p>ç”¨åˆ°çš„å®å¦‚ä¸‹ï¼š</p>
<ol>
<li><strong>__IPHONE_OS_VERSION_MAX_ALLOWED</strong>: å€¼ç­‰äºBase SDKï¼Œå³ç”¨äºæ£€æŸ¥SDKç‰ˆæœ¬çš„ã€‚</li>
<li><strong>__IPHONE_OS_VERSION_MIN_REQUIRED</strong>: å€¼ç­‰äºDeployment Targetï¼Œæ£€æŸ¥æ”¯æŒçš„æœ€å°ç³»ç»Ÿç‰ˆæœ¬ã€‚</li>
</ol>
<p>è¿è¡Œæ—¶æ£€æŸ¥ç³»ç»Ÿç‰ˆæœ¬ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> ([UIDevice currentDevice]<span class="selector-class">.systemVersion</span><span class="selector-class">.floatValue</span> &gt; <span class="number">8.0</span>f) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å‡å¦‚æˆ‘ä»¬ç°åœ¨æƒ³ç”¨iOS8æ–°çš„<strong>UIAlertController</strong>æ¥æ˜¾ç¤ºæç¤ºæ¡†ï¼Œåº”è¯¥å¦‚ä¸‹åˆ¤æ–­ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ç¼–è¯‘æ—¶åˆ¤æ–­ï¼šæ£€æŸ¥SDKç‰ˆæœ¬</span></div><div class="line"><span class="meta">#if __IPHONE_OS_VERSION_MAX_ALLOWED &gt; 80000</span></div><div class="line">    <span class="comment">// è¿è¡Œæ—¶åˆ¤æ–­ï¼šæ£€æŸ¥å½“å‰ç³»ç»Ÿç‰ˆæœ¬</span></div><div class="line">    <span class="keyword">if</span> ([<span class="built_in">UIDevice</span> currentDevice].systemVersion.floatValue &gt; <span class="number">8.0</span>f) &#123;</div><div class="line">        <span class="built_in">UIAlertController</span> *alertController =</div><div class="line">        [<span class="built_in">UIAlertController</span> alertControllerWithTitle:<span class="string">@"Tutuge"</span></div><div class="line">                                            message:<span class="string">@"Compatibility"</span></div><div class="line">                                     preferredStyle:<span class="built_in">UIAlertControllerStyleAlert</span>];</div><div class="line">        [alertController addAction:[<span class="built_in">UIAlertAction</span> actionWithTitle:<span class="string">@"Cancel"</span></div><div class="line">                                                            style:<span class="built_in">UIAlertActionStyleCancel</span></div><div class="line">                                                          handler:^(<span class="built_in">UIAlertAction</span> *action) &#123;</div><div class="line">                                                              <span class="built_in">NSLog</span>(<span class="string">@"Cancel"</span>);</div><div class="line">                                                          &#125;]];</div><div class="line">        [<span class="keyword">self</span> presentViewController:alertController animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="comment">// ç”¨æ—§çš„ä»£æ›¿</span></div><div class="line">        <span class="built_in">UIAlertView</span> *alertView = [[<span class="built_in">UIAlertView</span> alloc] initWithTitle:<span class="string">@"Tutuge"</span></div><div class="line">                                                            message:<span class="string">@"Compatibility"</span></div><div class="line">                                                           delegate:<span class="literal">nil</span></div><div class="line">                                                  cancelButtonTitle:<span class="string">@"Cancel"</span></div><div class="line">                                                  otherButtonTitles:<span class="literal">nil</span>];</div><div class="line">        [alertView show];</div><div class="line">    &#125;</div><div class="line"><span class="meta">#else</span></div><div class="line">    <span class="comment">// ...</span></div><div class="line"><span class="meta">#endif</span></div></pre></td></tr></table></figure>
<p>æ€»çš„æ¥è¯´å°±æ˜¯ç¼–è¯‘æ—¶ã€è¿è¡Œæ—¶çš„åˆ¤æ–­å‡ä¸èƒ½å°‘ã€‚</p>
<h2 id="Weakly-Linked-è¿è¡Œæ—¶æ£€æŸ¥ç±»ã€æ–¹æ³•æ˜¯å¦å¯ç”¨"><a href="#Weakly-Linked-è¿è¡Œæ—¶æ£€æŸ¥ç±»ã€æ–¹æ³•æ˜¯å¦å¯ç”¨" class="headerlink" title="Weakly Linked - è¿è¡Œæ—¶æ£€æŸ¥ç±»ã€æ–¹æ³•æ˜¯å¦å¯ç”¨"></a>Weakly Linked - è¿è¡Œæ—¶æ£€æŸ¥ç±»ã€æ–¹æ³•æ˜¯å¦å¯ç”¨</h2><p>é™¤äº†ç”¨å®ã€ç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹ï¼Œè¿˜å¯ä»¥ç”¨<strong>Weakly Linked</strong>ç‰¹æ€§åšè¿è¡Œæ—¶çš„æ£€æŸ¥ã€‚</p>
<p>å¯¹äºiOS4.2ä»¥ä¸Šçš„ï¼Œæœ‰<strong>NS_CLASS_AVAILABLE</strong>æ ‡ç¤ºçš„ç±»ï¼Œå¯ä»¥å¦‚ä¸‹åˆ¤æ–­æ˜¯å¦å¯ç”¨ï¼š</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">if</span> __IPHONE_OS_VERSION_MAX_ALLOWED &gt; 80000</span></div><div class="line">    <span class="comment">// Weakly Linkedåˆ¤æ–­</span></div><div class="line">    <span class="built_in">if</span> ([UIAlertController <span class="keyword">class</span>]) &#123;</div><div class="line">        <span class="comment">// ä½¿ç”¨UIAlertController...</span></div><div class="line">    &#125; <span class="built_in">else</span> &#123;</div><div class="line">        <span class="comment">// ä½¿ç”¨æ—§çš„æ–¹æ¡ˆ...</span></div><div class="line">    &#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥å¦‚ä¸‹åˆ¤æ–­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Class <span class="class"><span class="keyword">class</span> </span>= NSClassFromString (@<span class="string">"UIAlertController"</span>);</div><div class="line"><span class="keyword">if</span> (<span class="class"><span class="keyword">class</span>) </span>&#123;</div><div class="line">    <span class="comment">// ä½¿ç”¨UIAlertController...</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// ä½¿ç”¨æ—§çš„æ–¹æ¡ˆ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯¹äºæ–¹æ³•ï¼Œå¦‚ä¸‹åˆ¤æ–­:</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">if</span> ([UITableViewCell <span class="attribute">instancesRespondToSelector</span>:<span class="variable">@selector</span> (<span class="attribute">setSeparatorInset</span>:)]) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125; <span class="selector-tag">else</span> &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è‡³äºç”¨å“ªç§æ–¹æ³•ï¼Œç»Ÿä¸€ä¸€ä¸‹å³å¯ã€‚</p>
<h2 id="ç”¨Method-Swizzlingåšå…¼å®¹"><a href="#ç”¨Method-Swizzlingåšå…¼å®¹" class="headerlink" title="ç”¨Method Swizzlingåšå…¼å®¹"></a>ç”¨Method Swizzlingåšå…¼å®¹</h2><p>æœ‰å…³Runtimeã€Method Swizzlingçš„èµ„æ–™å¾ˆå¤šï¼Œå„ä½è‡ªè¡Œé˜…è¯»å“ˆ~</p>
<h3 id="åœ¨-void-loadæ–¹æ³•é‡Œé¢åšæ›¿æ¢"><a href="#åœ¨-void-loadæ–¹æ³•é‡Œé¢åšæ›¿æ¢" class="headerlink" title="åœ¨+ (void)loadæ–¹æ³•é‡Œé¢åšæ›¿æ¢"></a>åœ¨<code>+ (void)load</code>æ–¹æ³•é‡Œé¢åšæ›¿æ¢</h3><p>è¿™é‡Œæä¸€ä¸‹ä¸ºä»€ä¹ˆè¦åœ¨<code>+ (void)load</code>æ–¹æ³•é‡Œé¢åšMethod Swizzlingã€‚</p>
<p>åœ¨Objective-Cä¸­ï¼Œè¿è¡Œæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨æ¯ä¸ªç±»çš„ä¸¤ä¸ªæ–¹æ³•ã€‚<code>+ (void)load</code>ä¼šåœ¨ç±»ã€Categoryåˆå§‹åŠ è½½æ—¶è°ƒç”¨ï¼Œ<code>+ (void)initialize</code>ä¼šåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨ç±»çš„ç±»æ–¹æ³•æˆ–å®ä¾‹æ–¹æ³•ä¹‹å‰è¢«è°ƒç”¨ã€‚</p>
<p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>+ (void)initialize</code>æ˜¯å¯ä»¥è¢«Categoryè¦†ç›–é‡å†™çš„ï¼Œå¹¶ä¸”æœ‰å¤šä¸ªCategoryéƒ½é‡å†™äº†<code>+ (void)initialize</code>æ–¹æ³•æ—¶ï¼Œåªä¼šè¿è¡Œå…¶ä¸­ä¸€ä¸ªï¼Œæ‰€ä»¥åœ¨<code>+ (void)initialize</code>é‡Œé¢åšMethod Swizzlingæ˜¾ç„¶æ˜¯ä¸è¡Œçš„ã€‚</p>
<p>è€Œ<code>+ (void)load</code>æ–¹æ³•åªè¦å®ç°äº†ï¼Œå°±ä¸€å®šä¼šè°ƒç”¨ã€‚å…·ä½“ä¸ºä»€ä¹ˆå¤§å®¶å¯ä»¥è‡ªè¡Œé˜…è¯»Runtimeçš„æºç ï¼Œæˆ–è€…æŸ¥é˜…ç›¸å…³æ–‡ç« ã€‚</p>
<h3 id="ç”¨dispatch-onceä¿è¯åªè¿è¡Œä¸€æ¬¡"><a href="#ç”¨dispatch-onceä¿è¯åªè¿è¡Œä¸€æ¬¡" class="headerlink" title="ç”¨dispatch_onceä¿è¯åªè¿è¡Œä¸€æ¬¡"></a>ç”¨dispatch_onceä¿è¯åªè¿è¡Œä¸€æ¬¡</h3><p>å› ä¸ºMethod Swizzlingçš„å½±å“æ˜¯å…¨å±€çš„ï¼Œè€Œä¸”ä¸€æ—¦å¤šæ¬¡è°ƒç”¨ï¼Œä¼šå‡ºé”™ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ç”¨dispatch_onceå°±å†åˆé€‚ä¸è¿‡äº†~</p>
<h3 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h3><p>ä¸‹é¢å°±æ˜¯åˆ©ç”¨Method Swizzlingåšå…¼å®¹çš„ä¸€ä¸ªä¾‹å­ã€‚<br>æœ‰æ—¶å€™ï¼Œä¸åŒç‰ˆæœ¬ä¹‹é—´ï¼ŒåŒä¸€ä¸ªç±»ã€Viewæ§ä»¶çš„é»˜è®¤å±æ€§å¯èƒ½éƒ½ä¼šå˜åŒ–ï¼Œå¦‚UILabelçš„èƒŒæ™¯è‰²åœ¨iOS6ä¸Šï¼Œé»˜è®¤æ˜¯ç™½è‰²ï¼Œè€ŒiOS6ä»¥åæ˜¯é€æ˜çš„ï¼å¦‚æœåœ¨æ¯ä¸ªç”¨åˆ°UILabelçš„åœ°æ–¹ï¼Œéƒ½æ‰‹åŠ¨è®¾ç½®ä¸€æ¬¡èƒŒæ™¯è‰²ï¼Œä»£ä»·å¤ªå¤§ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦Runtimeçš„â€œé»‘é­”æ³•â€ä¸Šåœºã€‚</p>
<p>å°±ä»¥è®¾ç½®UILabelçš„é»˜è®¤èƒŒæ™¯è‰²é€æ˜ä¸ºä¾‹ï¼Œå°±æ˜¯åœ¨UILabelåˆå§‹åŒ–æ—¶ï¼Œå¦‚initWithFrameä¹‹å‰ï¼Œå…ˆè®¾ç½®å¥½é€æ˜èƒŒæ™¯è‰²ï¼Œç®€å•çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åˆ›å»ºCategory</span></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UILabel</span> (<span class="title">TTGCompatibility</span>)</span></div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)load &#123;</div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        <span class="comment">// å…ˆåˆ¤æ–­ç³»ç»Ÿç‰ˆæœ¬ï¼Œå°½é‡å‡å°‘Runtimeçš„ä½œç”¨èŒƒå›´</span></div><div class="line">        <span class="keyword">if</span> ([<span class="built_in">UIDevice</span> currentDevice].systemVersion.floatValue &lt; <span class="number">7.0</span>f) &#123;</div><div class="line">            <span class="comment">// Method Swizzling</span></div><div class="line">            <span class="comment">// initWithFrame</span></div><div class="line">            Method oriMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(initWithFrame:));</div><div class="line">            Method newMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(compatible_initWithFrame:));</div><div class="line">            method_exchangeImplementations(oriMethod, newMethod);</div><div class="line"></div><div class="line">            <span class="comment">// initWithCoder...</span></div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// initWithFrame</span></div><div class="line">- (<span class="keyword">id</span>)compatible_initWithFrame:(<span class="built_in">CGRect</span>)frame &#123;</div><div class="line">    <span class="keyword">id</span> newSelf = [<span class="keyword">self</span> compatible_initWithFrame:frame];</div><div class="line">    <span class="comment">// è®¾ç½®é€æ˜èƒŒæ™¯è‰²</span></div><div class="line">    ((<span class="built_in">UILabel</span> *)newSelf).backgroundColor = [<span class="built_in">UIColor</span> clearColor];</div><div class="line">    <span class="keyword">return</span> newSelf;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// initWithCoder...</span></div></pre></td></tr></table></figure>
<h2 id="è¿è¡Œæ—¶æ·»åŠ â€œDummyâ€æ–¹æ³•ï¼Œå‡å°‘ä»£ç æ”¹åŠ¨"><a href="#è¿è¡Œæ—¶æ·»åŠ â€œDummyâ€æ–¹æ³•ï¼Œå‡å°‘ä»£ç æ”¹åŠ¨" class="headerlink" title="è¿è¡Œæ—¶æ·»åŠ â€œDummyâ€æ–¹æ³•ï¼Œå‡å°‘ä»£ç æ”¹åŠ¨"></a>è¿è¡Œæ—¶æ·»åŠ â€œDummyâ€æ–¹æ³•ï¼Œå‡å°‘ä»£ç æ”¹åŠ¨</h2><p>Dummyï¼Œæ„æ€æ˜¯â€œå‡çš„ã€å‡åŠ¨ä½œã€å‡äººâ€ï¼Œåœ¨è¿™é‡ŒæŒ‡çš„æ˜¯ä¸ºæ—§ç‰ˆæœ¬ä¸å­˜åœ¨çš„æ–¹æ³•æä¾›ä¸€ä¸ªâ€œå‡çš„â€æ›¿ä»£æ–¹æ³•ï¼Œé˜²æ­¢å› æ–°APIæ‰¾ä¸åˆ°è€Œå¯¼è‡´çš„Crashã€‚</p>
<p>ä»¥UITableViewCellçš„<strong>â€œsetSeparatorInset:â€</strong>æ–¹æ³•ä¸ºä¾‹ï¼Œåœ¨iOS6ä¸­ï¼Œå‹æ ¹å°±ä¸å­˜åœ¨separatorInsetï¼Œä½†æ˜¯ç°æœ‰çš„ä»£ç é‡Œé¢å¤§é‡çš„è°ƒç”¨äº†è¿™ä¸ªæ–¹æ³•ï¼Œæ€ä¹ˆåŠï¼Ÿéš¾é“ä¸€ä¸ªä¸€ä¸ªçš„å»åŠ ä¸Šåˆ¤æ–­æ¡ä»¶ï¼Ÿä»£ä»·å¤ªå¤§ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨Runtimeçš„æ‰‹æ®µï¼Œåœ¨è¿è¡Œæ—¶æ·»åŠ ä¸€ä¸ªDummyæ–¹æ³•ï¼Œå»â€œ<strong>ä»£æ›¿æ¥æ”¶</strong>â€setSeparatorInsetæ¶ˆæ¯ï¼Œé˜²æ­¢åœ¨iOS6ä¸Šçš„Crashã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UITableViewCell</span> (<span class="title">TTGCompatibility</span>)</span></div><div class="line"></div><div class="line">+ (<span class="keyword">void</span>)load &#123;</div><div class="line"><span class="comment">// ç¼–è¯‘æ—¶åˆ¤æ–­SDK</span></div><div class="line"><span class="meta">#if __IPHONE_OS_VERSION_MAX_ALLOWED &gt; __IPHONE_7_0</span></div><div class="line">    <span class="comment">// è¿è¡Œæ—¶åˆ¤æ–­ç³»ç»Ÿç‰ˆæœ¬</span></div><div class="line">    <span class="keyword">if</span> ([<span class="built_in">UIDevice</span> currentDevice].systemVersion.floatValue &lt; <span class="number">7.0</span>f) &#123;</div><div class="line">        Method newMethod = class_getInstanceMethod(<span class="keyword">self</span>, <span class="keyword">@selector</span>(compatible_setSeparatorInset:));</div><div class="line">        <span class="comment">// å¢åŠ Dummyæ–¹æ³•</span></div><div class="line">        class_addMethod(</div><div class="line">                <span class="keyword">self</span>,</div><div class="line">                <span class="keyword">@selector</span>(setSeparatorInset:),</div><div class="line">                method_getImplementation(newMethod),</div><div class="line">                method_getTypeEncoding(newMethod));</div><div class="line">    &#125;</div><div class="line"><span class="meta">#endif</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// setSeparatorInset: çš„Dummyæ–¹æ³•</span></div><div class="line">- (<span class="keyword">void</span>)compatible_setSeparatorInset:(<span class="built_in">UIEdgeInsets</span>) inset &#123;</div><div class="line">    <span class="comment">// ç©ºæ–¹æ³•éƒ½å¯ä»¥ï¼Œåªæ˜¯ä¸ºäº†æ¥æ”¶setSeparatorInset:æ¶ˆæ¯ã€‚</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨é€‚é…æ—§ç‰ˆæœ¬æ—¶ï¼Œé™¤äº†åŸºæœ¬çš„å®å®šä¹‰ã€[UIDevice currentDevice].systemVersionåˆ¤æ–­ï¼Œé€‚å½“çš„ç”¨Runtimeï¼Œå¯ä»¥å¤§å¤§å‡å°‘å¯¹ç°æœ‰ä»£ç çš„â€œå¹²æ¶‰â€ï¼Œå¤šç§æ–¹æ³•ç›¸ç»“åˆæ‰æ˜¯æœ€å¥½çš„ã€‚</p>
<p>å—¯ï¼Œè¿˜åœ¨ç”¨iOS6çš„ç”¨æˆ·ï¼Œå‡ä¸ªçº§å‘—=ã€‚=</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://developer.apple.com/library/ios/documentation/DeveloperTools/Conceptual/cross_development/Introduction/Introduction.html#//apple_ref/doc/uid/10000163-BCICHGIE" target="_blank" rel="external">SDK Compatibility Guide</a></li>
<li><a href="http://git.devzeng.com/blog/ios-multiple-version-compatible.html" target="_blank" rel="external">iOSå¼€å‘ä¹‹å¤šç³»ç»Ÿç‰ˆæœ¬å…¼å®¹</a></li>
<li><a href="http://stackoverflow.com/questions/3057325/weak-linking-check-if-a-class-exists-and-use-that-class" target="_blank" rel="external">Weak Linking - check if a class exists and use that class</a></li>
<li><a href="http://stackoverflow.com/questions/19789958/xcode-preprocessor-macro-to-check-if-base-sdk-ios-7-0" target="_blank" rel="external">Xcode preprocessor macro to check if Base SDK &gt;= iOS 7.0</a></li>
<li><a href="http://xuzhongzhou.net/post/ios-sdk-compatibility-guide.html" target="_blank" rel="external">iOS SDK å…¼å®¹æ€§æŒ‡å—</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;h3 id=&quot;2015-11-16&quot;&gt;&lt;a href=&quot;#2015-11-16&quot; class=&quot;headerlink&quot; title=&quot;2015-11-16&quot;&gt;&lt;/a&gt;2015-11-16&lt;/h3&gt;&lt;p&gt;æ„Ÿè°¢å¾®åšå¥½å‹&lt;strong&gt;@zyyy_000&lt;/strong&gt;çš„è¯„è®ºï¼Œè¡¥å……äº†ä¸ºä»€ä¹ˆè¦åœ¨&lt;code&gt;+ (void)load&lt;/code&gt;æ–¹æ³•é‡Œé¢åš&lt;strong&gt;Method Swizzling&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æœ€è¿‘ï¼Œåœ¨åšé¡¹ç›®æ—¶ï¼Œå› ä¸ºæŸç§åŸå› ï¼Œçªç„¶è¦â€œé€‚é…â€iOS6ï¼ˆä¹Ÿæ˜¯é†‰äº†ã€‚ã€‚ã€‚ï¼‰ï¼Œä¿è¯æå°‘æ•°çš„iOS6ç”¨æˆ·å¯ä»¥â€œç”¨ä¸Šâ€æ–°çš„ç‰ˆæœ¬ã€‚å“ªæ€•ç•Œé¢ä¸Šæœ‰ç‘•ç–µï¼Œåªè¦åŠŸèƒ½æ­£å¸¸å°±è¡Œã€‚äºæ˜¯å°±åªå¥½èŠ±å‡ å¤©æ—¶é—´å¯¹iOS6è¿›è¡Œç´§æ€¥é€‚é…ï¼ˆå¿ƒä¸­ä¸€ä¸‡å¤´é©¼ç¾Šå¥”è·‘è€Œè¿‡ã€‚ã€‚ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æ€»ç»“äº†ä¸€äº›å¸¸è§„çš„ï¼Œå’Œâ€œéå¸¸è§„â€çš„iOSé¡¹ç›®å‘è€ç‰ˆæœ¬å…¼å®¹çš„åŠæ³•ï¼Œç»“åˆäº†&lt;strong&gt;å®å®šä¹‰&lt;/strong&gt;ã€&lt;strong&gt;Category&lt;/strong&gt;å’Œ&lt;strong&gt;Runtime&lt;/strong&gt;ï¼Œå¤§å®¶çœ‹ç€æ¶ˆé£ä¸€ä¸‹å°±å¥½å“ˆ~&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="Runtime" scheme="http://tutuge.me/tags/Runtime/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨Runtimeçš„æ‰‹æ®µå¡«å……ä»»æ„NSObjectå¯¹è±¡çš„nilå±æ€§</title>
    <link href="http://tutuge.me/2015/07/08/fill-nil-property-of-object/"/>
    <id>http://tutuge.me/2015/07/08/fill-nil-property-of-object/</id>
    <published>2015-07-08T15:23:23.000Z</published>
    <updated>2016-08-07T06:10:23.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¥½ä¹…æ²¡æœ‰å†™ä¸œè¥¿äº†ï¼Œå¿™å•Šã€‚</p>
<p>å‰æ®µæ—¶é—´å‚åŠ äº†ä¸€ä¸‹æˆ‘ä»¬åç§‘è”åˆ›çš„HackDayï¼ˆæœ¬äººåœ¨è¯»ç ”=ã€‚=ï¼Œç›®å‰åœ¨é˜¿é‡Œå®ä¹ ï¼‰ï¼Œä½œå“æ˜¯ä¸€æ¬¾<strong>å®æ—¶åœ¨çº¿å¯¹æˆ˜æ¸¸æˆ - æ³¢æ³¢æ”’</strong>ï¼Œï¼ˆä»‹ç»è¯·çœ‹<a href="http://www.zhihu.com/question/24402279" target="_blank" rel="external">çŸ¥ä¹</a>ï¼‰<br>ä»iOSæ¸¸æˆå®¢æˆ·ç«¯ï¼ˆç”¨çš„<strong>SpriteKit</strong>ï¼‰åˆ°åå°ï¼ˆ<strong>PHP CI + Node + SocketIO + MySQL</strong>ï¼‰å…¨æ˜¯è‡ªå·±ä¸€ä¸ªäººå€’è…¾å‡ºæ¥çš„ï¼Œåšäº†ä¸€æŠŠçœŸæ­£çš„å…¨æ ˆå·¥ç¨‹å¸ˆï¼Œçˆ½å•Š~<br>åé¢ä¼šå®Œå–„æ•´ä¸ªæ¸¸æˆï¼Œå¢åŠ è§’è‰²ã€ä¼˜åŒ–å•¥çš„ï¼Œè¿‡ä¸Šä¸€æ®µæ—¶é—´ä¼šä¸Šçº¿çš„å“ˆ~</p>
<p><strong>å›åˆ°æ­£æ–‡</strong>ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»äº†æ€ä¹ˆç”¨Runtimeçš„æ‰‹æ®µéå†ä»»æ„NSObjectå¯¹è±¡çš„æ‰€æœ‰propertyï¼Œæ£€æŸ¥å…¶å€¼æ˜¯å¦æ˜¯nilï¼Œæ˜¯çš„è¯æ ¹æ®å…¶ç±»å‹ä¸ºå…¶å¡«å……ä¸€ä¸ªé»˜è®¤å€¼ã€‚<br>Runtimeæ¯•ç«Ÿæ˜¯ä¸ªâ€œå±é™©â€çš„æŠ€æœ¯ï¼Œæœ¬æ–‡çš„ä»£ç åªæ˜¯ä¸ªåˆæ­¥çš„å°è¯•ã€‚</p>
<a id="more"></a>
<h2 id="åˆè¡·"><a href="#åˆè¡·" class="headerlink" title="åˆè¡·"></a>åˆè¡·</h2><p>åœ¨åšé¡¹ç›®çš„è¿‡ç¨‹ä¸­ï¼Œæ€»æ˜¯ä¼šå†™ä¸€å¤§å †ifã€elseè¯­å¥å»æ£€æŸ¥å¯¹è±¡çš„Propertyæ˜¯å¦æ˜¯nilï¼Œå¦‚ä»æœåŠ¡å™¨è¿”å›çš„JSONä¸­ç¼ºå°‘å±æ€§ï¼Œå¯¼è‡´Entityçš„æŸäº›å€¼ä¸ºç©ºï¼›æˆ–è€…åˆ›å»ºçš„å¯¹è±¡æ²¡æœ‰å¯¹æ‰€æœ‰å±æ€§åšåˆå§‹åŒ–ç­‰ç­‰ã€‚å†™å¤šäº†è§‰å¾—å¥½çƒ¦å•Š=ã€‚=<br>æ‰€ä»¥æƒ³åˆ°æœ¬æ–‡çš„æ–¹æ³•ï¼Œå—¯ï¼Œç¨‹åºå‘˜æ€»æ˜¯æ‡’çš„ã€‚</p>
<h2 id="è§£å†³æ­¥éª¤"><a href="#è§£å†³æ­¥éª¤" class="headerlink" title="è§£å†³æ­¥éª¤"></a>è§£å†³æ­¥éª¤</h2><ol>
<li>éå†ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼ˆé»˜è®¤ä¸åŒ…æ‹¬çˆ¶ç±»å±æ€§ï¼‰ã€‚</li>
<li>åˆ¤æ–­å±æ€§æ˜¯å¦æ˜¯nilã€‚</li>
<li>ä¸ºnilçš„å±æ€§ï¼Œè·å–å®ƒçš„ç±»å‹ã€‚</li>
<li>æ ¹æ®ç±»å‹è®¾ç½®åˆå§‹å€¼ï¼ˆå¦‚NSStringå¯ä»¥è®¾ä¸ºç©ºå­—ç¬¦ä¸²ï¼›NSNumberå¯ä»¥è®¾ä¸º@0ï¼‰</li>
</ol>
<h2 id="Runtime"><a href="#Runtime" class="headerlink" title="Runtime"></a>Runtime</h2><p>OCæ˜¯ä¸€é—¨â€œåŠ¨æ€â€ã€â€œåŸºäºæ¶ˆæ¯â€çš„è¯­è¨€ï¼Œè€ŒRuntimeå°±æ˜¯åˆ©ç”¨OCçš„åŠ¨æ€ç‰¹æ€§ï¼Œåœ¨è¿è¡Œæ—¶å¯¹ç¨‹åºåšå‡ºâ€œè°ƒæ•´â€çš„æŠ€æœ¯ã€‚æœ‰å…³Runtimeçš„å®˜æ–¹æ–‡æ¡£ã€ç½‘ä¸Šçš„èµ„æ–™å¾ˆå¤šï¼Œå¤§å®¶è‡ªå­¦å“ˆ~</p>
<p>æœ¬æ–‡ä¸»è¦ç”¨äº†å¦‚ä¸‹å‡ ä¸ªRuntimeçš„å‡½æ•°ï¼š</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">// è·å–ç±»çš„æ‰€æœ‰<span class="keyword">Property</span><span class="title"></span></div><div class="line"><span class="number">1</span>. objc_property_t *class_copyPropertyList(Class cls, unsigned int *outCount)</div><div class="line">// è·å–ä¸€ä¸ª<span class="keyword">Property</span><span class="title"></span>çš„å˜é‡å</div><div class="line"><span class="number">2</span>. const char *property_getName(objc_property_t <span class="keyword">property</span><span class="title"></span>)</div><div class="line">// è·å–ä¸€ä¸ª<span class="keyword">Property</span><span class="title"></span>çš„è¯¦ç»†ç±»å‹è¡¨è¾¾å­—ç¬¦ä¸²</div><div class="line"><span class="number">3</span>. const char *property_getAttributes(objc_property_t <span class="keyword">property</span><span class="title"></span>)</div></pre></td></tr></table></figure>
<h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p>ä¸å¥½ä¸€å—ä¸€å—æ‹†å¼€è¯´ï¼Œç›´æ¥ä¸Šä»£ç ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * è§£æPropertyçš„Attributedå­—ç¬¦ä¸²ï¼Œå‚è€ƒStackoverflow</div><div class="line"> */</div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *getPropertyType(objc_property_t property) &#123;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *attributes = property_getAttributes(property);</div><div class="line"></div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s"</span>, attributes);</div><div class="line"></div><div class="line">    <span class="keyword">char</span> buffer[<span class="number">1</span> + strlen(attributes)];</div><div class="line">    strcpy(buffer, attributes);</div><div class="line">    <span class="keyword">char</span> *state = buffer, *attribute;</div><div class="line">    <span class="keyword">while</span> ((attribute = strsep(&amp;state, <span class="string">","</span>)) != <span class="literal">NULL</span>) &#123;</div><div class="line">        <span class="comment">// éå¯¹è±¡ç±»å‹</span></div><div class="line">        <span class="keyword">if</span> (attribute[<span class="number">0</span>] == <span class="string">'T'</span> &amp;&amp; attribute[<span class="number">1</span>] != <span class="string">'@'</span>) &#123;</div><div class="line">            <span class="comment">// åˆ©ç”¨NSDataå¤åˆ¶ä¸€ä»½å­—ç¬¦ä¸²</span></div><div class="line">            <span class="keyword">return</span> (<span class="keyword">const</span> <span class="keyword">char</span> *) [[<span class="built_in">NSData</span> dataWithBytes:(attribute + <span class="number">1</span>) length:strlen(attribute) - <span class="number">1</span>] bytes];</div><div class="line">        <span class="comment">// çº¯idç±»å‹</span></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (attribute[<span class="number">0</span>] == <span class="string">'T'</span> &amp;&amp; attribute[<span class="number">1</span>] == <span class="string">'@'</span> &amp;&amp; strlen(attribute) == <span class="number">2</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"id"</span>;</div><div class="line">        <span class="comment">// å¯¹è±¡ç±»å‹</span></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (attribute[<span class="number">0</span>] == <span class="string">'T'</span> &amp;&amp; attribute[<span class="number">1</span>] == <span class="string">'@'</span>) &#123;</div><div class="line">            <span class="keyword">return</span> (<span class="keyword">const</span> <span class="keyword">char</span> *) [[<span class="built_in">NSData</span> dataWithBytes:(attribute + <span class="number">3</span>) length:strlen(attribute) - <span class="number">4</span>] bytes];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * ç»™å¯¹è±¡çš„å±æ€§è®¾ç½®é»˜è®¤å€¼</div><div class="line"> */</div><div class="line"><span class="keyword">void</span> checkEntity(<span class="built_in">NSObject</span> *object) &#123;</div><div class="line">    <span class="comment">// ä¸åŒç±»å‹çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œç›®å‰åªæ˜¯ç®€å•æ£€æŸ¥å­—ç¬¦ä¸²ã€æ•°å­—ã€æ•°ç»„</span></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *<span class="built_in">CLASS_NAME_NSSTRING</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *<span class="built_in">CLASS_NAME_NSNUMBER</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">char</span> *<span class="built_in">CLASS_NAME_NSARRAY</span>;</div><div class="line"></div><div class="line">    <span class="comment">// åˆå§‹åŒ–ç±»å‹å¸¸é‡</span></div><div class="line">    <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">        <span class="comment">// "NSString"</span></div><div class="line">        <span class="built_in">CLASS_NAME_NSSTRING</span> =  <span class="built_in">NSStringFromClass</span>([<span class="built_in">NSString</span> <span class="keyword">class</span>]).UTF8String;</div><div class="line">        <span class="comment">// "NSNumber</span></div><div class="line">        <span class="built_in">CLASS_NAME_NSNUMBER</span> = <span class="built_in">NSStringFromClass</span>([<span class="built_in">NSNumber</span> <span class="keyword">class</span>]).UTF8String;</div><div class="line">        <span class="comment">// "NSArray"</span></div><div class="line">        <span class="built_in">CLASS_NAME_NSARRAY</span> = <span class="built_in">NSStringFromClass</span>([<span class="built_in">NSArray</span> <span class="keyword">class</span>]).UTF8String;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="keyword">@try</span> &#123;</div><div class="line">        <span class="keyword">unsigned</span> <span class="keyword">int</span> outCount, i;</div><div class="line">        <span class="comment">// åŒ…å«æ‰€æœ‰Propertyçš„æ•°ç»„</span></div><div class="line">        objc_property_t *properties = class_copyPropertyList([object <span class="keyword">class</span>], &amp;outCount);</div><div class="line"></div><div class="line">        <span class="comment">// éå†æ¯ä¸ªProperty</span></div><div class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; outCount; i++) &#123;</div><div class="line">            <span class="comment">// å–å‡ºå¯¹åº”Property</span></div><div class="line">            objc_property_t property = properties[i];</div><div class="line">            <span class="comment">// è·å–Propertyå¯¹åº”çš„å˜é‡å</span></div><div class="line">            <span class="built_in">NSString</span> *propertyName = [<span class="built_in">NSString</span> stringWithUTF8String:property_getName(property)];</div><div class="line">            <span class="comment">// è·å–Propertyçš„ç±»å‹å</span></div><div class="line">            <span class="keyword">const</span> <span class="keyword">char</span> *propertyTypeName = getPropertyType(property);</div><div class="line">            <span class="comment">// è·å–Propertyçš„å€¼</span></div><div class="line">            <span class="keyword">id</span> propertyValue = [object valueForKey:propertyName];</div><div class="line"></div><div class="line">            <span class="comment">// å€¼ä¸ºç©ºï¼Œæ‰è®¾ç½®é»˜è®¤å€¼</span></div><div class="line">            <span class="keyword">if</span> (!propertyValue) &#123;</div><div class="line">                <span class="comment">// NSString</span></div><div class="line">                <span class="keyword">if</span> (strncmp(<span class="built_in">CLASS_NAME_NSSTRING</span>, propertyTypeName, strlen(<span class="built_in">CLASS_NAME_NSSTRING</span>)) == <span class="number">0</span>) &#123;</div><div class="line">                    [object setValue:<span class="string">@""</span> forKey:propertyName];</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="comment">// NSNumber</span></div><div class="line">                <span class="keyword">if</span> (strncmp(<span class="built_in">CLASS_NAME_NSNUMBER</span>, propertyTypeName, strlen(<span class="built_in">CLASS_NAME_NSNUMBER</span>)) == <span class="number">0</span>) &#123;</div><div class="line">                    [object setValue:@<span class="number">0</span> forKey:propertyName];</div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="comment">// NSArray</span></div><div class="line">                <span class="keyword">if</span> (strncmp(<span class="built_in">CLASS_NAME_NSARRAY</span>, propertyTypeName, strlen(<span class="built_in">CLASS_NAME_NSARRAY</span>)) == <span class="number">0</span>) &#123;</div><div class="line">                    [object setValue:@[] forKey:propertyName];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">// åˆ«å¿˜äº†é‡Šæ”¾æ•°ç»„</span></div><div class="line">        free(properties);</div><div class="line">    &#125; <span class="keyword">@catch</span> (<span class="built_in">NSException</span> *exception) &#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Check Entity Exception: %@"</span>, [exception description]);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="é‡ç‚¹-è§£æproperty-getAttributeså‡½æ•°çš„ç»“æœ"><a href="#é‡ç‚¹-è§£æproperty-getAttributeså‡½æ•°çš„ç»“æœ" class="headerlink" title="é‡ç‚¹ - è§£æproperty_getAttributeså‡½æ•°çš„ç»“æœ"></a>é‡ç‚¹ - è§£æproperty_getAttributeså‡½æ•°çš„ç»“æœ</h2><p>åœ¨æ•´ä¸ªå¤„ç†è¿‡ç¨‹ä¸­ï¼Œproperty_getAttributeså‡½æ•°æ˜¯å…³é”®ï¼Œå› ä¸ºæˆ‘ä»¬è¦é¦–å…ˆç¡®å®šPropertyçš„ç±»å‹ï¼Œæ‰èƒ½æ ¹æ®ç±»å‹èµ‹åˆå€¼ï¼Œä½†æ˜¯property_getAttributeså‡½æ•°è¿”å›çš„å­—ç¬¦ä¸²æ¯”è¾ƒâ€œæ™¦æ¶©éš¾æ‡‚â€ï¼š</p>
<p>å¦‚ä¸‹å®šä¹‰çš„Propertyï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *name;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSNumber</span> *number;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSArray</span> *array;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSInteger</span> i;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> f;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="keyword">char</span> *cStr;</div></pre></td></tr></table></figure>
<p>ä¾æ¬¡é€šè¿‡property_getAttributesè·å–çš„ç»“æœæ˜¯ï¼š</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">T</span>@<span class="string">"NSString"</span>,C,<span class="built_in">N</span>,V_name</div><div class="line"><span class="built_in">T</span>@<span class="string">"NSNumber"</span>,&amp;,<span class="built_in">N</span>,V_number</div><div class="line"><span class="built_in">T</span>@<span class="string">"NSArray"</span>,&amp;,<span class="built_in">N</span>,V_array</div><div class="line">Tq,<span class="built_in">N</span>,V_i</div><div class="line">Td,<span class="built_in">N</span>,V_f</div><div class="line"><span class="built_in">T</span>*,<span class="built_in">N</span>,V_cStr</div></pre></td></tr></table></figure>
<p>å‚è€ƒ<a href="https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtPropertyIntrospection.html#//apple_ref/doc/uid/TP40008048-CH101" target="_blank" rel="external"> Declared Properties of Objective-C Runtime Programming Guide</a><br>æˆ‘ä»¬å¤§æ¦‚å¯ä»¥çŸ¥é“ï¼ŒTè¡¨ç¤ºTypeï¼Œåé¢è·Ÿç€@è¡¨ç¤ºCocoaå¯¹è±¡ç±»å‹ï¼Œåé¢çš„è¡¨ç¤ºPropertyçš„å±æ€§ï¼Œå¦‚Copyã€strongç­‰ï¼Œç„¶åå°±æ˜¯å˜é‡åã€‚<br>æ‰€ä»¥getPropertyTypeå‡½æ•°çš„å·¥ä½œå°±æ˜¯çº¯ç²¹çš„è§£æå­—ç¬¦ä¸²ï¼Œè·å–T@åé¢çš„ç±»å‹åã€‚</p>
<h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p>ä¾‹å¦‚æˆ‘ä»¬æœ‰å¦‚ä¸‹å¯¹è±¡ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@interface</span> <span class="attribute">UserEntity </span>: NSObject</div><div class="line"><span class="variable">@property</span> (copy, nonatomic) NSString *name;</div><div class="line"><span class="variable">@property</span> (strong, nonatomic) NSNumber *number;</div><div class="line"><span class="variable">@property</span> (strong, nonatomic) NSArray *array;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>è®¾ç½®é»˜è®¤å€¼ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">UserEntity *userEntity = [UserEntity new];</div><div class="line"><span class="comment">// æ£€æŸ¥å±æ€§ï¼Œè®¾ç½®é»˜è®¤å€¼ã€‚</span></div><div class="line">checkEntity(userEntity);</div><div class="line"><span class="comment">// ä½¿ç”¨...</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"name: %@"</span>, userEntity.name);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"number: %@"</span>, userEntity.number);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"array: %@"</span>, userEntity.array);</div></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">2015-07-11</span> <span class="selector-tag">18</span><span class="selector-pseudo">:17</span><span class="selector-pseudo">:25.918</span> <span class="selector-tag">Common</span><span class="selector-attr">[6939:270543]</span> <span class="selector-tag">name</span>:</div><div class="line"><span class="selector-tag">2015-07-11</span> <span class="selector-tag">18</span><span class="selector-pseudo">:17</span><span class="selector-pseudo">:25.918</span> <span class="selector-tag">Common</span><span class="selector-attr">[6939:270543]</span> <span class="selector-tag">number</span>: <span class="selector-tag">0</span></div><div class="line"><span class="selector-tag">2015-07-11</span> <span class="selector-tag">18</span><span class="selector-pseudo">:17</span><span class="selector-pseudo">:25.918</span> <span class="selector-tag">Common</span><span class="selector-attr">[6939:270543]</span> <span class="selector-tag">array</span>: (</div><div class="line">)</div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰Propertyéƒ½æœ‰äº†åˆå€¼ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸Šé¢çš„ä¾‹å­åªæ˜¯ä¸ªç²—ç•¥çš„ç‰ˆæœ¬ï¼Œåªæ˜¯æ£€æŸ¥äº†å­—ç¬¦ä¸²ã€æ•°å­—ã€æ•°ç»„ï¼Œå…¶å®å®Œå…¨å¯ä»¥æ‰©å±•å‡ºå¾ˆå¤šåŠŸèƒ½ï¼Œå¦‚é’ˆå¯¹ä¸åŒçš„ç±»å‹ï¼Œæ ¹æ®å¯¹è±¡çš„ç±»å‹ï¼Œè®¾ç½®ä¸åŒçš„é»˜è®¤åˆå€¼ç­‰ï¼Œé è¯»è€…ä½ äº†~</p>
<p>Runtimeæ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œä½†æ˜¯åˆ«ä¹±ç”¨å•Š=ã€‚=</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ObjCRuntimeRef/index.html" target="_blank" rel="external">Objective-C Runtime Reference</a></li>
<li><a href="https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtPropertyIntrospection.html#//apple_ref/doc/uid/TP40008048-CH101" target="_blank" rel="external">Objective-C Runtime Programming Guide - Declared Properties</a></li>
<li><a href="http://stackoverflow.com/questions/754824/get-an-object-properties-list-in-objective-c" target="_blank" rel="external">Get an object properties list in Objective-C</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å¥½ä¹…æ²¡æœ‰å†™ä¸œè¥¿äº†ï¼Œå¿™å•Šã€‚&lt;/p&gt;
&lt;p&gt;å‰æ®µæ—¶é—´å‚åŠ äº†ä¸€ä¸‹æˆ‘ä»¬åç§‘è”åˆ›çš„HackDayï¼ˆæœ¬äººåœ¨è¯»ç ”=ã€‚=ï¼Œç›®å‰åœ¨é˜¿é‡Œå®ä¹ ï¼‰ï¼Œä½œå“æ˜¯ä¸€æ¬¾&lt;strong&gt;å®æ—¶åœ¨çº¿å¯¹æˆ˜æ¸¸æˆ - æ³¢æ³¢æ”’&lt;/strong&gt;ï¼Œï¼ˆä»‹ç»è¯·çœ‹&lt;a href=&quot;http://www.zhihu.com/question/24402279&quot;&gt;çŸ¥ä¹&lt;/a&gt;ï¼‰&lt;br&gt;ä»iOSæ¸¸æˆå®¢æˆ·ç«¯ï¼ˆç”¨çš„&lt;strong&gt;SpriteKit&lt;/strong&gt;ï¼‰åˆ°åå°ï¼ˆ&lt;strong&gt;PHP CI + Node + SocketIO + MySQL&lt;/strong&gt;ï¼‰å…¨æ˜¯è‡ªå·±ä¸€ä¸ªäººå€’è…¾å‡ºæ¥çš„ï¼Œåšäº†ä¸€æŠŠçœŸæ­£çš„å…¨æ ˆå·¥ç¨‹å¸ˆï¼Œçˆ½å•Š~&lt;br&gt;åé¢ä¼šå®Œå–„æ•´ä¸ªæ¸¸æˆï¼Œå¢åŠ è§’è‰²ã€ä¼˜åŒ–å•¥çš„ï¼Œè¿‡ä¸Šä¸€æ®µæ—¶é—´ä¼šä¸Šçº¿çš„å“ˆ~&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å›åˆ°æ­£æ–‡&lt;/strong&gt;ï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»äº†æ€ä¹ˆç”¨Runtimeçš„æ‰‹æ®µéå†ä»»æ„NSObjectå¯¹è±¡çš„æ‰€æœ‰propertyï¼Œæ£€æŸ¥å…¶å€¼æ˜¯å¦æ˜¯nilï¼Œæ˜¯çš„è¯æ ¹æ®å…¶ç±»å‹ä¸ºå…¶å¡«å……ä¸€ä¸ªé»˜è®¤å€¼ã€‚&lt;br&gt;Runtimeæ¯•ç«Ÿæ˜¯ä¸ªâ€œå±é™©â€çš„æŠ€æœ¯ï¼Œæœ¬æ–‡çš„ä»£ç åªæ˜¯ä¸ªåˆæ­¥çš„å°è¯•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="Runtime" scheme="http://tutuge.me/tags/Runtime/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰è¶£çš„Autolayoutç¤ºä¾‹-Masonryå®ç°</title>
    <link href="http://tutuge.me/2015/05/23/autolayout-example-with-masonry/"/>
    <id>http://tutuge.me/2015/05/23/autolayout-example-with-masonry/</id>
    <published>2015-05-23T11:59:22.000Z</published>
    <updated>2017-02-19T13:26:31.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><ul>
<li>2016-08-06: ç¬¬å››ç¯‡: <a href="http://tutuge.me/2016/08/06/autolayout-example-with-masonry4/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹4-Masonryå®ç°</a></li>
<li>2015-12-23: æ„Ÿè°¢<a href="https://github.com/XVXVXXX" target="_blank" rel="external">XVXVXXX</a>çš„PRï¼Œæ›´æ–°äº†Case2</li>
<li>2015-12-15: ç¬¬ä¸‰ç¯‡ï¼š<a href="http://tutuge.me/2015/12/14/autolayout-example-with-masonry3/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹3-Masonryå®ç°</a></li>
<li>2015-11-27: æ„Ÿè°¢â€œè°¢å°é›·â€æŒ‡å‡ºæ‰“å­—é”™è¯¯~</li>
<li>2015-9-10: ç¬¬äºŒç¯‡: <a href="http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/">æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°</a></li>
<li>2015-9-1: æ„Ÿè°¢â€œç‹æŒ¯å®‡Cè‰¹â€æŒ‡å‡ºæ‰“å­—é”™è¯¯ï¼Œå·²ç»ä¿®æ”¹äº†å“ˆ~</li>
</ul>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¥½ä¹…æ²¡æœ‰å†™Blogäº†ï¼Œè¿™æ®µæ—¶é—´æœ‰ç‚¹å¿™å•Š=ã€‚=<br>æœ¬æ–‡ä¸¾äº†3ä¸ªæ¯”è¾ƒæœ‰â€œç‰¹ç‚¹â€çš„Autolayoutä¾‹å­ï¼Œæºäºå¾®åšä¸Šå¥½å‹çš„æé—®ï¼Œæ„Ÿè§‰æ¯”è¾ƒæœ‰æ„æ€ï¼Œä¹Ÿæ¯”è¾ƒæœ‰ä»£è¡¨æ€§ï¼Œå°±å†™äº†å‡ºæ¥ï¼Œåˆ†äº«ç»™å¤§å®¶~<br>è‡³äºä¸ºä»€ä¹ˆç”¨Masonryï¼Œé‚£æ˜¯å› ä¸ºå®ƒå¥½ç”¨å•Šï¼ï¼ˆè¢«é—®åˆ°è¿‡æœ‰å…³Masonryçš„é—®é¢˜ï¼Œå°±ç´¢æ€§ç”¨å®ƒæ¥å®ç°å§=ã€‚=ï¼‰ã€‚</p>
<h3 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h3><p><img src="http://zorrochen.qiniudn.com/blog_autolayout_example_with_masonry_1.gif" alt="æ•ˆæœå›¾"></p>
<h3 id="Githubåœ°å€"><a href="#Githubåœ°å€" class="headerlink" title="Githubåœ°å€"></a>Githubåœ°å€</h3><p><a href="https://github.com/zekunyan/AutolayoutExampleWithMasonry" target="_blank" rel="external">https://github.com/zekunyan/AutolayoutExampleWithMasonry</a></p>
<a id="more"></a>
<h3 id="å…³äºä¾‹å­å·¥ç¨‹ç»“æ„"><a href="#å…³äºä¾‹å­å·¥ç¨‹ç»“æ„" class="headerlink" title="å…³äºä¾‹å­å·¥ç¨‹ç»“æ„"></a>å…³äºä¾‹å­å·¥ç¨‹ç»“æ„</h3><p>å®ç°çš„æ—¶å€™é‡‡ç”¨çš„æ˜¯ç”¨StoryBoardæ‹–æ‹½çº¦æŸ+Masonryæ‰‹å†™ä»£ç ç›¸ç»“åˆçš„æ–¹å¼å®ç°ã€‚æœ€å…³é”®çš„åœ°æ–¹æ˜¯ç”¨Masonryï¼Œä¸ºäº†æ›´å¥½åœ°çªå‡ºé‡ç‚¹ã€‚å…¶å®ƒçš„æ— å…³ç´§è¦çš„ç©ºé—´çº¦æŸï¼Œç›´æ¥å°±æ‹–æ‹½äº†ã€‚</p>
<h2 id="å…³äºAutolayout"><a href="#å…³äºAutolayout" class="headerlink" title="å…³äºAutolayout"></a>å…³äºAutolayout</h2><p>åˆšå¼€å§‹å­¦ä¹ Autolayoutçš„æ—¶å€™ï¼Œä»€ä¹ˆâ€œLeading Edgesâ€ã€â€œHorizontal Centersâ€ï¼Œå¥½å¤šå•Šï¼Œæ„Ÿè§‰ä¸€ä¸‹å­é€‚åº”ä¸æ¥ï¼Œæœ‰æ—¶å€™é¢å¯¹ä¸€ä¸ªç•Œé¢å¸ƒå±€ä¸Šçš„éœ€æ±‚ï¼Œå¯èƒ½éƒ½æ— ä»ä¸‹æ‰‹ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œæˆ‘è§‰å¾—Autolayoutçš„å…³é”®å°±æ˜¯â€œ<strong>Constraintï¼ˆçº¦æŸï¼‰</strong>â€ã€‚å…¶å®å°±æ˜¯ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p>
<ol>
<li>ä»æ˜¾å¼è®¾ç½®frameçš„å±æ€§ï¼Œåˆ°åˆ©ç”¨çº¦æŸæ§åˆ¶Viewçš„å¤§å°ã€ä½ç½®ã€‚</li>
<li>æ€è€ƒå¦‚ä½•å¸ƒå±€æ—¶ï¼Œé‡ç‚¹ä»å•ä¸ªçš„Viewï¼Œåˆ°æ•´ä½“æ‰€æœ‰Viewä¹‹é—´çš„ç›¸äº’å…³ç³»ã€‚</li>
</ol>
<p>æ—¢ç„¶æ²¡æœ‰äº†å…·ä½“è®¾ç½®Viewçš„frameå±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç³»ç»Ÿä¼šåœ¨è¿è¡Œæ—¶ï¼Œé€šè¿‡æˆ‘ä»¬è®¾å®šçš„â€œçº¦æŸâ€ï¼Œè®¡ç®—å‡ºæ¯ä¸ªViewçš„frameï¼Œå†å»ç»˜åˆ¶å±å¹•å†…å®¹ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è®¾ç½®çš„Constraintï¼Œè¦èƒ½ä½“ç°å‡ºViewçš„<strong>ä½ç½®ï¼ˆxã€yåæ ‡ï¼‰</strong>ã€<strong>å¤§å°ï¼ˆå®½é«˜ï¼‰</strong>ã€‚æ— è®ºæ˜¯ç”¨IBæ‹–æ‹½çº¦æŸï¼Œè¿˜æ˜¯æ‰‹å†™ä»£ç ï¼Œåªè¦ä»è¿™ä¸ªè§’åº¦å»æ€è€ƒï¼Œå¾ˆå¤šé—®é¢˜å°±éƒ½èƒ½è§£å†³ã€‚</p>
<p>æœ‰å…³Autolayoutçš„çŸ¥è¯†ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œåœ¨è¿™é‡Œå°±ä¸è¯¦ç»†åˆ—å‡ºäº†ï¼Œä½†æ˜¯æœ‰ä¸ªå…¬å¼å€’æ˜¯å¯ä»¥è´´å‡ºæ¥ï¼š</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">viewA-<span class="keyword">attribute</span> = viewB-<span class="keyword">attribute</span> * multiplier + <span class="keyword">constant</span></div></pre></td></tr></table></figure>
<h2 id="å…³äºMasonry"><a href="#å…³äºMasonry" class="headerlink" title="å…³äºMasonry"></a>å…³äºMasonry</h2><p>å¥½ç”¨ï¼</p>
<h2 id="Case-1-å¹¶æ’ä¸¤ä¸ªlabelï¼Œå®½åº¦ç”±å†…å®¹å†³å®šã€‚çˆ¶çº§Viewå®½åº¦ä¸å¤Ÿæ—¶ï¼Œä¼˜å…ˆæ˜¾ç¤ºå·¦è¾¹labelçš„å†…å®¹"><a href="#Case-1-å¹¶æ’ä¸¤ä¸ªlabelï¼Œå®½åº¦ç”±å†…å®¹å†³å®šã€‚çˆ¶çº§Viewå®½åº¦ä¸å¤Ÿæ—¶ï¼Œä¼˜å…ˆæ˜¾ç¤ºå·¦è¾¹labelçš„å†…å®¹" class="headerlink" title="Case 1: å¹¶æ’ä¸¤ä¸ªlabelï¼Œå®½åº¦ç”±å†…å®¹å†³å®šã€‚çˆ¶çº§Viewå®½åº¦ä¸å¤Ÿæ—¶ï¼Œä¼˜å…ˆæ˜¾ç¤ºå·¦è¾¹labelçš„å†…å®¹"></a>Case 1: å¹¶æ’ä¸¤ä¸ªlabelï¼Œå®½åº¦ç”±å†…å®¹å†³å®šã€‚çˆ¶çº§Viewå®½åº¦ä¸å¤Ÿæ—¶ï¼Œä¼˜å…ˆæ˜¾ç¤ºå·¦è¾¹labelçš„å†…å®¹</h2><p>é‡åˆ°è¿™ç§è·Ÿå†…å®¹å‹ç¼©ã€ä¼˜å…ˆçº§æœ‰å…³çš„å¸ƒå±€ï¼Œå°±ä¸å¾—ä¸æAutolayoutä¸­çš„ä¸¤ä¸ªé‡è¦çš„å±æ€§â€œ<strong>Content Compression Resistance</strong>â€å’Œâ€œ<strong>Content Hugging</strong>â€ã€‚</p>
<h3 id="Content-Compression-Resistance-ä¸è®¸æŒ¤æˆ‘ï¼"><a href="#Content-Compression-Resistance-ä¸è®¸æŒ¤æˆ‘ï¼" class="headerlink" title="Content Compression Resistance = ä¸è®¸æŒ¤æˆ‘ï¼"></a>Content Compression Resistance = ä¸è®¸æŒ¤æˆ‘ï¼</h3><p>å¯¹ï¼Œè¿™ä¸ªå±æ€§è¯´ç™½äº†å°±æ˜¯â€œä¸è®¸æŒ¤æˆ‘â€=ã€‚=<br>è¿™ä¸ªå±æ€§çš„ä¼˜å…ˆçº§ï¼ˆPriorityï¼‰è¶Šé«˜ï¼Œè¶Šä¸â€œå®¹æ˜“â€è¢«å‹ç¼©ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æ•´ä½“çš„ç©ºé—´è£…ä¸ä¸‹æ‰€æœ‰çš„Viewçš„æ—¶å€™ï¼ŒContent Compression Resistanceä¼˜å…ˆçº§è¶Šé«˜çš„ï¼Œæ˜¾ç¤ºçš„å†…å®¹è¶Šå®Œæ•´ã€‚</p>
<h3 id="Content-Hugging-æŠ±ç´§ï¼"><a href="#Content-Hugging-æŠ±ç´§ï¼" class="headerlink" title="Content Hugging = æŠ±ç´§ï¼"></a>Content Hugging = æŠ±ç´§ï¼</h3><p>è¿™ä¸ªå±æ€§çš„ä¼˜å…ˆçº§è¶Šé«˜ï¼Œæ•´ä¸ªViewå°±è¦è¶Šâ€œæŠ±ç´§â€Viewé‡Œé¢çš„å†…å®¹ã€‚ä¹Ÿå°±æ˜¯Viewçš„å¤§å°ä¸ä¼šéšç€çˆ¶çº§Viewçš„æ‰©å¤§è€Œæ‰©å¤§ã€‚</p>
<h3 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><p>æ ¹æ®è¦æ±‚ï¼Œå¯ä»¥å°†çº¦æŸåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li>æ•´ä½“ç©ºé—´è¶³å¤Ÿæ—¶ï¼Œä¸¤ä¸ªlabelçš„å®½åº¦ç”±å†…å®¹å†³å®šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œlabelçš„â€œContent Huggingâ€ä¼˜å…ˆçº§å¾ˆé«˜ï¼Œè€Œä¸”æ²¡æœ‰å›ºå®šçš„Widthå±æ€§ã€‚</li>
<li>æ•´ä½“ç©ºé—´ä¸å¤Ÿæ—¶ï¼Œå·¦è¾¹çš„labelæ›´ä¸å®¹æ˜“è¢«å‹ç¼©ï¼Œä¹Ÿå°±æ˜¯â€œContent Compression Resistanceâ€ä¼˜å…ˆçº§æ›´é«˜ã€‚</li>
</ol>
<p>é‡ç‚¹ï¼š</p>
<ol>
<li>labelä¸è®¾ç½®å…·ä½“çš„å®½åº¦ï¼ˆwidthï¼‰å±æ€§ï¼Œå®½åº¦ç”±å†…å®¹å†³å®šã€‚</li>
<li>æ˜¾ç¤ºçš„ä¼˜å…ˆçº§ç”±â€œContent Compression Resistanceâ€å±æ€§çš„é«˜ä½å†³å®šã€‚</li>
</ol>
<h3 id="çº¦æŸç¤ºä¾‹å›¾"><a href="#çº¦æŸç¤ºä¾‹å›¾" class="headerlink" title="çº¦æŸç¤ºä¾‹å›¾"></a>çº¦æŸç¤ºä¾‹å›¾</h3><p><img src="http://zorrochen.qiniudn.com/blog_autolayout_example_with_masonry_2.png" alt="çº¦æŸç¤ºä¾‹å›¾"></p>
<h3 id="å…³é”®ä»£ç "><a href="#å…³é”®ä»£ç " class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h3><p>å…³é”®çš„ä»£ç å¦‚ä¸‹ï¼šï¼ˆlabel1æ˜¯å·¦è¾¹çš„labelï¼Œlabel2æ˜¯å³è¾¹çš„ï¼‰</p>
<h4 id="è®¾ç½®ä½ç½®"><a href="#è®¾ç½®ä½ç½®" class="headerlink" title="è®¾ç½®ä½ç½®"></a>è®¾ç½®ä½ç½®</h4><figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// label1: ä½äºå·¦ä¸Šè§’</span></div><div class="line">[<span class="variable">_label1</span> mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    make.top.equalTo(<span class="variable">_contentView1</span>.mas_top).<span class="keyword">with</span>.offset(<span class="number">5</span>);</div><div class="line">    make.left.equalTo(<span class="variable">_contentView1</span>.mas_left).<span class="keyword">with</span>.offset(<span class="number">2</span>);</div><div class="line"></div><div class="line">    <span class="comment">// 40é«˜åº¦</span></div><div class="line">    make.height.equalTo(@<span class="number">40</span>);</div><div class="line">&#125;];</div><div class="line"></div><div class="line"><span class="comment">// label2: ä½äºå³ä¸Šè§’</span></div><div class="line">[<span class="variable">_label2</span> mas_makeConstraints:^(MASConstraintMaker *make) &#123;</div><div class="line">    <span class="comment">//å·¦è¾¹è´´ç€label1ï¼Œé—´éš”2</span></div><div class="line">    make.left.equalTo(<span class="variable">_label1</span>.mas_right).<span class="keyword">with</span>.offset(<span class="number">2</span>);</div><div class="line"></div><div class="line">    <span class="comment">//ä¸Šè¾¹è´´ç€çˆ¶viewï¼Œé—´éš”5</span></div><div class="line">    make.top.equalTo(<span class="variable">_contentView1</span>.mas_top).<span class="keyword">with</span>.offset(<span class="number">5</span>);</div><div class="line"></div><div class="line">    <span class="comment">//å³è¾¹çš„é—´éš”ä¿æŒå¤§äºç­‰äº2ï¼Œæ³¨æ„æ˜¯lessThanOrEqual</span></div><div class="line">    <span class="comment">//è¿™é‡Œçš„â€œlessThanOrEqualToâ€æ”¾åœ¨ä»å·¦å¾€å³çš„Xè½´ä¸Šè€ƒè™‘ä¼šæ›´å¥½ç†è§£ã€‚</span></div><div class="line">    <span class="comment">//å³ï¼šlabel2çš„å³è¾¹ç•Œçš„Xåæ ‡å€¼â€œå°äºç­‰äºâ€containViewçš„å³è¾¹ç•Œçš„Xåæ ‡å€¼ã€‚</span></div><div class="line">    make.right.lessThanOrEqualTo(<span class="variable">_contentView1</span>.mas_right).<span class="keyword">with</span>.offset(-<span class="number">2</span>);</div><div class="line"></div><div class="line">    <span class="comment">//åªè®¾ç½®é«˜åº¦40</span></div><div class="line">    make.height.equalTo(@<span class="number">40</span>);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<h4 id="è®¾ç½®å†…å®¹çº¦æŸ"><a href="#è®¾ç½®å†…å®¹çº¦æŸ" class="headerlink" title="è®¾ç½®å†…å®¹çº¦æŸ"></a>è®¾ç½®å†…å®¹çº¦æŸ</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®label1çš„content hugging ä¸º1000</span></div><div class="line">[_label1 setContentHuggingPriority:<span class="built_in">UILayoutPriorityRequired</span></div><div class="line">                           forAxis:<span class="built_in">UILayoutConstraintAxisHorizontal</span>];</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®label1çš„content compression ä¸º1000</span></div><div class="line">[_label1 setContentCompressionResistancePriority:<span class="built_in">UILayoutPriorityRequired</span></div><div class="line">                                         forAxis:<span class="built_in">UILayoutConstraintAxisHorizontal</span>];</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®å³è¾¹çš„label2çš„content hugging ä¸º1000</span></div><div class="line">[_label2 setContentHuggingPriority:<span class="built_in">UILayoutPriorityRequired</span></div><div class="line">                           forAxis:<span class="built_in">UILayoutConstraintAxisHorizontal</span>];</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®å³è¾¹çš„label2çš„content compression ä¸º250</span></div><div class="line">[_label2 setContentCompressionResistancePriority:<span class="built_in">UILayoutPriorityDefaultLow</span></div><div class="line">                                         forAxis:<span class="built_in">UILayoutConstraintAxisHorizontal</span>];</div></pre></td></tr></table></figure>
<h3 id="å°èŠ‚"><a href="#å°èŠ‚" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h3><p>çµæ´»è¿ç”¨â€œContent Compression Resistanceâ€å’Œâ€œContent Huggingâ€å±æ€§ã€‚</p>
<h2 id="Case-2-å››ä¸ªImageViewæ•´ä½“å±…ä¸­ï¼Œå¯ä»¥ä»»æ„æ˜¾ç¤ºã€éšè—"><a href="#Case-2-å››ä¸ªImageViewæ•´ä½“å±…ä¸­ï¼Œå¯ä»¥ä»»æ„æ˜¾ç¤ºã€éšè—" class="headerlink" title="Case 2: å››ä¸ªImageViewæ•´ä½“å±…ä¸­ï¼Œå¯ä»¥ä»»æ„æ˜¾ç¤ºã€éšè—"></a>Case 2: å››ä¸ªImageViewæ•´ä½“å±…ä¸­ï¼Œå¯ä»¥ä»»æ„æ˜¾ç¤ºã€éšè—</h2><p>å…ˆçœ‹çœ‹ç¤ºä¾‹çš„æˆªå›¾ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_autolayout_example_with_masonry_3.png" alt="æ•ˆæœå›¾"></p>
<p>ä¸‹é¢çš„å››ä¸ªSwitchæ§ä»¶åˆ†åˆ«æ§åˆ¶ä¸Šé¢å¯¹åº”ä½ç½®çš„å›¾ç‰‡æ˜¯å¦æ˜¾ç¤ºã€‚</p>
<h3 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h3><ol>
<li>é¦–å…ˆå°±æ˜¯æ•´ä½“å±…ä¸­ï¼Œä¸ºäº†å®ç°è¿™ä¸ªï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯å°†å››ä¸ªå›¾ç‰‡â€œè£…è¿›â€ä¸€ä¸ª<strong>å®¹å™¨View</strong>é‡Œé¢ï¼Œç„¶åè®©è¿™ä¸ªå®¹å™¨Viewåœ¨æ•´ä¸ªé¡µé¢ä¸­å±…ä¸­å³å¯ã€‚è¿™æ ·å°±ä¸ç”¨æ§åˆ¶æ¯ä¸ªå›¾ç‰‡çš„å±…ä¸­æ•ˆæœäº†ã€‚</li>
<li>ç„¶åå°±æ˜¯æ˜¾ç¤ºä¸éšè—ã€‚åœ¨è¿™é‡Œæˆ‘ç›´æ¥æ§åˆ¶å›¾ç‰‡ImageViewçš„å®½åº¦ï¼Œå®½åº¦ä¸º0çš„æ—¶å€™ä¸å°±â€œéšè—â€äº†å—ã€‚</li>
</ol>
<h3 id="çº¦æŸç¤ºä¾‹å›¾-1"><a href="#çº¦æŸç¤ºä¾‹å›¾-1" class="headerlink" title="çº¦æŸç¤ºä¾‹å›¾"></a>çº¦æŸç¤ºä¾‹å›¾</h3><p><img src="http://zorrochen.qiniudn.com/blog_autolayout_example_with_masonry_4.png" alt="çº¦æŸç¤ºä¾‹å›¾"></p>
<p><strong>è§£é‡Š</strong></p>
<p>ä¹‹æ‰€ä»¥è¿™ä¹ˆè®¾ç½®ï¼Œä¸»è¦ç›®çš„æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ol>
<li>å°½é‡å‡å°‘æ— æ•ˆçš„çº¦æŸï¼Œä¿è¯çº¦æŸä¸å¤šä¹Ÿä¸å°‘ã€‚</li>
<li>å†…éƒ¨çš„æ¯ä¸ªimageViewçº¦æŸå…¶å®éƒ½åªæœ‰å››ä¸ªï¼šleftã€centerYã€widthå’Œheightï¼Œè¿™æ ·æœ‰ä¸ªå¥½å¤„ï¼Œå°±æ˜¯å¯ä»¥åœ¨å¾ªç¯é‡Œé¢ä¾æ¬¡æ·»åŠ çº¦æŸï¼Œå¤§å¤§å‡å°‘ä»£ç é‡ã€‚</li>
<li>æœ€å³è¾¹çš„imageViewè¿˜è¦å•ç‹¬è®¾ç½®è·Ÿå®¹å™¨Viewçš„å³è¾¹çº¦æŸï¼Œæ˜¯ä¸ºäº†ä¸ç”¨è®¾ç½®å®¹å™¨Viewçš„widthï¼Œä¿è¯å®¹å™¨Viewæ˜¯åˆšå¥½åŒ…å«å†…éƒ¨çš„Viewçš„ï¼Œè¿™æ ·æ•´ä½“æ‰æ˜¯å±…ä¸­çš„ã€‚</li>
</ol>
<h3 id="å…³é”®ä»£ç -1"><a href="#å…³é”®ä»£ç -1" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h3><p>å…ˆçœ‹çœ‹æœ€å¤–å±‚å®¹å™¨Viewçš„ä»£ç ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//containerView å°±æ˜¯ å®¹å™¨View</span></div><div class="line"></div><div class="line">[_containerView mas_makeConstraints:^(MASConstraintMaker *<span class="built_in">make</span>) &#123;</div><div class="line">    <span class="comment">//åªè®¾ç½®é«˜åº¦ï¼Œå®½åº¦ç”±å­Viewå†³å®š</span></div><div class="line">    <span class="built_in">make</span>.height.equalTo(@(IMAGE_SIZE));</div><div class="line">    <span class="comment">//æ°´å¹³å±…ä¸­</span></div><div class="line">    <span class="built_in">make</span>.centerX.equalTo(self.view.mas_centerX);</div><div class="line">    <span class="comment">//è·ç¦»çˆ¶Viewé¡¶éƒ¨200ç‚¹</span></div><div class="line">    <span class="built_in">make</span>.top.equalTo(self.view.mas_top).offset(<span class="number">200</span>);</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>å¾ªç¯åˆ›å»ºæ¯ä¸ªå†…éƒ¨çš„imageView</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¾ªç¯åˆ›å»ºã€æ·»åŠ imageView</span></div><div class="line"><span class="keyword">for</span> (NSUInteger i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</div><div class="line">    UIImageView *imageView = [[UIImageView alloc] <span class="string">initWithImage:</span>[UIImage <span class="string">imageNamed:</span>_imageNames[i]]];</div><div class="line">    [_imageViews <span class="string">addObject:</span>imageView];</div><div class="line">    [_containerView <span class="string">addSubview:</span>imageView];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ€åæ˜¯å¾ªç¯å¯¹imageViewåŠ ä¸Šçº¦æŸï¼š æ„Ÿè°¢<a href="https://github.com/XVXVXXX" target="_blank" rel="external">XVXVXXX</a>çš„PR:-D</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾å®šå¤§å°</span></div><div class="line">CGSize imageViewSize = CGSizeMake(IMAGE_SIZE, IMAGE_SIZE);</div><div class="line"></div><div class="line"><span class="comment">//åˆ†åˆ«è®¾ç½®æ¯ä¸ªimageViewçš„å®½é«˜ã€å·¦è¾¹ã€å‚ç›´ä¸­å¿ƒçº¦æŸï¼Œæ³¨æ„çº¦æŸçš„å¯¹è±¡</span></div><div class="line"><span class="comment">//æ¯ä¸ªViewçš„å·¦è¾¹çº¦æŸå’Œå·¦è¾¹çš„Viewçš„å³è¾¹ç›¸ç­‰=ã€‚=ï¼Œæœ‰ç‚¹ç»•å£...</span></div><div class="line"></div><div class="line"><span class="comment">// ä¿å­˜å¾ªç¯ä¸­çš„ä¸´æ—¶ç»“æœ</span></div><div class="line">__block UIView *lastView = nil;</div><div class="line">__block MASConstraint *widthConstraint = nil;</div><div class="line"></div><div class="line">NSUInteger arrayCount = _imageViews.count;</div><div class="line">[_imageViews enumerateObjectsUsingBlock:^(UIView *<span class="built_in">view</span>, NSUInteger idx, <span class="keyword">BOOL</span> *<span class="keyword">stop</span>) &#123;</div><div class="line">    [<span class="built_in">view</span> mas_makeConstraints:^(MASConstraintMaker *<span class="built_in">make</span>) &#123;</div><div class="line">        <span class="comment">//å®½é«˜å›ºå®š</span></div><div class="line">        widthConstraint = <span class="built_in">make</span>.width.equalTo(<span class="comment">@(imageViewSize.width));</span></div><div class="line">        make.height.equalTo(@(imageViewSize.height));</div><div class="line">        <span class="comment">//å·¦è¾¹çº¦æŸ</span></div><div class="line">        <span class="built_in">make</span>.left.equalTo(lastView ? lastView.mas_right : <span class="built_in">view</span>.superview.mas_left);</div><div class="line">        <span class="comment">//å‚ç›´ä¸­å¿ƒå¯¹é½</span></div><div class="line">        <span class="built_in">make</span>.centerY.equalTo(<span class="built_in">view</span>.superview.mas_centerY);</div><div class="line">        <span class="comment">//è®¾ç½®æœ€å³è¾¹çš„imageViewçš„å³è¾¹ä¸çˆ¶viewçš„æœ€å³å¯¹é½</span></div><div class="line">        <span class="keyword">if</span> (idx == arrayCount - <span class="number">1</span>) &#123;</div><div class="line">            <span class="built_in">make</span>.right.equalTo(<span class="built_in">view</span>.superview.mas_right);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        [_widthConstraints addObject:widthConstraint];</div><div class="line">        lastView = <span class="built_in">view</span>;</div><div class="line">    &#125;];</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>æ§åˆ¶ImageViewæ˜¾ç¤ºã€éšè—çš„æ—¶å€™ï¼Œç›´æ¥è®©å…¶å®½åº¦ç­‰äº0å°±è¡Œï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">IBAction</span>)showOrHideImage:(<span class="built_in">UISwitch</span> *)sender &#123;</div><div class="line">    <span class="built_in">NSUInteger</span> index = (<span class="built_in">NSUInteger</span>) sender.tag;</div><div class="line">    MASConstraint *width = _widthConstraints[index];</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (sender.on) &#123;</div><div class="line">        width.equalTo(@(IMAGE_SIZE));</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        width.equalTo(@<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å°èŠ‚-1"><a href="#å°èŠ‚-1" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h3><p>æœ‰æ—¶å€™ç”¨ä¸ªâ€œå®¹å™¨Viewâ€ç®¡ç†å†…éƒ¨çš„Viewï¼Œå¾€å¾€ä¼šèµ·åˆ°äº‹åŠåŠŸå€çš„æ•ˆæœã€‚è€Œä¸”åœ¨ç»„ç»‡çº¦æŸçš„æ—¶å€™ï¼Œå°½é‡çš„å°†çº¦æŸç»Ÿä¸€èµ·æ¥ï¼Œè¿™æ ·å¯ä»¥ç”¨ä¸€ä¸ªå‡½æ•°å»è®¾ç½®ï¼Œå‡å°‘ä»£ç é‡ã€‚</p>
<h2 id="Case-3-å­Viewçš„å®½åº¦å§‹ç»ˆæ˜¯çˆ¶çº§Viewçš„ä¸€åŠï¼ˆæˆ–è€…ä»»æ„ç™¾åˆ†æ¯”ï¼‰"><a href="#Case-3-å­Viewçš„å®½åº¦å§‹ç»ˆæ˜¯çˆ¶çº§Viewçš„ä¸€åŠï¼ˆæˆ–è€…ä»»æ„ç™¾åˆ†æ¯”ï¼‰" class="headerlink" title="Case 3: å­Viewçš„å®½åº¦å§‹ç»ˆæ˜¯çˆ¶çº§Viewçš„ä¸€åŠï¼ˆæˆ–è€…ä»»æ„ç™¾åˆ†æ¯”ï¼‰"></a>Case 3: å­Viewçš„å®½åº¦å§‹ç»ˆæ˜¯çˆ¶çº§Viewçš„ä¸€åŠï¼ˆæˆ–è€…ä»»æ„ç™¾åˆ†æ¯”ï¼‰</h2><p>å…¶å®è¿™ä¸ªå¾ˆç®€å•=ã€‚= å†çœ‹çœ‹è¿™ä¸ªå…¬å¼ï¼š</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">viewA-<span class="keyword">attribute</span> = viewB-<span class="keyword">attribute</span> * multiplier + <span class="keyword">constant</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ˜¯Autolayouté‡Œé¢ä¸€ä¸ªçº¦æŸçš„ä¸åŒå±æ€§çš„åŸºæœ¬ç»„åˆå…³ç³»ï¼Œæ›¿æ¢æˆå®½åº¦çš„è¯ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">å­<span class="keyword">View</span>çš„å®½åº¦ = çˆ¶çº§<span class="keyword">View</span>å®½åº¦ * ç³»æ•° + å¸¸æ•°ï¼›</div></pre></td></tr></table></figure>
<p>åœ¨Masonryé‡Œé¢ï¼Œå…¶å®æœ‰ä¸ªå‡½æ•°â€œ<strong>multipliedBy</strong>â€ï¼Œå°±æ˜¯ç”¨æ¥è®¾ç½®multiplerå±æ€§çš„ï¼ˆè·ŸåŸæœ¬çš„NSLayoutConstraintçš„å¯¹åº”ï¼‰ã€‚</p>
<h3 id="å…³é”®ä»£ç -2"><a href="#å…³é”®ä»£ç -2" class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h3><p>å¦‚ä¸‹ï¼š</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">[subView mas_makeConstraints:^(<span class="name">MASConstraintMaker</span> *make) &#123;</div><div class="line">    //ä¸Šä¸‹å·¦è´´è¾¹</div><div class="line">    make.left.equalTo(<span class="name">_containerView.mas_left</span>)<span class="comment">;</span></div><div class="line">    make.top.equalTo(<span class="name">_containerView.mas_top</span>)<span class="comment">;</span></div><div class="line">    make.bottom.equalTo(<span class="name">_containerView.mas_bottom</span>)<span class="comment">;</span></div><div class="line"></div><div class="line">    //å®½åº¦ä¸ºçˆ¶viewçš„å®½åº¦çš„ä¸€åŠ</div><div class="line">    make.width.equalTo(<span class="name">_containerView.mas_width</span>).multipliedBy(<span class="number">0.5</span>)<span class="comment">;</span></div><div class="line">&#125;]<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>æ¥ç€ï¼Œåªè¦æ§åˆ¶çˆ¶çº§Viewçš„å®½åº¦ï¼Œå­Viewçš„å®½åº¦å°±ä¼šéšç€å˜åŒ–äº†ã€‚</p>
<h3 id="å°èŠ‚-2"><a href="#å°èŠ‚-2" class="headerlink" title="å°èŠ‚"></a>å°èŠ‚</h3><p>multipliedByåœ¨Masonryçš„Githubä¸»é¡µé‡Œé¢æ²¡æœ‰=ã€‚=<br>æ‰€ä»¥è¦å…»æˆè¯»å¤´æ–‡ä»¶çš„ä¹ æƒ¯~</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ‰å…³Autolayoutçš„ä¸œè¥¿è¿˜æœ‰å¥½å¤šæ²¡æœ‰å†™ï¼Œä»€ä¹ˆåŠ¨ç”»å•Šã€åŠ¨æ€ä¿®æ”¹çº¦æŸä¹‹ç±»çš„ï¼Œæœ¬æ–‡ä¹Ÿç®—æ˜¯ä¸ªå¼•å­å§ï¼Œä»»é‡è€Œé“è¿œ~</p>
<p>èƒ½çœ‹åˆ°è¿™çš„æœ‹å‹ï¼Œä¹Ÿç®—æ˜¯å¾ˆæœ‰è€å¿ƒäº†ï¼Œå“ˆå“ˆ~~</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://github.com/SnapKit/Masonry" target="_blank" rel="external">SnapKit/Masonry</a></li>
<li><a href="http://adad184.com/2014/09/28/use-masonry-to-quick-solve-autolayout/" target="_blank" rel="external">Masonryä»‹ç»ä¸ä½¿ç”¨å®è·µ(å¿«é€Ÿä¸Šæ‰‹Autolayout)</a></li>
<li><a href="http://www.vienta.me/2014/12/07/AutoLayout-å¿˜æ‰Frame-æ‹¥æŠ±Constraintï¼ˆIï¼‰/" target="_blank" rel="external">AutoLayout:å¿˜æ‰Frame,æ‹¥æŠ±Constraint</a></li>
<li><a href="https://www.zybuluo.com/MicroCai/note/73867#autolayout-åŸºç¡€" target="_blank" rel="external">Autolayout åŸºç¡€</a></li>
<li><a href="http://codingobjc.com/blog/2015/01/28/autolayoutzhong-de-content-compression-resistancehe-content-huggingdao-di-shi-shi-yao-yi-si/" target="_blank" rel="external">å¯¹Auto Layoutä¸­çš„Content Compression Resistanceå’ŒContent Huggingçš„æ€»ç»“</a></li>
<li><a href="https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/AutolayoutPG/Introduction/Introduction.html" target="_blank" rel="external">Auto Layout Guide</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2016-08-06: ç¬¬å››ç¯‡: &lt;a href=&quot;http://tutuge.me/2016/08/06/autolayout-example-with-masonry4/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹4-Masonryå®ç°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;2015-12-23: æ„Ÿè°¢&lt;a href=&quot;https://github.com/XVXVXXX&quot;&gt;XVXVXXX&lt;/a&gt;çš„PRï¼Œæ›´æ–°äº†Case2&lt;/li&gt;
&lt;li&gt;2015-12-15: ç¬¬ä¸‰ç¯‡ï¼š&lt;a href=&quot;http://tutuge.me/2015/12/14/autolayout-example-with-masonry3/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹3-Masonryå®ç°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;2015-11-27: æ„Ÿè°¢â€œè°¢å°é›·â€æŒ‡å‡ºæ‰“å­—é”™è¯¯~&lt;/li&gt;
&lt;li&gt;2015-9-10: ç¬¬äºŒç¯‡: &lt;a href=&quot;http://tutuge.me/2015/08/08/autolayout-example-with-masonry2/&quot;&gt;æœ‰è¶£çš„Autolayoutç¤ºä¾‹2-Masonryå®ç°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;2015-9-1: æ„Ÿè°¢â€œç‹æŒ¯å®‡Cè‰¹â€æŒ‡å‡ºæ‰“å­—é”™è¯¯ï¼Œå·²ç»ä¿®æ”¹äº†å“ˆ~&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å¥½ä¹…æ²¡æœ‰å†™Blogäº†ï¼Œè¿™æ®µæ—¶é—´æœ‰ç‚¹å¿™å•Š=ã€‚=&lt;br&gt;æœ¬æ–‡ä¸¾äº†3ä¸ªæ¯”è¾ƒæœ‰â€œç‰¹ç‚¹â€çš„Autolayoutä¾‹å­ï¼Œæºäºå¾®åšä¸Šå¥½å‹çš„æé—®ï¼Œæ„Ÿè§‰æ¯”è¾ƒæœ‰æ„æ€ï¼Œä¹Ÿæ¯”è¾ƒæœ‰ä»£è¡¨æ€§ï¼Œå°±å†™äº†å‡ºæ¥ï¼Œåˆ†äº«ç»™å¤§å®¶~&lt;br&gt;è‡³äºä¸ºä»€ä¹ˆç”¨Masonryï¼Œé‚£æ˜¯å› ä¸ºå®ƒå¥½ç”¨å•Šï¼ï¼ˆè¢«é—®åˆ°è¿‡æœ‰å…³Masonryçš„é—®é¢˜ï¼Œå°±ç´¢æ€§ç”¨å®ƒæ¥å®ç°å§=ã€‚=ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&quot;æ•ˆæœå›¾&quot;&gt;&lt;a href=&quot;#æ•ˆæœå›¾&quot; class=&quot;headerlink&quot; title=&quot;æ•ˆæœå›¾&quot;&gt;&lt;/a&gt;æ•ˆæœå›¾&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;http://zorrochen.qiniudn.com/blog_autolayout_example_with_masonry_1.gif&quot; alt=&quot;æ•ˆæœå›¾&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Githubåœ°å€&quot;&gt;&lt;a href=&quot;#Githubåœ°å€&quot; class=&quot;headerlink&quot; title=&quot;Githubåœ°å€&quot;&gt;&lt;/a&gt;Githubåœ°å€&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/zekunyan/AutolayoutExampleWithMasonry&quot;&gt;https://github.com/zekunyan/AutolayoutExampleWithMasonry&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="Autolayout" scheme="http://tutuge.me/tags/Autolayout/"/>
    
      <category term="Masonry" scheme="http://tutuge.me/tags/Masonry/"/>
    
  </entry>
  
  <entry>
    <title>UITextViewç¼–è¾‘æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…-ç»­-è‡ªå®šä¹‰è¡¨æƒ…å›¾ç‰‡çš„å¤§å°</title>
    <link href="http://tutuge.me/2015/04/21/resizable-nstextattachment/"/>
    <id>http://tutuge.me/2015/04/21/resizable-nstextattachment/</id>
    <published>2015-04-21T12:26:17.000Z</published>
    <updated>2016-03-20T09:03:47.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><ul>
<li>2015-11-27ï¼šå¢åŠ äº†åˆ©ç”¨NSTextAttachmentçš„boundså±æ€§ä¿®æ”¹å¤§å°çš„æ–¹æ³•ã€‚</li>
</ul>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡æ˜¯åŸºäº<a href="http://tutuge.me/2015/03/07/UITextViewç¼–è¾‘æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…-ç®€å•çš„å›¾æ–‡æ··ç¼–/">UITextViewç¼–è¾‘æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…-ç®€å•çš„å›¾æ–‡æ··ç¼–</a>å†™çš„ï¼Œä¸»è¦å®ç°äº†åœ¨UITextViewæ’å…¥è¡¨æƒ…å›¾ç‰‡æ—¶ï¼Œè‡ªå®šä¹‰è¡¨æƒ…å¤§å°çš„åŠŸèƒ½ã€‚</p>
<h4 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h4><p>æœ¬æ–‡ä»£ç å·¥ç¨‹åœ°å€ï¼š<a href="https://github.com/zekunyan/UITextViewDIYEmojiExample" target="_blank" rel="external">https://github.com/zekunyan/UITextViewDIYEmojiExample</a></p>
<h4 id="Gifç¤ºä¾‹å›¾"><a href="#Gifç¤ºä¾‹å›¾" class="headerlink" title="Gifç¤ºä¾‹å›¾"></a>Gifç¤ºä¾‹å›¾</h4><p><img src="http://zorrochen.qiniudn.com/blog_resizable_nstextattachment_1.gif" alt="Gifç¤ºä¾‹å›¾"></p>
<a id="more"></a>
<h2 id="å…³é”®ç‚¹"><a href="#å…³é”®ç‚¹" class="headerlink" title="å…³é”®ç‚¹"></a>å…³é”®ç‚¹</h2><p>é¦–å…ˆè¦æ˜ç¡®æˆ‘ä»¬è¦ä»€ä¹ˆï¼Œå¾ˆç®€å•ï¼Œå°±æ˜¯<strong>æŒ‡å®šNSTextAttachmentåœ¨è¢«ç»˜åˆ¶æ—¶çš„å¤§å°</strong>ã€‚</p>
<p>æ‰€ä»¥ï¼ŒæŒ‰ç…§è¿™ä¸ªæ€è·¯ï¼Œå°±å¯ä»¥å»æ‰¾æ‰¾NSTextAttachmentç±»çš„ç›¸å…³æ–¹æ³•ï¼Œçœ‹èƒ½ä¸èƒ½é€šè¿‡ç»§æ‰¿æˆ–å…¶ä»–çš„æ–¹å¼æ”¹å˜å¤§å°ã€‚</p>
<h3 id="æ–¹æ³•1-NSTextAttachmentContainer"><a href="#æ–¹æ³•1-NSTextAttachmentContainer" class="headerlink" title="æ–¹æ³•1 - NSTextAttachmentContainer"></a>æ–¹æ³•1 - NSTextAttachmentContainer</h3><p>NSTextAttachmentå®ç°äº†â€œ<strong>NSTextAttachmentContainer</strong>â€è¿™ä¸ªProtocolï¼Œè€Œè¿™ä¸ªProtocolé‡Œé¢æœ‰å¦‚ä¸‹æ–¹æ³•ï¼š</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- <span class="params">(CGRect)</span>attachmentBoundsForTextContainer:<span class="params">(NSTextContainer *)</span>textContainer</div><div class="line">                      proposedLineFragment:<span class="params">(CGRect)</span>lineFrag</div><div class="line">                             glyphPosition:<span class="params">(CGPoint)</span>position</div><div class="line">                            characterIndex:<span class="params">(NSUInteger)</span>charIndex</div></pre></td></tr></table></figure>
<p>å†çœ‹çœ‹å…¶è§£é‡Šï¼š<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Returns <span class="keyword">the</span> layout bounds <span class="keyword">of</span> <span class="keyword">the</span> <span class="keyword">text</span> attachment <span class="built_in">to</span> <span class="keyword">the</span> layout manager. (required)</div></pre></td></tr></table></figure></p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç»˜åˆ¶NSTextAttachmentçš„å†…å®¹çš„æ—¶å€™ï¼Œå†…å®¹çš„â€œBoundsâ€æ˜¯é€šè¿‡è¿™ä¸ªæ–¹æ³•è·å¾—çš„ã€‚æ‰€ä»¥ï¼Œå¯ä»¥é‡å†™è¿™ä¸ªæ–¹æ³•ï¼Œæ¥è¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ã€‚</p>
<h3 id="æ–¹æ³•2-ç›´æ¥ä¿®æ”¹bounds"><a href="#æ–¹æ³•2-ç›´æ¥ä¿®æ”¹bounds" class="headerlink" title="æ–¹æ³•2 - ç›´æ¥ä¿®æ”¹bounds"></a>æ–¹æ³•2 - ç›´æ¥ä¿®æ”¹bounds</h3><p>NSTextAttachmentè¿˜æœ‰ä¸€ä¸ªå±æ€§<code>@property(nonatomic) CGRect bounds</code>ï¼Œå…¶è§£é‡Šå¦‚ä¸‹ï¼š<br><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Defines the layout bounds <span class="keyword">of</span> the receiver<span class="symbol">'s</span> graphical representation <span class="keyword">in</span> the <span class="literal">text</span> coordinate system.</div></pre></td></tr></table></figure></p>
<p>æ‰€ä»¥ï¼Œä¿®æ”¹è¿™ä¸ªä¹Ÿå¯ä»¥è¾¾åˆ°ç›®çš„ã€‚</p>
<h2 id="å®ç°æ–¹æ³•1-ç»§ç»­æ‰©å±•NSTextAttachmentç±»"><a href="#å®ç°æ–¹æ³•1-ç»§ç»­æ‰©å±•NSTextAttachmentç±»" class="headerlink" title="å®ç°æ–¹æ³•1 - ç»§ç»­æ‰©å±•NSTextAttachmentç±»"></a>å®ç°æ–¹æ³•1 - ç»§ç»­æ‰©å±•NSTextAttachmentç±»</h2><h3 id="ä¿å­˜è‡ªå®šä¹‰Size"><a href="#ä¿å­˜è‡ªå®šä¹‰Size" class="headerlink" title="ä¿å­˜è‡ªå®šä¹‰Size"></a>ä¿å­˜è‡ªå®šä¹‰Size</h3><p>æ ¹æ®ä¹‹å‰çš„å®šä¹‰ï¼Œæˆ‘ä»¬åœ¨è‡ªå®šä¹‰çš„ç±»â€œEmojiTextAttachmentâ€ä¸­å†åŠ ä¸€ä¸ªä¿å­˜å¤§å°çš„å±æ€§ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//EmojiTextAttachmentç±»å®šä¹‰</span></div><div class="line"></div><div class="line"><span class="variable">@interface</span> <span class="attribute">EmojiTextAttachment </span>: NSTextAttachment</div><div class="line"><span class="comment">//è¡¨æƒ…çš„å­—ç¬¦ä¸²è¡¨ç¤ºï¼Œè§å‰æ–‡</span></div><div class="line"><span class="variable">@property</span>(strong, nonatomic) NSString *emojiTag;</div><div class="line"></div><div class="line"><span class="comment">//æ–°å¢ï¼šä¿å­˜å½“å‰è¡¨æƒ…å›¾ç‰‡çš„å¤§å°</span></div><div class="line"><span class="variable">@property</span>(assign, nonatomic) CGSize emojiSize;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>æœ‰äº†â€œ<strong>emojiSize</strong>â€è¿™ä¸ªå±æ€§ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è‡ªç”±çš„æŒ‡å®šæ¯ä¸ªNSTextAttachmentçš„å¤§å°ã€‚</p>
<h3 id="é‡å†™"><a href="#é‡å†™" class="headerlink" title="é‡å†™"></a>é‡å†™</h3><p>æ¥ä¸‹æ¥å°±æ˜¯é‡å†™æ–¹æ³•ï¼Œä¸å¤šè¯´ï¼Œè§ä»£ç ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//EmojiTextAttachmentå®ç°</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">EmojiTextAttachment</span></span></div><div class="line"></div><div class="line"><span class="comment">//é‡ç‚¹ï¼é‡å†™NSTextAttachmentContainer Protocolçš„æ–¹æ³•</span></div><div class="line">- (<span class="built_in">CGRect</span>)attachmentBoundsForTextContainer:(<span class="built_in">NSTextContainer</span> *)textContainer proposedLineFragment:(<span class="built_in">CGRect</span>)lineFrag glyphPosition:(<span class="built_in">CGPoint</span>)position characterIndex:(<span class="built_in">NSUInteger</span>)charIndex &#123;</div><div class="line">	<span class="comment">// è¿”å›æˆ‘ä»¬æŒ‡å®šçš„size</span></div><div class="line">    <span class="keyword">return</span> <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, _emojiSize.width, _emojiSize.height);</div><div class="line">&#125;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h2 id="å®ç°æ–¹æ³•2"><a href="#å®ç°æ–¹æ³•2" class="headerlink" title="å®ç°æ–¹æ³•2"></a>å®ç°æ–¹æ³•2</h2><p>ç›´æ¥åœ¨åˆ›å»ºè¡¨æƒ…NSTextAttachmentçš„æ—¶å€™è®¾ç½®<code>bounds</code>å±æ€§å³å¯ã€‚</p>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>å¢åŠ äº†emojiSizeå±æ€§åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨åˆ›å»ºè¡¨æƒ…ï¼Œç”šè‡³åˆ›å»ºåï¼Œè‡ªç”±çš„è°ƒæ•´æ¯ä¸ªNSTextAttachmentçš„å¤§å°ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸€å…±åªå¢åŠ äº†åå‡ è¡Œä»£ç ï¼Œä½†æ˜¯æ•ˆæœè¿˜æ˜¯ä¸é”™å“’~</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/NSTextAttachment_Class_TextKit/index.html#//apple_ref/occ/instp/NSTextAttachment/fileType" target="_blank" rel="external">NSTextAttachment</a></li>
<li><a href="https://developer.apple.com/library/prerelease/ios/documentation/UIKit/Reference/NSTextAttachmentContainer_Protocol/index.html#//apple_ref/occ/intfm/NSTextAttachmentContainer/attachmentBoundsForTextContainer:proposedLineFragment:glyphPosition:characterIndex:" target="_blank" rel="external">NSTextAttachmentContainer</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2015-11-27ï¼šå¢åŠ äº†åˆ©ç”¨NSTextAttachmentçš„boundså±æ€§ä¿®æ”¹å¤§å°çš„æ–¹æ³•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡æ˜¯åŸºäº&lt;a href=&quot;http://tutuge.me/2015/03/07/UITextViewç¼–è¾‘æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…-ç®€å•çš„å›¾æ–‡æ··ç¼–/&quot;&gt;UITextViewç¼–è¾‘æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…-ç®€å•çš„å›¾æ–‡æ··ç¼–&lt;/a&gt;å†™çš„ï¼Œä¸»è¦å®ç°äº†åœ¨UITextViewæ’å…¥è¡¨æƒ…å›¾ç‰‡æ—¶ï¼Œè‡ªå®šä¹‰è¡¨æƒ…å¤§å°çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h4 id=&quot;Github&quot;&gt;&lt;a href=&quot;#Github&quot; class=&quot;headerlink&quot; title=&quot;Github&quot;&gt;&lt;/a&gt;Github&lt;/h4&gt;&lt;p&gt;æœ¬æ–‡ä»£ç å·¥ç¨‹åœ°å€ï¼š&lt;a href=&quot;https://github.com/zekunyan/UITextViewDIYEmojiExample&quot;&gt;https://github.com/zekunyan/UITextViewDIYEmojiExample&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;Gifç¤ºä¾‹å›¾&quot;&gt;&lt;a href=&quot;#Gifç¤ºä¾‹å›¾&quot; class=&quot;headerlink&quot; title=&quot;Gifç¤ºä¾‹å›¾&quot;&gt;&lt;/a&gt;Gifç¤ºä¾‹å›¾&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;http://zorrochen.qiniudn.com/blog_resizable_nstextattachment_1.gif&quot; alt=&quot;Gifç¤ºä¾‹å›¾&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>RPCæ¡†æ¶Thriftä¾‹å­-PHPè°ƒç”¨C++åç«¯ç¨‹åº</title>
    <link href="http://tutuge.me/2015/04/19/thrift-example-cpp-and-php/"/>
    <id>http://tutuge.me/2015/04/19/thrift-example-cpp-and-php/</id>
    <published>2015-04-19T09:04:56.000Z</published>
    <updated>2016-03-20T09:03:50.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><ul>
<li>2016-02-22: Responseå¯¹è±¡ä¸ç”¨ä¸»åŠ¨åˆ›å»ºã€‚</li>
</ul>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰æ®µæ—¶é—´ç”¨äº†ä¸€ä¸‹Facebookçš„å¼€æºRPCæ¡†æ¶Thriftï¼ŒåšPHPå®¢æˆ·ç«¯è°ƒç”¨C++åç«¯ç¨‹åºï¼ŒçœŸå¿ƒè§‰å¾—Thriftä¸é”™ï¼</p>
<p>æœ¬æ–‡é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/zekunyan/ThriftDemo_PHP_CPP" target="_blank" rel="external">https://github.com/zekunyan/ThriftDemo_PHP_CPP</a></p>
<p>å…ˆçœ‹çœ‹æœ¬æ–‡çš„ä¾‹å­ç¤ºæ„å›¾ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_thrift_example_cpp_and_php_1.jpg" alt="é€šä¿¡ç¤ºæ„å›¾"></p>
<p><strong>æµç¨‹</strong></p>
<ol>
<li>PHPå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚å‚æ•°æ˜¯â€œRequestâ€ç±»å‹ï¼Œé‡Œé¢æœ‰studentIDå‚æ•°ã€‚</li>
<li>CPPæœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚è¿”å›æ•°æ®ï¼Œè¿”å›ç±»å‹ä¸ºâ€œResponseâ€ï¼Œé‡Œé¢åŒ…å«äº†studentçš„ä¿¡æ¯ï¼Œæ­¤å¤„åªæ˜¯ç®€å•çš„ç¤ºä¾‹ã€‚</li>
</ol>
<a id="more"></a>
<h2 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h2><h3 id="ä»€ä¹ˆæ˜¯RPC"><a href="#ä»€ä¹ˆæ˜¯RPC" class="headerlink" title="ä»€ä¹ˆæ˜¯RPC"></a>ä»€ä¹ˆæ˜¯RPC</h3><p>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆè‹±è¯­ï¼šRemote Procedure Callï¼Œç¼©å†™ä¸º RPCï¼‰æ˜¯ä¸€ä¸ªè®¡ç®—æœºé€šä¿¡åè®®ã€‚è¯¥åè®®å…è®¸è¿è¡Œäºä¸€å°è®¡ç®—æœºçš„ç¨‹åºè°ƒç”¨å¦ä¸€å°è®¡ç®—æœºçš„å­ç¨‹åºï¼Œè€Œç¨‹åºå‘˜æ— éœ€é¢å¤–åœ°ä¸ºè¿™ä¸ªäº¤äº’ä½œç”¨ç¼–ç¨‹ã€‚ â€“ ç»´åŸºç™¾ç§‘ - <a href="http://zh.wikipedia.org/wiki/%E9%81%A0%E7%A8%8B%E9%81%8E%E7%A8%8B%E8%AA%BF%E7%94%A8" target="_blank" rel="external">è¿œç¨‹è¿‡ç¨‹è°ƒç”¨</a></p>
<p>é€šä¿—ç‚¹è®²ï¼Œå°±æ˜¯è·¨è®¡ç®—æœºã€è·¨ç½‘ç»œè°ƒç”¨ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯Thrift"><a href="#ä»€ä¹ˆæ˜¯Thrift" class="headerlink" title="ä»€ä¹ˆæ˜¯Thrift"></a>ä»€ä¹ˆæ˜¯Thrift</h3><p>Apache Thrift æ˜¯Facebookå®ç°çš„ä¸€ç§é«˜æ•ˆçš„ã€æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€çš„è¿œç¨‹æœåŠ¡è°ƒç”¨(RPC)çš„æ¡†æ¶ã€‚å®ƒé‡‡ç”¨æ¥å£æè¿°è¯­è¨€å®šä¹‰å¹¶åˆ›å»ºæœåŠ¡ï¼Œæ”¯æŒå¯æ‰©å±•çš„è·¨è¯­è¨€æœåŠ¡å¼€å‘ï¼Œæ‰€åŒ…å«çš„ä»£ç ç”Ÿæˆå¼•æ“å¯ä»¥åœ¨å¤šç§è¯­è¨€ä¸­ï¼Œå¦‚ C++, Java, Python, PHP, Ruby, Erlang, Perl, Haskell, C#, Cocoa, Smalltalk ç­‰åˆ›å»ºé«˜æ•ˆçš„ã€æ— ç¼çš„æœåŠ¡ï¼Œå…¶ä¼ è¾“æ•°æ®é‡‡ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼Œç›¸å¯¹ XML å’Œ JSON ä½“ç§¯æ›´å°ï¼Œå¯¹äºé«˜å¹¶å‘ã€å¤§æ•°æ®é‡å’Œå¤šè¯­è¨€çš„ç¯å¢ƒæ›´æœ‰ä¼˜åŠ¿ã€‚ â€“ <a href="https://www.ibm.com/developerworks/cn/java/j-lo-apachethrift/" target="_blank" rel="external">Apache Thrift - å¯ä¼¸ç¼©çš„è·¨è¯­è¨€æœåŠ¡å¼€å‘æ¡†æ¶</a></p>
<h2 id="å¼€å‘æµç¨‹"><a href="#å¼€å‘æµç¨‹" class="headerlink" title="å¼€å‘æµç¨‹"></a>å¼€å‘æµç¨‹</h2><ol>
<li>é…ç½®ç¯å¢ƒã€‚C++çš„å¦‚CMakeã€makeã€g++ï¼›PHPçš„å¦‚phpã€php-fpmã€Apacheï¼ˆNginxï¼‰ã€‚</li>
<li>æ ¹æ®éœ€æ±‚ï¼Œç¼–å†™thriftæ¥å£å®šä¹‰æ–‡ä»¶ï¼ˆIDLå®šä¹‰æ–‡ä»¶ï¼‰ã€‚</li>
<li>ä½¿ç”¨thriftç¨‹åºï¼Œä¸ºä¸åŒçš„è¯­è¨€ç”Ÿæˆä»£ç ã€‚</li>
<li>æ ¹æ®éœ€æ±‚ï¼Œä¿®æ”¹ç”Ÿæˆçš„ä»£ç ï¼ˆä¸»è¦æ˜¯Serverç«¯ï¼‰ï¼Œç¼–å†™å®é™…çš„ä¸šåŠ¡é€»è¾‘ã€‚</li>
<li>ç¼–è¯‘ã€éƒ¨ç½²ã€‚</li>
</ol>
<h2 id="Thriftçš„æ¥å£å®šä¹‰æ–‡ä»¶"><a href="#Thriftçš„æ¥å£å®šä¹‰æ–‡ä»¶" class="headerlink" title="Thriftçš„æ¥å£å®šä¹‰æ–‡ä»¶"></a>Thriftçš„æ¥å£å®šä¹‰æ–‡ä»¶</h2><p>åœ¨åˆ©ç”¨Thriftå¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œé‡ç‚¹å°±æ˜¯ç¼–å†™æ¥å£å®šä¹‰æ–‡ä»¶ã€‚<br>ä¸€èˆ¬æ¥è¯´ï¼Œæ¥å£å®šä¹‰æ–‡ä»¶å†³å®šäº†RPCè¿‡ç¨‹ä¸­çš„é€šä¿¡æ•°æ®ç»“æ„ã€é€šä¿¡æ¥å£å®šä¹‰ç­‰ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œthriftçš„æ¥å£å®šä¹‰è¯­æ³•ç±»ä¼¼äºCè¯­è¨€ï¼ŒåŒ…å«äº†structã€enumã€mapã€listç­‰åŸºç¡€æ•°æ®ç»“æ„ï¼ŒåŒæ—¶æ”¯æŒå¤§éƒ¨åˆ†åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¦‚32ä½æ•´å‹â€œi32â€ç­‰ã€‚</p>
<p>è¯¦ç»†çš„æ¥å£å®šä¹‰è¯·å‚è€ƒï¼š</p>
<ul>
<li><a href="http://thrift.apache.org/docs/idl" target="_blank" rel="external">Thrift interface description language</a></li>
<li><a href="https://git-wip-us.apache.org/repos/asf?p=thrift.git;a=blob_plain;f=tutorial/tutorial.thrift" target="_blank" rel="external">example.thrift</a></li>
</ul>
<p>çœ‹çœ‹æœ¬ä¾‹å­ä¸­çš„å®šä¹‰æ–‡ä»¶â€œTTG.thriftâ€ï¼š</p>
<figure class="highlight thrift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">namespace</span> cpp TTG</div><div class="line"><span class="keyword">namespace</span> php TTG</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">ResponseState</span> </span>&#123;</div><div class="line">    StateOk = <span class="number">0</span>,</div><div class="line">    StateError = <span class="number">1</span>,</div><div class="line">    StateEmpty = <span class="number">2</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Request</span> </span>&#123;</div><div class="line">    <span class="number">1</span>: <span class="built_in">i32</span> studentID = <span class="number">0</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Response</span> </span>&#123;</div><div class="line">    <span class="number">1</span>: <span class="built_in">i32</span> studentID = <span class="number">0</span>,</div><div class="line">    <span class="number">2</span>: <span class="built_in">string</span> name,</div><div class="line">    <span class="number">3</span>: list&lt;<span class="keyword">string</span>&gt; infos,</div><div class="line">    <span class="number">4</span>: ResponseState state</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">service</span> <span class="title">TTGService</span> </span>&#123;</div><div class="line">    Response getStudentInfo(<span class="number">1</span>: Request request);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ol>
<li>å…ˆå®šä¹‰å‘½åç©ºé—´ï¼Œå°½é‡å‡å°‘å‘½åå†²çªã€‚</li>
<li>Requestç±»å‹ï¼šPHPå®¢æˆ·ç«¯è¯·æ±‚çš„æ•°æ®ç±»å‹ã€‚</li>
<li>Responseç±»å‹ï¼šCPPæœåŠ¡ç«¯è¿”å›çš„æ•°æ®ç±»å‹ã€‚</li>
<li>ResponseStateæšä¸¾ï¼šå®šä¹‰è¿”å›çš„çŠ¶æ€ã€‚</li>
<li>TTGServiceï¼šæœåŠ¡æ¥å£å®šä¹‰ã€‚</li>
</ol>
<h2 id="ç”Ÿæˆå¯¹åº”è¯­è¨€çš„ä»£ç ï¼"><a href="#ç”Ÿæˆå¯¹åº”è¯­è¨€çš„ä»£ç ï¼" class="headerlink" title="ç”Ÿæˆå¯¹åº”è¯­è¨€çš„ä»£ç ï¼"></a>ç”Ÿæˆå¯¹åº”è¯­è¨€çš„ä»£ç ï¼</h2><p>æ˜¯çš„ï¼Œç”Ÿæˆä»£ç ï¼è¿™æ˜¯æˆ‘è§‰å¾—Thriftæ¡†æ¶æœ€â€œç¥å¥‡â€çš„åœ°æ–¹ã€‚æˆ‘ä»¬åªéœ€è¦æ‰§è¡Œå‡ æ¡å‘½ä»¤ï¼Œå°±å¯ä»¥æ ¹æ®æ¥å£å®šä¹‰æ–‡ä»¶â€œç”Ÿæˆâ€å¯¹åº”è¯­è¨€çš„ä»£ç ã€‚ç„¶åæˆ‘ä»¬åªéœ€è¦å°†å¯¹åº”çš„ä¸šåŠ¡é€»è¾‘åŠ å…¥åˆ°ç”Ÿæˆçš„ä»£ç ä¸­å³å¯ã€‚</p>
<p>å¦‚ç”ŸæˆCPPæœåŠ¡ç«¯çš„ä»£ç ï¼š</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">thrift <span class="comment">--gen cpp TTG.thrift</span></div></pre></td></tr></table></figure>
<p>ç„¶åå°±ä¼šç”Ÿæˆå¦‚ä¸‹ä»£ç ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">TTGService<span class="selector-class">.cpp</span></div><div class="line">TTGService<span class="selector-class">.h</span></div><div class="line">TTGService_server<span class="selector-class">.skeleton</span><span class="selector-class">.cpp</span></div><div class="line">TTG_constants<span class="selector-class">.cpp</span></div><div class="line">TTG_constants<span class="selector-class">.h</span></div><div class="line">TTG_types<span class="selector-class">.cpp</span></div><div class="line">TTG_types.h</div></pre></td></tr></table></figure>
<h2 id="æ ¹æ®éœ€è¦ä¿®æ”¹ç”Ÿæˆçš„ä»£ç "><a href="#æ ¹æ®éœ€è¦ä¿®æ”¹ç”Ÿæˆçš„ä»£ç " class="headerlink" title="æ ¹æ®éœ€è¦ä¿®æ”¹ç”Ÿæˆçš„ä»£ç "></a>æ ¹æ®éœ€è¦ä¿®æ”¹ç”Ÿæˆçš„ä»£ç </h2><p>ç”ŸæˆCPPã€PHPç«¯çš„ä»£ç ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ã€æ·»åŠ ä¸šåŠ¡ä»£ç ã€‚</p>
<h3 id="CPPæœåŠ¡ç«¯"><a href="#CPPæœåŠ¡ç«¯" class="headerlink" title="CPPæœåŠ¡ç«¯"></a>CPPæœåŠ¡ç«¯</h3><p>åœ¨ç”ŸæˆCPPçš„ä»£ç æ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªâ€œTTGService_server.skeleton.cppâ€æ–‡ä»¶ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬çš„CPPæœåŠ¡ç«¯çš„ä»£ç â€œæ¶å­â€ã€‚å…¶ä¸­é‡ç‚¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®ç°è°ƒç”¨çš„æ¥å£</span></div><div class="line"><span class="keyword">class</span> TTGServiceHandler : <span class="keyword">virtual</span> <span class="keyword">public</span> TTGServiceIf &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">TTGServiceHandler() &#123;</div><div class="line">    <span class="comment">// Your initialization goes here</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//æ¥å£å®ç°éƒ¨åˆ†ï¼Œå®ç°getStudentInfoè¿™ä¸ªæ¥å£çš„å…·ä½“ç»†èŠ‚ï¼Œå¦‚æ ¹æ®requeståˆ›å»ºã€è¿”å›å¯¹åº”çš„response</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">getStudentInfo</span><span class="params">(Response&amp; _return, <span class="keyword">const</span> Request&amp; request)</span> </span>&#123;</div><div class="line">    <span class="comment">// Your implementation goes here</span></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"getStudentInfo\n"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;;</div><div class="line"><span class="comment">//...</span></div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†å…¶æ”¹æˆï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> getStudentInfo(Response &amp;_<span class="keyword">return</span>, <span class="keyword">const</span> Request &amp;request) &#123;</div><div class="line">    <span class="comment">// è¾“å‡ºè¯·æ±‚å‚æ•°</span></div><div class="line">    cout&lt;&lt;<span class="string">"Request: "</span>&lt;&lt;request.studentID&lt;&lt;endl;</div><div class="line"></div><div class="line">    <span class="comment">//å¡«å……æ•°æ®ï¼ŒResponseå¯¹è±¡ä¸ç”¨ä¸»åŠ¨åˆ›å»ºï¼Œè¿›å…¥å‡½æ•°æ—¶å·²ç»åˆ›å»ºå¥½äº†</span></div><div class="line">    _<span class="keyword">return</span>.studentID = request.studentID;</div><div class="line">    _<span class="keyword">return</span>.name = <span class="string">"tutuge"</span>;</div><div class="line">    _<span class="keyword">return</span>.infos.push_back(<span class="string">"Info 1"</span>);</div><div class="line">    _<span class="keyword">return</span>.infos.push_back(<span class="string">"Info 2"</span>);</div><div class="line">    _<span class="keyword">return</span>.state = ResponseState::StateOk;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼ŒCPPæœåŠ¡ç«¯çš„ç¼–å†™å°±å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åªéœ€è¦ç¼–è¯‘ã€é“¾æ¥ï¼Œæ‰§è¡Œæœ€ç»ˆç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶å³å¯ã€‚</p>
<h3 id="PHPå®¢æˆ·ç«¯"><a href="#PHPå®¢æˆ·ç«¯" class="headerlink" title="PHPå®¢æˆ·ç«¯"></a>PHPå®¢æˆ·ç«¯</h3><p>PHPå®¢æˆ·ç«¯çš„ç¼–å†™æ¯”è¾ƒç®€å•ï¼Œç›´æ¥å‚è€ƒä»£ç å§ï¼š<a href="https://github.com/zekunyan/ThriftDemo_PHP_CPP/blob/master/PHP/client.php" target="_blank" rel="external">https://github.com/zekunyan/ThriftDemo_PHP_CPP/blob/master/PHP/client.php</a></p>
<h2 id="ç¼–è¯‘ã€é“¾æ¥ï¼Œè¿è¡Œ"><a href="#ç¼–è¯‘ã€é“¾æ¥ï¼Œè¿è¡Œ" class="headerlink" title="ç¼–è¯‘ã€é“¾æ¥ï¼Œè¿è¡Œ"></a>ç¼–è¯‘ã€é“¾æ¥ï¼Œè¿è¡Œ</h2><p>ç”¨CMakeï¼Œæˆ–è€…ç›´æ¥ç¼–å†™makefileå‡å¯ï¼Œä¿è¯Thriftè£…å¥½å°±è¡Œäº†ã€‚</p>
<p>ç›´æ¥è¿è¡Œæœ€åç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶TTG.runå³å¯ã€‚</p>
<p>ä»æµè§ˆå™¨ï¼Œæˆ–è€…ç›´æ¥è¿è¡Œclient.phpï¼Œå³å¯çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">object(TTG\Response)[<span class="number">9</span>]</div><div class="line">  <span class="keyword">public</span> <span class="string">'studentID'</span> =&gt; <span class="keyword">int</span> <span class="number">100</span></div><div class="line">  <span class="keyword">public</span> <span class="string">'name'</span> =&gt; string <span class="string">'tutuge'</span> (length=<span class="number">6</span>)</div><div class="line">  <span class="keyword">public</span> <span class="string">'infos'</span> =&gt;</div><div class="line">    <span class="keyword">array</span> (size=<span class="number">2</span>)</div><div class="line">      <span class="number">0</span> =&gt; string <span class="string">'Info 1'</span> (length=<span class="number">6</span>)</div><div class="line">      <span class="number">1</span> =&gt; string <span class="string">'Info 2'</span> (length=<span class="number">6</span>)</div><div class="line">  <span class="keyword">public</span> <span class="string">'state'</span> =&gt; <span class="keyword">int</span> <span class="number">0</span></div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Thriftæ˜¯ä¸ªå¥½ä¸œè¥¿ï¼å°±æ˜¯æ–‡æ¡£å¥½å°‘=ã€‚=</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="http://thrift.apache.org/" target="_blank" rel="external">Apache Thrift</a></li>
<li><a href="http://thrift.apache.org/tutorial/php" target="_blank" rel="external">Thrift PHP Tutorial</a></li>
<li><a href="http://thrift.apache.org/tutorial/cpp" target="_blank" rel="external">Thrift C++ Tutorial</a></li>
<li><a href="http://en.wikipedia.org/wiki/Apache_Thrift" target="_blank" rel="external">Apache Thrift</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-apachethrift/" target="_blank" rel="external">Apache Thrift - å¯ä¼¸ç¼©çš„è·¨è¯­è¨€æœåŠ¡å¼€å‘æ¡†æ¶</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2016-02-22: Responseå¯¹è±¡ä¸ç”¨ä¸»åŠ¨åˆ›å»ºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å‰æ®µæ—¶é—´ç”¨äº†ä¸€ä¸‹Facebookçš„å¼€æºRPCæ¡†æ¶Thriftï¼ŒåšPHPå®¢æˆ·ç«¯è°ƒç”¨C++åç«¯ç¨‹åºï¼ŒçœŸå¿ƒè§‰å¾—Thriftä¸é”™ï¼&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡é¡¹ç›®åœ°å€ï¼š&lt;a href=&quot;https://github.com/zekunyan/ThriftDemo_PHP_CPP&quot;&gt;https://github.com/zekunyan/ThriftDemo_PHP_CPP&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…ˆçœ‹çœ‹æœ¬æ–‡çš„ä¾‹å­ç¤ºæ„å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://zorrochen.qiniudn.com/blog_thrift_example_cpp_and_php_1.jpg&quot; alt=&quot;é€šä¿¡ç¤ºæ„å›¾&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æµç¨‹&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;PHPå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚å‚æ•°æ˜¯â€œRequestâ€ç±»å‹ï¼Œé‡Œé¢æœ‰studentIDå‚æ•°ã€‚&lt;/li&gt;
&lt;li&gt;CPPæœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚è¿”å›æ•°æ®ï¼Œè¿”å›ç±»å‹ä¸ºâ€œResponseâ€ï¼Œé‡Œé¢åŒ…å«äº†studentçš„ä¿¡æ¯ï¼Œæ­¤å¤„åªæ˜¯ç®€å•çš„ç¤ºä¾‹ã€‚&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="æœåŠ¡ç«¯" scheme="http://tutuge.me/categories/%E6%9C%8D%E5%8A%A1%E7%AB%AF/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="C++" scheme="http://tutuge.me/tags/C/"/>
    
      <category term="PHP" scheme="http://tutuge.me/tags/PHP/"/>
    
      <category term="åç«¯" scheme="http://tutuge.me/tags/%E5%90%8E%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>GCDä½¿ç”¨ç»éªŒä¸æŠ€å·§æµ…è°ˆ</title>
    <link href="http://tutuge.me/2015/04/03/something-about-gcd/"/>
    <id>http://tutuge.me/2015/04/03/something-about-gcd/</id>
    <published>2015-04-03T13:59:56.000Z</published>
    <updated>2016-08-07T06:14:47.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>GCD(Grand Central Dispatch)å¯ä»¥è¯´æ˜¯Macã€iOSå¼€å‘ä¸­çš„ä¸€å¤§â€œåˆ©å™¨â€ï¼Œæœ¬æ–‡å°±æ€»ç»“ä¸€äº›æœ‰å…³ä½¿ç”¨GCDçš„ç»éªŒä¸æŠ€å·§ã€‚</p>
<h2 id="dispatch-once-tå¿…é¡»æ˜¯å…¨å±€æˆ–staticå˜é‡"><a href="#dispatch-once-tå¿…é¡»æ˜¯å…¨å±€æˆ–staticå˜é‡" class="headerlink" title="dispatch_once_tå¿…é¡»æ˜¯å…¨å±€æˆ–staticå˜é‡"></a>dispatch_once_tå¿…é¡»æ˜¯å…¨å±€æˆ–staticå˜é‡</h2><p>è¿™ä¸€æ¡ç®—æ˜¯â€œè€ç”Ÿå¸¸è°ˆâ€äº†ï¼Œä½†æˆ‘è®¤ä¸ºè¿˜æ˜¯æœ‰å¿…è¦å¼ºè°ƒä¸€æ¬¡ï¼Œæ¯•ç«Ÿéå…¨å±€æˆ–éstaticçš„dispatch_once_tå˜é‡åœ¨ä½¿ç”¨æ—¶ä¼šå¯¼è‡´éå¸¸ä¸å¥½æ’æŸ¥çš„bugï¼Œæ­£ç¡®çš„å¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//é™æ€å˜é‡ï¼Œä¿è¯åªæœ‰ä¸€ä»½å®ä¾‹ï¼Œæ‰èƒ½ç¡®ä¿åªæ‰§è¡Œä¸€æ¬¡</span></div><div class="line"><span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</div><div class="line"><span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</div><div class="line">   <span class="comment">//å•ä¾‹ä»£ç </span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å…¶å®å°±æ˜¯ä¿è¯<strong>dispatch_once_t</strong>åªæœ‰ä¸€ä»½å®ä¾‹ã€‚</p>
<a id="more"></a>
<h2 id="dispatch-queue-createçš„ç¬¬äºŒä¸ªå‚æ•°"><a href="#dispatch-queue-createçš„ç¬¬äºŒä¸ªå‚æ•°" class="headerlink" title="dispatch_queue_createçš„ç¬¬äºŒä¸ªå‚æ•°"></a>dispatch_queue_createçš„ç¬¬äºŒä¸ªå‚æ•°</h2><p><strong>dispatch_queue_create</strong>ï¼Œåˆ›å»ºé˜Ÿåˆ—ç”¨çš„ï¼Œå®ƒçš„å‚æ•°åªæœ‰ä¸¤ä¸ªï¼ŒåŸå‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">dispatch_queue_t</span> dispatch_queue_create ( <span class="keyword">const</span> <span class="keyword">char</span> *label, <span class="keyword">dispatch_queue_attr_t</span> attr );</div></pre></td></tr></table></figure>
<p>åœ¨ç½‘ä¸Šçš„å¤§éƒ¨åˆ†æ•™ç¨‹é‡Œï¼ˆç”šè‡³Appleè‡ªå·±çš„æ–‡æ¡£é‡Œï¼‰ï¼Œéƒ½æ˜¯è¿™ä¹ˆåˆ›å»ºä¸²è¡Œé˜Ÿåˆ—çš„ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">dispatch_queue_t</span> <span class="built_in">queue</span> = dispatch_queue_create(<span class="string">"com.example.MyQueue"</span>, <span class="literal">NULL</span>);</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¼ çš„æ˜¯â€œ<strong>NULL</strong>â€ã€‚  ä½†æ˜¯dispatch_queue_attr_tç±»å‹æ˜¯æœ‰å·²ç»å®šä¹‰å¥½çš„å¸¸é‡çš„ï¼Œæ‰€ä»¥æˆ‘è®¤ä¸ºï¼Œä¸ºäº†æ›´åŠ çš„æ¸…æ™°ã€ä¸¥è°¨ï¼Œæœ€å¥½å¦‚ä¸‹åˆ›å»ºé˜Ÿåˆ—ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ä¸²è¡Œé˜Ÿåˆ—</span></div><div class="line"><span class="keyword">dispatch_queue_t</span> <span class="built_in">queue</span> = dispatch_queue_create(<span class="string">"com.example.MyQueue"</span>, DISPATCH_QUEUE_SERIAL);</div><div class="line"></div><div class="line"><span class="comment">//å¹¶è¡Œé˜Ÿåˆ—</span></div><div class="line"><span class="keyword">dispatch_queue_t</span> <span class="built_in">queue</span> = dispatch_queue_create(<span class="string">"com.example.MyQueue"</span>, DISPATCH_QUEUE_CONCURRENT);</div></pre></td></tr></table></figure>
<p>å¸¸é‡å°±æ˜¯ä¸ºäº†ä½¿ä»£ç æ›´åŠ â€œæ˜“æ‡‚â€ï¼Œæ›´åŠ æ¸…æ™°ï¼Œæ—¢ç„¶æœ‰ï¼Œä¸ºå•¥ä¸ç”¨å‘¢~</p>
<h2 id="dispatch-afteræ˜¯å»¶è¿Ÿæäº¤ï¼Œä¸æ˜¯å»¶è¿Ÿè¿è¡Œ"><a href="#dispatch-afteræ˜¯å»¶è¿Ÿæäº¤ï¼Œä¸æ˜¯å»¶è¿Ÿè¿è¡Œ" class="headerlink" title="dispatch_afteræ˜¯å»¶è¿Ÿæäº¤ï¼Œä¸æ˜¯å»¶è¿Ÿè¿è¡Œ"></a>dispatch_afteræ˜¯<strong>å»¶è¿Ÿæäº¤</strong>ï¼Œä¸æ˜¯<strong>å»¶è¿Ÿè¿è¡Œ</strong></h2><p>å…ˆçœ‹çœ‹å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼š</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Enqueue <span class="keyword">a</span> block <span class="keyword">for</span> execution <span class="keyword">at</span> <span class="keyword">the</span> specified <span class="built_in">time</span>.</div></pre></td></tr></table></figure>
<p><strong>Enqueue</strong>ï¼Œå°±æ˜¯å…¥é˜Ÿï¼ŒæŒ‡çš„å°±æ˜¯å°†ä¸€ä¸ªBlockåœ¨ç‰¹å®šçš„å»¶æ—¶ä»¥åï¼ŒåŠ å…¥åˆ°æŒ‡å®šçš„é˜Ÿåˆ—ä¸­ï¼Œ<strong>ä¸æ˜¯åœ¨ç‰¹å®šçš„æ—¶é—´åç«‹å³è¿è¡Œï¼</strong>ã€‚</p>
<p>çœ‹çœ‹å¦‚ä¸‹ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—</span></div><div class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_queue_create(<span class="string">"me.tutuge.test.gcd"</span>, DISPATCH_QUEUE_SERIAL);</div><div class="line"></div><div class="line"><span class="comment">//ç«‹å³æ‰“å°ä¸€æ¡ä¿¡æ¯</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"Begin add block..."</span>);</div><div class="line"></div><div class="line"><span class="comment">//æäº¤ä¸€ä¸ªblock</span></div><div class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</div><div class="line">    <span class="comment">//Sleep 10ç§’</span></div><div class="line">    [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">10</span>];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"First block done..."</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//5 ç§’ä»¥åæäº¤block</span></div><div class="line">dispatch_after(dispatch_time(DISPATCH_TIME_NOW, (int64_t)(<span class="number">5</span> * <span class="built_in">NSEC_PER_SEC</span>)), queue, ^&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"After..."</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2015<span class="selector-tag">-03-31</span> 20<span class="selector-pseudo">:57</span><span class="selector-pseudo">:27.122</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[45633:1812016]</span> <span class="selector-tag">Begin</span> <span class="selector-tag">add</span> <span class="selector-tag">block</span>...</div><div class="line">2015<span class="selector-tag">-03-31</span> 20<span class="selector-pseudo">:57</span><span class="selector-pseudo">:37.127</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[45633:1812041]</span> <span class="selector-tag">First</span> <span class="selector-tag">block</span> <span class="selector-tag">done</span>...</div><div class="line">2015<span class="selector-tag">-03-31</span> 20<span class="selector-pseudo">:57</span><span class="selector-pseudo">:37.127</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[45633:1812041]</span> <span class="selector-tag">After</span>...</div></pre></td></tr></table></figure>
<p>ä»ç»“æœä¹ŸéªŒè¯äº†ï¼Œdispatch_afteråªæ˜¯å»¶æ—¶æäº¤blockï¼Œå¹¶ä¸æ˜¯å»¶æ—¶åç«‹å³æ‰§è¡Œã€‚æ‰€ä»¥æƒ³ç”¨dispatch_afterç²¾ç¡®æ§åˆ¶è¿è¡ŒçŠ¶æ€çš„æœ‹å‹å¯è¦æ³¨æ„äº†~</p>
<h2 id="æ­£ç¡®åˆ›å»ºdispatch-time-t"><a href="#æ­£ç¡®åˆ›å»ºdispatch-time-t" class="headerlink" title="æ­£ç¡®åˆ›å»ºdispatch_time_t"></a>æ­£ç¡®åˆ›å»ºdispatch_time_t</h2><p>ç”¨dispatch_afterçš„æ—¶å€™å°±ä¼šç”¨åˆ°dispatch_time_tå˜é‡ï¼Œä½†æ˜¯å¦‚ä½•åˆ›å»ºåˆé€‚çš„æ—¶é—´å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ç”¨<strong>dispatch_time</strong>å‡½æ•°ï¼Œå…¶åŸå‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">dispatch_time_t </span><span class="keyword">dispatch_time </span>( <span class="keyword">dispatch_time_t </span>when, int64_t delta )<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸€èˆ¬æ˜¯<strong>DISPATCH_TIME_NOW</strong>ï¼Œè¡¨ç¤ºä»ç°åœ¨å¼€å§‹ã€‚<br>é‚£ä¹ˆç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯çœŸæ­£çš„å»¶æ—¶çš„å…·ä½“æ—¶é—´ã€‚</p>
<p>è¿™é‡Œè¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œ<strong>delta</strong>å‚æ•°æ˜¯â€œ<strong>çº³ç§’ï¼</strong>â€ï¼Œå°±æ˜¯è¯´ï¼Œå»¶æ—¶1ç§’çš„è¯ï¼Œdeltaåº”è¯¥æ˜¯â€œ1000000000â€=ã€‚=ï¼Œå¤ªé•¿äº†ï¼Œæ‰€ä»¥ç†æ‰€å½“ç„¶ç³»ç»Ÿæä¾›äº†å¸¸é‡ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> NSEC_PER_SEC 1000000000ull</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> USEC_PER_SEC 1000000ull</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> NSEC_PER_USEC 1000ull</span></div></pre></td></tr></table></figure>
<p>å…³é”®è¯è§£é‡Šï¼š</p>
<ul>
<li>NSECï¼šçº³ç§’ã€‚</li>
<li>USECï¼šå¾®å¦™ã€‚</li>
<li>SECï¼šç§’</li>
<li>PERï¼šæ¯</li>
</ul>
<p>æ‰€ä»¥ï¼š</p>
<ol>
<li>NSEC_PER_SECï¼Œæ¯ç§’æœ‰å¤šå°‘çº³ç§’ã€‚</li>
<li>USEC_PER_SECï¼Œæ¯ç§’æœ‰å¤šå°‘æ¯«ç§’ã€‚ï¼ˆæ³¨æ„æ˜¯æŒ‡åœ¨çº³ç§’çš„åŸºç¡€ä¸Šï¼‰</li>
<li>NSEC_PER_USECï¼Œæ¯æ¯«ç§’æœ‰å¤šå°‘çº³ç§’ã€‚</li>
</ol>
<p>æ‰€ä»¥ï¼Œå»¶æ—¶<strong>1ç§’</strong>å¯ä»¥å†™æˆå¦‚ä¸‹å‡ ç§ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">dispatch_time(DISPATCH_TIME_NOW, </span><span class="number">1</span> * NSEC_PER_SEC)<span class="comment">;</span></div><div class="line"><span class="keyword">dispatch_time(DISPATCH_TIME_NOW, </span><span class="number">1000</span> * USEC_PER_SEC)<span class="comment">;</span></div><div class="line"><span class="keyword">dispatch_time(DISPATCH_TIME_NOW, </span>USEC_PER_SEC * NSEC_PER_USEC)<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>æœ€åä¸€ä¸ªâ€œ<strong>USEC_PER_SEC * NSEC_PER_USEC</strong>â€ï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯â€œ<strong>æ¯ç§’çš„æ¯«ç§’æ•°ä¹˜ä»¥æ¯æ¯«ç§’çš„çº³ç§’æ•°</strong>â€ï¼Œä¹Ÿå°±æ˜¯â€œ<strong>æ¯ç§’çš„çº³ç§’æ•°</strong>â€ï¼Œæ‰€ä»¥ï¼Œå»¶æ—¶500æ¯«ç§’ä¹‹ç±»çš„ï¼Œä¹Ÿå°±ä¸éš¾äº†å§~</p>
<h2 id="dispatch-suspend-ç«‹å³åœæ­¢é˜Ÿåˆ—çš„è¿è¡Œ"><a href="#dispatch-suspend-ç«‹å³åœæ­¢é˜Ÿåˆ—çš„è¿è¡Œ" class="headerlink" title="dispatch_suspend != ç«‹å³åœæ­¢é˜Ÿåˆ—çš„è¿è¡Œ"></a>dispatch_suspend != ç«‹å³åœæ­¢é˜Ÿåˆ—çš„è¿è¡Œ</h2><p><strong>dispatch_suspend</strong>ï¼Œ<strong>dispatch_resume</strong>æä¾›äº†â€œæŒ‚èµ·ã€æ¢å¤â€é˜Ÿåˆ—çš„åŠŸèƒ½ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯å¯ä»¥æš‚åœã€æ¢å¤é˜Ÿåˆ—ä¸Šçš„ä»»åŠ¡ã€‚ä½†æ˜¯è¿™é‡Œçš„â€œ<strong>æŒ‚èµ·</strong>â€ï¼Œå¹¶ä¸èƒ½ä¿è¯å¯ä»¥<strong>ç«‹å³</strong>åœæ­¢é˜Ÿåˆ—ä¸Šæ­£åœ¨è¿è¡Œçš„blockï¼Œçœ‹å¦‚ä¸‹ä¾‹å­ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_queue_create(<span class="string">"me.tutuge.test.gcd"</span>, DISPATCH_QUEUE_SERIAL);</div><div class="line"></div><div class="line"><span class="comment">//æäº¤ç¬¬ä¸€ä¸ªblockï¼Œå»¶æ—¶5ç§’æ‰“å°ã€‚</span></div><div class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</div><div class="line">    [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">5</span>];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"After 5 seconds..."</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//æäº¤ç¬¬äºŒä¸ªblockï¼Œä¹Ÿæ˜¯å»¶æ—¶5ç§’æ‰“å°</span></div><div class="line"><span class="built_in">dispatch_async</span>(queue, ^&#123;</div><div class="line">    [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">5</span>];</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"After 5 seconds again..."</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//å»¶æ—¶ä¸€ç§’</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"sleep 1 second..."</span>);</div><div class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="comment">//æŒ‚èµ·é˜Ÿåˆ—</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"suspend..."</span>);</div><div class="line">dispatch_suspend(queue);</div><div class="line"></div><div class="line"><span class="comment">//å»¶æ—¶10ç§’</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"sleep 10 second..."</span>);</div><div class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">10</span>];</div><div class="line"></div><div class="line"><span class="comment">//æ¢å¤é˜Ÿåˆ—</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"resume..."</span>);</div><div class="line">dispatch_resume(queue);</div></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:32</span><span class="selector-pseudo">:09.903</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47201:1883834]</span> <span class="selector-tag">sleep</span> 1 <span class="selector-tag">second</span>...</div><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:32</span><span class="selector-pseudo">:10.910</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47201:1883834]</span> <span class="selector-tag">suspend</span>...</div><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:32</span><span class="selector-pseudo">:10.910</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47201:1883834]</span> <span class="selector-tag">sleep</span> 10 <span class="selector-tag">second</span>...</div><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:32</span><span class="selector-pseudo">:14.908</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47201:1883856]</span> <span class="selector-tag">After</span> 5 <span class="selector-tag">seconds</span>...</div><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:32</span><span class="selector-pseudo">:20.911</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47201:1883834]</span> <span class="selector-tag">resume</span>...</div><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:32</span><span class="selector-pseudo">:25.912</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47201:1883856]</span> <span class="selector-tag">After</span> 5 <span class="selector-tag">seconds</span> <span class="selector-tag">again</span>...</div></pre></td></tr></table></figure>
<p>å¯çŸ¥ï¼Œåœ¨dispatch_suspendæŒ‚èµ·é˜Ÿåˆ—åï¼Œç¬¬ä¸€ä¸ªblock<strong>è¿˜æ˜¯åœ¨è¿è¡Œ</strong>ï¼Œå¹¶ä¸”æ­£å¸¸è¾“å‡ºã€‚<br>ç»“åˆæ–‡æ¡£ï¼Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œdispatch_suspendå¹¶ä¸ä¼šç«‹å³æš‚åœæ­£åœ¨è¿è¡Œçš„blockï¼Œè€Œæ˜¯åœ¨å½“å‰blockæ‰§è¡Œå®Œæˆåï¼Œæš‚åœåç»­çš„blockæ‰§è¡Œã€‚</p>
<p>æ‰€ä»¥ä¸‹æ¬¡æƒ³æš‚åœæ­£åœ¨é˜Ÿåˆ—ä¸Šè¿è¡Œçš„blockæ—¶ï¼Œè¿˜æ˜¯ä¸è¦ç”¨dispatch_suspendäº†å§~</p>
<h2 id="â€œåŒæ­¥â€çš„dispatch-apply"><a href="#â€œåŒæ­¥â€çš„dispatch-apply" class="headerlink" title="â€œåŒæ­¥â€çš„dispatch_apply"></a>â€œåŒæ­¥â€çš„dispatch_apply</h2><p>dispatch_applyçš„ä½œç”¨æ˜¯åœ¨ä¸€ä¸ªé˜Ÿåˆ—ï¼ˆä¸²è¡Œæˆ–å¹¶è¡Œï¼‰ä¸Šâ€œè¿è¡Œâ€å¤šæ¬¡blockï¼Œå…¶å®å°±æ˜¯ç®€åŒ–äº†ç”¨å¾ªç¯å»å‘é˜Ÿåˆ—ä¾æ¬¡æ·»åŠ blockä»»åŠ¡ã€‚ä½†æ˜¯æˆ‘ä¸ªäººè§‰å¾—è¿™ä¸ªå‡½æ•°å°±æ˜¯ä¸ªâ€œå‘â€ï¼Œå…ˆçœ‹çœ‹å¦‚ä¸‹ä»£ç è¿è¡Œç»“æœï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ›å»ºå¼‚æ­¥ä¸²è¡Œé˜Ÿåˆ—</span></div><div class="line"><span class="keyword">dispatch_queue_t</span> <span class="built_in">queue</span> = dispatch_queue_create(<span class="string">"me.tutuge.test.gcd"</span>, DISPATCH_QUEUE_SERIAL);</div><div class="line"></div><div class="line"><span class="comment">//è¿è¡Œblock3æ¬¡</span></div><div class="line">dispatch_apply(<span class="number">3</span>, <span class="built_in">queue</span>, ^(<span class="keyword">size_t</span> i) &#123;</div><div class="line">    NSLog(@<span class="string">"apply loop: %zu"</span>, i);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//æ‰“å°ä¿¡æ¯</span></div><div class="line">NSLog(@<span class="string">"After apply"</span>);</div></pre></td></tr></table></figure>
<p>è¿è¡Œçš„ç»“æœæ˜¯ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:55</span><span class="selector-pseudo">:40.854</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47402:1893289]</span> <span class="selector-tag">apply</span> <span class="selector-tag">loop</span>: 0</div><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:55</span><span class="selector-pseudo">:40.856</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47402:1893289]</span> <span class="selector-tag">apply</span> <span class="selector-tag">loop</span>: 1</div><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:55</span><span class="selector-pseudo">:40.856</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47402:1893289]</span> <span class="selector-tag">apply</span> <span class="selector-tag">loop</span>: 2</div><div class="line">2015<span class="selector-tag">-04-01</span> 00<span class="selector-pseudo">:55</span><span class="selector-pseudo">:40.856</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[47402:1893289]</span> <span class="selector-tag">After</span> <span class="selector-tag">apply</span></div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œæ˜æ˜æ˜¯æäº¤åˆ°å¼‚æ­¥çš„é˜Ÿåˆ—å»è¿è¡Œï¼Œä½†æ˜¯â€œAfter applyâ€å±…ç„¶åœ¨applyåæ‰“å°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œdispatch_applyå°†å¤–é¢çš„çº¿ç¨‹ï¼ˆmainçº¿ç¨‹ï¼‰<strong>â€œé˜»å¡â€</strong>äº†ï¼</p>
<p>æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼Œdispatch_applyç¡®å®ä¼šâ€œç­‰å¾…â€å…¶æ‰€æœ‰çš„å¾ªç¯è¿è¡Œå®Œæ¯•æ‰å¾€ä¸‹æ‰§è¡Œ=ã€‚=ï¼Œçœ‹æ¥è¦å°å¿ƒä½¿ç”¨äº†ã€‚</p>
<h2 id="é¿å…æ­»é”ï¼"><a href="#é¿å…æ­»é”ï¼" class="headerlink" title="é¿å…æ­»é”ï¼"></a>é¿å…æ­»é”ï¼</h2><h4 id="dispatch-syncå¯¼è‡´çš„æ­»é”"><a href="#dispatch-syncå¯¼è‡´çš„æ­»é”" class="headerlink" title="dispatch_syncå¯¼è‡´çš„æ­»é”"></a>dispatch_syncå¯¼è‡´çš„æ­»é”</h4><p>æ¶‰åŠåˆ°å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œä¸å¯é¿å…çš„å°±ä¼šæœ‰â€œæ­»é”â€è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨GCDæ—¶ï¼Œå¾€å¾€ä¸€ä¸å°å¿ƒï¼Œå°±å¯èƒ½é€ æˆæ­»é”ï¼Œçœ‹çœ‹ä¸‹é¢çš„â€œ<strong>æ­»é”</strong>â€ä¾‹å­ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åœ¨mainçº¿ç¨‹ä½¿ç”¨â€œåŒæ­¥â€æ–¹æ³•æäº¤Blockï¼Œå¿…å®šä¼šæ­»é”ã€‚</span></div><div class="line"><span class="built_in">dispatch_sync</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">    <span class="built_in">NSLog</span>(<span class="string">@"I am block..."</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä½ å¯èƒ½ä¼šè¯´ï¼Œè¿™ä¹ˆä½çº§çš„é”™è¯¯ï¼Œæˆ‘æ€ä¹ˆä¼šçŠ¯ï¼Œé‚£ä¹ˆï¼Œçœ‹çœ‹ä¸‹é¢çš„ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)updateUI1 &#123;</div><div class="line">    <span class="built_in">dispatch_sync</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Update ui 1"</span>);</div><div class="line"></div><div class="line">        <span class="comment">//æ­»é”ï¼</span></div><div class="line">        [<span class="keyword">self</span> updateUI2];</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)updateUI2 &#123;</div><div class="line">    <span class="built_in">dispatch_sync</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">        <span class="built_in">NSLog</span>(<span class="string">@"Update ui 2"</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨ä½ ä¸æ³¨æ„çš„æ—¶å€™ï¼ŒåµŒå¥—è°ƒç”¨å¯èƒ½å°±ä¼šé€ æˆæ­»é”ï¼æ‰€ä»¥ä¸ºäº†â€œä¸–ç•Œå’Œå¹³â€=ã€‚=ï¼Œæˆ‘ä»¬è¿˜æ˜¯å°‘ç”¨<strong>dispatch_sync</strong>å§ã€‚</p>
<h4 id="dispatch-applyå¯¼è‡´çš„æ­»é”ï¼"><a href="#dispatch-applyå¯¼è‡´çš„æ­»é”ï¼" class="headerlink" title="dispatch_applyå¯¼è‡´çš„æ­»é”ï¼"></a>dispatch_applyå¯¼è‡´çš„æ­»é”ï¼</h4><p>å•¥ï¼Œdispatch_applyå¯¼è‡´çš„æ­»é”ï¼Ÿã€‚ã€‚ã€‚æ˜¯çš„ï¼Œå‰ä¸€èŠ‚è®²åˆ°ï¼Œdispatch_applyä¼š<strong>ç­‰</strong>å¾ªç¯æ‰§è¡Œå®Œæˆï¼Œè¿™ä¸å°±å·®ä¸å¤šæ˜¯<strong>é˜»å¡</strong>äº†å—ã€‚çœ‹å¦‚ä¸‹ä¾‹å­ï¼š</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">dispatch_queue_t queue = dispatch_queue_create(<span class="string">"me.tutuge.test.gcd"</span>, DISPATCH_QUEUE_SERIAL)<span class="comment">;</span></div><div class="line"></div><div class="line">dispatch_apply(<span class="number">3</span>, queue, ^(<span class="name">size_t</span> i) &#123;</div><div class="line">	NSLog(@<span class="string">"apply loop: %zu"</span>, i)<span class="comment">;</span></div><div class="line"></div><div class="line">    //å†æ¥ä¸€ä¸ªdispatch_applyï¼æ­»é”ï¼</div><div class="line">	dispatch_apply(<span class="number">3</span>, queue, ^(<span class="name">size_t</span> j) &#123;</div><div class="line">		NSLog(@<span class="string">"apply loop inside %zu"</span>, j)<span class="comment">;</span></div><div class="line">	&#125;)<span class="comment">;</span></div><div class="line">&#125;)<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>è¿™ç«¯ä»£ç åªä¼šè¾“å‡ºâ€œapply loop: 1â€ã€‚ã€‚ã€‚å°±æ²¡æœ‰ç„¶åäº†=ã€‚=</p>
<p>æ‰€ä»¥ï¼Œä¸€å®šè¦é¿å…dispatch_applyçš„<strong>åµŒå¥—è°ƒç”¨</strong>ã€‚</p>
<h2 id="çµæ´»ä½¿ç”¨dispatch-group"><a href="#çµæ´»ä½¿ç”¨dispatch-group" class="headerlink" title="çµæ´»ä½¿ç”¨dispatch_group"></a>çµæ´»ä½¿ç”¨dispatch_group</h2><p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦ç­‰å¾…ä¸€ç³»åˆ—ä»»åŠ¡ï¼ˆblockï¼‰æ‰§è¡Œå®Œæˆï¼Œç„¶åå†åšä¸€äº›æ”¶å°¾çš„å·¥ä½œã€‚å¦‚æœæ˜¯æœ‰åºçš„ä»»åŠ¡ï¼Œå¯ä»¥åˆ†æ­¥éª¤å®Œæˆçš„ï¼Œç›´æ¥ä½¿ç”¨ä¸²è¡Œé˜Ÿåˆ—å°±è¡Œã€‚ä½†æ˜¯å¦‚æœæ˜¯ä¸€ç³»åˆ—<strong>å¹¶è¡Œ</strong>æ‰§è¡Œçš„ä»»åŠ¡å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦dispatch_groupå¸®å¿™äº†~æ€»çš„æ¥è¯´ï¼Œdispatch_groupçš„ä½¿ç”¨åˆ†å¦‚ä¸‹å‡ æ­¥ï¼š</p>
<ol>
<li>åˆ›å»ºdispatch_group_t</li>
<li>æ·»åŠ ä»»åŠ¡ï¼ˆblockï¼‰</li>
<li>æ·»åŠ ç»“æŸä»»åŠ¡ï¼ˆå¦‚æ¸…ç†æ“ä½œã€é€šçŸ¥UIç­‰ï¼‰</li>
</ol>
<p>ä¸‹é¢ç€é‡è®²è®²åœ¨åé¢ä¸¤æ­¥ã€‚</p>
<h4 id="æ·»åŠ ä»»åŠ¡"><a href="#æ·»åŠ ä»»åŠ¡" class="headerlink" title="æ·»åŠ ä»»åŠ¡"></a>æ·»åŠ ä»»åŠ¡</h4><p>æ·»åŠ ä»»åŠ¡å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p>
<ol>
<li>è‡ªå·±åˆ›å»ºé˜Ÿåˆ—ï¼šä½¿ç”¨<strong>dispatch_group_async</strong>ã€‚</li>
<li>æ— æ³•ç›´æ¥ä½¿ç”¨é˜Ÿåˆ—å˜é‡ï¼ˆå¦‚ä½¿ç”¨AFNetworkingæ·»åŠ å¼‚æ­¥ä»»åŠ¡ï¼‰ï¼šä½¿ç”¨<strong>dispatch_group_enter</strong>ï¼Œ<strong>dispatch_group_leave</strong>ã€‚</li>
</ol>
<p>è‡ªå·±åˆ›å»ºé˜Ÿåˆ—æ—¶ï¼Œå½“ç„¶å°±ç”¨dispatch_group_asyncå‡½æ•°ï¼Œç®€å•æœ‰æ•ˆï¼Œç®€å•ä¾‹å­å¦‚ä¸‹ï¼š</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//çœå»åˆ›å»ºgroupã€queueä»£ç ã€‚ã€‚ã€‚</span></div><div class="line"></div><div class="line">dispatch_group_async(<span class="keyword">group</span>, <span class="built_in">queue</span>, ^&#123;</div><div class="line">    <span class="comment">//Do you work...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å½“ä½ æ— æ³•ç›´æ¥ä½¿ç”¨é˜Ÿåˆ—å˜é‡æ—¶ï¼Œå°±æ— æ³•ä½¿ç”¨dispatch_group_asyncäº†ï¼Œä¸‹é¢ä»¥ä½¿ç”¨AFNetworkingæ—¶çš„æƒ…å†µï¼š</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];</div><div class="line"></div><div class="line"><span class="comment">//Enter group</span></div><div class="line">dispatch_group_enter(<span class="keyword">group</span>);</div><div class="line">[manager GET:@"http:<span class="comment">//www.baidu.com" parameters:nil success:^(AFHTTPRequestOperation *operation, id responseObject) &#123;</span></div><div class="line">    <span class="comment">//Deal with result...</span></div><div class="line"></div><div class="line">    <span class="comment">//Leave group</span></div><div class="line">    dispatch_group_leave(<span class="keyword">group</span>);</div><div class="line">&#125;    failure:^(AFHTTPRequestOperation *operation, NSError *<span class="keyword">error</span>) &#123;</div><div class="line">    <span class="comment">//Deal with error...</span></div><div class="line"></div><div class="line">    <span class="comment">//Leave group</span></div><div class="line">    dispatch_group_leave(<span class="keyword">group</span>);</div><div class="line">&#125;];</div><div class="line"></div><div class="line"><span class="comment">//More request...</span></div></pre></td></tr></table></figure>
<p>ä½¿ç”¨<strong>dispatch_group_enter</strong>ï¼Œ<strong>dispatch_group_leave</strong>å°±å¯ä»¥æ–¹ä¾¿çš„å°†ä¸€ç³»åˆ—ç½‘ç»œè¯·æ±‚â€œ<strong>æ‰“åŒ…</strong>â€èµ·æ¥~</p>
<h4 id="æ·»åŠ ç»“æŸä»»åŠ¡"><a href="#æ·»åŠ ç»“æŸä»»åŠ¡" class="headerlink" title="æ·»åŠ ç»“æŸä»»åŠ¡"></a>æ·»åŠ ç»“æŸä»»åŠ¡</h4><p>æ·»åŠ ç»“æŸä»»åŠ¡ä¹Ÿå¯ä»¥åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œå¦‚ä¸‹ï¼š</p>
<ol>
<li>åœ¨å½“å‰çº¿ç¨‹<strong>é˜»å¡çš„åŒæ­¥ç­‰å¾…</strong>ï¼šdispatch_group_waitã€‚</li>
<li>æ·»åŠ ä¸€ä¸ªå¼‚æ­¥æ‰§è¡Œçš„ä»»åŠ¡ä½œä¸ºç»“æŸä»»åŠ¡ï¼šdispatch_group_notify</li>
</ol>
<p>è¿™ä¸¤ä¸ªæ¯”è¾ƒç®€å•ï¼Œå°±ä¸å†è´´ä»£ç äº†=ã€‚=</p>
<h2 id="ä½¿ç”¨dispatch-barrier-async-dispatch-barrier-syncçš„æ³¨æ„äº‹é¡¹"><a href="#ä½¿ç”¨dispatch-barrier-async-dispatch-barrier-syncçš„æ³¨æ„äº‹é¡¹" class="headerlink" title="ä½¿ç”¨dispatch_barrier_async,dispatch_barrier_syncçš„æ³¨æ„äº‹é¡¹"></a>ä½¿ç”¨dispatch_barrier_async,dispatch_barrier_syncçš„æ³¨æ„äº‹é¡¹</h2><p>dispatch_barrier_asyncçš„ä½œç”¨å°±æ˜¯å‘æŸä¸ªé˜Ÿåˆ—æ’å…¥ä¸€ä¸ªblockï¼Œå½“ç›®å‰æ­£åœ¨æ‰§è¡Œçš„blockè¿è¡Œå®Œæˆåï¼Œé˜»å¡è¿™ä¸ªblockåé¢æ·»åŠ çš„blockï¼Œåªè¿è¡Œè¿™ä¸ªblockç›´åˆ°å®Œæˆï¼Œç„¶åå†ç»§ç»­åç»­çš„ä»»åŠ¡ï¼Œæœ‰ç‚¹â€œå”¯æˆ‘ç‹¬å°Šâ€çš„æ„Ÿè§‰=ã€‚=</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š</p>
<ol>
<li>dispatch<em>barrier\</em>(a)syncåªåœ¨è‡ªå·±åˆ›å»ºçš„å¹¶å‘é˜Ÿåˆ—ä¸Šæœ‰æ•ˆï¼Œåœ¨å…¨å±€(Global)å¹¶å‘é˜Ÿåˆ—ã€ä¸²è¡Œé˜Ÿåˆ—ä¸Šï¼Œæ•ˆæœè·Ÿ<strong>dispatch_(a)sync</strong>æ•ˆæœä¸€æ ·ã€‚</li>
<li>æ—¢ç„¶åœ¨ä¸²è¡Œé˜Ÿåˆ—ä¸Šè·Ÿ<strong>dispatch_(a)sync</strong>æ•ˆæœä¸€æ ·ï¼Œé‚£å°±è¦å°å¿ƒåˆ«æ­»é”ï¼</li>
</ol>
<h2 id="dispatch-set-contextä¸dispatch-set-finalizer-fçš„é…åˆä½¿ç”¨"><a href="#dispatch-set-contextä¸dispatch-set-finalizer-fçš„é…åˆä½¿ç”¨" class="headerlink" title="dispatch_set_contextä¸dispatch_set_finalizer_fçš„é…åˆä½¿ç”¨"></a>dispatch_set_contextä¸dispatch_set_finalizer_fçš„é…åˆä½¿ç”¨</h2><p>dispatch_set_contextå¯ä»¥ä¸ºé˜Ÿåˆ—æ·»åŠ <strong>ä¸Šä¸‹æ–‡æ•°æ®</strong>ï¼Œä½†æ˜¯å› ä¸ºGCDæ˜¯Cè¯­è¨€æ¥å£å½¢å¼çš„ï¼Œæ‰€ä»¥å…¶contextå‚æ•°ç±»å‹æ˜¯â€œ<strong>void *</strong>â€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åˆ›å»ºcontextæ—¶æœ‰å¦‚ä¸‹å‡ ç§é€‰æ‹©ï¼š</p>
<ol>
<li>ç”¨Cè¯­è¨€çš„mallocåˆ›å»ºcontextæ•°æ®ã€‚</li>
<li>ç”¨C++çš„newåˆ›å»ºç±»å¯¹è±¡ã€‚</li>
<li>ç”¨Objective-Cçš„å¯¹è±¡ï¼Œä½†æ˜¯è¦ç”¨__bridgeç­‰å…³é”®å­—è½¬ä¸ºCore Foundationå¯¹è±¡ã€‚</li>
</ol>
<p>ä»¥ä¸Šæ‰€æœ‰åˆ›å»ºcontextçš„æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªå¿…é¡»çš„è¦æ±‚ï¼Œå°±æ˜¯éƒ½è¦<strong>é‡Šæ”¾å†…å­˜ï¼</strong>ï¼Œæ— è®ºæ˜¯ç”¨<strong>freeã€deleteè¿˜æ˜¯CFçš„CFRelease</strong>ï¼Œæˆ‘ä»¬éƒ½è¦ç¡®ä¿åœ¨é˜Ÿåˆ—ä¸ç”¨çš„æ—¶å€™ï¼Œé‡Šæ”¾contextçš„å†…å­˜ï¼Œå¦åˆ™å°±ä¼šé€ æˆå†…å­˜æ³„éœ²ã€‚</p>
<p>æ‰€ä»¥ï¼Œä½¿ç”¨dispatch_set_contextçš„æ—¶å€™ï¼Œæœ€å¥½ç»“åˆdispatch_set_finalizer_fä½¿ç”¨ï¼Œä¸ºé˜Ÿåˆ—è®¾ç½®â€œææ„å‡½æ•°â€ï¼Œåœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢é‡Šæ”¾å†…å­˜ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">cleanStaff</span><span class="params">(<span class="keyword">void</span> *context)</span> </span>&#123;</div><div class="line">    <span class="comment">//é‡Šæ”¾contextçš„å†…å­˜ï¼</span></div><div class="line"></div><div class="line">    <span class="comment">//CFRelease(context);</span></div><div class="line">    <span class="comment">//free(context);</span></div><div class="line">    <span class="comment">//delete context;</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment">//åœ¨é˜Ÿåˆ—åˆ›å»ºåï¼Œè®¾ç½®å…¶â€œææ„å‡½æ•°â€</span></div><div class="line">dispatch_set_finalizer_f(<span class="built_in">queue</span>, cleanStaff);</div></pre></td></tr></table></figure>
<p>è¯¦ç»†ç”¨æ³•ï¼Œè¯·çœ‹æˆ‘ä¹‹å‰å†™çš„Blog<a href="http://tutuge.me/2015/03/29/bind-data-to-gcd-queue/">ä¸ºGCDé˜Ÿåˆ—ç»‘å®šNSObjectç±»å‹ä¸Šä¸‹æ–‡æ•°æ®-åˆ©ç”¨__bridge_retained(transfer)è½¬ç§»å†…å­˜ç®¡ç†æƒ</a></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®æœ¬æ–‡æ›´åƒæ˜¯æ€»ç»“äº†GCDä¸­çš„â€œå‘â€=ã€‚=</p>
<p>è‡³äºç»éªŒï¼Œæ€»ç»“ä¸€æ¡ï¼Œå°±æ˜¯ä½¿ç”¨ä»»ä½•æŠ€æœ¯ï¼Œéƒ½è¦ç ”ç©¶é€å½»ï¼Œå¦åˆ™åæ‚£æ— ç©·å•Š~</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://developer.apple.com/library/prerelease/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/index.html" target="_blank" rel="external">Grand Central Dispatch (GCD) Reference</a></li>
<li><a href="https://developer.apple.com/library/prerelease/mac/documentation/General/Conceptual/ConcurrencyProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008091" target="_blank" rel="external">Concurrency Programming Guide</a></li>
<li><a href="http://commandshift.co.uk/blog/2014/03/19/using-dispatch-groups-to-wait-for-multiple-web-services" target="_blank" rel="external">Using Dispatch Groups to Wait for Multiple Web Services</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;GCD(Grand Central Dispatch)å¯ä»¥è¯´æ˜¯Macã€iOSå¼€å‘ä¸­çš„ä¸€å¤§â€œåˆ©å™¨â€ï¼Œæœ¬æ–‡å°±æ€»ç»“ä¸€äº›æœ‰å…³ä½¿ç”¨GCDçš„ç»éªŒä¸æŠ€å·§ã€‚&lt;/p&gt;
&lt;h2 id=&quot;dispatch-once-tå¿…é¡»æ˜¯å…¨å±€æˆ–staticå˜é‡&quot;&gt;&lt;a href=&quot;#dispatch-once-tå¿…é¡»æ˜¯å…¨å±€æˆ–staticå˜é‡&quot; class=&quot;headerlink&quot; title=&quot;dispatch_once_tå¿…é¡»æ˜¯å…¨å±€æˆ–staticå˜é‡&quot;&gt;&lt;/a&gt;dispatch_once_tå¿…é¡»æ˜¯å…¨å±€æˆ–staticå˜é‡&lt;/h2&gt;&lt;p&gt;è¿™ä¸€æ¡ç®—æ˜¯â€œè€ç”Ÿå¸¸è°ˆâ€äº†ï¼Œä½†æˆ‘è®¤ä¸ºè¿˜æ˜¯æœ‰å¿…è¦å¼ºè°ƒä¸€æ¬¡ï¼Œæ¯•ç«Ÿéå…¨å±€æˆ–éstaticçš„dispatch_once_tå˜é‡åœ¨ä½¿ç”¨æ—¶ä¼šå¯¼è‡´éå¸¸ä¸å¥½æ’æŸ¥çš„bugï¼Œæ­£ç¡®çš„å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//é™æ€å˜é‡ï¼Œä¿è¯åªæœ‰ä¸€ä»½å®ä¾‹ï¼Œæ‰èƒ½ç¡®ä¿åªæ‰§è¡Œä¸€æ¬¡&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;dispatch_once_t&lt;/span&gt; onceToken;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;dispatch_once&lt;/span&gt;(&amp;amp;onceToken, ^&amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;   &lt;span class=&quot;comment&quot;&gt;//å•ä¾‹ä»£ç &lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å…¶å®å°±æ˜¯ä¿è¯&lt;strong&gt;dispatch_once_t&lt;/strong&gt;åªæœ‰ä¸€ä»½å®ä¾‹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºGCDé˜Ÿåˆ—ç»‘å®šNSObjectç±»å‹ä¸Šä¸‹æ–‡æ•°æ®-åˆ©ç”¨__bridge_retained(transfer)è½¬ç§»å†…å­˜ç®¡ç†æƒ</title>
    <link href="http://tutuge.me/2015/03/29/bind-data-to-gcd-queue/"/>
    <id>http://tutuge.me/2015/03/29/bind-data-to-gcd-queue/</id>
    <published>2015-03-29T11:27:40.000Z</published>
    <updated>2016-08-07T06:07:19.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="2015-5-28æ›´æ–°"><a href="#2015-5-28æ›´æ–°" class="headerlink" title="2015-5-28æ›´æ–°"></a>2015-5-28æ›´æ–°</h2><p>ä¸‹é¢è¯„è®ºçš„å¥½å‹â€œ@Jimâ€ç»™äº†ç§æ–°çš„æ€è·¯ï¼Œå°±æ˜¯åœ¨æ¸…é™¤contextçš„å‡½æ•°é‡Œé¢ï¼Œç”¨â€œ<strong>_bridge_transfer</strong>â€è½¬æ¢contextï¼ŒæŠŠcontextçš„å†…å­˜ç®¡ç†æƒé™é‡æ–°äº¤ç»™ARCï¼Œè¿™æ ·ï¼Œå°±ä¸ç”¨æ˜¾å¼è°ƒç”¨â€œ<strong>CFRelease</strong>â€äº†ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="literal">void</span> cleanStaff(<span class="literal">void</span> *context) &#123;</div><div class="line">    <span class="comment">//è¿™é‡Œç”¨_bridge_transferè½¬æ¢ï¼Œå°†å†…å­˜ç®¡ç†æƒé™äº¤è¿˜ç»™ARC</span></div><div class="line">    <span class="built_in">Data</span> *<span class="built_in">data</span> = (_bridge_transfer <span class="built_in">Data</span> *)(context);</div><div class="line">    NSLog(@<span class="string">"In clean, context number: %d"</span>, <span class="built_in">data</span>.number);</div><div class="line"></div><div class="line">    <span class="comment">//ä¸ç”¨æ˜¾å¼é‡Šæ”¾contextçš„å†…å­˜ï¼</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>çœ‹è¿‡GCDï¼ˆGrand Central Dispatchï¼‰çš„Apple<a href="https://developer.apple.com/library/prerelease/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/index.html" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>çš„æœ‹å‹ä¸€å®šè§è¿‡â€œ<strong>dispatch_set_context</strong>â€å’Œâ€œ<strong>dispatch_get_context</strong>â€è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå‡½æ•°è¯¥æ€ä¹ˆç”¨å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒGCDçš„æ¥å£å‚æ•°éƒ½æ˜¯â€œCè¯­è¨€ç±»å‹â€œçš„ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•å°†NSObjectç±»å‹ï¼ˆFoundationæ¡†æ¶ï¼‰çš„æ•°æ®ï¼Œä¼ å…¥GCDçš„æ¥å£å‘¢ï¼Ÿï¼ˆå³ï¼šCore Foundationå’ŒFoundationå¯¹è±¡çš„è½¬æ¢ï¼‰</p>
<h2 id="æœ¬æ–‡å…³é”®å­—"><a href="#æœ¬æ–‡å…³é”®å­—" class="headerlink" title="æœ¬æ–‡å…³é”®å­—"></a>æœ¬æ–‡å…³é”®å­—</h2><ul>
<li>GCDï¼šdispatch_set_contextï¼Œdispatch_get_context</li>
<li>__bridgeï¼Œ__bridge_retainedï¼Œ__bridge_transfer</li>
<li>Core Foundation, NSObject</li>
</ul>
<a id="more"></a>
<h2 id="dispatch-set-get-context"><a href="#dispatch-set-get-context" class="headerlink" title="dispatch_set(get)_context"></a>dispatch_set(get)_context</h2><p>å…ˆçœ‹çœ‹è¿™ä¸¤ä¸ªå‡½æ•°çš„åŸå‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è®¾ç½®context</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dispatch_set_context</span> <span class="params">(<span class="keyword">dispatch_object_t</span> object, <span class="keyword">void</span> *context)</span></span>;</div><div class="line"><span class="comment">//è·å–context</span></div><div class="line"><span class="function"><span class="keyword">void</span>* <span class="title">dispatch_get_context</span> <span class="params">(<span class="keyword">dispatch_object_t</span> object)</span></span>;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œçš„objectä¸€èˆ¬æŒ‡çš„å°±æ˜¯é€šè¿‡dispatch_queue_createåˆ›å»ºçš„é˜Ÿåˆ—ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°åˆ†åˆ«å®Œæˆäº†å°†contextâ€œç»‘å®šâ€åˆ°ç‰¹å®šGCDé˜Ÿåˆ—å’Œä»GCDé˜Ÿåˆ—è·å–å¯¹åº”contextçš„ä»»åŠ¡ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯context"><a href="#ä»€ä¹ˆæ˜¯context" class="headerlink" title="ä»€ä¹ˆæ˜¯context"></a>ä»€ä¹ˆæ˜¯context</h3><p>åœ¨ä¸Šè¿°å‡½æ•°åŸå‹ä¸­ï¼Œcontextæ˜¯ä¸€ä¸ªâ€œ<strong>voidç±»å‹æŒ‡é’ˆ</strong>â€ï¼Œå­¦è¿‡Cè¯­è¨€çš„æœ‹å‹åº”è¯¥éƒ½çŸ¥é“ï¼Œvoidå‹æŒ‡é’ˆå¯ä»¥æŒ‡å‘ä»»æ„ç±»å‹ï¼Œå°±æ˜¯è¯´ï¼Œcontextåœ¨è¿™é‡Œå¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„æŒ‡é’ˆã€‚</p>
<p>ä»è¿™é‡Œå¯ä»¥å¾—çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºé˜Ÿåˆ—â€œ<strong>set</strong>â€ä»»æ„ç±»å‹çš„æ•°æ®ï¼Œå¹¶åœ¨åˆé€‚çš„æ—¶å€™å–å‡ºæ¥ç”¨ã€‚</p>
<h2 id="ç”¨mallocåˆ›å»ºcontextå¹¶ç»‘å®šåˆ°é˜Ÿåˆ—ä¸Š"><a href="#ç”¨mallocåˆ›å»ºcontextå¹¶ç»‘å®šåˆ°é˜Ÿåˆ—ä¸Š" class="headerlink" title="ç”¨mallocåˆ›å»ºcontextå¹¶ç»‘å®šåˆ°é˜Ÿåˆ—ä¸Š"></a>ç”¨mallocåˆ›å»ºcontextå¹¶ç»‘å®šåˆ°é˜Ÿåˆ—ä¸Š</h2><p>å‚è€ƒ<a href="https://developer.apple.com/library/ios/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW13" target="_blank" rel="external">Appleå®˜æ–¹çš„ä¾‹å­</a>ï¼Œæˆ‘ä»¬å…ˆç”¨ä¼ ç»Ÿçš„<strong>malloc</strong>åˆ›å»ºcontextï¼Œçœ‹çœ‹å¦‚ä¸‹ç®€çŸ­ä¾‹å­ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®šä¹‰contextï¼Œå³ä¸€ä¸ªç»“æ„ä½“</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> _Data &#123;</div><div class="line">    <span class="keyword">int</span> number;</div><div class="line">&#125; Data;</div><div class="line"></div><div class="line"><span class="comment">//å®šä¹‰é˜Ÿåˆ—çš„finalizerå‡½æ•°ï¼Œç”¨äºé‡Šæ”¾contextå†…å­˜</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">cleanStaff</span><span class="params">(<span class="keyword">void</span> *context)</span> </span>&#123;</div><div class="line">    NSLog(@<span class="string">"In clean, context number: %d"</span>, ((Data *)context)-&gt;number);</div><div class="line">    <span class="comment">//é‡Šæ”¾ï¼Œå¦‚æœæ˜¯newå‡ºæ¥çš„å¯¹è±¡ï¼Œå°±è¦ç”¨delete</span></div><div class="line">    <span class="built_in">free</span>(context);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)runTest &#123;</div><div class="line">    <span class="comment">//åˆ›å»ºé˜Ÿåˆ—</span></div><div class="line">    <span class="keyword">dispatch_queue_t</span> <span class="built_in">queue</span> = dispatch_queue_create(<span class="string">"me.tutuge.test.gcd"</span>, DISPATCH_QUEUE_SERIAL);</div><div class="line"></div><div class="line">    <span class="comment">//åˆ›å»ºDataç±»å‹contextæ•°æ®å¹¶åˆå§‹åŒ–</span></div><div class="line">    Data *myData = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Data));</div><div class="line">    myData-&gt;number = <span class="number">10</span>;</div><div class="line"></div><div class="line">    <span class="comment">//ç»‘å®šcontext</span></div><div class="line">    dispatch_set_context(<span class="built_in">queue</span>, myData);</div><div class="line"></div><div class="line">    <span class="comment">//è®¾ç½®finalizerå‡½æ•°ï¼Œç”¨äºåœ¨é˜Ÿåˆ—æ‰§è¡Œå®Œæˆåé‡Šæ”¾å¯¹åº”contextå†…å­˜</span></div><div class="line">    dispatch_set_finalizer_f(<span class="built_in">queue</span>, cleanStaff);</div><div class="line"></div><div class="line">    dispatch_async(<span class="built_in">queue</span>, ^&#123;</div><div class="line">        <span class="comment">//è·å–é˜Ÿåˆ—çš„contextæ•°æ®</span></div><div class="line">        Data *data = dispatch_get_context(<span class="built_in">queue</span>);</div><div class="line">        <span class="comment">//æ‰“å°</span></div><div class="line">        NSLog(@<span class="string">"1: context number: %d"</span>, data-&gt;number);</div><div class="line">        <span class="comment">//ä¿®æ”¹contextä¿å­˜çš„æ•°æ®</span></div><div class="line">        data-&gt;number = <span class="number">20</span>;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç è¿è¡Œåå¦‚ä¸‹ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">2015<span class="selector-tag">-03-29</span> 20<span class="selector-pseudo">:28</span><span class="selector-pseudo">:16.854</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[37787:1443423]</span> 1: <span class="selector-tag">context</span> <span class="selector-tag">number</span>: 10</div><div class="line">2015<span class="selector-tag">-03-29</span> 20<span class="selector-pseudo">:28</span><span class="selector-pseudo">:16.855</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[37787:1443423]</span> <span class="selector-tag">In</span> <span class="selector-tag">clean</span>, <span class="selector-tag">context</span> <span class="selector-tag">number</span>: 20</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œé€šè¿‡ä¸ºé˜Ÿåˆ—è®¾ç½®contextï¼Œæˆ‘ä»¬å°±èƒ½ä¸ºé˜Ÿåˆ—ç»‘å®šè‡ªå®šä¹‰çš„æ•°æ®ï¼Œç„¶ååœ¨åˆé€‚çš„æ—¶å€™å–å‡ºæ¥ç”¨ã€‚</p>
<h2 id="NSObjectç±»å‹çš„context"><a href="#NSObjectç±»å‹çš„context" class="headerlink" title="NSObjectç±»å‹çš„context"></a>NSObjectç±»å‹çš„context</h2><p>åœ¨Macã€iOSçš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¤§éƒ¨åˆ†ç”¨çš„éƒ½æ˜¯Foundationæ¡†æ¶ä¸‹çš„ç±»ï¼Œå°±æ˜¯å¦‚NSStringã€NSDictionaryè¿™äº›NSObjectç±»å‹çš„ç±»ã€‚  </p>
<p>ä½†æ˜¯ä¸Šé¢çš„<strong>dispatch_set(get)_context</strong>æ¥å—çš„contextå‚æ•°æ˜¯Cè¯­è¨€ç±»å‹çš„ï¼Œå³Core Foundationç±»å‹çš„ï¼Œæˆ‘ä»¬å¦‚ä½•è½¬æ¢å‘¢ï¼Ÿ</p>
<p><strong>ç”±äºARCä¸èƒ½ç®¡ç†Core Foundation Objectçš„ç”Ÿå‘½å‘¨æœŸ</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»å…ˆè½¬æ¢contextçš„â€œç±»å‹â€ï¼Œä»¥ä¾¿è½¬æ¢å†…å­˜ç®¡ç†æƒã€‚</p>
<h3 id="bridge"><a href="#bridge" class="headerlink" title="__bridge"></a>__bridge</h3><p>Appleå·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†ç”¨äºè½¬æ¢çš„å…³é”®å­—ï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li>__bridge: åªåšäº†ç±»å‹è½¬æ¢ï¼Œä¸ä¿®æ”¹å†…å­˜ç®¡ç†æƒï¼›</li>
<li>__bridge_retainedï¼ˆå³CFBridgingRetainï¼‰è½¬æ¢ç±»å‹ï¼ŒåŒæ—¶å°†å†…å­˜ç®¡ç†æƒä»ARCä¸­ç§»é™¤ï¼Œåé¢éœ€è¦ä½¿ç”¨CFReleaseæ¥é‡Šæ”¾å¯¹è±¡ï¼›</li>
<li>__bridge_transferï¼ˆå³CFBridgingReleaseï¼‰å°†Core Foundationçš„å¯¹è±¡è½¬æ¢ä¸ºObjective-Cçš„å¯¹è±¡ï¼ŒåŒæ—¶å°†å†…å­˜ç®¡ç†æƒäº¤ç»™ARCã€‚</li>
</ul>
<h3 id="é‡æ–°å®šä¹‰context"><a href="#é‡æ–°å®šä¹‰context" class="headerlink" title="é‡æ–°å®šä¹‰context"></a>é‡æ–°å®šä¹‰context</h3><p>ä¸ºäº†æ–¹ä¾¿ä¸‹é¢çš„è¯´æ˜ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰contextç±»ã€‚</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@interface</span> <span class="attribute">Data </span>: NSObject</div><div class="line"><span class="variable">@property</span>(assign, nonatomic) int number;</div><div class="line"><span class="variable">@end</span></div><div class="line"></div><div class="line"><span class="variable">@implementation</span> Data</div><div class="line"></div><div class="line"><span class="comment">//ç»§æ‰¿deallocæ–¹æ³•ï¼Œä¾¿äºè§‚å¯Ÿå¯¹è±¡ä½•æ—¶è¢«é‡Šæ”¾</span></div><div class="line">- (void)dealloc &#123;</div><div class="line">    <span class="selector-tag">NSLog</span>(@<span class="string">"Data dealloc..."</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">@<span class="selector-tag">end</span></div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œæˆ‘ä»¬ç»§æ‰¿äº†<strong>dealloc</strong>æ–¹æ³•ï¼Œè¿™æ ·å°±èƒ½çŸ¥é“Dataç±»å‹å¯¹è±¡ä»€ä¹ˆæ—¶å€™è¢«é‡Šæ”¾ã€‚</p>
<h3 id="éœ€è¦æ³¨æ„çš„ç‚¹"><a href="#éœ€è¦æ³¨æ„çš„ç‚¹" class="headerlink" title="éœ€è¦æ³¨æ„çš„ç‚¹"></a>éœ€è¦æ³¨æ„çš„ç‚¹</h3><p><strong>__bridge</strong>çš„è½¬æ¢æ˜¯æ²¡æœ‰è½¬ç§»å†…å­˜ç®¡ç†æƒçš„ï¼Œè¿™ç‚¹è¦ç‰¹åˆ«æ³¨æ„ã€‚</p>
<p>å¦‚æœåœ¨ä¼ contextå¯¹è±¡æ—¶ï¼Œç”¨çš„æ˜¯<strong>__bridge</strong>è½¬æ¢ï¼Œé‚£ä¹ˆcontextå¯¹è±¡çš„å†…å­˜ç®¡ç†æƒè¿˜åœ¨ARCæ‰‹é‡Œï¼Œä¸€æ—¦å½“å‰ä½œç”¨åŸŸæ‰§è¡Œå®Œï¼Œcontextå°±ä¼šè¢«é‡Šæ”¾ï¼Œè€Œå¦‚æœé˜Ÿåˆ—çš„ä»»åŠ¡ç”¨äº†contextå¯¹è±¡ï¼Œå°±ä¼šé€ æˆâ€œ<strong>EXC_BAD_ACCESS</strong>â€å´©æºƒï¼</p>
<h3 id="æ­£ç¡®çš„ç”¨æ³•"><a href="#æ­£ç¡®çš„ç”¨æ³•" class="headerlink" title="æ­£ç¡®çš„ç”¨æ³•"></a>æ­£ç¡®çš„ç”¨æ³•</h3><p>é‡å†™ä¸Šé¢çš„ä¾‹å­ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®šä¹‰é˜Ÿåˆ—çš„finalizerå‡½æ•°ï¼Œç”¨äºé‡Šæ”¾contextå†…å­˜</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">cleanStaff</span><span class="params">(<span class="keyword">void</span> *context)</span> </span>&#123;</div><div class="line">    <span class="comment">//è¿™é‡Œç”¨__bridgeè½¬æ¢ï¼Œä¸æ”¹å˜å†…å­˜ç®¡ç†æƒ</span></div><div class="line">    Data *data = (__bridge Data *)(context);</div><div class="line">    NSLog(@<span class="string">"In clean, context number: %d"</span>, data.number);</div><div class="line"></div><div class="line">    <span class="comment">//é‡Šæ”¾contextçš„å†…å­˜ï¼</span></div><div class="line">    CFRelease(context);</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)testBody &#123;</div><div class="line">    <span class="comment">//åˆ›å»ºé˜Ÿåˆ—</span></div><div class="line">    <span class="keyword">dispatch_queue_t</span> <span class="built_in">queue</span> = dispatch_queue_create(<span class="string">"me.tutuge.test.gcd"</span>, DISPATCH_QUEUE_SERIAL);</div><div class="line"></div><div class="line">    <span class="comment">//åˆ›å»ºDataç±»å‹contextæ•°æ®å¹¶åˆå§‹åŒ–</span></div><div class="line">    Data *myData = [Data <span class="keyword">new</span>];</div><div class="line">    myData.number = <span class="number">10</span>;</div><div class="line"></div><div class="line">    <span class="comment">//ç»‘å®šcontext</span></div><div class="line">    <span class="comment">//è¿™é‡Œç”¨__bridge_retainedè½¬æ¢ï¼Œå°†contextçš„å†…å­˜ç®¡ç†æƒä»ARCç§»é™¤ï¼Œäº¤ç”±æˆ‘ä»¬è‡ªå·±æ‰‹åŠ¨é‡Šæ”¾ï¼</span></div><div class="line">    dispatch_set_context(<span class="built_in">queue</span>, (__bridge_retained <span class="keyword">void</span> *)(myData));</div><div class="line"></div><div class="line">    <span class="comment">//è®¾ç½®finalizerå‡½æ•°ï¼Œç”¨äºåœ¨é˜Ÿåˆ—æ‰§è¡Œå®Œæˆåé‡Šæ”¾å¯¹åº”contextå†…å­˜</span></div><div class="line">    dispatch_set_finalizer_f(<span class="built_in">queue</span>, cleanStaff);</div><div class="line"></div><div class="line">    dispatch_async(<span class="built_in">queue</span>, ^&#123;</div><div class="line">        <span class="comment">//è·å–é˜Ÿåˆ—çš„contextæ•°æ®</span></div><div class="line">        <span class="comment">//è¿™é‡Œç”¨__bridgeè½¬æ¢ï¼Œä¸æ”¹å˜å†…å­˜ç®¡ç†æƒ</span></div><div class="line">        Data *data = (__bridge Data *)(dispatch_get_context(<span class="built_in">queue</span>));</div><div class="line">        <span class="comment">//æ‰“å°</span></div><div class="line">        NSLog(@<span class="string">"1: context number: %d"</span>, data.number);</div><div class="line">        <span class="comment">//ä¿®æ”¹contextä¿å­˜çš„æ•°æ®</span></div><div class="line">        data.number = <span class="number">20</span>;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="è§£é‡Š"><a href="#è§£é‡Š" class="headerlink" title="è§£é‡Š"></a>è§£é‡Š</h4><ul>
<li>åœ¨dispatch_set_contextçš„æ—¶å€™ç”¨<strong>__bridge_retained</strong>è½¬æ¢ï¼Œå°†contextçš„å†…å­˜ç®¡ç†æƒä»ARCç§»é™¤ï¼Œäº¤ç»™æˆ‘ä»¬è‡ªå·±ç®¡ç†ã€‚</li>
<li>åœ¨é˜Ÿåˆ—ä»»åŠ¡ä¸­ï¼Œç”¨dispatch_get_contextè·å–contextçš„æ—¶å€™ï¼Œç”¨<strong>__bridge</strong>è½¬æ¢ï¼Œç»´æŒcontextçš„å†…å­˜ç®¡ç†æƒä¸å˜ï¼Œé˜²æ­¢å‡ºäº†ä½œç”¨åŸŸcontextè¢«é‡Šæ”¾ã€‚</li>
<li>æœ€åç”¨<strong>CFRelease</strong>é‡Šæ”¾contextå†…å­˜ã€‚</li>
</ul>
<h3 id="è¿è¡Œç»“æœ"><a href="#è¿è¡Œç»“æœ" class="headerlink" title="è¿è¡Œç»“æœ"></a>è¿è¡Œç»“æœ</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2015<span class="selector-tag">-03-29</span> 21<span class="selector-pseudo">:12</span><span class="selector-pseudo">:41.631</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[38131:1465900]</span> 1: <span class="selector-tag">context</span> <span class="selector-tag">number</span>: 10</div><div class="line">2015<span class="selector-tag">-03-29</span> 21<span class="selector-pseudo">:12</span><span class="selector-pseudo">:41.632</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[38131:1465900]</span> <span class="selector-tag">In</span> <span class="selector-tag">clean</span>, <span class="selector-tag">context</span> <span class="selector-tag">number</span>: 20</div><div class="line">2015<span class="selector-tag">-03-29</span> 21<span class="selector-pseudo">:12</span><span class="selector-pseudo">:41.632</span> <span class="selector-tag">GCDTest</span><span class="selector-attr">[38131:1465900]</span> <span class="selector-tag">Data</span> <span class="selector-tag">dealloc</span>...</div></pre></td></tr></table></figure>
<p>ç”±ç»“æœå¯çŸ¥ï¼Œæˆ‘ä»¬çš„contextå¯¹è±¡åœ¨æœ€åæ˜¾å¼è°ƒç”¨<strong>CFRelease</strong>æ‰è¢«é‡Šæ”¾ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯åˆç†è¿ç”¨__bridge_retained(transfer)å…³é”®å­—è½¬æ¢å¯¹è±¡çš„å†…å­˜ç®¡ç†æƒï¼Œè®©æˆ‘ä»¬è‡ªå·±æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://developer.apple.com/library/prerelease/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/index.html" target="_blank" rel="external">Grand Central Dispatch (GCD) Reference</a></li>
<li><a href="https://developer.apple.com/library/ios/documentation/General/Conceptual/ConcurrencyProgrammingGuide/OperationQueues/OperationQueues.html#//apple_ref/doc/uid/TP40008091-CH102-SW13" target="_blank" rel="external">Concurrency Programming Guide</a></li>
<li><a href="https://developer.apple.com/library/ios/documentation/CoreFoundation/Conceptual/CFDesignConcepts/Articles/tollFreeBridgedTypes.html" target="_blank" rel="external">Toll-Free Bridged Types</a></li>
<li><a href="http://blog.csdn.net/diyagoanyhacker/article/details/7573801" target="_blank" rel="external">Core Foundation æ¡†æ¶</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;2015-5-28æ›´æ–°&quot;&gt;&lt;a href=&quot;#2015-5-28æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;2015-5-28æ›´æ–°&quot;&gt;&lt;/a&gt;2015-5-28æ›´æ–°&lt;/h2&gt;&lt;p&gt;ä¸‹é¢è¯„è®ºçš„å¥½å‹â€œ@Jimâ€ç»™äº†ç§æ–°çš„æ€è·¯ï¼Œå°±æ˜¯åœ¨æ¸…é™¤contextçš„å‡½æ•°é‡Œé¢ï¼Œç”¨â€œ&lt;strong&gt;_bridge_transfer&lt;/strong&gt;â€è½¬æ¢contextï¼ŒæŠŠcontextçš„å†…å­˜ç®¡ç†æƒé™é‡æ–°äº¤ç»™ARCï¼Œè¿™æ ·ï¼Œå°±ä¸ç”¨æ˜¾å¼è°ƒç”¨â€œ&lt;strong&gt;CFRelease&lt;/strong&gt;â€äº†ã€‚å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight lasso&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;literal&quot;&gt;void&lt;/span&gt; cleanStaff(&lt;span class=&quot;literal&quot;&gt;void&lt;/span&gt; *context) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//è¿™é‡Œç”¨_bridge_transferè½¬æ¢ï¼Œå°†å†…å­˜ç®¡ç†æƒé™äº¤è¿˜ç»™ARC&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;Data&lt;/span&gt; *&lt;span class=&quot;built_in&quot;&gt;data&lt;/span&gt; = (_bridge_transfer &lt;span class=&quot;built_in&quot;&gt;Data&lt;/span&gt; *)(context);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    NSLog(@&lt;span class=&quot;string&quot;&gt;&quot;In clean, context number: %d&quot;&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;data&lt;/span&gt;.number);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;//ä¸ç”¨æ˜¾å¼é‡Šæ”¾contextçš„å†…å­˜ï¼&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;çœ‹è¿‡GCDï¼ˆGrand Central Dispatchï¼‰çš„Apple&lt;a href=&quot;https://developer.apple.com/library/prerelease/mac/documentation/Performance/Reference/GCD_libdispatch_Ref/index.html&quot;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;çš„æœ‹å‹ä¸€å®šè§è¿‡â€œ&lt;strong&gt;dispatch_set_context&lt;/strong&gt;â€å’Œâ€œ&lt;strong&gt;dispatch_get_context&lt;/strong&gt;â€è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå‡½æ•°è¯¥æ€ä¹ˆç”¨å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒGCDçš„æ¥å£å‚æ•°éƒ½æ˜¯â€œCè¯­è¨€ç±»å‹â€œçš„ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•å°†NSObjectç±»å‹ï¼ˆFoundationæ¡†æ¶ï¼‰çš„æ•°æ®ï¼Œä¼ å…¥GCDçš„æ¥å£å‘¢ï¼Ÿï¼ˆå³ï¼šCore Foundationå’ŒFoundationå¯¹è±¡çš„è½¬æ¢ï¼‰&lt;/p&gt;
&lt;h2 id=&quot;æœ¬æ–‡å…³é”®å­—&quot;&gt;&lt;a href=&quot;#æœ¬æ–‡å…³é”®å­—&quot; class=&quot;headerlink&quot; title=&quot;æœ¬æ–‡å…³é”®å­—&quot;&gt;&lt;/a&gt;æœ¬æ–‡å…³é”®å­—&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;GCDï¼šdispatch_set_contextï¼Œdispatch_get_context&lt;/li&gt;
&lt;li&gt;__bridgeï¼Œ__bridge_retainedï¼Œ__bridge_transfer&lt;/li&gt;
&lt;li&gt;Core Foundation, NSObject&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>Enum-æšä¸¾çš„æ­£ç¡®ä½¿ç”¨-Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-5</title>
    <link href="http://tutuge.me/2015/03/21/effective-objective-c-5-enum/"/>
    <id>http://tutuge.me/2015/03/21/effective-objective-c-5-enum/</id>
    <published>2015-03-21T12:52:57.000Z</published>
    <updated>2016-03-20T09:03:27.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Enumï¼Œä¹Ÿå°±æ˜¯æšä¸¾ï¼Œä»Cè¯­è¨€å¼€å§‹å°±æœ‰äº†ï¼ŒC++ã€Javaã€Objective-Cã€Swiftè¿™äº›è¯­è¨€ï¼Œå½“ç„¶éƒ½æœ‰å¯¹åº”çš„æšä¸¾ç±»å‹ï¼ŒåŠŸèƒ½å¯èƒ½æœ‰å¤šæœ‰å°‘ï¼Œä½†æ˜¯æœ€æ ¸å¿ƒçš„è¿˜æ˜¯ä¸€ä¸ªâ€”è§„èŒƒçš„å®šä¹‰ä»£ç ä¸­çš„çŠ¶æ€ã€é€‰é¡¹ç­‰â€œå¸¸é‡â€ã€‚</p>
<h2 id="Item-5-Use-Enumerations-for-States-Options-and-Status-Codes"><a href="#Item-5-Use-Enumerations-for-States-Options-and-Status-Codes" class="headerlink" title="Item 5 - Use Enumerations for States, Options, and Status Codes"></a>Item 5 - Use Enumerations for States, Options, and Status Codes</h2><p>æœ¬èŠ‚çš„å†…å®¹å°±æ˜¯å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨æšä¸¾ã€‚</p>
<h2 id="çŠ¶æ€ä¸é€‰é¡¹çš„åŒºåˆ«ï¼ˆstates-and-optionsï¼‰"><a href="#çŠ¶æ€ä¸é€‰é¡¹çš„åŒºåˆ«ï¼ˆstates-and-optionsï¼‰" class="headerlink" title="çŠ¶æ€ä¸é€‰é¡¹çš„åŒºåˆ«ï¼ˆstates and optionsï¼‰"></a>çŠ¶æ€ä¸é€‰é¡¹çš„åŒºåˆ«ï¼ˆstates and optionsï¼‰</h2><p>åœ¨ç”¨<strong>enum</strong>ä¹‹å‰ï¼Œæˆ‘ä¸ªäººè§‰å¾—ï¼ŒåŒºåˆ†ä¸€ä¸‹çŠ¶æ€å’Œé€‰é¡¹çš„æ¦‚å¿µè¿˜æ˜¯å¾ˆå¿…è¦çš„ã€‚</p>
<p><strong>çŠ¶æ€</strong>ï¼ŒåŒæ—¶åªèƒ½æœ‰ä¸€ç§ï¼Œå¦‚â€œ<strong>OK</strong>â€ï¼Œâ€œ<strong>Error</strong>â€ï¼Œä¸å¯èƒ½åŒæ—¶æ˜¯OKå’ŒErrorã€‚<br><strong>é€‰é¡¹</strong>ï¼ŒåŒæ—¶å¯ä»¥æœ‰ä¸€ç§æˆ–ä¸€ç§ä»¥ä¸Šï¼Œå¦‚Appå¯ä»¥<strong>åŒæ—¶</strong>æ”¯æŒæ¨ªå±å’Œç«–å±ï¼Œæ¨ªå±ç«–å±åœ¨è¿™ä¸ªæ—¶å€™å°±æ˜¯â€œå±å¹•æ–¹å‘â€çš„ä¸¤ç§ä¸åŒçš„é€‰é¡¹ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç”¨æšä¸¾å®šä¹‰çŠ¶æ€å’Œé€‰é¡¹ã€‚</p>
<a id="more"></a>
<h2 id="enumä¸çŠ¶æ€ï¼ˆstatesï¼‰"><a href="#enumä¸çŠ¶æ€ï¼ˆstatesï¼‰" class="headerlink" title="enumä¸çŠ¶æ€ï¼ˆstatesï¼‰"></a>enumä¸çŠ¶æ€ï¼ˆstatesï¼‰</h2><h4 id="ä¸å¥½çš„åšæ³•"><a href="#ä¸å¥½çš„åšæ³•" class="headerlink" title="ä¸å¥½çš„åšæ³•"></a>ä¸å¥½çš„åšæ³•</h4><p>ç»å¸¸çœ‹åˆ°è¿™æ ·çš„å†™æ³•ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> STATE_OK 0</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> STATE_ERROR 1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> STATE_UNKNOW 2</span></div><div class="line"></div><div class="line"><span class="comment">//ç›´æ¥ç”¨intå‹å˜é‡æ¥æ”¶</span></div><div class="line"><span class="keyword">int</span> STATE = STATE_UNKNOW;</div></pre></td></tr></table></figure>
<p>è¿™æ ·åšæœ‰å¦‚ä¸‹â€œä¸æ°å½“â€ï¼š</p>
<ul>
<li>å®å®šä¹‰æ²¡æœ‰ç±»å‹çº¦æŸï¼Œåªæ˜¯å•çº¯çš„æ›¿æ¢ã€‚</li>
<li>æ— æ³•é™åˆ¶çŠ¶æ€çš„æ‰€æœ‰æƒ…å†µï¼Œå¦‚ï¼Œè®¤ä¸ºçš„å°†STATEèµ‹å€¼æˆ3ï¼Œç¨‹åºå¯èƒ½å°±ä¼šå‡ºé”™ï¼Œæ‰¾ä¸åˆ°åŒ¹é…çš„çŠ¶æ€ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¸ä¼šå¯¹â€œ<strong>STATE = 3;</strong>â€æå‡ºè­¦å‘Šã€‚</li>
</ul>
<h4 id="æ­£ç¡®çš„åšæ³•"><a href="#æ­£ç¡®çš„åšæ³•" class="headerlink" title="æ­£ç¡®çš„åšæ³•"></a>æ­£ç¡®çš„åšæ³•</h4><figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">typedef <span class="class"><span class="keyword">enum</span> <span class="title">_TTGState</span> &#123;</span></div><div class="line">    TTGStateOK  = <span class="number">0</span>,</div><div class="line">    TTGStateError,</div><div class="line">    TTGStateUnknow</div><div class="line">&#125; TTGState;</div><div class="line"></div><div class="line"><span class="regexp">//</span>æŒ‡æ˜æšä¸¾ç±»å‹</div><div class="line">TTGState state = TTGStateOK;</div></pre></td></tr></table></figure>
<p>ç”¨çš„æ—¶å€™å°±å¦‚ä¸‹ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)<span class="string">dealWithState:</span>(TTGState)state &#123;</div><div class="line">    <span class="keyword">switch</span> (state) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">TTGStateOK:</span></div><div class="line">            <span class="comment">//...</span></div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="string">TTGStateError:</span></div><div class="line">            <span class="comment">//...</span></div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="string">TTGStateUnknow:</span></div><div class="line">            <span class="comment">//...</span></div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="enumä¸é€‰é¡¹-options"><a href="#enumä¸é€‰é¡¹-options" class="headerlink" title="enumä¸é€‰é¡¹ (options)"></a>enumä¸é€‰é¡¹ (options)</h2><p>é€‰é¡¹ï¼Œå°±æ˜¯è¯´ä¸€ä¸ªâ€œé€‰é¡¹å˜é‡â€çš„ç±»å‹è¦èƒ½å¤ŸåŒæ—¶è¡¨ç¤ºä¸€ä¸ªæˆ–å¤šä¸ªç»„åˆçš„é€‰æ‹©ï¼Œå¦‚ä¸‹ä¾‹å­ï¼š</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ–¹å‘ï¼Œå¯åŒæ—¶æ”¯æŒä¸€ä¸ªæˆ–å¤šä¸ªæ–¹å‘</span></div><div class="line">typedef enum _TTGDirection &#123;</div><div class="line">    TTGDirectionNone = <span class="number">0</span>,</div><div class="line">    TTGDirectionTop = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</div><div class="line">    TTGDirectionLeft = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</div><div class="line">    TTGDirectionRight = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</div><div class="line">    TTGDirectionBottom = <span class="number">1</span> &lt;&lt; <span class="number">3</span></div><div class="line">&#125; TTGDirection;</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œè¿™é‡Œçš„é€‰é¡¹æ˜¯ç”¨<strong>ä½è¿ç®—</strong>çš„æ–¹å¼å®šä¹‰çš„ï¼Œè¿™æ ·çš„å¥½å¤„å°±æ˜¯ï¼Œæˆ‘ä»¬çš„é€‰é¡¹å˜é‡å¯ä»¥å¦‚ä¸‹è¡¨ç¤ºï¼š</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ç”¨â€œæˆ–â€è¿ç®—åŒæ—¶èµ‹å€¼å¤šä¸ªé€‰é¡¹</span></div><div class="line">TTGDirection <span class="built_in">direction</span> = TTGDirectionTop | TTGDirectionLeft | TTGDirectionBottom;</div><div class="line"></div><div class="line"><span class="comment">//ç”¨â€œä¸â€è¿ç®—å–å‡ºå¯¹åº”ä½</span></div><div class="line"><span class="keyword">if</span> (<span class="built_in">direction</span> &amp; TTGDirectionTop) &#123;</div><div class="line">    NSLog(@<span class="string">"top"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (<span class="built_in">direction</span> &amp; TTGDirectionLeft) &#123;</div><div class="line">    NSLog(@<span class="string">"left"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (<span class="built_in">direction</span> &amp; TTGDirectionRight) &#123;</div><div class="line">    NSLog(@<span class="string">"right"</span>);</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (<span class="built_in">direction</span> &amp; TTGDirectionBottom) &#123;</div><div class="line">    NSLog(@<span class="string">"bottom"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>direction</strong>å˜é‡çš„å®é™…å†…å­˜å¦‚ä¸‹ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_effective_objective_c_5_enum_2.jpg" alt="å†…å­˜ç¤ºæ„å›¾"></p>
<p>è¿™æ ·ï¼Œç”¨ä½è¿ç®—ï¼Œå°±å¯ä»¥åŒæ—¶æ”¯æŒå¤šä¸ªå€¼ã€‚</p>
<h2 id="enumåœ¨Objective-Cä¸­çš„â€œå‡çº§ç‰ˆâ€"><a href="#enumåœ¨Objective-Cä¸­çš„â€œå‡çº§ç‰ˆâ€" class="headerlink" title="enumåœ¨Objective-Cä¸­çš„â€œå‡çº§ç‰ˆâ€"></a>enumåœ¨Objective-Cä¸­çš„â€œå‡çº§ç‰ˆâ€</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä¸èƒ½æŒ‡å®šæšä¸¾å˜é‡çš„å®é™…ç±»å‹æ˜¯ä»€ä¹ˆï¼Œå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸çŸ¥é“æšä¸¾æœ€åæ˜¯intå‹ï¼Œè¿˜æ˜¯å…¶ä»–çš„ä»€ä¹ˆç±»å‹ã€‚ä½†æ˜¯ä»C++ 11å¼€å§‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæšä¸¾æŒ‡å®šå…¶å®é™…çš„å­˜å‚¨ç±»å‹ï¼Œå¦‚ä¸‹è¯­æ³•ï¼š</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">TTGState</span> : <span class="title">NSInteger</span> &#123;/*...*/&#125;;</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œæˆ‘ä»¬åœ¨å®šä¹‰æšä¸¾çš„æ—¶å€™å¦‚ä½•ä¿è¯å…¼å®¹æ€§å‘¢ï¼ŸFoundationæ¡†æ¶å·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†æ›´åŠ â€œç»Ÿä¸€ã€ä¾¿æ·â€çš„æšä¸¾å®šä¹‰æ–¹æ³•ï¼Œæˆ‘ä»¬é‡æ–°å®šä¹‰ä¸Šé¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">//<span class="type">NS_ENUM</span>ï¼Œå®šä¹‰çŠ¶æ€ç­‰æ™®é€šæšä¸¾</div><div class="line">typedef <span class="type">NS_ENUM</span>(<span class="type">NSUInteger</span>, <span class="type">TTGState</span>) &#123;</div><div class="line">    <span class="type">TTGStateOK</span> = 0,</div><div class="line">    <span class="type">TTGStateError</span>,</div><div class="line">    <span class="type">TTGStateUnknow</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">//<span class="type">NS_OPTIONS</span>ï¼Œå®šä¹‰é€‰é¡¹</div><div class="line">typedef <span class="type">NS_OPTIONS</span>(<span class="type">NSUInteger</span>, <span class="type">TTGDirection</span>) &#123;</div><div class="line">    <span class="type">TTGDirectionNone</span> = 0,</div><div class="line">    <span class="type">TTGDirectionTop</span> = 1 &lt;&lt; 0,</div><div class="line">    <span class="type">TTGDirectionLeft</span> = 1 &lt;&lt; 1,</div><div class="line">    <span class="type">TTGDirectionRight</span> = 1 &lt;&lt; 2,</div><div class="line">    <span class="type">TTGDirectionBottom</span> = 1 &lt;&lt; 3</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œåœ¨å¼€å‘Macã€iOSç¨‹åºä¸­ï¼Œæœ€å¥½æ‰€æœ‰çš„æšä¸¾éƒ½ç”¨â€œ<strong>NS_ENUM</strong>â€å’Œâ€œ<strong>NS_OPTIONS</strong>â€å®šä¹‰ï¼Œä¿è¯ç»Ÿä¸€ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å……åˆ†çš„ç”¨å¥½æšä¸¾ï¼Œå¯ä»¥å¢å¼ºä»£ç çš„å¯è¯»æ€§ï¼Œå‡å°‘å„ç§â€œé”™è¯¯â€ï¼Œè®©ä»£ç æ›´åŠ çš„è§„èŒƒã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;Enumï¼Œä¹Ÿå°±æ˜¯æšä¸¾ï¼Œä»Cè¯­è¨€å¼€å§‹å°±æœ‰äº†ï¼ŒC++ã€Javaã€Objective-Cã€Swiftè¿™äº›è¯­è¨€ï¼Œå½“ç„¶éƒ½æœ‰å¯¹åº”çš„æšä¸¾ç±»å‹ï¼ŒåŠŸèƒ½å¯èƒ½æœ‰å¤šæœ‰å°‘ï¼Œä½†æ˜¯æœ€æ ¸å¿ƒçš„è¿˜æ˜¯ä¸€ä¸ªâ€”è§„èŒƒçš„å®šä¹‰ä»£ç ä¸­çš„çŠ¶æ€ã€é€‰é¡¹ç­‰â€œå¸¸é‡â€ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Item-5-Use-Enumerations-for-States-Options-and-Status-Codes&quot;&gt;&lt;a href=&quot;#Item-5-Use-Enumerations-for-States-Options-and-Status-Codes&quot; class=&quot;headerlink&quot; title=&quot;Item 5 - Use Enumerations for States, Options, and Status Codes&quot;&gt;&lt;/a&gt;Item 5 - Use Enumerations for States, Options, and Status Codes&lt;/h2&gt;&lt;p&gt;æœ¬èŠ‚çš„å†…å®¹å°±æ˜¯å¦‚ä½•æ­£ç¡®çš„ä½¿ç”¨æšä¸¾ã€‚&lt;/p&gt;
&lt;h2 id=&quot;çŠ¶æ€ä¸é€‰é¡¹çš„åŒºåˆ«ï¼ˆstates-and-optionsï¼‰&quot;&gt;&lt;a href=&quot;#çŠ¶æ€ä¸é€‰é¡¹çš„åŒºåˆ«ï¼ˆstates-and-optionsï¼‰&quot; class=&quot;headerlink&quot; title=&quot;çŠ¶æ€ä¸é€‰é¡¹çš„åŒºåˆ«ï¼ˆstates and optionsï¼‰&quot;&gt;&lt;/a&gt;çŠ¶æ€ä¸é€‰é¡¹çš„åŒºåˆ«ï¼ˆstates and optionsï¼‰&lt;/h2&gt;&lt;p&gt;åœ¨ç”¨&lt;strong&gt;enum&lt;/strong&gt;ä¹‹å‰ï¼Œæˆ‘ä¸ªäººè§‰å¾—ï¼ŒåŒºåˆ†ä¸€ä¸‹çŠ¶æ€å’Œé€‰é¡¹çš„æ¦‚å¿µè¿˜æ˜¯å¾ˆå¿…è¦çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çŠ¶æ€&lt;/strong&gt;ï¼ŒåŒæ—¶åªèƒ½æœ‰ä¸€ç§ï¼Œå¦‚â€œ&lt;strong&gt;OK&lt;/strong&gt;â€ï¼Œâ€œ&lt;strong&gt;Error&lt;/strong&gt;â€ï¼Œä¸å¯èƒ½åŒæ—¶æ˜¯OKå’ŒErrorã€‚&lt;br&gt;&lt;strong&gt;é€‰é¡¹&lt;/strong&gt;ï¼ŒåŒæ—¶å¯ä»¥æœ‰ä¸€ç§æˆ–ä¸€ç§ä»¥ä¸Šï¼Œå¦‚Appå¯ä»¥&lt;strong&gt;åŒæ—¶&lt;/strong&gt;æ”¯æŒæ¨ªå±å’Œç«–å±ï¼Œæ¨ªå±ç«–å±åœ¨è¿™ä¸ªæ—¶å€™å°±æ˜¯â€œå±å¹•æ–¹å‘â€çš„ä¸¤ç§ä¸åŒçš„é€‰é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç”¨æšä¸¾å®šä¹‰çŠ¶æ€å’Œé€‰é¡¹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>@autoreleasepool-å†…å­˜çš„åˆ†é…ä¸é‡Šæ”¾</title>
    <link href="http://tutuge.me/2015/03/17/what-is-autoreleasepool/"/>
    <id>http://tutuge.me/2015/03/17/what-is-autoreleasepool/</id>
    <published>2015-03-17T12:21:56.000Z</published>
    <updated>2016-03-20T09:03:59.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å¼€å‘è¿‡iOSã€Macçš„æœ‹å‹åº”è¯¥å¯¹â€œ<strong>@autoreleasepool</strong>â€ä¸é™Œç”Ÿã€‚åªè¦åœ¨Xcodeé‡Œåˆ›å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œå°±èƒ½çœ‹åˆ°ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//iOS program</span></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">char</span> * argv[]) &#123;</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">UIApplicationMain</span>(argc, argv, <span class="literal">nil</span>, <span class="built_in">NSStringFromClass</span>([AppDelegate <span class="keyword">class</span>]));</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//Command line program</span></div><div class="line"><span class="keyword">int</span> main(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> *argv[]) &#123;</div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        <span class="comment">//...</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œæ¯ä¸ª<strong>main</strong>å‡½æ•°çš„ä¸»ä½“éƒ½è¢«<strong>@autoreleasepool</strong>çš„Blockå—åŒ…åœ¨é‡Œé¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¥ä¸‹æ¥æ‰€æœ‰çš„å¯¹è±¡åˆ›å»ºéƒ½åœ¨è¿™ä¸ªblocké‡Œé¢ã€‚</p>
<p>é‚£ä¹ˆï¼Œ<strong>@autoreleasepool</strong>çš„ä½œç”¨åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬å¼€å‘ä¸­å¯ä»¥ç”¨å®ƒæ¥åšä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>å¯ä»¥åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¤§å¹…åº¦é™ä½ç¨‹åºçš„å†…å­˜å ç”¨ï¼Œå¦‚ä¸‹å›¾:</p>
<p><img src="https://camo.githubusercontent.com/2c1f07459d33c72de07d8a9305703b2ba40abfc4/687474703a2f2f7a6f72726f6368656e2e71696e6975646e2e636f6d2f626c6f675f776861745f69735f6175746f72656c65617365706f6f6c5f312e706e673f696d61676556696577322f302f682f343030" alt="autoreleasepoolæµ‹è¯•å†…å­˜å ç”¨å›¾"></p>
<ul>
<li>æµ‹è¯•çš„å†…å®¹ï¼š500000æ¬¡å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯åˆ›å»ºä¸€ä¸ªNSNumberå®ä¾‹å’Œä¸¤ä¸ªNSStringå®ä¾‹ã€‚</li>
<li>å›¾ï¼šçº¢çº¿è¡¨ç¤ºæ²¡æœ‰ç”¨<strong>@autoreleasepool</strong>æ—¶çš„å†…å­˜å ç”¨ã€‚</li>
<li>å›¾ï¼šç»¿çº¿è¡¨ç¤ºç”¨äº†<strong>@autoreleasepool</strong>ä¼˜åŒ–åçš„å†…å­˜å ç”¨ï¼</li>
</ul>
<p>æ•ˆæœæ˜¯ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼</p>
<p>ä»£ç Githubåœ°å€ï¼š<a href="https://github.com/zekunyan/AutoReleasePoolTestExample" target="_blank" rel="external">AutoReleasePoolTestExample</a> Xcode 6, iOS 8, iPhone 5æ¨¡æ‹Ÿå™¨.</p>
<a id="more"></a>
<h2 id="MRC-ä¸-ARC"><a href="#MRC-ä¸-ARC" class="headerlink" title="MRC ä¸ ARC"></a>MRC ä¸ ARC</h2><p>MRCï¼ˆMannul Reference Countingï¼‰å’ŒARC(Automatic Reference Counting)ï¼Œåˆ†åˆ«å¯¹åº”ç€æ‰‹åŠ¨å¼•ç”¨è®¡æ•°å’Œè‡ªåŠ¨å¼•ç”¨è®¡æ•°ã€‚</p>
<p>å¯¹ï¼æ˜¯è®¡æ•°ï¼Œä¸æ˜¯â€œ<strong>GCã€åƒåœ¾å›æ”¶</strong>â€ä»€ä¹ˆçš„ï¼Œå°±æ˜¯è¯´ï¼Œåœ¨Objective-Cçš„å¼€å‘ä¸­ï¼ŒARCä¸ä»£è¡¨åƒJavaé‚£æ ·æœ‰GCåšåƒåœ¾å›æ”¶ï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šè¿˜æ˜¯è¦â€œæ‰‹åŠ¨â€ç®¡ç†å†…å­˜çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨ARCç¯å¢ƒä¸‹å†™çš„ä»£ç ï¼Œä¸ç”¨è‡ªå·±æ‰‹åŠ¨æ’å…¥â€œ<strong>retainã€releaseè¿™äº›æ¶ˆæ¯</strong>â€ï¼ŒARCä¼šåœ¨ç¼–è¯‘æ—¶ä¸ºæˆ‘ä»¬åœ¨åˆé€‚çš„ä½ç½®æ’å…¥ï¼Œé‡Šæ”¾ä¸å¿…è¦çš„å†…å­˜ã€‚</p>
<p>è€Œ<strong>@autoreleasepool</strong>å°±è·Ÿå¯¹è±¡çš„<strong>release</strong>å¯†åˆ‡ç›¸å…³ã€‚</p>
<h2 id="autoreleasepool-å¹²äº†å•¥"><a href="#autoreleasepool-å¹²äº†å•¥" class="headerlink" title="@autoreleasepool å¹²äº†å•¥"></a>@autoreleasepool å¹²äº†å•¥</h2><p>åœ¨MRCæ—¶ä»£ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å…ˆretainä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“åœ¨ä»€ä¹ˆæ—¶å€™å¯ä»¥releaseå®ƒï¼Œæˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™ä¹ˆåšï¼š</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">NSAutoreleasePool</span> *pool = [[<span class="symbol">NSAutoreleasePool</span> alloc] init];</div><div class="line"></div><div class="line"><span class="symbol">NSString</span>* str = [[[<span class="symbol">NSString</span> alloc] initWithString:@<span class="string">"tutuge"</span>] autorelease];</div><div class="line">//use str...</div><div class="line"></div><div class="line">[pool release];</div><div class="line">//str is released</div></pre></td></tr></table></figure>
<p>å°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ç»™å¯¹è±¡å‘é€â€œ<strong>autorelease</strong>â€æ¶ˆæ¯ï¼Œç„¶åå½“<strong>NSAutoreleasePool</strong>ç»“æŸçš„æ—¶å€™ï¼Œâ€œæ ‡è®°è¿‡â€autoreleaseçš„å¯¹è±¡éƒ½ä¼šè¢«â€œ<strong>release</strong>â€æ‰ï¼Œä¹Ÿå°±æ˜¯ä¼šè¢«é‡Šæ”¾æ‰ã€‚</p>
<p>ä½†æ˜¯åœ¨ARCæ—¶ä»£ï¼Œæˆ‘ä»¬ä¸ç”¨æ‰‹åŠ¨å‘é€<strong>autorelease</strong>æ¶ˆæ¯ï¼ŒARCä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬åŠ ã€‚è€Œè¿™ä¸ªæ—¶å€™ï¼Œ<strong>@autoreleasepool</strong>åšçš„äº‹æƒ…ï¼Œè·Ÿ<strong>NSAutoreleasePool</strong>å°±ä¸€æ¨¡ä¸€æ ·äº†ã€‚</p>
<h2 id="ä»€ä¹ˆæ—¶å€™ç”¨-autoreleasepool"><a href="#ä»€ä¹ˆæ—¶å€™ç”¨-autoreleasepool" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ç”¨@autoreleasepool"></a>ä»€ä¹ˆæ—¶å€™ç”¨@autoreleasepool</h2><p>æ ¹æ®<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmAutoreleasePools.html" target="_blank" rel="external">Appleçš„æ–‡æ¡£</a>ï¼Œä½¿ç”¨åœºæ™¯å¦‚ä¸‹ï¼š</p>
<ul>
<li>å†™åŸºäºå‘½ä»¤è¡Œçš„çš„ç¨‹åºæ—¶ï¼Œå°±æ˜¯æ²¡æœ‰UIæ¡†æ¶ï¼Œå¦‚AppKitç­‰Cocoaæ¡†æ¶æ—¶ã€‚</li>
<li>å†™å¾ªç¯ï¼Œå¾ªç¯é‡Œé¢åŒ…å«äº†å¤§é‡ä¸´æ—¶åˆ›å»ºçš„å¯¹è±¡ã€‚ï¼ˆæœ¬æ–‡çš„ä¾‹å­ï¼‰</li>
<li>åˆ›å»ºäº†æ–°çš„çº¿ç¨‹ã€‚ï¼ˆéCocoaç¨‹åºåˆ›å»ºçº¿ç¨‹æ—¶æ‰éœ€è¦ï¼‰</li>
<li>é•¿æ—¶é—´åœ¨åå°è¿è¡Œçš„ä»»åŠ¡ã€‚</li>
</ul>
<h2 id="åˆ©ç”¨-autoreleasepoolä¼˜åŒ–å¾ªç¯"><a href="#åˆ©ç”¨-autoreleasepoolä¼˜åŒ–å¾ªç¯" class="headerlink" title="åˆ©ç”¨@autoreleasepoolä¼˜åŒ–å¾ªç¯"></a>åˆ©ç”¨@autoreleasepoolä¼˜åŒ–å¾ªç¯</h2><p>åˆ©ç”¨@autoreleasepoolä¼˜åŒ–å¾ªç¯çš„å†…å­˜å ç”¨ï¼Œæˆ‘è§‰å¾—æœ€æœ‰ç”¨çš„ä¸€ç‚¹ï¼Œä¸‹é¢å°±è¯´è¯´è¿™ä¸ªç‚¹ã€‚<br>å¦‚ä¸‹é¢çš„å¾ªç¯ï¼Œæ¬¡æ•°éå¸¸å¤šï¼Œè€Œä¸”å¾ªç¯ä½“é‡Œé¢çš„å¯¹è±¡éƒ½æ˜¯ä¸´æ—¶åˆ›å»ºä½¿ç”¨çš„ï¼Œå°±å¯ä»¥ç”¨<strong>@autoreleasepool</strong>åŒ…èµ·æ¥ï¼Œè®©æ¯æ¬¡å¾ªç¯ç»“æŸæ—¶ï¼Œå¯ä»¥åŠæ—¶çš„é‡Šæ”¾ä¸´æ—¶å¯¹è±¡çš„å†…å­˜ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//æ¥è‡ªAppleæ–‡æ¡£ï¼Œè§å‚è€ƒ</span></div><div class="line"><span class="built_in">NSArray</span> *urls = &lt;<span class="meta"># An array of file URLs #&gt;;</span></div><div class="line"><span class="keyword">for</span> (<span class="built_in">NSURL</span> *url <span class="keyword">in</span> urls) &#123;</div><div class="line"></div><div class="line">    <span class="keyword">@autoreleasepool</span> &#123;</div><div class="line">        <span class="built_in">NSError</span> *error;</div><div class="line">        <span class="built_in">NSString</span> *fileContents = [<span class="built_in">NSString</span> stringWithContentsOfURL:url</div><div class="line">                                        encoding:<span class="built_in">NSUTF8StringEncoding</span> error:&amp;error];</div><div class="line">        <span class="comment">/* Process the string, creating and autoreleasing more objects. */</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ä¹ˆåšçš„æ•ˆæœæ˜¯æå…¶æ˜¾è‘—åœ°ï¼Œå°±å¦‚æœ¬æ–‡æœ€å¼€å§‹çš„å›¾ä¸€æ ·ï¼Œå¯ä»¥è‡ªå·±æŠŠç¤ºä¾‹å·¥ç¨‹ä¸‹å›æ¥è¿è¡Œä¸‹è¯•è¯•~</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><strong>@autoreleasepool</strong>çœ‹èµ·æ¥å¾ˆä¸â€œèµ·çœ¼â€ï¼Œå¹³å¸¸å¼€å‘å¾ˆå®¹æ˜“å°±å¿½ç•¥å®ƒäº†ï¼Œä½†æ˜¯ä»”ç»†ä¸€çœ‹ï¼Œç¡®å¦‚æ­¤æœ‰ç”¨~</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmAutoreleasePools.html" target="_blank" rel="external">Using Autorelease Pool Blocks</a></li>
<li><a href="http://stackoverflow.com/questions/14677049/what-is-autoreleasepool-objective-c" target="_blank" rel="external">What is autoreleasepool? - Objective-C</a></li>
<li><a href="http://stackoverflow.com/questions/9086913/objective-c-why-is-autorelease-autoreleasepool-still-needed-with-arc" target="_blank" rel="external">Objective-C: Why is autorelease (@autoreleasepool) still needed with ARC?</a></li>
<li><a href="http://blog.zilongshanren.com/blog/2013/12/20/what-is-autorelease-pool/" target="_blank" rel="external">What-is-autorelease-pool?</a></li>
<li><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSAutoreleasePool_Class/index.html" target="_blank" rel="external">NSAutoreleasePool</a></li>
</ul>
<h3 id="ç¤ºä¾‹ä¸­çš„ç¬¬ä¸‰æ–¹åº“"><a href="#ç¤ºä¾‹ä¸­çš„ç¬¬ä¸‰æ–¹åº“" class="headerlink" title="ç¤ºä¾‹ä¸­çš„ç¬¬ä¸‰æ–¹åº“"></a>ç¤ºä¾‹ä¸­çš„ç¬¬ä¸‰æ–¹åº“</h3><p><a href="https://github.com/kevinzhow/PNChart" target="_blank" rel="external">PNChart</a></p>
<h3 id="è¿è¡Œä¸­ç”¨ä»£ç è·å–Appè¿è¡Œæ¶ˆè€—å†…å­˜"><a href="#è¿è¡Œä¸­ç”¨ä»£ç è·å–Appè¿è¡Œæ¶ˆè€—å†…å­˜" class="headerlink" title="è¿è¡Œä¸­ç”¨ä»£ç è·å–Appè¿è¡Œæ¶ˆè€—å†…å­˜"></a>è¿è¡Œä¸­ç”¨ä»£ç è·å–Appè¿è¡Œæ¶ˆè€—å†…å­˜</h3><p><a href="http://stackoverflow.com/questions/787160/programmatically-retrieve-memory-usage-on-iphone" target="_blank" rel="external">Programmatically retrieve memory usage on iPhone</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å¼€å‘è¿‡iOSã€Macçš„æœ‹å‹åº”è¯¥å¯¹â€œ&lt;strong&gt;@autoreleasepool&lt;/strong&gt;â€ä¸é™Œç”Ÿã€‚åªè¦åœ¨Xcodeé‡Œåˆ›å»ºä¸€ä¸ªå·¥ç¨‹ï¼Œå°±èƒ½çœ‹åˆ°ä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight objectivec&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//iOS program&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; main(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; argc, &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; * argv[]) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;@autoreleasepool&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;UIApplicationMain&lt;/span&gt;(argc, argv, &lt;span class=&quot;literal&quot;&gt;nil&lt;/span&gt;, &lt;span class=&quot;built_in&quot;&gt;NSStringFromClass&lt;/span&gt;([AppDelegate &lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt;]));&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//Command line program&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; main(&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; argc, &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;char&lt;/span&gt; *argv[]) &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;@autoreleasepool&lt;/span&gt; &amp;#123;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;//...&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &amp;#125;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&amp;#125;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;çœ‹ï¼Œæ¯ä¸ª&lt;strong&gt;main&lt;/strong&gt;å‡½æ•°çš„ä¸»ä½“éƒ½è¢«&lt;strong&gt;@autoreleasepool&lt;/strong&gt;çš„Blockå—åŒ…åœ¨é‡Œé¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¥ä¸‹æ¥æ‰€æœ‰çš„å¯¹è±¡åˆ›å»ºéƒ½åœ¨è¿™ä¸ªblocké‡Œé¢ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œ&lt;strong&gt;@autoreleasepool&lt;/strong&gt;çš„ä½œç”¨åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬å¼€å‘ä¸­å¯ä»¥ç”¨å®ƒæ¥åšä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯ä»¥åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¤§å¹…åº¦é™ä½ç¨‹åºçš„å†…å­˜å ç”¨ï¼Œå¦‚ä¸‹å›¾:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://camo.githubusercontent.com/2c1f07459d33c72de07d8a9305703b2ba40abfc4/687474703a2f2f7a6f72726f6368656e2e71696e6975646e2e636f6d2f626c6f675f776861745f69735f6175746f72656c65617365706f6f6c5f312e706e673f696d61676556696577322f302f682f343030&quot; alt=&quot;autoreleasepoolæµ‹è¯•å†…å­˜å ç”¨å›¾&quot;&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æµ‹è¯•çš„å†…å®¹ï¼š500000æ¬¡å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯åˆ›å»ºä¸€ä¸ªNSNumberå®ä¾‹å’Œä¸¤ä¸ªNSStringå®ä¾‹ã€‚&lt;/li&gt;
&lt;li&gt;å›¾ï¼šçº¢çº¿è¡¨ç¤ºæ²¡æœ‰ç”¨&lt;strong&gt;@autoreleasepool&lt;/strong&gt;æ—¶çš„å†…å­˜å ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;å›¾ï¼šç»¿çº¿è¡¨ç¤ºç”¨äº†&lt;strong&gt;@autoreleasepool&lt;/strong&gt;ä¼˜åŒ–åçš„å†…å­˜å ç”¨ï¼&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ•ˆæœæ˜¯ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼&lt;/p&gt;
&lt;p&gt;ä»£ç Githubåœ°å€ï¼š&lt;a href=&quot;https://github.com/zekunyan/AutoReleasePoolTestExample&quot;&gt;AutoReleasePoolTestExample&lt;/a&gt; Xcode 6, iOS 8, iPhone 5æ¨¡æ‹Ÿå™¨.&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰å…³å®å®šä¹‰çš„ç»éªŒä¸æŠ€å·§-ç®€åŒ–ä»£ç -å¢å¼ºLog</title>
    <link href="http://tutuge.me/2015/03/15/%E6%9C%89%E5%85%B3%E5%AE%8F%E5%AE%9A%E4%B9%89%E7%9A%84%E7%BB%8F%E9%AA%8C%E4%B8%8E%E6%8A%80%E5%B7%A7-%E7%AE%80%E5%8C%96%E4%BB%A3%E7%A0%81-%E5%A2%9E%E5%BC%BALog/"/>
    <id>http://tutuge.me/2015/03/15/æœ‰å…³å®å®šä¹‰çš„ç»éªŒä¸æŠ€å·§-ç®€åŒ–ä»£ç -å¢å¼ºLog/</id>
    <published>2015-03-15T07:34:28.000Z</published>
    <updated>2016-03-20T09:04:09.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å®å®šä¹‰ã€#defineå•¥çš„ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ã€‚<br>ä¸€èˆ¬æ¥è¯´ï¼Œæœ€å¸¸ç”¨çš„å¯èƒ½å°±æ˜¯å®šä¹‰ä¸€äº›å¸¸é‡ã€ç®€å•çš„â€œå‡½æ•°â€ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="regexp">//</span>å®šä¹‰å¸¸é‡PI</div><div class="line"><span class="comment">#define PI 3.1415926</span></div><div class="line"></div><div class="line"><span class="regexp">//</span>å®šä¹‰â€œå‡½æ•°â€MIN</div><div class="line"><span class="comment">#define MIN(A,B) ((A) &lt; (B) ? (A) : (B))</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œè¿™æ ·å®šä¹‰å¸¸é‡ã€å‡½æ•°ï¼Œæœ‰ä¸€å®šçš„é£é™©ã€‚ï¼ˆè§ï¼š<a href="http://tutuge.me/2015/03/11/Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-4-å¦‚ä½•æ­£ç¡®å®šä¹‰å¸¸é‡/">Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-4-å¦‚ä½•æ­£ç¡®å®šä¹‰å¸¸é‡</a>, <a href="http://onevcat.com/2014/01/black-magic-in-macro/" target="_blank" rel="external">å®å®šä¹‰çš„é»‘é­”æ³• - å®èœé¸Ÿèµ·é£æ‰‹å†Œ</a>ï¼‰</p>
<p>æœ¬æ–‡å°±åˆ—å‡ºå‡ æ¡æˆ‘ä¸ªäººåœ¨iOSå¼€å‘å½“ä¸­å¸¸ç”¨çš„ç»éªŒä¸æŠ€å·§ã€‚</p>
<a id="more"></a>
<h2 id="ç®€åŒ–ä»£ç "><a href="#ç®€åŒ–ä»£ç " class="headerlink" title="ç®€åŒ–ä»£ç "></a>ç®€åŒ–ä»£ç </h2><p>åœ¨å¼€å‘å½“ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¤§é‡çš„å†™ä¸€äº›é‡å¤çš„ï¼Œç”šè‡³å…·æœ‰â€œå±é™©â€çš„ä»£ç ï¼Œç”¨å®å®šä¹‰#defineï¼Œå¾€å¾€å¯ä»¥ç®€åŒ–ä»£ç ï¼Œçœ‹çœ‹ä¸‹é¢å‡ ä¸ªä¾‹å­ã€‚</p>
<h3 id="GCDä¸-define"><a href="#GCDä¸-define" class="headerlink" title="GCDä¸#define"></a>GCDä¸#define</h3><p><strong>dispatch_once</strong><br>é¡¹ç›®ä¸­å¾€å¾€å°‘ä¸äº†å„ç§å•ä¾‹ç±»ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šå¦‚ä¸‹å®šä¹‰ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">instancetype)sharedService </span>&#123;</div><div class="line">    static XXX *<span class="keyword">sharedService </span>= nil<span class="comment">;</span></div><div class="line"></div><div class="line">    static <span class="keyword">dispatch_once_t </span>onceToken<span class="comment">;</span></div><div class="line">    <span class="keyword">dispatch_once, </span>^&#123;</div><div class="line">        <span class="keyword">sharedService </span>= [XXX new]<span class="comment">;</span></div><div class="line">    &#125;)<span class="comment">;</span></div><div class="line"></div><div class="line">    return <span class="keyword">sharedService;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™ï¼Œå°±è¦æ³¨æ„å‡ ç‚¹ï¼š</p>
<ul>
<li>dispatch_once_tå¿…é¡»æ˜¯<strong>static</strong>çš„ï¼Œå¦åˆ™ä¼šå„ç§æŠ¥é”™=ã€‚=ã€‚</li>
<li><strong>dispatch_once</strong>çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»å–onceTokençš„åœ°å€ï¼Œå°±æ˜¯è¦â€œ<strong>&amp;onceToken</strong>ã€‚â€</li>
</ul>
<p>çœ‹ï¼Œå†™ä¸ªå°å°çš„å•ä¾‹éƒ½è¦è¿™ä¹ˆæ³¨æ„ï¼Œé”™äº†ä¸€ç‚¹éƒ½å¾ˆå±é™©å•Šï¼Œè€Œä¸”æ€»è¦é‡å¤å†™è¿™å‡ è¡Œã€‚æ‰€ä»¥è¿™ä¸ªæ—¶å€™éœ€è¦è®©å®å®šä¹‰å¸®å¿™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®šä¹‰å®å®šä¹‰</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DISPATCH_ONCE_BLOCK(onceBlock) static dispatch_once_t onceToken; dispatch_once(&amp;onceToken, onceBlock);</span></div><div class="line"></div><div class="line">+ (instancetype)sharedService &#123;</div><div class="line">    <span class="keyword">static</span> XXX *sharedService = nil;</div><div class="line"></div><div class="line">    <span class="comment">//ç›´æ¥ä¸€è¡Œæå®š</span></div><div class="line">    DISPATCH_ONCE_BLOCK(^&#123;</div><div class="line">        sharedService = [XXX <span class="keyword">new</span>];</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> sharedService;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œæ˜¯ä¸æ˜¯å˜å¾—æ›´åŠ ç®€æ´ã€â€œå®‰å…¨äº†â€~</p>
<p><strong>dispatch_async</strong><br>é™¤äº†dispatch_onceï¼Œå¦ä¸€ä¸ªå¸¸ç”¨çš„å°±æ˜¯dispatch_asyncã€‚ä¸å¤šè¯´ï¼Œç›´æ¥çœ‹ä¾‹å­ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åœ¨Mainçº¿ç¨‹ä¸Šè¿è¡Œ</span></div><div class="line"><span class="selector-id">#define</span> <span class="selector-tag">DISPATCH_ON_MAIN_THREAD</span>(mainQueueBlock) <span class="selector-tag">dispatch_async</span>(dispatch_get_main_queue(), mainQueueBlock);</div><div class="line"></div><div class="line"><span class="comment">//åœ¨Global Queueä¸Šè¿è¡Œ</span></div><div class="line"><span class="selector-id">#define</span> <span class="selector-tag">DISPATCH_ON_GLOBAL_QUEUE_HIGH</span>(globalQueueBlocl) <span class="selector-tag">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, <span class="number">0</span>), globalQueueBlocl);</div><div class="line"><span class="selector-id">#define</span> <span class="selector-tag">DISPATCH_ON_GLOBAL_QUEUE_DEFAULT</span>(globalQueueBlocl) <span class="selector-tag">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), globalQueueBlocl);</div><div class="line"><span class="selector-id">#define</span> <span class="selector-tag">DISPATCH_ON_GLOBAL_QUEUE_LOW</span>(globalQueueBlocl) <span class="selector-tag">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, <span class="number">0</span>), globalQueueBlocl);</div><div class="line"><span class="selector-id">#define</span> <span class="selector-tag">DISPATCH_ON_GLOBAL_QUEUE_BACKGROUND</span>(globalQueueBlocl) <span class="selector-tag">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, <span class="number">0</span>), globalQueueBlocl);</div><div class="line"></div><div class="line"><span class="comment">//ä¸»çº¿ç¨‹ä¸Š</span></div><div class="line"><span class="selector-tag">DISPATCH_ON_MAIN_THREAD</span>(^&#123;</div><div class="line">    <span class="comment">//æ›´æ–°UI</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">//Global Queue</span></div><div class="line"><span class="selector-tag">DISPATCH_ON_GLOBAL_QUEUE_DEFAULT</span>(^&#123;</div><div class="line">    <span class="comment">//å¼‚æ­¥è€—æ—¶ä»»åŠ¡</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>å†ä¹Ÿä¸ç”¨å†™ä¸€å¤§å †â€dispatch_async(dispatch_get_global_queueâ€äº†~çœ‹èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆæ¸…çˆ½~</p>
<h3 id="èƒ½ä¸€è¡Œæå®šï¼Œå¹²å˜›è¿˜è¦å†™å¤šè¡Œ"><a href="#èƒ½ä¸€è¡Œæå®šï¼Œå¹²å˜›è¿˜è¦å†™å¤šè¡Œ" class="headerlink" title="èƒ½ä¸€è¡Œæå®šï¼Œå¹²å˜›è¿˜è¦å†™å¤šè¡Œ"></a>èƒ½ä¸€è¡Œæå®šï¼Œå¹²å˜›è¿˜è¦å†™å¤šè¡Œ</h3><p>å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å†™çš„å‡½æ•°ã€æ–¹æ³•éƒ½ä¼šåœ¨èµ·å§‹çš„åœ°æ–¹åŠ ä¸€äº›å…¬å…±çš„åˆ¤æ–­ï¼Œæ¡ä»¶æ»¡è¶³äº†æ‰å¯ä»¥ç»§ç»­å¾€ä¸‹è¿è¡Œï¼Œå¦‚â€œç”¨æˆ·æ˜¯å¦ç™»å½•â€ã€â€œæŸä¸ªæ¨¡å—æ˜¯å¦åŠ è½½å®Œæˆâ€ç­‰ç­‰ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå†™å¦‚ä¸‹æ ·å­çš„ä»£ç ï¼š</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)doSomething &#123;</div><div class="line">    <span class="keyword">if</span> (![[XXXAccountService sharedService] isLogin]) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//do staff...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)doSomething2 &#123;</div><div class="line">    <span class="keyword">if</span> (![[XXXAccountService sharedService] isLogin]) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//do staff...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¯æ¬¡éƒ½è¦è¿™ä¹ˆå†™ï¼Œæ˜¯ä¸æ˜¯æ„Ÿè§‰å¾ˆæµªè´¹æ—¶é—´ï¼Ÿè€Œä¸”é‡å¤çš„å¥½å¤š=ã€‚=<br>æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ç”¨#defineï¼ŒæŠŠ3è¡Œå˜æˆä¸€è¡Œ:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®šä¹‰</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> CHECK_LOGIN_IN <span class="meta-keyword">if</span> (![[XXXAccountService sharedService] isLogin]) &#123;return;&#125;</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)doSomething &#123;</div><div class="line">    CHECK_LOGIN_IN</div><div class="line">    <span class="comment">//do staff...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)doSomething2 &#123;</div><div class="line">    CHECK_LOGIN_IN</div><div class="line">    <span class="comment">//do staff...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å…¶å®#defineçš„åŸç†å°±æ˜¯ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œç›´æ¥åšæ›¿æ¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ï¼Œå‘æŒ¥è‡ªå·±çš„æƒ³è±¡ï¼Œç®€åŒ–ä»£ç ~</p>
<h2 id="å®å®šä¹‰ä¸Log"><a href="#å®å®šä¹‰ä¸Log" class="headerlink" title="å®å®šä¹‰ä¸Log"></a>å®å®šä¹‰ä¸Log</h2><p>æ‰“Logï¼Œæ˜¯ä¸ªæ°¸æ’çš„è¯é¢˜ã€‚</p>
<h3 id="NSLogå¢å¼ºç‰ˆ"><a href="#NSLogå¢å¼ºç‰ˆ" class="headerlink" title="NSLogå¢å¼ºç‰ˆ"></a>NSLogå¢å¼ºç‰ˆ</h3><p>æˆ‘ä»¬ä¼šç»å¸¸ç”¨åˆ°<strong>NSLog</strong>æ‰“Logï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªå‡½æ•°èƒ½æä¾›çš„ä¿¡æ¯éå¸¸å°‘ï¼Œæ‰€ä»¥ï¼Œä¸‹é¢å°±æ˜¯ä¸€ä¸ªå¢å¼ºç‰ˆ, æœ€å¥½å®šä¹‰åœ¨é¡¹ç›®çš„pchæ–‡ä»¶ä¸­ï¼š</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#define NSLog(format, ...) \</span></div><div class="line">    <span class="keyword">do</span> &#123; <span class="string">\</span></div><div class="line">        NSLog(@<span class="string">"&lt;%@ : %d : %s&gt;-: %@"</span>, <span class="string">\</span></div><div class="line">        [[NSString stringWithUTF8String:__FILE__] lastPathComponent], <span class="string">\</span></div><div class="line">        __LINE__, <span class="string">\</span></div><div class="line">        __FUNCTION__, <span class="string">\</span></div><div class="line">        [NSString stringWithFormat:format, <span class="comment">##__VA_ARGS__]); \</span></div><div class="line">    &#125; <span class="keyword">while</span>(<span class="number">0</span>)</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ï¼š</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> *argv[])</span> </span>&#123;</div><div class="line">    <span class="meta">@autoreleasepool</span> &#123;</div><div class="line">        NSLog(@<span class="string">"Blog: %@"</span>, @<span class="string">"http://tutuge.me"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;main.<span class="string">m :</span> <span class="number">22</span> : main&gt;-: <span class="string">Blog:</span> <span class="string">http:</span><span class="comment">//tutuge.me</span></div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œè¿™ä¸‹Logå°±å¸¦ä¸Šäº†æ–‡ä»¶åã€è¡Œå·ã€å‡½æ•°åï¼Œä¸€ä¸‹å­å°±æ¸…æ¥šå¤šäº†~<br>è‡³äºä¸ºä»€ä¹ˆè¦ç”¨è¿™ä¸ªå¥‡æ€ªçš„â€œdo{â€¦}while(0)â€ï¼Œå…¶å®å°±æ˜¯ä¸ºäº†é˜²æ­¢åœ¨ä¸åŒçš„ä½¿ç”¨åœºæ™¯ä¸­å¯¼è‡´è¯­æ³•é”™è¯¯ï¼Œè¯¦ç»†è¯·è§ï¼š<a href="http://onevcat.com/2014/01/black-magic-in-macro/" target="_blank" rel="external">å®å®šä¹‰çš„é»‘é­”æ³• - å®èœé¸Ÿèµ·é£æ‰‹å†Œ</a></p>
<h3 id="ä¸ºLogå¢åŠ å…¨å±€å¼€å…³"><a href="#ä¸ºLogå¢åŠ å…¨å±€å¼€å…³" class="headerlink" title="ä¸ºLogå¢åŠ å…¨å±€å¼€å…³"></a>ä¸ºLogå¢åŠ å…¨å±€å¼€å…³</h3><p>å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šåœ¨è®¸å¤šåœ°æ–¹åŠ ä¸ŠLogï¼Œä½†æ˜¯åœ¨å‘å¸ƒçš„æ—¶å€™ï¼Œåˆä¸æƒ³æ˜¾ç¤ºè¿™äº›Logï¼Œè¿™ä¸ªæ—¶å€™éš¾é“è¦ä¸€ä¸ªä¸€ä¸ªçš„åˆ é™¤æ‰“Logçš„åœ°æ–¹ï¼Ÿ<br>æ‰€ä»¥ï¼Œä¸ºäº†å¢åŠ å¼€å…³ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸Šé¢çš„å¢å¼ºå‹NSLogæ”¹é€ ä¸€ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆ¤æ–­æ˜¯å¦è¦Log</span></div><div class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> NEED_DEBUG</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> NSLog(format, ...) \</span></div><div class="line">    <span class="comment">//Logå®šä¹‰...</span></div><div class="line"><span class="meta">#<span class="meta-keyword">else</span></span></div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> NSLog(format, ...) do&#123; &#125; while(0)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬éœ€è¦Logçš„æ—¶å€™ï¼Œåœ¨ä¸Šé¢å®šä¹‰çš„ä¹‹å‰åŠ ä¸Šä¸‹é¢è¿™ä¸€è¡Œï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> NEED_DEBUG</span></div></pre></td></tr></table></figure>
<p>å°±å¯ä»¥æ‰“å¼€Logäº†ã€‚ä¸åŠ çš„è¯ï¼Œå°±ä¸ä¼šæœ‰Log~ç®€å•çš„æ¡ä»¶ç¼–è¯‘~</p>
<h3 id="ä¸ºLogå¢åŠ ç­‰çº§"><a href="#ä¸ºLogå¢åŠ ç­‰çº§" class="headerlink" title="ä¸ºLogå¢åŠ ç­‰çº§"></a>ä¸ºLogå¢åŠ ç­‰çº§</h3><p>å¼€å‘è¿‡Androidçš„åº”è¯¥éƒ½çŸ¥é“ï¼ŒAndroidé‡Œé¢å¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”¨Log.iã€Log.dè¾“å‡ºä¸åŒâ€œç­‰çº§â€çš„Logï¼Œè°ƒè¯•æ›´åŠ æ–¹ä¾¿ï¼ŒNSLogå´ä¸è¡Œã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯è¦å€ŸåŠ©å®å®šä¹‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Debugç­‰çº§Log, åœ¨æ­¤ä¹‹å‰å®šä¹‰è‡ªå·±çš„NSLog</span></div><div class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOG_LEVEL_DEBUG</span></div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> DLog(format, ...) NSLog(@<span class="meta-string">"&lt;DEBUG&gt;: %@"</span>, [NSString stringWithFormat:format, ##__VA_ARGS__])</span></div><div class="line"><span class="meta">#<span class="meta-keyword">else</span></span></div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> DLog(format, ...) do&#123; &#125; while(0)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line"></div><div class="line"><span class="comment">//Infoç­‰çº§Log</span></div><div class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOG_LEVEL_INFO</span></div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> ILog(format, ...) NSLog(@<span class="meta-string">"&lt;Info&gt;: %@"</span>, [NSString stringWithFormat:format, ##__VA_ARGS__])</span></div><div class="line"><span class="meta">#<span class="meta-keyword">else</span></span></div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> ILog(format, ...) do&#123; &#125; while(0)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line"></div><div class="line"><span class="comment">//Errorç­‰çº§Log</span></div><div class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOG_LEVEL_ERROR</span></div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> ELog(format, ...) NSLog(@<span class="meta-string">"&lt;Error&gt;: %@"</span>, [NSString stringWithFormat:format, ##__VA_ARGS__])</span></div><div class="line"><span class="meta">#<span class="meta-keyword">else</span></span></div><div class="line">    <span class="meta">#<span class="meta-keyword">define</span> ELog(format, ...) do&#123; &#125; while(0)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div></pre></td></tr></table></figure>
<p>å½“æˆ‘ä»¬åœ¨æ‰“Logçš„æ—¶å€™ï¼Œå°±å¯ä»¥æ ¹æ®éœ€è¦ï¼Œç”¨ä¸åŒç­‰çº§çš„Logï¼Œè€Œä¸”å¯ä»¥æ–¹ä¾¿çš„å®šåˆ¶éœ€è¦è¾“å‡ºå“ªå‡ ç§ï¼Œå¹¶ä¸”ä¹‹å‰çš„â€œå¢å¼ºç‰ˆâ€NSLogä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</p>
<p>å®Œæ•´çš„è¯·çœ‹<a href="https://gist.github.com/zekunyan/2f2356136b9b40348584" target="_blank" rel="external">Gist</a>.</p>
<h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h2><p>è¿˜æœ‰ä¸€äº›ç®€å•å¥½ç”¨çš„å®å®šä¹‰ï¼Œåœ¨è¿™å°±åªä¸¾å‡ ä¸ªå…¸å‹çš„ä¾‹å­äº†~</p>
<h3 id="æ‰“å°è‡ªå®šä¹‰ç±»å‹ä¿¡æ¯"><a href="#æ‰“å°è‡ªå®šä¹‰ç±»å‹ä¿¡æ¯" class="headerlink" title="æ‰“å°è‡ªå®šä¹‰ç±»å‹ä¿¡æ¯"></a>æ‰“å°è‡ªå®šä¹‰ç±»å‹ä¿¡æ¯</h3><p>å‡å¦‚æœ‰å¦‚ä¸‹ç»“æ„ä½“å®šä¹‰(è‡ªå®šä¹‰ç±»çš„è¯ï¼Œç›´æ¥é‡å†™descriptionæ–¹æ³•å³å¯):</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å¤æ•°ç»“æ„ä½“</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> Complex &#123;</div><div class="line">    <span class="keyword">float</span> r; <span class="comment">//å®éƒ¨</span></div><div class="line">    <span class="keyword">float</span> i; <span class="comment">//è™šéƒ¨</span></div><div class="line">&#125; Complex;</div><div class="line"></div><div class="line"><span class="comment">//å®šä¹‰æ‰“å°Complexç±»å‹çš„å®</span></div><div class="line"><span class="comment">//è¾“å‡ºï¼š(1+2i), (1-2i)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> NSLogComplex(complex) NSLog(@<span class="meta-string">"Complex: (%g%s%gi)"</span>, complex.r, (complex.i &gt; 0 ? <span class="meta-string">"+"</span> : <span class="meta-string">""</span>), complex.i)</span></div></pre></td></tr></table></figure>
<h3 id="å¸¸ç”¨å‡½æ•°ç®€åŒ–ã€å•ä¾‹è·å–"><a href="#å¸¸ç”¨å‡½æ•°ç®€åŒ–ã€å•ä¾‹è·å–" class="headerlink" title="å¸¸ç”¨å‡½æ•°ç®€åŒ–ã€å•ä¾‹è·å–"></a>å¸¸ç”¨å‡½æ•°ç®€åŒ–ã€å•ä¾‹è·å–</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è·å–Viewçš„å±æ€§</span></div><div class="line"><span class="number">#def</span>ine GetViewWidth(view)  view<span class="selector-class">.frame</span><span class="selector-class">.size</span><span class="selector-class">.width</span></div><div class="line"><span class="number">#def</span>ine GetViewHeight(view) view<span class="selector-class">.frame</span><span class="selector-class">.size</span><span class="selector-class">.height</span></div><div class="line"><span class="number">#def</span>ine GetViewX(view)      view<span class="selector-class">.frame</span><span class="selector-class">.origin</span><span class="selector-class">.x</span></div><div class="line"><span class="number">#def</span>ine GetViewY(view)      view<span class="selector-class">.frame</span><span class="selector-class">.origin</span><span class="selector-class">.y</span></div><div class="line"></div><div class="line"><span class="comment">//å±å¹•å¸¸é‡</span></div><div class="line"><span class="number">#def</span>ine GetScreenWidth      [[UIScreen mainScreen] bounds]<span class="selector-class">.size</span><span class="selector-class">.width</span></div><div class="line"><span class="number">#def</span>ine GetScreenHeight     [[UIScreen mainScreen] bounds]<span class="selector-class">.size</span><span class="selector-class">.height</span></div><div class="line"></div><div class="line"><span class="comment">//è·å–å›¾ç‰‡èµ„æº</span></div><div class="line"><span class="number">#def</span>ine GetImage(imageName) [UIImage imageNamed:[NSString stringWithFormat:@<span class="string">"%@"</span>,imageName]]</div><div class="line"></div><div class="line"><span class="comment">//ç­‰ç­‰~åªè¦ä½ æƒ³å¾—åˆ°~</span></div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å®å®šä¹‰çš„å„ç§Tipè¿˜è¿œè¿œä¸æ­¢è¿™äº›ï¼Œåˆç†ä½¿ç”¨å®ƒï¼Œå¯ä»¥æœ‰æ•ˆæ”¹å–„ä»£ç çš„é˜…è¯»è´¨é‡~</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://gcc.gnu.org/onlinedocs/cpp/index.html" target="_blank" rel="external">The C Preprocessor</a></li>
<li><a href="http://onevcat.com/2014/01/black-magic-in-macro/" target="_blank" rel="external">å®å®šä¹‰çš„é»‘é­”æ³• - å®èœé¸Ÿèµ·é£æ‰‹å†Œ</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å®å®šä¹‰ã€#defineå•¥çš„ï¼Œæˆ‘ä»¬ç»å¸¸é‡åˆ°ã€‚&lt;br&gt;ä¸€èˆ¬æ¥è¯´ï¼Œæœ€å¸¸ç”¨çš„å¯èƒ½å°±æ˜¯å®šä¹‰ä¸€äº›å¸¸é‡ã€ç®€å•çš„â€œå‡½æ•°â€ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight awk&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;regexp&quot;&gt;//&lt;/span&gt;å®šä¹‰å¸¸é‡PI&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#define PI 3.1415926&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;regexp&quot;&gt;//&lt;/span&gt;å®šä¹‰â€œå‡½æ•°â€MIN&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#define MIN(A,B) ((A) &amp;lt; (B) ? (A) : (B))&lt;/span&gt;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œè¿™æ ·å®šä¹‰å¸¸é‡ã€å‡½æ•°ï¼Œæœ‰ä¸€å®šçš„é£é™©ã€‚ï¼ˆè§ï¼š&lt;a href=&quot;http://tutuge.me/2015/03/11/Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-4-å¦‚ä½•æ­£ç¡®å®šä¹‰å¸¸é‡/&quot;&gt;Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-4-å¦‚ä½•æ­£ç¡®å®šä¹‰å¸¸é‡&lt;/a&gt;, &lt;a href=&quot;http://onevcat.com/2014/01/black-magic-in-macro/&quot;&gt;å®å®šä¹‰çš„é»‘é­”æ³• - å®èœé¸Ÿèµ·é£æ‰‹å†Œ&lt;/a&gt;ï¼‰&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°±åˆ—å‡ºå‡ æ¡æˆ‘ä¸ªäººåœ¨iOSå¼€å‘å½“ä¸­å¸¸ç”¨çš„ç»éªŒä¸æŠ€å·§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="æŠ€å·§" scheme="http://tutuge.me/tags/%E6%8A%80%E5%B7%A7/"/>
    
  </entry>
  
  <entry>
    <title>Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-4-å¦‚ä½•æ­£ç¡®å®šä¹‰å¸¸é‡</title>
    <link href="http://tutuge.me/2015/03/11/Effective-Objective-C-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Item-4-%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E5%AE%9A%E4%B9%89%E5%B8%B8%E9%87%8F/"/>
    <id>http://tutuge.me/2015/03/11/Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-4-å¦‚ä½•æ­£ç¡®å®šä¹‰å¸¸é‡/</id>
    <published>2015-03-10T16:07:23.000Z</published>
    <updated>2016-08-07T06:09:31.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å†™åšå®¢æœç„¶æ¯”å…‰çœ‹ä¹¦è¦èŠ±æ—¶é—´=ã€‚=ï¼Œä¹¦éƒ½å¿«çœ‹å®Œäº†ï¼Œæ‰å†™åˆ°ç¬¬4èŠ‚ã€‚ä½†æ˜¯æ€»ç»“ä¸€éï¼Œçš„ç¡®å°è±¡æ·±åˆ»å•Š~~</p>
<p>è¿™æ¬¡çš„ä¸»é¢˜æ˜¯â€œ<strong>å¸¸é‡</strong>â€ï¼Œéå¸¸å¸¸ç”¨ï¼Œåˆéå¸¸é‡è¦çš„ä¸œè¥¿~è‰¯å¥½çš„ä»£ç è§„èŒƒã€è®¾è®¡ï¼Œå°‘ä¸äº†å„ç§<strong>å¸¸é‡</strong>ã€‚</p>
<h2 id="Item-4-Prefer-Typed-Constants-to-Preprocessor-define"><a href="#Item-4-Prefer-Typed-Constants-to-Preprocessor-define" class="headerlink" title="Item 4 - Prefer Typed Constants to Preprocessor #define"></a>Item 4 - Prefer Typed Constants to Preprocessor #define</h2><p>æœ¬èŠ‚ç€é‡å¯¹æ¯”äº†å¸¸é‡çš„å®šä¹‰å½¢å¼ï¼Œç±»å‹å¸¸é‡å’Œ#defineçš„åŒºåˆ«ã€å„è‡ªçš„ç‰¹ç‚¹ã€‚æœ€åå¾—å‡ºï¼Œæˆ‘ä»¬åº”è¯¥ç”¨å¸¦æœ‰ç±»å‹çš„å¸¸é‡ï¼Œè€Œä¸æ˜¯#defineã€‚</p>
<a id="more"></a>
<h2 id="ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹"><a href="#ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹"></a>ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹</h2><p>åº”ç”¨ä¸­ï¼Œå°‘ä¸äº†å„ç§åŠ¨ç”»ï¼Œä¹Ÿå°±å°‘ä¸äº†è®¾å®šåŠ¨ç”»çš„æ—¶é—´é•¿åº¦ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šè®¾å®šçŸ­ã€ä¸­ã€é•¿å‡ ç§æ—¶é—´å¸¸é‡ï¼Œç”¨äºä¸åŒçš„åœºåˆï¼Œäº†è§£Cè¯­è¨€çš„ç«¥é‹ä¼°è®¡å¯¹â€œ<strong>#define</strong>â€å®å®šä¹‰ä¸é™Œç”Ÿï¼Œäºæ˜¯ï¼Œå¯èƒ½å°±ä¼šå¦‚ä¸‹è¿™ä¹ˆå®šä¹‰ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ANIMATION_DURATION_SHORT 0.3</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ANIMATION_DURATION_MIDDLE 0.6</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ANIMATION_DURATION_LONG 1.0</span></div></pre></td></tr></table></figure>
<p>äºæ˜¯ï¼Œæ‰€æœ‰ç”¨åˆ°åŠ¨ç”»æ—¶é•¿çš„åœ°æ–¹ï¼Œç›´æ¥ç”¨è¿™å‡ ä¸ªå®å®šä¹‰å°±è¡Œäº†ã€‚</p>
<p>ä¹ä¸€çœ‹ï¼Œä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ã€‚</p>
<h3 id="ç±»å‹-ä¸å¯å˜"><a href="#ç±»å‹-ä¸å¯å˜" class="headerlink" title="ç±»å‹+ä¸å¯å˜"></a>ç±»å‹+ä¸å¯å˜</h3><p>å…ˆæ¥çœ‹çœ‹å®å®šä¹‰å¹²äº†ä»€ä¹ˆã€‚<br>æ€»çš„æ¥è¯´ï¼Œ#defineå°±æ˜¯â€œæ›¿æ¢â€ï¼Œåœ¨ç¼–è¯‘æ—¶ï¼Œå°†ä¸€åˆ‡å®å®šä¹‰æ›¿æ¢æˆå®šä¹‰åé¢çš„å†…å®¹ã€‚ï¼ˆå‚è€ƒ<a href="http://baike.baidu.com/view/2076445.htm" target="_blank" rel="external">ç™¾åº¦ç™¾ç§‘</a>ï¼‰</p>
<p>å…³é”®åœ¨äºï¼š</p>
<ul>
<li>å®å®šä¹‰ä¸ä¼šæ£€æŸ¥æ›¿æ¢çš„â€œ<strong>ç±»å‹</strong>â€ï¼Œåªè¦é‡åˆ°ï¼Œå°±åšæ›¿æ¢ã€‚</li>
<li>å®å®šä¹‰ä¸ä¿è¯â€œ<strong>ä¸å¯å˜</strong>â€ï¼Œå› ä¸ºå¯ä»¥<strong>é‡å¤å®šä¹‰</strong>ï¼Œä¸èƒ½ä¿è¯å€¼ä¸å˜ã€‚(è¿™ä¸ªæˆ‘è§‰å¾—æ˜¯æœ€å®¹æ˜“è®©äººå¿½ç•¥çš„åœ°æ–¹)</li>
</ul>
<p>æ‰€ä»¥ï¼Œç”¨å®å®šä¹‰å®šä¹‰å¸¸é‡ï¼Œå¾ˆâ€œå±é™©â€ã€‚</p>
<h2 id="æ­£ç¡®çš„åšæ³•"><a href="#æ­£ç¡®çš„åšæ³•" class="headerlink" title="æ­£ç¡®çš„åšæ³•"></a>æ­£ç¡®çš„åšæ³•</h2><p>æ°å½“çš„å¸¸é‡ï¼Œåº”è¯¥å…·å¤‡åˆé€‚çš„å¸¸é‡åå­—ã€æ­£ç¡®çš„ç±»å‹ï¼Œè¿˜æœ‰constã€externç­‰å…³é”®å­—çš„ä¿®é¥°ï¼Œå½“ç„¶ï¼Œè¿˜è¦æ ¹æ®å¸¸é‡é€‚ç”¨çš„â€œ<strong>èŒƒå›´</strong>â€ï¼Œåšå‡ºæ°å½“çš„å¤„ç†ã€‚ä¸€ä¸‹ä¸¾ä¾‹è¯´æ˜ã€‚</p>
<h3 id="åªåœ¨å‡½æ•°ä¸­ç”¨çš„å¸¸é‡"><a href="#åªåœ¨å‡½æ•°ä¸­ç”¨çš„å¸¸é‡" class="headerlink" title="åªåœ¨å‡½æ•°ä¸­ç”¨çš„å¸¸é‡"></a>åªåœ¨å‡½æ•°ä¸­ç”¨çš„å¸¸é‡</h3><p>åªåœ¨å‡½æ•°ä¸­ç”¨çš„å¸¸é‡ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)runAnimation &#123;</div><div class="line">    <span class="comment">//åŠ¨ç”»æ—¶é—´é•¿åº¦å¸¸é‡</span></div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="built_in">NSTimeInterval</span> kAnimationDurationLong = <span class="number">1.0</span>f;</div><div class="line">    <span class="comment">//...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>staticã€constå®šä¹‰äº†å®ƒæ˜¯é™æ€ä¸å¯å˜çš„ï¼›<strong>NSTimeInterval</strong>åˆ™â€œç²¾ç¡®â€æŒ‡å®šäº†å¸¸é‡çš„ç±»å‹ã€‚</p>
<h3 id="åªåœ¨ä¸€ä¸ªâ€œ-mâ€æ–‡ä»¶ä¸­ä½¿ç”¨çš„å¸¸é‡"><a href="#åªåœ¨ä¸€ä¸ªâ€œ-mâ€æ–‡ä»¶ä¸­ä½¿ç”¨çš„å¸¸é‡" class="headerlink" title="åªåœ¨ä¸€ä¸ªâ€œ.mâ€æ–‡ä»¶ä¸­ä½¿ç”¨çš„å¸¸é‡"></a>åªåœ¨ä¸€ä¸ªâ€œ<strong>.m</strong>â€æ–‡ä»¶ä¸­ä½¿ç”¨çš„å¸¸é‡</h3><p>åœ¨ç±»çš„å®ç°æ–‡ä»¶â€œxxx.mâ€æ–‡ä»¶ä¸­å®šä¹‰å¸¸é‡ï¼Œä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ã€‚</p>
<p>ä½ å¯èƒ½ä¼šè§‰å¾—ï¼Œæ—¢ç„¶æ˜¯ä¸€ä¸ªç±»ä½¿ç”¨çš„ï¼Œé‚£å°±æ”¾åœ¨ç±»çš„å¤´æ–‡ä»¶é‡Œé¢å®šä¹‰ä¸å°±å¥½äº†ã€‚</p>
<p><strong>ä½†æ˜¯è¿™ä¹ˆæƒ³æ˜¯é”™çš„=ã€‚=</strong></p>
<p><strong>å› ä¸ºæ‰€æœ‰è¦ç”¨åˆ°è¿™ä¸ªç±»çš„æ–‡ä»¶ï¼Œéƒ½ä¼šæ— å½¢å½“ä¸­åŒ…å«äº†è¿™äº›å¸¸é‡å£°æ˜ï¼Œå°†ä¸å¿…è¦çš„æ•°æ®æš´éœ²åœ¨å¤–é¢ï¼Œè¿™æ ·æ˜¯è¿åè®¾è®¡åŸåˆ™çš„ï¼Œå¹¶ä¸”ï¼Œå¦‚æœå¸¸é‡åå­—å–å¾—ä¸æ°å½“ï¼Œè¿˜æœ‰å¯èƒ½é€ æˆå†²çªã€‚</strong></p>
<p>æ‰€ä»¥ï¼Œåº”è¯¥å¦‚ä¸‹:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//XXX.m</span></div><div class="line"></div><div class="line"><span class="comment">//å¿…é¡»è¦static</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="built_in">NSTimeInterval</span> kAnimationDurationLong = <span class="number">1.0</span>f;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">XXX</span></span></div><div class="line"><span class="comment">//...</span></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„ç‚¹ï¼š</p>
<ul>
<li>ä¸€å®šè¦æ”¾åœ¨.mæ–‡ä»¶ä¸­ã€‚</li>
<li>å¿…é¡»æ˜¯<strong>static</strong>ï¼Œè¡¨ç¤ºæ­¤å¸¸é‡ä½œç”¨åŸŸåªåœ¨æ­¤.mæ–‡ä»¶ä¸­ã€‚å¦‚æœä¸åŠ staticçš„è¯ï¼Œå¸¸é‡å°±ä¼šåœ¨å…¨å±€ä½œç”¨åŸŸä¸­å£°æ˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´è·Ÿå…¶ä»–çš„å¸¸é‡å†²çªã€‚</li>
<li>constï¼Œå½“ç„¶ã€‚</li>
<li>NSTimeIntervalï¼Œç¡®å®šçš„ç±»å‹ã€‚</li>
<li>kAnimationDurationLongï¼Œâ€œ<strong>k</strong>â€å¼€å¤´çš„å‘½åï¼Œä¹Ÿç®—æ˜¯Appleçš„è§„èŒƒäº†å§ï¼Œå†…éƒ¨å¸¸é‡ç»Ÿä¸€ä»¥â€œ<strong>k</strong>â€å¼€å¤´ã€‚</li>
</ul>
<h3 id="å…¨å±€å¸¸é‡"><a href="#å…¨å±€å¸¸é‡" class="headerlink" title="å…¨å±€å¸¸é‡"></a>å…¨å±€å¸¸é‡</h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œæœ€å¸¸è§çš„å…¨å±€å¸¸é‡å°±æ˜¯å‘å¹¿æ’­Notificationæ—¶ç”¨çš„Notificationçš„åå­—ï¼Œå¾€å¾€éƒ½æ˜¯ä¸€äº›å­—ç¬¦ä¸²ï¼Œä¸‹é¢å°±ä»¥è¿™ä¸ªä¸ºä¾‹å­ï¼š</p>
<p>å‡è®¾æˆ‘ä»¬çš„ç±»å«â€œ<strong>TTGClass</strong>â€ï¼Œæˆ‘ä»¬çš„ç±»ä¼šå‘å¤–å‘é€Notificationï¼Œæ‰€ä»¥éœ€è¦å®šä¹‰ä¸€ä¸ªNotificationçš„åå­—å¸¸é‡ä¾›å¤–ç•Œæ³¨å†Œï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//TTGClass.h</span></div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> TTGClassWorkBeginNotification;</div><div class="line"></div><div class="line"><span class="comment">//TTGClass.m</span></div><div class="line"><span class="built_in">NSString</span> * <span class="keyword">const</span> TTGClassWorkBeginNotification = <span class="string">@"TTGClassWorkBeginNotification"</span>;</div></pre></td></tr></table></figure>
<p>å…³é”®ï¼š</p>
<ul>
<li>å¤´æ–‡ä»¶ä¸­åªæ˜¯åšå£°æ˜ï¼Œä¸åšå®šä¹‰ã€‚æ‰€ä»¥ç”¨externè¡¨ç¤ºå¸¸é‡åœ¨åˆ«å¤„å®šä¹‰çš„ï¼Œå°½é‡éšè—ç»†èŠ‚ã€‚</li>
<li>åŒ<strong>ç±»å</strong>åšå¸¸é‡åå­—çš„å¼€å¤´ï¼Œ<strong>è¿™ä¸ªéå¸¸å…³é”®ï¼Œå› ä¸ºObjective-Cé‡Œé¢æ²¡æœ‰åƒJavaé‚£æ ·çš„â€œåŒ…â€æœºåˆ¶ï¼Œæ‰€ä»¥å¿…é¡»é å‘½åæ¥åˆ’åˆ†ä¸åŒçš„ç±»ï¼Œå¸¸é‡å½“ç„¶ä¹Ÿè¦éµå¾ªè¿™ä¸ªè§„åˆ™ã€‚</strong></li>
<li>NSStringï¼Œç¡®å®šçš„ç±»å‹ï¼›constï¼Œè¡¨æ˜å¸¸é‡ï¼›Notificationåç¼€ï¼Œè¡¨æ˜ç”¨é€”ã€‚è¿™äº›éƒ½æ˜¯éœ€è¦æ³¨æ„çš„ã€‚</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è‰¯å¥½çš„ä»£ç ï¼Œæ€»æ˜¯å°‘ä¸äº†å®šä¹‰å„ç§å¸¸é‡ï¼Œä»¥é¿å…â€œé­”é¬¼æ•°å­—ã€é­”é¬¼å­—ç¬¦ä¸²â€ã€‚æ‰€ä»¥æˆ‘ä»¬åº”è¯¥å°½é‡é¿å…å°‘ç”¨#defineå®šä¹‰å¸¸é‡ï¼Œè€Œæ˜¯ç”¨å¸¦æœ‰ç±»å‹çš„ã€constçš„å¸¸é‡ï¼Œå¹¶ä¸”å°½å¯èƒ½çš„ç¼©å°å¸¸é‡çš„ä½œç”¨åŸŸã€‚</p>
<p>æš´éœ²çš„ç»†èŠ‚è¶Šå°‘ï¼Œå‡ºé”™çš„æœºä¼šä¹Ÿå°±è¶Šå°ï¼ˆå¿˜äº†ä»å“ªé‡Œçœ‹åˆ°çš„=ã€‚=ï¼‰</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;å†™åšå®¢æœç„¶æ¯”å…‰çœ‹ä¹¦è¦èŠ±æ—¶é—´=ã€‚=ï¼Œä¹¦éƒ½å¿«çœ‹å®Œäº†ï¼Œæ‰å†™åˆ°ç¬¬4èŠ‚ã€‚ä½†æ˜¯æ€»ç»“ä¸€éï¼Œçš„ç¡®å°è±¡æ·±åˆ»å•Š~~&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡çš„ä¸»é¢˜æ˜¯â€œ&lt;strong&gt;å¸¸é‡&lt;/strong&gt;â€ï¼Œéå¸¸å¸¸ç”¨ï¼Œåˆéå¸¸é‡è¦çš„ä¸œè¥¿~è‰¯å¥½çš„ä»£ç è§„èŒƒã€è®¾è®¡ï¼Œå°‘ä¸äº†å„ç§&lt;strong&gt;å¸¸é‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Item-4-Prefer-Typed-Constants-to-Preprocessor-define&quot;&gt;&lt;a href=&quot;#Item-4-Prefer-Typed-Constants-to-Preprocessor-define&quot; class=&quot;headerlink&quot; title=&quot;Item 4 - Prefer Typed Constants to Preprocessor #define&quot;&gt;&lt;/a&gt;Item 4 - Prefer Typed Constants to Preprocessor #define&lt;/h2&gt;&lt;p&gt;æœ¬èŠ‚ç€é‡å¯¹æ¯”äº†å¸¸é‡çš„å®šä¹‰å½¢å¼ï¼Œç±»å‹å¸¸é‡å’Œ#defineçš„åŒºåˆ«ã€å„è‡ªçš„ç‰¹ç‚¹ã€‚æœ€åå¾—å‡ºï¼Œæˆ‘ä»¬åº”è¯¥ç”¨å¸¦æœ‰ç±»å‹çš„å¸¸é‡ï¼Œè€Œä¸æ˜¯#defineã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="ç¿»è¯‘" scheme="http://tutuge.me/tags/%E7%BF%BB%E8%AF%91/"/>
    
      <category term="ç¬”è®°" scheme="http://tutuge.me/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>UITextViewç¼–è¾‘æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…-ç®€å•çš„å›¾æ–‡æ··ç¼–</title>
    <link href="http://tutuge.me/2015/03/07/UITextView%E7%BC%96%E8%BE%91%E6%97%B6%E6%8F%92%E5%85%A5%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A1%A8%E6%83%85-%E7%AE%80%E5%8D%95%E7%9A%84%E5%9B%BE%E6%96%87%E6%B7%B7%E7%BC%96/"/>
    <id>http://tutuge.me/2015/03/07/UITextViewç¼–è¾‘æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…-ç®€å•çš„å›¾æ–‡æ··ç¼–/</id>
    <published>2015-03-07T03:04:38.000Z</published>
    <updated>2016-08-07T06:19:54.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨iOSå¼€å‘ä¸­ï¼Œç»å¸¸éœ€è¦ç”¨UITextViewä½œä¸ºç¼–è¾‘æ–‡æœ¬çš„è¾“å…¥æ§ä»¶ã€‚<br>ä½†æ˜¯å¦‚ä½•åœ¨ç¼–è¾‘æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…å‘¢ï¼Ÿå°±æ˜¯åƒå‘å¾®åšæ—¶é‚£æ ·ï¼Ÿ</p>
<p>æœ¬æ–‡ç®€å•çš„ç”¨<strong>NSTextAttachment</strong>ã€<strong>NSAttributedString</strong>çš„ç‰¹æ€§ï¼Œå®ç°äº†</p>
<ul>
<li>åœ¨UITextViewä¸­ç¼–è¾‘æ–‡å­—æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…å›¾ç‰‡</li>
<li>åŒæ—¶å¯ä»¥è¿”å›å¸¦æœ‰è¡¨æƒ…â€œ<strong>æ›¿æ¢ç¬¦</strong>â€çš„çº¯æ–‡æœ¬å­—ç¬¦ä¸²ã€‚</li>
</ul>
<h2 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h2><p>æœ¬æ–‡ä»£ç å·¥ç¨‹åœ°å€ï¼š<a href="https://github.com/zekunyan/UITextViewDIYEmojiExample" target="_blank" rel="external">https://github.com/zekunyan/UITextViewDIYEmojiExample</a></p>
<p>æ•ˆæœå›¾ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/inputEmoji_Sample.gif" alt="æ•ˆæœå›¾"></p>
<a id="more"></a>
<h2 id="èƒŒæ™¯çŸ¥è¯†"><a href="#èƒŒæ™¯çŸ¥è¯†" class="headerlink" title="èƒŒæ™¯çŸ¥è¯†"></a>èƒŒæ™¯çŸ¥è¯†</h2><ul>
<li>NSAttributedStringåŠå…¶å­ç±»ï¼Œç”¨äºæ˜¾ç¤ºå¯Œæ–‡æœ¬ã€‚</li>
<li>NSTextAttachmentï¼ŒNSAttributedStringçš„ä¸€ç§æ ·å¼ç±»ï¼Œå¯ä»¥åœ¨æ–‡æœ¬ä¸­æ˜¾ç¤ºå›¾ç‰‡ã€‚</li>
<li>NSTextStorageï¼ŒUITextViewä¸­çš„å®é™…çš„æ–‡æœ¬å°è£…ã€‚ï¼ˆè§å‚è€ƒä¸­çš„UITextViewæ–‡æ¡£ï¼‰</li>
</ul>
<h3 id="è¡¨æƒ…ä¸å…¶æ ‡å¿—"><a href="#è¡¨æƒ…ä¸å…¶æ ‡å¿—" class="headerlink" title="è¡¨æƒ…ä¸å…¶æ ‡å¿—"></a>è¡¨æƒ…ä¸å…¶æ ‡å¿—</h3><p>é¦–å…ˆéœ€è¦æ˜ç¡®çš„æ˜¯ï¼Œæˆ‘ä»¬çš„è‡ªå®šä¹‰è¡¨æƒ…ä¸€å®šæ˜¯æœ‰ä¸€ä¸€å¯¹åº”çš„â€œ<strong>æ ‡å¿—</strong>â€çš„ï¼Œå¦‚â€œ<strong>[/emoji_haha]</strong>â€ã€‚</p>
<p>å°±æ˜¯è¯´ï¼Œä¸ºäº†æ–¹ä¾¿å¤„ç†ï¼Œæ–¹ä¾¿åœ¨æ•°æ®åº“ã€ç½‘ç»œä¼ è¾“ä¸­ä¿å­˜ã€ä¼ è¾“å¸¦æœ‰è¡¨æƒ…å›¾ç‰‡çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬å¿…é¡»è¦ä¸ºæ¯ç§è¡¨æƒ…å–ç‰¹å®šçš„â€œ<strong>åå­—</strong>â€ï¼Œæ•°æ®åº“ä¸­å‚¨å­˜çš„ã€ç½‘ç»œä¼ è¾“çš„æ–‡æœ¬å°±åªåŒ…å«è¿™äº›æ ‡å¿—åå­—å°±è¡Œï¼Œåœ¨æ˜¾ç¤ºçš„æ—¶å€™åšå¯¹åº”çš„æ›¿æ¢ã€‚</p>
<p>å¦‚ï¼š</p>
<p><strong>tutuge.me<img src="http://zorrochen.qiniudn.com/blog_uitextview_input_emoji_emoji_1.png" alt="è¡¨æƒ…"></strong></p>
<p>å¯¹åº”çš„çº¯æ–‡æœ¬å°±æ˜¯ï¼š</p>
<p><strong>tutuge.me[/emoji_1]</strong></p>
<h2 id="æ’å…¥å¹¶æ˜¾ç¤ºè¡¨æƒ…å›¾ç‰‡"><a href="#æ’å…¥å¹¶æ˜¾ç¤ºè¡¨æƒ…å›¾ç‰‡" class="headerlink" title="æ’å…¥å¹¶æ˜¾ç¤ºè¡¨æƒ…å›¾ç‰‡"></a>æ’å…¥å¹¶æ˜¾ç¤ºè¡¨æƒ…å›¾ç‰‡</h2><p>æ’å…¥è¡¨æƒ…å¾ˆç®€å•ï¼Œç›´æ¥å®ä¾‹åŒ–<strong>NSTextAttachment</strong>ç±»ï¼Œå°†éœ€è¦çš„è¡¨æƒ…çš„UIImageå®ä¾‹èµ‹å€¼ç»™NSTextAttachmentçš„imageå±æ€§ï¼Œç„¶åç”¨â€œ<strong>[NSAttributedString attributedStringWithAttachment:]</strong>â€æ–¹æ³•å®ä¾‹åŒ–ä¸€ä¸ªNSAttributedStringçš„å¯¹è±¡ï¼Œæ’å…¥åˆ°UITextViewçš„textStorageå¯¹åº”çš„ä½ç½®å³å¯ã€‚</p>
<p>å¦‚ä¸‹ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">NSTextAttachment *emojiTextAttachment = [NSTextAttachment <span class="keyword">new</span>];</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®è¡¨æƒ…å›¾ç‰‡</span></div><div class="line">emojiTextAttachment.image = emojiImage;</div><div class="line"></div><div class="line"><span class="comment">//æ’å…¥è¡¨æƒ…</span></div><div class="line">[textView.textStorage <span class="string">insertAttributedString:</span>[NSAttributedString <span class="string">attributedStringWithAttachment:</span>emojiTextAttachment]</div><div class="line"><span class="symbol">                                     atIndex:</span>textView.selectedRange.location];</div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œå°±èƒ½åœ¨UITextViewå½“å‰å…‰æ ‡ä½ç½®æ’å…¥è¡¨æƒ…å›¾ç‰‡äº†ã€‚</p>
<h2 id="è·å–å¸¦æœ‰è¡¨æƒ…æ ‡å¿—çš„æ–‡æœ¬å­—ç¬¦ä¸²"><a href="#è·å–å¸¦æœ‰è¡¨æƒ…æ ‡å¿—çš„æ–‡æœ¬å­—ç¬¦ä¸²" class="headerlink" title="è·å–å¸¦æœ‰è¡¨æƒ…æ ‡å¿—çš„æ–‡æœ¬å­—ç¬¦ä¸²"></a>è·å–å¸¦æœ‰è¡¨æƒ…æ ‡å¿—çš„æ–‡æœ¬å­—ç¬¦ä¸²</h2><h3 id="éš¾ç‚¹"><a href="#éš¾ç‚¹" class="headerlink" title="éš¾ç‚¹"></a>éš¾ç‚¹</h3><p>NSTextAttachmentè¢«æ’å…¥åˆ°NSAttributedStringä¸­çš„æ—¶å€™ï¼Œ<strong>å°±è¢«å½“æˆäº†ä¸€ä¸ªå­—ç¬¦å¤„ç†ï¼ï¼ï¼</strong>ã€‚<br>å°±æ˜¯è¯´ï¼Œåªä»UITextViewçš„textä¸­ï¼Œæ˜¯æ‰¾ä¸å›æ–‡æœ¬é‡Œé¢ä¸åŒçš„è¡¨æƒ…æ‰€å¯¹åº”çš„æ ‡å¿—çš„ï¼</p>
<h3 id="è§£å†³ç‚¹"><a href="#è§£å†³ç‚¹" class="headerlink" title="è§£å†³ç‚¹"></a>è§£å†³ç‚¹</h3><ol>
<li>æˆ‘ä»¬è¦èƒ½éå†å‡ºå½“å‰æ–‡æœ¬ä¸­æ‰€æœ‰çš„è¡¨æƒ…ï¼Œä¹Ÿå°±æ˜¯NSTextAttachmentç±»ã€‚</li>
<li>æˆ‘ä»¬è¦èƒ½çŸ¥é“éå†å‡ºçš„è¡¨æƒ…ï¼Œå¯¹åº”çš„æ ‡å¿—æ˜¯ä»€ä¹ˆã€‚</li>
</ol>
<h3 id="éå†æ‰€æœ‰çš„NSTextAttachmentç±»å±æ€§"><a href="#éå†æ‰€æœ‰çš„NSTextAttachmentç±»å±æ€§" class="headerlink" title="éå†æ‰€æœ‰çš„NSTextAttachmentç±»å±æ€§"></a>éå†æ‰€æœ‰çš„NSTextAttachmentç±»å±æ€§</h3><p>éå†ï¼Œå—¯ï¼Œå…ˆçœ‹çœ‹Appleæœ‰æ²¡æœ‰æä¾›ç›¸åº”çš„æ–¹æ³•ï¼Œèƒ½éå†NSAttributedStringï¼ˆåŠå…¶å­ç±»ï¼‰çš„å±æ€§çš„ã€‚æŸ¥é˜…æ–‡æ¡£ï¼š<a href="https://developer.apple.com/library/prerelease/ios/documentation/Cocoa/Reference/Foundation/Classes/NSAttributedString_Class/index.html#//apple_ref/occ/instm/NSAttributedString" target="_blank" rel="external">NSAttributedString Class Reference</a>ï¼Œå¯ä»¥æ‰¾åˆ°è¿™ä¹ˆä¸€ä¸ªæ–¹æ³•ï¼šâ€œ<strong>- enumerateAttribute:inRange:options:usingBlock:</strong>â€ï¼Œå…¶åŸå‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)enumerateAttribute:(<span class="built_in">NSString</span> *)attrName</div><div class="line">                   inRange:(<span class="built_in">NSRange</span>)enumerationRange</div><div class="line">                   options:(<span class="built_in">NSAttributedStringEnumerationOptions</span>)opts</div><div class="line">                usingBlock:(<span class="keyword">void</span> (^)(<span class="keyword">id</span> value, <span class="built_in">NSRange</span> range, <span class="built_in">BOOL</span> *stop))block</div></pre></td></tr></table></figure>
<p>ç”¨å¤„ï¼š</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Executes <span class="keyword">the</span> Block <span class="keyword">for</span> <span class="keyword">the</span> specified attribute run <span class="keyword">in</span> <span class="keyword">the</span> specified range.</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œå°±æ˜¯è¿™ä¸ªæ–¹æ³•~å°±èƒ½éå†å‡ºNSTextAttachmentå¯¹è±¡äº†~</p>
<h3 id="åˆ›å»ºNSTextAttachmentçš„å­ç±»"><a href="#åˆ›å»ºNSTextAttachmentçš„å­ç±»" class="headerlink" title="åˆ›å»ºNSTextAttachmentçš„å­ç±»"></a>åˆ›å»ºNSTextAttachmentçš„å­ç±»</h3><p>å¦‚ä½•ç»‘å®šNSTextAttachmentæ‰€è¡¨ç¤ºçš„è¡¨æƒ…å’Œä¸å…¶å¯¹åº”çš„æ ‡å¿—ï¼Ÿåˆ›å»ºå­ç±»å˜›~ç›´æ¥åœ¨å­ç±»ä¸­å¢åŠ å±æ€§ï¼Œä¿å­˜æ ‡å¿—ä¸å°±è¡Œäº†ã€‚<br>å¦‚ä¸‹ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@interface</span> <span class="attribute">EmojiTextAttachment </span>: NSTextAttachment</div><div class="line"><span class="variable">@property</span>(strong, nonatomic) NSString *emojiTag;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ’å…¥è¡¨æƒ…çš„ä»£ç åº”è¯¥å°±æ˜¯ä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">EmojiTextAttachment *emojiTextAttachment = [EmojiTextAttachment <span class="keyword">new</span>];</div><div class="line"></div><div class="line"><span class="comment">//ä¿å­˜è¡¨æƒ…æ ‡å¿—</span></div><div class="line">emojiTextAttachment.emojiTag = emojiTag;</div><div class="line"></div><div class="line"><span class="comment">//è®¾ç½®è¡¨æƒ…å›¾ç‰‡</span></div><div class="line">emojiTextAttachment.image = emojiImage;</div><div class="line"></div><div class="line"><span class="comment">//æ’å…¥è¡¨æƒ…</span></div><div class="line">[textView.textStorage <span class="string">insertAttributedString:</span>[NSAttributedString <span class="string">attributedStringWithAttachment:</span>emojiTextAttachment]</div><div class="line"><span class="symbol">                                      atIndex:</span>textView.selectedRange.location];</div></pre></td></tr></table></figure>
<h3 id="åˆ›å»ºNSAttributedStringçš„Category"><a href="#åˆ›å»ºNSAttributedStringçš„Category" class="headerlink" title="åˆ›å»ºNSAttributedStringçš„Category"></a>åˆ›å»ºNSAttributedStringçš„Category</h3><p>æœ€åï¼Œå°±æ˜¯å°†è¿™ä¸ªéå†è¡¨æƒ…ã€æ‹¼æ¥æœ€ç»ˆæ–‡æœ¬å­—ç¬¦ä¸²çš„æ–¹æ³•è®¾ç½®æˆNSAttributedStringçš„è‡ªå®šä¹‰Categoryæ–¹æ³•ï¼Œä»¥æ–¹ä¾¿ç›´æ¥è°ƒç”¨ã€‚<br>å½“ç„¶ï¼Œè¿™é‡Œé¢æœ‰äº›ç»†èŠ‚çš„å¤„ç†ï¼Œå¦‚æ›¿æ¢è¡¨æƒ…æ ‡å¿—æ—¶çš„å­—ç¬¦ä¸²åç§»é‡è®¡ç®—ç­‰ï¼Œçœ‹ä»£ç å§ã€‚</p>
<p>å¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//NSAttributedString+EmojiExtension.h</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">NSAttributedString</span> (<span class="title">EmojiExtension</span>)</span></div><div class="line">- (<span class="built_in">NSString</span> *)getPlainString;</div><div class="line"><span class="keyword">@end</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//NSAttributedString+EmojiExtension.m</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">NSAttributedString</span> (<span class="title">EmojiExtension</span>)</span></div><div class="line"></div><div class="line">- (<span class="built_in">NSString</span> *)getPlainString &#123;</div><div class="line"></div><div class="line">    <span class="comment">//æœ€ç»ˆçº¯æ–‡æœ¬</span></div><div class="line">    <span class="built_in">NSMutableString</span> *plainString = [<span class="built_in">NSMutableString</span> stringWithString:<span class="keyword">self</span>.string];</div><div class="line"></div><div class="line">    <span class="comment">//æ›¿æ¢ä¸‹æ ‡çš„åç§»é‡</span></div><div class="line">    __block <span class="built_in">NSUInteger</span> base = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="comment">//éå†</span></div><div class="line">    [<span class="keyword">self</span> enumerateAttribute:<span class="built_in">NSAttachmentAttributeName</span> inRange:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="keyword">self</span>.length)</div><div class="line">                    options:<span class="number">0</span></div><div class="line">                 usingBlock:^(<span class="keyword">id</span> value, <span class="built_in">NSRange</span> range, <span class="built_in">BOOL</span> *stop) &#123;</div><div class="line"></div><div class="line">                    <span class="comment">//æ£€æŸ¥ç±»å‹æ˜¯å¦æ˜¯è‡ªå®šä¹‰NSTextAttachmentç±»</span></div><div class="line">                    <span class="keyword">if</span> (value &amp;&amp; [value isKindOfClass:[EmojiTextAttachment <span class="keyword">class</span>]]) &#123;</div><div class="line">                        <span class="comment">//æ›¿æ¢</span></div><div class="line">                        [plainString replaceCharactersInRange:<span class="built_in">NSMakeRange</span>(range.location + base, range.length)</div><div class="line">                                                    withString:((EmojiTextAttachment *) value).emojiTag];</div><div class="line"></div><div class="line">                       <span class="comment">//å¢åŠ åç§»é‡</span></div><div class="line">                        base += ((EmojiTextAttachment *) value).emojiTag.length - <span class="number">1</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;];</div><div class="line"></div><div class="line">    <span class="keyword">return</span> plainString;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>ç›´æ¥è°ƒç”¨getPlainStringæ–¹æ³•å³å¯ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å…¶å®æœ¬æ–‡ä¹Ÿæ˜¯æ¥æºäºæœ€è¿‘çš„é¡¹ç›®éœ€æ±‚ï¼Œåœ¨ç½‘ä¸Šä¸€ç›´æ‰¾ä¸åˆ°æ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå°±è‡ªå·±æ‘¸ç´¢å‡ºæ¥ä¸€ä¸ªã€‚è‡³äºå¤æ‚çš„å›¾æ–‡æ··åˆç¼–è¾‘ï¼Œå½“ç„¶è¿˜æ˜¯Core Textæ¥çš„å¼ºå¤§ï¼ˆè‡ªå·±ä¹Ÿåœ¨å­¦ä¹ ä¸­ï¼‰~</p>
<p>å¦‚æœæœ‰æ›´å¥½åœ°åŠæ³•ï¼Œä¸€å®šè¦å‘Šè¯‰æˆ‘å•Š~~~</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://developer.apple.com/library/ios/documentation/UIKit/Reference/UITextView_Class/#//apple_ref/occ/instp/UITextView/textStorage" target="_blank" rel="external">UITextView Class Reference</a></li>
<li><a href="https://developer.apple.com/library/prerelease/ios/documentation/Cocoa/Reference/Foundation/Classes/NSAttributedString_Class/index.html#//apple_ref/occ/instm/NSAttributedString/enumerateAttribute:inRange:options:usingBlock:" target="_blank" rel="external">NSAttributedString Class Reference</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;åœ¨iOSå¼€å‘ä¸­ï¼Œç»å¸¸éœ€è¦ç”¨UITextViewä½œä¸ºç¼–è¾‘æ–‡æœ¬çš„è¾“å…¥æ§ä»¶ã€‚&lt;br&gt;ä½†æ˜¯å¦‚ä½•åœ¨ç¼–è¾‘æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…å‘¢ï¼Ÿå°±æ˜¯åƒå‘å¾®åšæ—¶é‚£æ ·ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ç®€å•çš„ç”¨&lt;strong&gt;NSTextAttachment&lt;/strong&gt;ã€&lt;strong&gt;NSAttributedString&lt;/strong&gt;çš„ç‰¹æ€§ï¼Œå®ç°äº†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨UITextViewä¸­ç¼–è¾‘æ–‡å­—æ—¶æ’å…¥è‡ªå®šä¹‰è¡¨æƒ…å›¾ç‰‡&lt;/li&gt;
&lt;li&gt;åŒæ—¶å¯ä»¥è¿”å›å¸¦æœ‰è¡¨æƒ…â€œ&lt;strong&gt;æ›¿æ¢ç¬¦&lt;/strong&gt;â€çš„çº¯æ–‡æœ¬å­—ç¬¦ä¸²ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;ç¤ºä¾‹&quot;&gt;&lt;a href=&quot;#ç¤ºä¾‹&quot; class=&quot;headerlink&quot; title=&quot;ç¤ºä¾‹&quot;&gt;&lt;/a&gt;ç¤ºä¾‹&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡ä»£ç å·¥ç¨‹åœ°å€ï¼š&lt;a href=&quot;https://github.com/zekunyan/UITextViewDIYEmojiExample&quot;&gt;https://github.com/zekunyan/UITextViewDIYEmojiExample&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ•ˆæœå›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://zorrochen.qiniudn.com/inputEmoji_Sample.gif&quot; alt=&quot;æ•ˆæœå›¾&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>å…³äºè¯„è®ºä¸è§äº†=ã€‚=</title>
    <link href="http://tutuge.me/2015/03/06/%E5%85%B3%E4%BA%8E%E8%AF%84%E8%AE%BA%E4%B8%8D%E8%A7%81%E4%BA%86/"/>
    <id>http://tutuge.me/2015/03/06/å…³äºè¯„è®ºä¸è§äº†/</id>
    <published>2015-03-06T01:09:32.000Z</published>
    <updated>2016-03-20T09:04:03.000Z</updated>
    
    <content type="html"><![CDATA[<p>å‰å¤©å‡çº§äº†ä¸€æ¬¡Hexoï¼ŒåŸæ¥çš„ä¸»é¢˜è¯´å•¥ä¹Ÿç”¨ä¸äº†äº†=ã€‚=ï¼ˆå‰ç«¯çŸ¥è¯†ä¸è¶³ï¼Œæ­£åœ¨è¡¥~ï¼‰å¯¼è‡´åªèƒ½æ¢ä¸»é¢˜ï¼Œå¤šè¯´çš„è¯„è®ºå°±è¿™æ ·ä¸è§äº†ã€‚ã€‚ã€‚åŸæ¥æœ‰ç•™è¨€çš„å„ä½ç­’å­ï¼Œæ²¡çœ‹åˆ°ï¼Œä¸å¥½æ„æ€å•Š=ã€‚=</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‰å¤©å‡çº§äº†ä¸€æ¬¡Hexoï¼ŒåŸæ¥çš„ä¸»é¢˜è¯´å•¥ä¹Ÿç”¨ä¸äº†äº†=ã€‚=ï¼ˆå‰ç«¯çŸ¥è¯†ä¸è¶³ï¼Œæ­£åœ¨è¡¥~ï¼‰å¯¼è‡´åªèƒ½æ¢ä¸»é¢˜ï¼Œå¤šè¯´çš„è¯„è®ºå°±è¿™æ ·ä¸è§äº†ã€‚ã€‚ã€‚åŸæ¥æœ‰ç•™è¨€çš„å„ä½ç­’å­ï¼Œæ²¡çœ‹åˆ°ï¼Œä¸å¥½æ„æ€å•Š=ã€‚=&lt;/p&gt;

    
    </summary>
    
      <category term="å…¶å®ƒ" scheme="http://tutuge.me/categories/%E5%85%B6%E5%AE%83/"/>
    
    
      <category term="æ‚çƒ©" scheme="http://tutuge.me/tags/%E6%9D%82%E7%83%A9/"/>
    
  </entry>
  
  <entry>
    <title>Entityå’ŒModelçš„ä¸åŒ-å…³äºä»£ç çš„æ•°æ®å±‚</title>
    <link href="http://tutuge.me/2015/03/01/Entity%E5%92%8CModel%E7%9A%84%E4%B8%8D%E5%90%8C-%E5%85%B3%E4%BA%8E%E4%BB%A3%E7%A0%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%B1%82/"/>
    <id>http://tutuge.me/2015/03/01/Entityå’ŒModelçš„ä¸åŒ-å…³äºä»£ç çš„æ•°æ®å±‚/</id>
    <published>2015-03-01T15:03:10.000Z</published>
    <updated>2016-03-20T09:03:37.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç»å¸¸éƒ½èƒ½åœ¨ä¸€äº›åšå®¢ã€æ–‡æ¡£ä¸­çœ‹åˆ°â€œ<strong>Model</strong>â€ã€â€œ<strong>Entity</strong>â€çš„å­—æ ·ã€‚å¦‚<strong>MVC</strong>æ¨¡å¼ä¸­çš„â€œ<strong>Må°±æ˜¯Model</strong>â€ï¼Œâ€œ<strong>MVVMå¯¹åº”çš„Model-View-ViewModel</strong>â€ï¼Œæ•°æ®åº“æŠ½è±¡å±‚é‡Œé¢çš„â€œ<strong>Model</strong>â€œç­‰ã€‚</p>
<p>å®ƒä»¬çš„åŒºåˆ«åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>å…¶å®æ²¡æœ‰çœŸæ­£å®˜æ–¹çš„å¯¹Entityå’ŒModelçš„å®šä¹‰ï¼Œåœ¨æ­¤æˆ‘åªæ˜¯è¯´è¯´æˆ‘è‡ªå·±çš„ç†è§£ã€‚</p>
<a id="more"></a>
<h2 id="ä»€ä¹ˆæ˜¯Entity"><a href="#ä»€ä¹ˆæ˜¯Entity" class="headerlink" title="ä»€ä¹ˆæ˜¯Entity"></a>ä»€ä¹ˆæ˜¯<strong>Entity</strong></h2><p>å…ˆçœ‹çœ‹è¿™ä¸ªå•è¯æ˜¯ä»€ä¹ˆæ„æ€ï¼š<br><a href="http://www.iciba.com/entity" target="_blank" rel="external">çˆ±è¯éœ¸</a>ï¼šn: å®ä½“ï¼Œå®é™…å­˜åœ¨ç‰©ï¼Œæœ¬è´¨ã€‚</p>
<p>åœ¨ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›å…·æœ‰â€œ<strong>ç°å®</strong>â€æ„ä¹‰çš„â€œ<strong>ä¸ªä½“</strong>â€ï¼Œå¦‚ä¸€ä¸ªç”¨æˆ·ï¼Œä¸€é¦–æ­Œæ›²ï¼Œä¸€æ¡è¯„è®ºç­‰ç­‰ï¼Œå®ƒä»¬éƒ½æ˜¯åœ¨é€»è¾‘ä¸Šå®Œæ•´çš„ä¸€ä¸ªæ•´ä½“ï¼Œéƒ½å…·æœ‰ç›¸ä¼¼çš„ç»“æ„ï¼Œä½†æ˜¯å´å› ä¸ºâ€œ<strong>å±æ€§</strong>â€çš„ä¸åŒè€Œä¸åŒã€‚</p>
<p>çœ‹çœ‹ä¸€ä¸ªå…¸å‹çš„Entityç±»ï¼š</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Java</span></div><div class="line"></div><div class="line"><span class="comment">//Entityç±»å®šä¹‰</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserEntity</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">String</span> name;</div><div class="line">    <span class="keyword">public</span> int age;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">String</span> address;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//Entityå¯¹è±¡</span></div><div class="line">UserEntity john = <span class="keyword">new</span> <span class="type">UserEntity</span>();</div><div class="line">john.name = <span class="string">"John"</span>;</div><div class="line">john.age = <span class="number">20</span>;</div><div class="line">john.address = <span class="string">"China Hubei Wuhan"</span>;</div><div class="line"></div><div class="line">UserEntity tom = <span class="keyword">new</span> <span class="type">UserEntity</span>();</div><div class="line">tom.name = <span class="string">"Tom"</span>;</div><div class="line">tom.age = <span class="number">30</span>;</div><div class="line">tom.address = <span class="string">"USA Californian"</span>;</div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼š</p>
<ul>
<li>Entityç±»ï¼Œæˆ–è€…è¯´<strong>å®ä½“ç±»</strong>ï¼Œä»£è¡¨äº†ä¸€ç§â€œä¸ªä½“â€ï¼Œç±»ä¸­çš„å±æ€§ï¼ˆå°±æ˜¯å„ç§å˜é‡ï¼‰åˆ™æ˜¯è¿™ä¸ªâ€œä¸ªä½“â€çš„å…·ä½“ä½“ç°ã€‚å¦‚UserEntityç±»ï¼Œé‡Œé¢æœ‰nameã€ageå±æ€§ï¼Œå°±æ˜¯è¯´Entityç±»â€œ<strong>æè¿°</strong>â€äº†æŸç§ä¸ªä½“ã€‚</li>
<li>Entityç±»çš„å…·ä½“å¯¹è±¡ï¼Œä»£è¡¨äº†ä¸€ä¸ªå…·ä½“çš„å®ä½“ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ä»£ç å½“ä¸­ï¼Œä¸€ä¸ªå…·ä½“çš„Entityç±»å¯¹è±¡æ‰€ä»£è¡¨çš„å®ä½“åº”å½“æ˜¯å”¯ä¸€çš„ã€‚</li>
<li>å¾€å¾€Entityç±»çš„å®šä¹‰è·Ÿæ•°æ®åº“ä¸­çš„è¡¨å®šä¹‰æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚</li>
<li>è€ŒEntityçš„å…·ä½“å¯¹è±¡å¾€å¾€å¯¹åº”æ•°æ®åº“ä¸­çš„ä¸€è¡Œæ•°æ®ã€‚</li>
<li>Entityæ˜¯ä»£ç ä¸­æ“ä½œæ•°æ®çš„â€œ<strong>æœ€å°å•å…ƒ</strong>â€ã€‚</li>
</ul>
<h2 id="ä»€ä¹ˆæ˜¯Model"><a href="#ä»€ä¹ˆæ˜¯Model" class="headerlink" title="ä»€ä¹ˆæ˜¯Model"></a>ä»€ä¹ˆæ˜¯Model</h2><h3 id="å„ç§ç”¨æ³•"><a href="#å„ç§ç”¨æ³•" class="headerlink" title="å„ç§ç”¨æ³•"></a>å„ç§ç”¨æ³•</h3><p>å…¶å®å¾ˆå¤šæ—¶å€™ï¼ŒModelæœ‰å¦‚ä¸‹å‡ ç§ç”¨æ³•ï¼š</p>
<ol>
<li>å½“æˆEntityç”¨ï¼Œå®Œå…¨ä¸å…·å¤‡å…¶ä»–ä¸šåŠ¡é€»è¾‘ä»£ç ã€‚</li>
<li>å½“æˆ<strong>æ•°æ®åº“æ¥å£å±‚</strong>ï¼Œå°±æ˜¯å°†æ•°æ®åº“çš„è¯»å†™ï¼Œå¢åˆ æ”¹æŸ¥éƒ½å°è£…åœ¨äº†Modelä¸­ï¼Œå¾€å¾€å°±ä¼šæœ‰å¦‚â€œ<strong>getUserByID</strong>â€è¿™æ ·çš„æ–¹æ³•ã€‚</li>
<li>å½“æˆçº¯ç²¹çš„ä¸šåŠ¡å¤„ç†ç±»ã€‚</li>
</ol>
<p>æ‰€ä»¥ä»è€…è§ä»ï¼Œæ™ºè€…è§æ™ºï¼Œå…¶å®éƒ½å¯ä»¥ã€‚</p>
<p>åœ¨æ­¤è¯´è¯´æˆ‘çš„è®¤è¯†ã€‚</p>
<h3 id="æˆ‘çš„è®¤è¯†"><a href="#æˆ‘çš„è®¤è¯†" class="headerlink" title="æˆ‘çš„è®¤è¯†"></a>æˆ‘çš„è®¤è¯†</h3><p>å…ˆçœ‹çœ‹Modelå•è¯çš„æ„æ€:<br><a href="http://www.iciba.com/model" target="_blank" rel="external">çˆ±è¯éœ¸</a>ï¼šn: æ¨¡å‹ï¼›æ¨¡å¼ï¼›å…¸å‹ã€‚</p>
<p>æ—¢ç„¶æ˜¯æ¨¡å‹ï¼Œè€Œä¸æ˜¯â€œæ•°æ®â€ï¼Œæ‰€ä»¥æˆ‘è§‰å¾—ï¼Œ<strong>Modelåº”è¯¥æ˜¯åˆ©ç”¨Entityå®ä½“ï¼Œæ¥ç»„åˆã€å¤„ç†ã€æ•´åˆæ›´ä¸Šå±‚ã€æ›´æŠ½è±¡æ•°æ®çš„ç±»</strong>ã€‚</p>
<p>è¿˜æ˜¯åŸºäºä¸Šé¢çš„â€œ<strong>UserEntity</strong>â€ï¼Œçœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> <span class="title">UserListModel</span> &#123;</div><div class="line">    <span class="keyword">private</span> UserEntity[] users;</div><div class="line"></div><div class="line">    <span class="comment">//æ„é€ å‡½æ•°ï¼Œåˆå§‹åŒ–ç”¨æˆ·åˆ—è¡¨ç­‰ã€‚</span></div><div class="line"></div><div class="line">    <span class="function">UserEntity <span class="title">getUserByName</span>(<span class="params">String name</span>) </span>&#123;</div><div class="line">        <span class="comment">//æŸ¥æ‰¾...</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">void</span> transformUserAddressFormat &#123;</div><div class="line">        <span class="comment">//è½¬åŒ–åœ°å€æ ¼å¼</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å°±æ˜¯è¯´ï¼ŒEntityè¿˜æ˜¯åŸæœ¬çš„æ¦‚å¿µï¼Œåªä¸è¿‡Modelæ˜¯åŸºäºEntityçš„æ›´é«˜å±‚çš„æ•°æ®æŠ½è±¡ä¸å¤„ç†ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¯´å®è¯ï¼ŒEntityã€Modelï¼Œå®ƒä»¬çš„èŒè´£åˆ°åº•æ˜¯ä»€ä¹ˆï¼ŒçœŸçš„ä¸å¥½è¯´æ˜ç™½ï¼Œå¤§å®¶ä¹Ÿå°±åšä¸ªå‚è€ƒå§=ã€‚=</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="http://stackoverflow.com/questions/3029952/ddd-and-mvc-difference-between-model-and-entity" target="_blank" rel="external">DDD and MVC: Difference between â€˜Modelâ€™ and â€˜Entityâ€™</a></li>
<li><a href="http://whatis.techtarget.com/definition/entity" target="_blank" rel="external">Whatis.com Entity</a></li>
<li><a href="http://blogsh.de/2011/09/08/models-vs-entities" target="_blank" rel="external">Models vs. Entities</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ç»å¸¸éƒ½èƒ½åœ¨ä¸€äº›åšå®¢ã€æ–‡æ¡£ä¸­çœ‹åˆ°â€œ&lt;strong&gt;Model&lt;/strong&gt;â€ã€â€œ&lt;strong&gt;Entity&lt;/strong&gt;â€çš„å­—æ ·ã€‚å¦‚&lt;strong&gt;MVC&lt;/strong&gt;æ¨¡å¼ä¸­çš„â€œ&lt;strong&gt;Må°±æ˜¯Model&lt;/strong&gt;â€ï¼Œâ€œ&lt;strong&gt;MVVMå¯¹åº”çš„Model-View-ViewModel&lt;/strong&gt;â€ï¼Œæ•°æ®åº“æŠ½è±¡å±‚é‡Œé¢çš„â€œ&lt;strong&gt;Model&lt;/strong&gt;â€œç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒä»¬çš„åŒºåˆ«åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¶å®æ²¡æœ‰çœŸæ­£å®˜æ–¹çš„å¯¹Entityå’ŒModelçš„å®šä¹‰ï¼Œåœ¨æ­¤æˆ‘åªæ˜¯è¯´è¯´æˆ‘è‡ªå·±çš„ç†è§£ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€æ¬¡å®¡æ ¸è¢«æ‹’çš„ç»å†-å…³äºiCloudåˆ°åº•åº”è¯¥å¤‡ä»½ä»€ä¹ˆæ•°æ®</title>
    <link href="http://tutuge.me/2015/02/28/%E4%B8%80%E6%AC%A1%E5%AE%A1%E6%A0%B8%E8%A2%AB%E6%8B%92%E7%9A%84%E7%BB%8F%E5%8E%86-%E5%85%B3%E4%BA%8EiCloud%E5%88%B0%E5%BA%95%E5%BA%94%E8%AF%A5%E5%A4%87%E4%BB%BD%E4%BB%80%E4%B9%88%E6%95%B0%E6%8D%AE/"/>
    <id>http://tutuge.me/2015/02/28/ä¸€æ¬¡å®¡æ ¸è¢«æ‹’çš„ç»å†-å…³äºiCloudåˆ°åº•åº”è¯¥å¤‡ä»½ä»€ä¹ˆæ•°æ®/</id>
    <published>2015-02-28T10:18:11.000Z</published>
    <updated>2016-03-20T09:04:01.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é¡¹ç›®æœ€è¿‘ä¸€æ¬¡å®¡æ ¸è¢«æ‹’äº†=ã€‚=<br>ä»”ç»†çœ‹äº†ä¸€ä¸‹åï¼Œå‘ç°æ˜¯æ²¡æœ‰éµå®ˆâ€œ<strong>iOS Data Storage Guidelines</strong>â€ã€‚<br>åœ¨æ­¤æ€»ç»“ä¸€ä¸‹ã€‚</p>
<h2 id="è¢«æ‹’åŸå› "><a href="#è¢«æ‹’åŸå› " class="headerlink" title="è¢«æ‹’åŸå› "></a>è¢«æ‹’åŸå› </h2><p>å…ˆçœ‹çœ‹è¢«æ‹’çš„åé¦ˆä¿¡æ¯ï¼š</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Apps must follow the iOS <span class="built_in">Data</span> Storage Guidelines <span class="literal">or</span> they will be rejected</div><div class="line"></div><div class="line"><span class="keyword">On</span> launch <span class="literal">and</span> content download, your app stores <span class="number">12.14</span> MB, which does <span class="literal">not</span> comply <span class="keyword">with</span> the iOS <span class="built_in">Data</span> Storage Guidelines.</div></pre></td></tr></table></figure>
<p>å¤§è‡´æ„æ€å°±æ˜¯Appä¸‹è½½ä¸œè¥¿ä»¥åï¼Œåœ¨iCloudé‡Œé¢æŸ¥çœ‹æ­¤Appéœ€è¦å¤‡ä»½çš„ä½“ç§¯å˜å¤§äº†ã€‚</p>
<a id="more"></a>
<p>å†æ ¹æ® <a href="https://developer.apple.com/icloud/documentation/data-storage/index.html" target="_blank" rel="external"><strong>iOS Data Storage Guidelines</strong></a>çš„è¯´æ˜ï¼Œå¾—å‡ºå‡ ç‚¹é‡è¦ä¿¡æ¯ï¼š</p>
<ul>
<li>åªæœ‰<strong>ç”¨æˆ·åˆ›å»ºçš„ï¼Œå¹¶ä¸”ä¸èƒ½è¢«Appé‡ç°çš„æ–‡æ¡£ã€æ•°æ®</strong>ï¼Œæ‰åº”è¯¥è¢«ä¿å­˜åœ¨â€œ<strong><application_home>/Documents</application_home></strong>â€è·¯å¾„ä¸‹ã€‚</li>
<li>å¯ä»¥é‡æ–°äº§ç”Ÿã€ä¸‹è½½çš„æ•°æ®å¯ä»¥æ”¾åœ¨â€œ<strong><application_home>/Library/Caches</application_home></strong>â€ç›®å½•ä¸‹ï¼Œå¦‚ç”¨äºç¼“å­˜çš„æ•°æ®åº“æ–‡ä»¶ã€‚</li>
<li>çº¯ç²¹ç”¨äºç¼“å­˜çš„æ•°æ®å¯ä»¥æ”¾åœ¨â€œ<strong><application_home>/tmp</application_home></strong>â€ç›®å½•ä¸‹ã€‚</li>
<li>å¯ä»¥é€šè¿‡å¯¹NSURLåŠ å‚æ•°ï¼Œæ¥ä¿è¯ç‰¹å®šçš„æ–‡ä»¶å¤¹åŠå…¶å†…å®¹ä¸è¢«iCloudå¤‡ä»½ï¼Œä¹Ÿä¸ä¼šè¢«æ¸…é™¤ï¼Œå¦‚Documentæ–‡ä»¶å¤¹ã€‚</li>
</ul>
<p>æ‰€ä»¥å¯ä»¥åˆæ­¥å¾—å‡ºè¢«æ‹’çš„åŸå› æ˜¯å› ä¸ºAppä¸­ä¸‹è½½çš„æ–‡ä»¶ä¹Ÿè¢«åŒ…å«åœ¨iCloudå¤‡ä»½å½“ä¸­äº†ï¼Œè€ŒAppleå®¡æ ¸äººå‘˜è§‰å¾—è¿™äº›æ–‡ä»¶ä¸åº”è¯¥è¢«å¤‡ä»½ã€‚</p>
<h3 id="çœŸæ­£åº”è¯¥å¤‡ä»½çš„æ•°æ®"><a href="#çœŸæ­£åº”è¯¥å¤‡ä»½çš„æ•°æ®" class="headerlink" title="çœŸæ­£åº”è¯¥å¤‡ä»½çš„æ•°æ®"></a>çœŸæ­£åº”è¯¥å¤‡ä»½çš„æ•°æ®</h3><p>æ‰€ä»¥ï¼ŒçœŸæ­£éœ€è¦å¤‡ä»½çš„æ–‡ä»¶æ˜¯<strong>ç”¨æˆ·åˆ›å»ºçš„ï¼Œä¸èƒ½é€šè¿‡ç¨‹åºé‡æ–°äº§ç”Ÿçš„</strong>ï¼Œå¦‚è®°äº‹æœ¬åº”ç”¨ä¸­ç”¨æˆ·åˆ›å»ºçš„æ–‡æœ¬æ•°æ®ï¼Œç»˜ç”»åº”ç”¨ä¸­ç”¨æˆ·ç”»çš„ç”»ç­‰ã€‚</p>
<h2 id="è§£å†³å½“ä¸­é‡åˆ°çš„å‘"><a href="#è§£å†³å½“ä¸­é‡åˆ°çš„å‘" class="headerlink" title="è§£å†³å½“ä¸­é‡åˆ°çš„å‘"></a>è§£å†³å½“ä¸­é‡åˆ°çš„å‘</h2><p>æ—¢ç„¶çŸ¥é“äº†åŸå› ï¼Œé‚£å°±å¥½åŠäº†ã€‚</p>
<p>æ ¹æ®<strong>iOS Data Storage Guidelines</strong>çš„ç®€çŸ­è¯´æ˜ï¼Œä¹ä¸€çœ‹ï¼Œ<strong><application_home>/Library/Caches</application_home></strong>æ˜¯å­˜æ”¾å¯ä»¥é‡æ–°äº§ç”Ÿã€ä¸‹è½½çš„æ•°æ®ã€‚</p>
<p>ä½†æ˜¯æœ‰ä¸ªâ€œé™·é˜±â€åœ¨è¿™ã€‚</p>
<h3 id="ç³»ç»Ÿå¯èƒ½æ¸…ç©ºçš„ç›®å½•"><a href="#ç³»ç»Ÿå¯èƒ½æ¸…ç©ºçš„ç›®å½•" class="headerlink" title="ç³»ç»Ÿå¯èƒ½æ¸…ç©ºçš„ç›®å½•"></a>ç³»ç»Ÿå¯èƒ½æ¸…ç©ºçš„ç›®å½•</h3><p>æ ¹æ®å®˜æ–¹æ–‡æ¡£â€œ<a href="https://developer.apple.com/library/mac/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html#//apple_ref/doc/uid/TP40010672-CH2-SW1" target="_blank" rel="external"><strong>File System Programming Guide</strong></a>â€å¯ä»¥æ•´ç†å‡ºä¸€ä¸‹ä¸¤ä¸ªç³»ç»Ÿå¯èƒ½ä¼šæ¸…é™¤çš„ç›®å½•ï¼šï¼ˆåœ¨å‚¨å­˜ç©ºé—´ä¸å¤Ÿæ—¶ï¼‰</p>
<ol>
<li>Library/Caches/</li>
<li>tmp/</li>
</ol>
<p>æ‰€ä»¥ï¼ŒåƒAppä¸‹è½½çš„æ­Œæ›²ç­‰èµ„æºæ–‡ä»¶æ˜¯ä¸èƒ½æ”¾åœ¨ä¸Šé¢ä¸¤ä¸ªç›®å½•ä¸­çš„ã€‚</p>
<h2 id="è§£å†³ï¼š"><a href="#è§£å†³ï¼š" class="headerlink" title="è§£å†³ï¼š"></a>è§£å†³ï¼š</h2><p>æ‰€ä»¥ï¼Œä¸ºäº†ä¿é™©èµ·è§ï¼Œæœ€é è°±çš„è¿˜æ˜¯æ”¾åœ¨<strong><application_home>/Documents</application_home></strong>ä¸­ï¼Œå¹¶ä¸”é€šè¿‡è®¾ç½®ï¼Œä¸è®©iCloudå¤‡ä»½ã€‚</p>
<p>Appleå·²ç»æä¾›äº†ç›¸åº”çš„å‡½æ•°ï¼Œå¦‚ä¸‹ï¼ˆiOS 5.1åŠä»¥åçš„ç‰ˆæœ¬ï¼‰ï¼š</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (BOOL)addSkipBackupAttributeToItemAtURL:(NSURL *)URL &#123;</div><div class="line">    <span class="built_in">assert</span>(<span class="string">[[NSFileManager defaultManager] fileExistsAtPath: [URL path]]</span>);</div><div class="line"></div><div class="line">    NSError *<span class="built_in">error</span> = <span class="keyword">nil</span>;</div><div class="line">    BOOL success = [URL setResourceValue: [NSNumber numberWithBool: YES]</div><div class="line">                                  forKey: NSURLIsExcludedFromBackupKey <span class="built_in">error</span>: &amp;<span class="built_in">error</span>];</div><div class="line">    <span class="keyword">if</span>(!success)&#123;</div><div class="line">        NSLog(@<span class="string">"Error excluding %@ from backup %@"</span>, [URL lastPathComponent], <span class="built_in">error</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> success;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h3><ul>
<li><strong><application_home>/Documents</application_home></strong>æ ¹ç›®å½•ä¹Ÿå¯ä»¥é€šè¿‡ä¸Šé¢çš„å‡½æ•°è®¾ç½®æˆä¸å¤‡ä»½ã€‚ï¼ˆå¦‚åº”ç”¨AVPlayerï¼‰</li>
<li>è®¾ç½®æ˜¯é€’å½’çš„ï¼Œæ‰€ä»¥å…¶æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶éƒ½ä¸ç”¨å†è®¾ç½®ä¸€æ¬¡ï¼Œéƒ½ä¼šè‡ªåŠ¨ä¸è¢«å¤‡ä»½ã€‚ï¼ˆæµ‹è¯•æœ‰æ•ˆï¼Œä½†æ˜¯ä¸ç¡®å®š=ã€‚=ï¼Œå‚è€ƒï¼š<a href="http://stackoverflow.com/questions/14376883/is-nsurlisexcludedfrombackupkey-recursive" target="_blank" rel="external">is-nsurlisexcludedfrombackupkey-recursive</a>ï¼‰</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¤šçœ‹å®˜æ–¹è¯´æ˜=ã€‚=</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://developer.apple.com/icloud/documentation/data-storage/index.html" target="_blank" rel="external">iOS Data Storage Guidelines</a></li>
<li><a href="https://developer.apple.com/library/ios/qa/qa1719/_index.html" target="_blank" rel="external">How do I prevent files from being backed up to iCloud and iTunes?</a></li>
<li><a href="https://developer.apple.com/library/mac/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/FileSystemOverview/FileSystemOverview.html#//apple_ref/doc/uid/TP40010672-CH2-SW4" target="_blank" rel="external">File System Programming Guide</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;é¡¹ç›®æœ€è¿‘ä¸€æ¬¡å®¡æ ¸è¢«æ‹’äº†=ã€‚=&lt;br&gt;ä»”ç»†çœ‹äº†ä¸€ä¸‹åï¼Œå‘ç°æ˜¯æ²¡æœ‰éµå®ˆâ€œ&lt;strong&gt;iOS Data Storage Guidelines&lt;/strong&gt;â€ã€‚&lt;br&gt;åœ¨æ­¤æ€»ç»“ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;è¢«æ‹’åŸå› &quot;&gt;&lt;a href=&quot;#è¢«æ‹’åŸå› &quot; class=&quot;headerlink&quot; title=&quot;è¢«æ‹’åŸå› &quot;&gt;&lt;/a&gt;è¢«æ‹’åŸå› &lt;/h2&gt;&lt;p&gt;å…ˆçœ‹çœ‹è¢«æ‹’çš„åé¦ˆä¿¡æ¯ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight lasso&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;Apps must follow the iOS &lt;span class=&quot;built_in&quot;&gt;Data&lt;/span&gt; Storage Guidelines &lt;span class=&quot;literal&quot;&gt;or&lt;/span&gt; they will be rejected&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;On&lt;/span&gt; launch &lt;span class=&quot;literal&quot;&gt;and&lt;/span&gt; content download, your app stores &lt;span class=&quot;number&quot;&gt;12.14&lt;/span&gt; MB, which does &lt;span class=&quot;literal&quot;&gt;not&lt;/span&gt; comply &lt;span class=&quot;keyword&quot;&gt;with&lt;/span&gt; the iOS &lt;span class=&quot;built_in&quot;&gt;Data&lt;/span&gt; Storage Guidelines.&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;å¤§è‡´æ„æ€å°±æ˜¯Appä¸‹è½½ä¸œè¥¿ä»¥åï¼Œåœ¨iCloudé‡Œé¢æŸ¥çœ‹æ­¤Appéœ€è¦å¤‡ä»½çš„ä½“ç§¯å˜å¤§äº†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="å®¡æ ¸" scheme="http://tutuge.me/tags/%E5%AE%A1%E6%A0%B8/"/>
    
  </entry>
  
  <entry>
    <title>Blockç±»å‹å˜é‡-ç¼“å­˜Httpè¯·æ±‚ä¸å›è°ƒ</title>
    <link href="http://tutuge.me/2015/02/19/Block%E7%B1%BB%E5%9E%8B%E5%8F%98%E9%87%8F-%E7%BC%93%E5%AD%98Http%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%9B%9E%E8%B0%83/"/>
    <id>http://tutuge.me/2015/02/19/Blockç±»å‹å˜é‡-ç¼“å­˜Httpè¯·æ±‚ä¸å›è°ƒ/</id>
    <published>2015-02-18T19:18:36.000Z</published>
    <updated>2016-03-20T09:02:18.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Objective-Cä¸­çš„Blockså®åœ¨æ˜¯å¤ªå¥½ç”¨äº†ï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†â€œä»£ç å—â€å°è£…èµ·æ¥ï¼Œå½“æˆå˜é‡ä½¿ç”¨ã€ä¼ é€’ï¼Œæ‰€ä»¥ï¼Œåœ¨Objective-Cä¸­ï¼ŒiOSä¸­ï¼Œè®¸å¤šçš„å›è°ƒæ˜¯ç”¨Blockæ¥å®Œæˆçš„ã€‚</p>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>æˆ‘è‡ªå·±åœ¨ä¹‹å‰çš„é¡¹ç›®ä¸­ï¼Œå°±é‡åˆ°è¿‡ä¸€ä¸ªé—®é¢˜ã€‚å› ä¸ºé¡¹ç›®çš„éœ€è¦ï¼Œæ‰‹æœºç«¯æ‰€æœ‰çš„è·ŸæœåŠ¡å™¨çš„é€šä¿¡éƒ½éœ€è¦â€œåŠ å¯†â€ï¼Œåœ¨ç»è¿‡ä¸€ç•ªè°ƒç ”åï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ç±»ä¼¼OAuthæœºåˆ¶ï¼ˆè‡³äºä»€ä¹ˆæ˜¯OAuthï¼Œå„ä½Googleä¸€ä¸‹å°±æ˜ç™½äº†ï¼Œå¤§éƒ¨åˆ†çš„å…¬å…±APIéƒ½ç”¨åˆ°äº†è¿™ç§æœºåˆ¶ï¼‰ã€‚</p>
<a id="more"></a>
<h3 id="ç¼“å­˜Httpè¯·æ±‚åçš„å›è°ƒä»£ç å—"><a href="#ç¼“å­˜Httpè¯·æ±‚åçš„å›è°ƒä»£ç å—" class="headerlink" title="ç¼“å­˜Httpè¯·æ±‚åçš„å›è°ƒä»£ç å—"></a>ç¼“å­˜Httpè¯·æ±‚åçš„å›è°ƒä»£ç å—</h3><p>æ—¢ç„¶æ˜¯OAuthæœºåˆ¶ï¼Œå°±æ˜¯è¯´æˆ‘ä»¬æ¯æ¬¡å‘æœåŠ¡å™¨å‘èµ·çš„è¯·æ±‚ï¼Œé™¤äº†è·Ÿä¸šåŠ¡ç›¸å…³çš„å‚æ•°ï¼Œè¿˜éœ€è¦å¸¦ä¸ŠAccessTokenã€UserTokenè¿™ç±»çš„æˆæƒå‚æ•°ï¼Œè€ŒAccessTokenåœ¨æœ¬æ¬¡è¯·æ±‚ä¸­æ˜¯å¦ä¼šè¿‡æœŸï¼Œåœ¨ç»“æœè¿”å›å‰æ˜¯ä¸çŸ¥é“çš„ï¼Œæ‰€ä»¥ï¼Œä¸ºäº†æ›´å¥½åœ°ç”¨æˆ·ä½“éªŒï¼Œä¸è‡³äºè®©ç”¨æˆ·åœ¨æŸä¸ªæ—¶åˆ»çš„æ“ä½œï¼Œå› ä¸ºæˆæƒè¿‡æœŸäº†è€Œâ€œæ²¡æœ‰å“åº”â€ï¼Œæˆ‘ä»¬çš„æ¯æ¬¡Httpè¯·æ±‚éƒ½å¿…é¡»ç¼“å­˜èµ·æ¥ã€‚</p>
<p>è¿™é‡Œçš„ç¼“å­˜å¯ä¸æ˜¯å•å•æŒ‡ç¼“å­˜è¯·æ±‚çš„å‚æ•°ã€URLï¼Œæ›´é‡è¦çš„æ˜¯ç¼“å­˜Httpè¯·æ±‚æˆåŠŸæˆ–è€…å¤±è´¥æ—¶çš„â€œ<strong>å›è°ƒä»£ç å—</strong>â€ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="AFNetworkingçš„Getæ–¹æ³•"><a href="#AFNetworkingçš„Getæ–¹æ³•" class="headerlink" title="AFNetworkingçš„Getæ–¹æ³•"></a>AFNetworkingçš„Getæ–¹æ³•</h3><p>åœ¨iOSçš„é¡¹ç›®ä¸­ï¼ŒAFNetworkingåº”è¯¥ç®—æ˜¯ä½¿ç”¨çš„æœ€å¤šçš„ç½‘ç»œåº“äº†ï¼Œå®ƒçš„Getè¯·æ±‚çš„æ–¹æ³•æ¥å£å¦‚ä¸‹ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">-</span> (AFHTTPRequestOperation *)<span class="selector-tag">GET</span><span class="selector-pseudo">:(NSString</span> *)<span class="selector-tag">URLString</span></div><div class="line">                     <span class="selector-tag">parameters</span><span class="selector-pseudo">:(id)parameters</span></div><div class="line">                        <span class="selector-tag">success</span><span class="selector-pseudo">:(void</span> (^)(AFHTTPRequestOperation *operation, id responseObject))<span class="selector-tag">success</span></div><div class="line">                        <span class="selector-tag">failure</span><span class="selector-pseudo">:(void</span> (^)(AFHTTPRequestOperation *operation, NSError *error))<span class="selector-tag">failure</span></div></pre></td></tr></table></figure>
<p>åªæœ‰å››ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯Urlã€å‚æ•°ã€æˆåŠŸçš„å›è°ƒBlockï¼Œå¤±è´¥çš„å›è°ƒBlockï¼Œçœ‹ï¼Œè¿™é‡Œï¼Œå›è°ƒçš„ä»£ç å—å°±è¢«å°è£…åˆ°äº†Blocké‡Œé¢ï¼Œå¹¶å½“æˆå‚æ•°ä¼ å…¥ã€‚</p>
<h3 id="å†æ¬¡å°è£…"><a href="#å†æ¬¡å°è£…" class="headerlink" title="å†æ¬¡å°è£…"></a>å†æ¬¡å°è£…</h3><p>ä»‹äºAFNetworkingåªæä¾›äº†æœ€åŸºæœ¬çš„Getã€Postã€Putè¿™äº›æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å¾€å¾€æ ¹æ®ä¸šåŠ¡çš„æ¥å£åšäº†å°è£…ï¼Œå¦‚å…ˆå®šä¹‰äº†è¯·æ±‚çš„ç±»å‹æšä¸¾ï¼š</p>
<figure class="highlight elm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">typedef <span class="type">NS_ENUM</span>(<span class="type">NSUInteger</span>, <span class="type">HTTP_REQUEST_TYPE</span>) &#123;</div><div class="line">	<span class="type">ICG_GET</span>,</div><div class="line">	<span class="type">ICG_POST</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ç„¶åå®šä¹‰äº†ç»Ÿä¸€çš„è¯·æ±‚å…¥å£ä¸å›è°ƒå‚æ•°Blockï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è¯·æ±‚æˆåŠŸåçš„å›è°ƒ</span></div><div class="line">typedef <span class="keyword">void</span> (^http_success)(id result);</div><div class="line"><span class="comment">//è¯·æ±‚å¤±è´¥åçš„å›è°ƒ</span></div><div class="line">typedef <span class="keyword">void</span> (^http_fail)();</div><div class="line"></div><div class="line"><span class="comment">//ç»Ÿä¸€çš„è¯·æ±‚å…¥å£</span></div><div class="line">+ (<span class="keyword">void</span>)<span class="string">executeWithType:</span>(HTTP_REQUEST_TYPE)type <span class="string">api:</span>(NSString *)api</div><div class="line"><span class="symbol">             parameters:</span>(NSDictionary *)parameters <span class="string">success:</span>(http_success)success <span class="string">fail:</span>(http_fail)fail &#123;</div><div class="line">    <span class="comment">//ä¸ºæ¯ä¸ªè¯·æ±‚å¢åŠ AccessTokenã€UserTokenç­‰å…¬å…±å‚æ•°</span></div><div class="line">    <span class="comment">//...</span></div><div class="line">    <span class="comment">//ç¼“å­˜Httpè¯·æ±‚</span></div><div class="line">    <span class="comment">//...</span></div><div class="line"></div><div class="line">    <span class="comment">//æ ¹æ®typeåŒºåˆ†å…·ä½“æ˜¯å“ªä¸€ç§Httpè¯·æ±‚ã€‚</span></div><div class="line">    <span class="keyword">switch</span> (type) &#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">ICG_GET:</span></div><div class="line">            [HttpUtil <span class="string">get:</span>url <span class="string">parameters:</span>paras <span class="string">success:</span>success <span class="string">fail:</span>fail];</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="string">ICG_POST:</span></div><div class="line">            [HttpUtil <span class="string">post:</span>url <span class="string">parameters:</span>paras <span class="string">success:</span>success <span class="string">fail:</span>fail];</div><div class="line">            <span class="keyword">break</span>;</div><div class="line"><span class="symbol">        default:</span></div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å†æ¬¡å°è£…çš„å¥½å¤„"><a href="#å†æ¬¡å°è£…çš„å¥½å¤„" class="headerlink" title="å†æ¬¡å°è£…çš„å¥½å¤„"></a>å†æ¬¡å°è£…çš„å¥½å¤„</h3><p>ä¸ºä»€ä¹ˆè¦å†æ¬¡åšå°è£…ï¼Œå°†åŸºæœ¬çš„Httpè¯·æ±‚ç»Ÿä¸€å…¥å£ï¼Ÿé“ç†å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸ºäº†èƒ½æ–¹ä¾¿çš„å¯¹æ¯æ¬¡è¯·æ±‚å¢åŠ é¢å¤–çš„å¤„ç†ï¼Œå¹¶ä¸”å¯¹ä¸Šå±‚è°ƒç”¨é€æ˜ã€‚å¦‚:</p>
<ul>
<li>ç»Ÿä¸€ä¸ºæ¯ä¸ªè¯·æ±‚å¢åŠ Logã€‚</li>
<li>ç»Ÿä¸€ä¸ºæ¯ä¸ªè¯·æ±‚å¢åŠ å¦‚AccessTokenè¿™äº›é¢å¤–çš„å‚æ•°ã€‚</li>
<li>æ–¹ä¾¿å¯¹Httpè¯·æ±‚åšç¼“å­˜ï¼</li>
</ul>
<h3 id="ç¼“å­˜Httpè¯·æ±‚çš„æ•°æ®ç»“æ„"><a href="#ç¼“å­˜Httpè¯·æ±‚çš„æ•°æ®ç»“æ„" class="headerlink" title="ç¼“å­˜Httpè¯·æ±‚çš„æ•°æ®ç»“æ„"></a>ç¼“å­˜Httpè¯·æ±‚çš„æ•°æ®ç»“æ„</h3><p>æ—¢ç„¶æˆ‘ä»¬å·²ç»æœ‰äº†ç»Ÿä¸€çš„è¯·æ±‚å…¥å£ï¼Œä¸ºäº†ç¼“å­˜ï¼Œæ‰€éœ€è¦åšçš„å°±æ˜¯å°†èƒ½ä»£è¡¨ä¸€æ¬¡è¯·æ±‚çš„æ‰€æœ‰å‚æ•°ç¼“å­˜èµ·æ¥å°±è¡Œäº†ï¼Œå¦‚URLã€è¯·æ±‚å‚æ•°ç­‰ï¼Œå¦‚ä¸‹æ•°æ®ç»“æ„ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@interface</span> <span class="attribute">RequestHolder </span>: NSObject</div><div class="line"><span class="comment">//URLåœ°å€</span></div><div class="line"><span class="variable">@property</span>(strong, nonatomic) NSString *url;</div><div class="line"><span class="comment">//è¯·æ±‚å‚æ•°</span></div><div class="line"><span class="variable">@property</span>(strong, nonatomic) NSMutableDictionary *paras;</div><div class="line"><span class="comment">//è¯·æ±‚ç±»å‹ï¼Œå¦‚Getã€Post</span></div><div class="line"><span class="variable">@property</span>(assign, nonatomic) HTTP_REQUEST_TYPE type;</div><div class="line"><span class="comment">//è¯·æ±‚æˆåŠŸå›è°ƒ</span></div><div class="line"><span class="variable">@property</span>(copy) http_success success;</div><div class="line"><span class="comment">//è¯·æ±‚å¤±è´¥å›è°ƒ</span></div><div class="line"><span class="variable">@property</span>(copy) http_fail fail;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>è¿™å‡ ä¸ªå‚æ•°ï¼Œå°±å¯ä»¥å®Œæ•´çš„â€œä»£è¡¨ã€é‡ç°â€ä¸€æ¬¡å…·ä½“çš„Httpè¯·æ±‚ã€‚</p>
<h3 id="å¦‚ä½•ç¼“å­˜"><a href="#å¦‚ä½•ç¼“å­˜" class="headerlink" title="å¦‚ä½•ç¼“å­˜"></a>å¦‚ä½•ç¼“å­˜</h3><p>åªè¦Appå¼€å¯ï¼ŒHttpè¯·æ±‚å°±ä¼šä¸åœåœ°äº§ç”Ÿï¼Œä¼šæœ‰æºæºä¸æ–­çš„è¯·æ±‚ï¼Œéš¾é“æˆ‘ä»¬æŠŠæ¯æ¬¡è¯·æ±‚éƒ½ç¼“å­˜èµ·æ¥ï¼Ÿ</p>
<p>å…¨éƒ¨éƒ½ç¼“å­˜è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªç¼“å­˜ç­–ç•¥ã€‚</p>
<p>ä¸€ä¸ªAppä¸­ï¼Œæ‰€æœ‰çš„Httpè¯·æ±‚çš„è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯Urlï¼Œä¸åŒ…æ‹¬å‚æ•°ï¼Œåº”è¯¥æ˜¯æ•°é‡å›ºå®šçš„ï¼Œå¦‚â€œ/user, /commentâ€ï¼Œå¹¶ä¸”ï¼Œä¸€ä¸ªè¯·æ±‚å¾€å¾€å¯¹åº”çš„æ“ä½œã€åŠŸèƒ½ä¹Ÿæ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥ï¼Œå®Œå…¨å¯ä»¥ä»¥è¯·æ±‚çš„<strong>Url</strong>ä¸º<strong>Key</strong>ï¼Œä»¥æœ¬æ¬¡è¯·æ±‚çš„â€œ<strong>RequestHolder</strong>â€ä¸º<strong>Value</strong>ï¼Œç”¨Objective-Cä¸­çš„NSDictionaryæ¥ç¼“å­˜Httpè¯·æ±‚ã€‚</p>
<p>æ‰€ä»¥ï¼Œç¼“å­˜è¯·æ±‚çš„æ–¹æ³•å¤§è‡´å¦‚ä¸‹ï¼š</p>
<figure class="highlight fsharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ç¼“å­˜Httpè¯·æ±‚</span></div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)cacheHttpRequest:(HTTP_REQUEST_TYPE)<span class="class"><span class="keyword">type</span> <span class="title">url</span>:</span>(NSString *)url</div><div class="line">            parameters:(NSMutableDictionary *)parameters success:(http_success)success fail:(http_fail)fail &#123;</div><div class="line">    <span class="comment">//åˆ›å»ºç¼“å­˜æ•°æ®ç»“æ„ï¼Œä¿å­˜æœ¬æ¬¡è¯·æ±‚çš„å‚æ•°ã€å›è°ƒ</span></div><div class="line">    ICGRequestHolder *requestHolder = [ICGRequestHolder <span class="keyword">new</span>];</div><div class="line">    requestHolder.url = url;</div><div class="line">    requestHolder.paras = parameters;</div><div class="line">    requestHolder.success = [success copy];</div><div class="line">    requestHolder.fail = [fail copy];</div><div class="line">    requestHolder.<span class="keyword">type</span> = <span class="class"><span class="keyword">type</span>;</span></div><div class="line"></div><div class="line">    <span class="comment">//ä¿å­˜æœ¬æ¬¡è¯·æ±‚</span></div><div class="line">    [_operationQueue addOperationWithBlock:^&#123;</div><div class="line">        _cachedRequests[url] = requestHolder;</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œå°±èƒ½å®Œæ•´çš„ç¼“å­˜Httpè¯·æ±‚äº†ã€‚</p>
<h3 id="ä»ç¼“å­˜ä¸­æ¢å¤Httpè¯·æ±‚"><a href="#ä»ç¼“å­˜ä¸­æ¢å¤Httpè¯·æ±‚" class="headerlink" title="ä»ç¼“å­˜ä¸­æ¢å¤Httpè¯·æ±‚"></a>ä»ç¼“å­˜ä¸­æ¢å¤Httpè¯·æ±‚</h3><p>æ¢å¤è¯·æ±‚å¾ˆç®€å•ï¼Œç›´æ¥éå†æ‰€æœ‰ç¼“å­˜çš„è¯·æ±‚ï¼Œå†æ¬¡å‘èµ·Httpè¯·æ±‚å³å¯ï¼Œå°±ä¸å†è´´ä»£ç äº†ã€‚</p>
<h3 id="åˆ é™¤æˆåŠŸçš„Httpè¯·æ±‚"><a href="#åˆ é™¤æˆåŠŸçš„Httpè¯·æ±‚" class="headerlink" title="åˆ é™¤æˆåŠŸçš„Httpè¯·æ±‚"></a>åˆ é™¤æˆåŠŸçš„Httpè¯·æ±‚</h3><p>ç¼“å­˜çš„ç›®çš„æ˜¯åœ¨è¯·æ±‚å¤±è´¥æ—¶ï¼Œå¦‚AccessTokenè¶…æ—¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é‡æ–°è·å–AccessTokenåé‡ç°ä¸Šæ¬¡å¤±è´¥çš„è¯·æ±‚ï¼Œæ‰€ä»¥ï¼Œä¸€æ—¦è¯·æ±‚æˆåŠŸæ—¶ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†æˆåŠŸçš„è¯·æ±‚åˆ é™¤ï¼Œå½“ç„¶ï¼Œä¹Ÿæ˜¯åˆ©ç”¨Urlï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)<span class="string">removeRequestForKey:</span>(NSString *)url &#123;</div><div class="line">    <span class="comment">//æ”¾å…¥é˜Ÿåˆ—æ‰§è¡Œ</span></div><div class="line">    [_operationQueue <span class="string">addOperationWithBlock:</span>^&#123;</div><div class="line">        <span class="comment">//åˆ é™¤Urlå¯¹åº”çš„è¯·æ±‚</span></div><div class="line">        [_cachedRequests <span class="string">removeObjectForKey:</span>url];</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡åªæ˜¯ç®€å•åœ°åˆ©ç”¨Objective-Cä¸­çš„Blockç‰¹æ€§ï¼Œå®ç°äº†Httpè¯·æ±‚çš„ç¼“å­˜ã€‚ç›®çš„ä¸æ˜¯ä»‹ç»Blockï¼Œæ˜¯ä¸ºäº†åˆ†äº«æˆ‘è‡ªå·±åœ¨é¡¹ç›®ä¸­è¿ç”¨Blockçš„ä¾‹å­ï¼Œå¦‚æœè¯»è€…æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œæ¬¢è¿ç•™è¨€å•Š~~</p>
<h2 id="å‚è€ƒã€æ¨èé˜…è¯»"><a href="#å‚è€ƒã€æ¨èé˜…è¯»" class="headerlink" title="å‚è€ƒã€æ¨èé˜…è¯»"></a>å‚è€ƒã€æ¨èé˜…è¯»</h2><ul>
<li><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/WorkingwithBlocks/WorkingwithBlocks.html" target="_blank" rel="external">Working with Blocks</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;Objective-Cä¸­çš„Blockså®åœ¨æ˜¯å¤ªå¥½ç”¨äº†ï¼Œæœ‰äº†å®ƒï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†â€œä»£ç å—â€å°è£…èµ·æ¥ï¼Œå½“æˆå˜é‡ä½¿ç”¨ã€ä¼ é€’ï¼Œæ‰€ä»¥ï¼Œåœ¨Objective-Cä¸­ï¼ŒiOSä¸­ï¼Œè®¸å¤šçš„å›è°ƒæ˜¯ç”¨Blockæ¥å®Œæˆçš„ã€‚&lt;/p&gt;
&lt;h2 id=&quot;é—®é¢˜&quot;&gt;&lt;a href=&quot;#é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜&quot;&gt;&lt;/a&gt;é—®é¢˜&lt;/h2&gt;&lt;p&gt;æˆ‘è‡ªå·±åœ¨ä¹‹å‰çš„é¡¹ç›®ä¸­ï¼Œå°±é‡åˆ°è¿‡ä¸€ä¸ªé—®é¢˜ã€‚å› ä¸ºé¡¹ç›®çš„éœ€è¦ï¼Œæ‰‹æœºç«¯æ‰€æœ‰çš„è·ŸæœåŠ¡å™¨çš„é€šä¿¡éƒ½éœ€è¦â€œåŠ å¯†â€ï¼Œåœ¨ç»è¿‡ä¸€ç•ªè°ƒç ”åï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ç±»ä¼¼OAuthæœºåˆ¶ï¼ˆè‡³äºä»€ä¹ˆæ˜¯OAuthï¼Œå„ä½Googleä¸€ä¸‹å°±æ˜ç™½äº†ï¼Œå¤§éƒ¨åˆ†çš„å…¬å…±APIéƒ½ç”¨åˆ°äº†è¿™ç§æœºåˆ¶ï¼‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>æå‡UITableViewæ€§èƒ½-å¤æ‚é¡µé¢çš„ä¼˜åŒ–</title>
    <link href="http://tutuge.me/2015/02/19/%E6%8F%90%E5%8D%87UITableView%E6%80%A7%E8%83%BD-%E5%A4%8D%E6%9D%82%E9%A1%B5%E9%9D%A2%E7%9A%84%E4%BC%98%E5%8C%96/"/>
    <id>http://tutuge.me/2015/02/19/æå‡UITableViewæ€§èƒ½-å¤æ‚é¡µé¢çš„ä¼˜åŒ–/</id>
    <published>2015-02-18T17:28:41.000Z</published>
    <updated>2016-03-20T09:04:07.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>éšç€Appçš„ç”¨æˆ·ç•Œé¢çš„å†…å®¹è¶Šæ¥è¶Šä¸°å¯Œï¼Œå†å¼ºçš„æ‰‹æœºå¯èƒ½éƒ½æ— æ³•åŒæ—¶æ¸²æŸ“å¤æ‚çš„UIç•Œé¢å’Œä¿è¯æµç•…çš„ä½“éªŒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™äº›ç¨‹åºçŒ¿=ã€‚=åœ¨å†™ä»£ç çš„æ—¶å€™å°±è¦æ³¨æ„ï¼Œå¦‚ä½•å°½å¯èƒ½æé«˜ç”¨æˆ·çš„æ“ä½œæµç•…æ€§ã€‚</p>
<p>ä¹‹å‰çš„åšçš„é¡¹ç›®ï¼Œ<a href="https://itunes.apple.com/us/app/qing-ju-yin-le-quan-guo-zui/id913235479?l=zh&amp;ls=1&amp;mt=8" target="_blank" rel="external">é’æ¡”éŸ³ä¹iOSå®¢æˆ·ç«¯</a>é‡Œé¢çš„é¦–é¡µå°±æ˜¯ä¸€ä¸ªç±»ä¼¼å¾®ä¿¡æœ‹å‹åœˆçš„â€œåŠ¨æ€â€é¡µé¢ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_ios_speed_up_uitableview_1_1.png?imageView2/0/h/300" alt="é’æ¡”åŠ¨æ€é¡µé¢"></p>
<p>å¦‚æœæ˜¯ä½ ï¼Œä½ ä¼šæ€ä¹ˆå®ç°è¿™ä¸ªé¡µé¢å‘¢ï¼Ÿ</p>
<p>è¿™è¿˜ç”¨é—®ï¼Œå½“ç„¶æ˜¯ç”¨UITableView+è‡ªå®šä¹‰çš„UITableViewCellã€‚</p>
<p>UITableViewæ˜¯å¯ä»¥æ»‘åŠ¨çš„ï¼Œä¸ºäº†ä¸è®©ç”¨æˆ·åœ¨æ»‘åŠ¨ä¸­æ„Ÿåˆ°æœ‰å¡é¡¿ï¼Œè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿä¸‹é¢ï¼Œæˆ‘å°±å†™ä¸€ä¸‹æˆ‘è‡ªå·±åœ¨åšé¡¹ç›®æ—¶çš„â€œç»éªŒâ€~</p>
<a id="more"></a>
<h2 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h2><p>ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>åªå®šä¹‰ä¸€ç§Cellã€‚</li>
<li>æå‰è®¡ç®—å¹¶ç¼“å­˜æ¯ä¸ªCellçš„é«˜åº¦ã€‚</li>
<li>æå‰åˆ›å»ºçœŸæ­£æ˜¾ç¤ºçš„ã€éœ€è¦åŠ å·¥çš„æ•°æ®å¹¶ç¼“å­˜ã€‚</li>
<li>ç¼“å­˜Viewï¼</li>
<li>å…¶å®ƒã€‚</li>
</ul>
<h3 id="åªå®šä¹‰ä¸€ç§Cell"><a href="#åªå®šä¹‰ä¸€ç§Cell" class="headerlink" title="åªå®šä¹‰ä¸€ç§Cell"></a>åªå®šä¹‰ä¸€ç§Cell</h3><p>ä¹ä¸€çœ‹ï¼Œè¿™ä¸ªç•Œé¢è‡³å°‘æœ‰3ç§æ ·å¼çš„Cellï¼Œä¸ºä»€ä¹ˆåªå®šä¹‰ä¸€ç§å‘¢ï¼Ÿ</p>
<h4 id="åˆ†æç»“æ„"><a href="#åˆ†æç»“æ„" class="headerlink" title="åˆ†æç»“æ„"></a>åˆ†æç»“æ„</h4><p>ä»”ç»†åˆ†æä¸€ä¸‹ï¼Œé¡µé¢ä¸­æ¯ä¸ªCellçš„å†…å®¹éƒ½æœ‰å¤´åƒã€æ ‡é¢˜ã€æ­£æ–‡ã€è¯„è®ºã€å…¶å®ƒï¼ˆæ­Œæ›²ã€å›¾ç‰‡ã€æ­Œæ‰‹ï¼‰ã€‚æ‰€ä»¥ï¼Œä»æ•´ä½“ä¸Šçœ‹ï¼Œæ¯ä¸ªCellçš„ç»“æ„æ˜¯ä¸€è‡´çš„ï¼</p>
<h4 id="é‡ç”¨-å¤§è‡´å›ºå®šæ•°é‡çš„Cell"><a href="#é‡ç”¨-å¤§è‡´å›ºå®šæ•°é‡çš„Cell" class="headerlink" title="é‡ç”¨=å¤§è‡´å›ºå®šæ•°é‡çš„Cell"></a>é‡ç”¨=å¤§è‡´å›ºå®šæ•°é‡çš„Cell</h4><p>å¹¶ä¸”ï¼Œå‡¡æ˜¯è®¤çœŸç ”ç©¶è¿‡UITableViewçš„äººåº”è¯¥éƒ½çŸ¥é“ï¼ŒAppleå·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†Cellçš„é‡ç”¨ï¼Œå¦‚ç”¨â€œ<strong>registerNib:forCellReuseIdentifier</strong>â€æ–¹æ³•æ³¨å†Œè‡ªå®šä¹‰Cellçš„Nibï¼Œç„¶ååœ¨â€œ<strong>cellForRowAtIndexPath</strong>â€çš„æ—¶å€™ç”¨â€œ<strong>dequeueReusableCellWithIdentifier</strong>â€è·å–å¯ä»¥é‡ç”¨çš„Cellï¼Œæ‰€ä»¥ï¼Œæ— è®ºUITableViewè¦æ˜¾ç¤ºå†…å®¹æœ‰å¤šå°‘ï¼ŒçœŸæ­£åˆ›å»ºå‡ºçš„Cellå¯èƒ½åªæœ‰5ã€6ä¸ªã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥åªåˆ›å»ºä¸€ç§Cellï¼Œè™½ç„¶è¿™æ ·ä¸€ä¸ªCellçš„â€œä½“ç§¯â€å¯èƒ½ä¼šå¾ˆå¤§ï¼Œä½†æ˜¯ä»‹äºCellçš„æ•°é‡ä¸ä¼šå¾ˆå¤šï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥æ¥å—ã€‚</p>
<h5 id="åªå®šä¹‰ä¸€ç§Cellçš„å¥½å¤„"><a href="#åªå®šä¹‰ä¸€ç§Cellçš„å¥½å¤„" class="headerlink" title="åªå®šä¹‰ä¸€ç§Cellçš„å¥½å¤„"></a><strong>åªå®šä¹‰ä¸€ç§Cellçš„å¥½å¤„</strong></h5><ul>
<li>å‡å°‘ä»£ç é‡ï¼Œå‡å°‘Nibæ–‡ä»¶çš„æ•°é‡ï¼Œç»Ÿä¸€ä¸€ä¸ªNibæ–‡ä»¶å®šä¹‰Cellï¼Œå®¹æ˜“ä¿®æ”¹ã€ç»´æŠ¤ã€‚</li>
<li>åŸºäºCellçš„é‡ç”¨ï¼ŒçœŸæ­£è¿è¡Œæ—¶é“ºæ»¡å±å¹•æ‰€éœ€çš„Cellæ•°é‡å¤§è‡´æ˜¯å›ºå®šçš„ï¼Œè®¾ä¸º<strong>N</strong>ä¸ªã€‚æ‰€ä»¥å¦‚æœå¦‚æœåªæœ‰ä¸€ç§Cellï¼Œé‚£å°±æ˜¯åªæœ‰<strong>N</strong>ä¸ªCellçš„å®ä¾‹ï¼›ä½†æ˜¯å¦‚æœæœ‰<strong>M</strong>ç§Cellï¼Œé‚£ä¹ˆè¿è¡Œæ—¶æœ€å¤šå¯èƒ½ä¼šæ˜¯â€œ<strong>M x N = MN</strong>â€ä¸ªCellçš„å®ä¾‹ï¼Œè™½ç„¶å¯èƒ½å¹¶ä¸ä¼šå ç”¨å¤ªå¤šå†…å­˜ï¼Œä½†æ˜¯èƒ½å°‘ç‚¹ä¸æ˜¯æ›´å¥½å—ã€‚</li>
</ul>
<h4 id="å–„ç”¨hiddenéšè—ï¼ˆæ˜¾ç¤ºï¼‰Subview"><a href="#å–„ç”¨hiddenéšè—ï¼ˆæ˜¾ç¤ºï¼‰Subview" class="headerlink" title="å–„ç”¨hiddenéšè—ï¼ˆæ˜¾ç¤ºï¼‰Subview"></a>å–„ç”¨hiddenéšè—ï¼ˆæ˜¾ç¤ºï¼‰Subview</h4><p>æ—¢ç„¶åªå®šä¹‰ä¸€ç§Cellï¼Œé‚£è¯¥å¦‚ä½•æ˜¾ç¤ºä¸åŒç±»å‹çš„å†…å®¹å‘¢ï¼Ÿ<br>ç­”æ¡ˆå°±æ˜¯ï¼ŒæŠŠæ‰€æœ‰ä¸åŒç±»å‹çš„viewéƒ½å®šä¹‰å¥½ï¼Œæ”¾åœ¨cellé‡Œé¢ï¼Œé€šè¿‡hiddenæ˜¾ç¤ºã€éšè—ï¼Œæ¥æ˜¾ç¤ºä¸åŒç±»å‹çš„å†…å®¹ã€‚å¦‚ä¸‹å›¾å®šä¹‰Cellï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_ios_speed_up_uitableview_1_2.jpg?imageView2/0/h/400" alt="Cellç¤ºæ„å›¾"></p>
<p>å›¾ä¸­çš„Subview1ã€Subview2ã€Subview3å°±æ˜¯ä¸åŒç±»å‹Cellçš„ä¸åŒä¹‹å¤„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨â€œ<strong>cellForRowAtIndexPath</strong>â€å‡½æ•°ä¸­ï¼Œè®¾ç½®Cellçš„æ ·å¼ã€å†…å®¹æ—¶ï¼Œå°±å¯ä»¥é€šè¿‡æ˜¾ç¤ºã€éšè—è¿™ä¸‰ä¸ªå­viewæ¥æ˜¾ç¤ºã€‚</p>
<p>æ¯•ç«Ÿï¼Œåœ¨ç”¨æˆ·å¿«é€Ÿæ»‘åŠ¨ä¸­ï¼Œåªæ˜¯å•çº¯çš„æ˜¾ç¤ºã€éšè—subviewæ¯”å®æ—¶åˆ›å»ºè¦å¿«å¾—å¤šã€‚</p>
<h3 id="æå‰è®¡ç®—å¹¶ç¼“å­˜æ¯ä¸ªCellçš„é«˜åº¦"><a href="#æå‰è®¡ç®—å¹¶ç¼“å­˜æ¯ä¸ªCellçš„é«˜åº¦" class="headerlink" title="æå‰è®¡ç®—å¹¶ç¼“å­˜æ¯ä¸ªCellçš„é«˜åº¦"></a>æå‰è®¡ç®—å¹¶ç¼“å­˜æ¯ä¸ªCellçš„é«˜åº¦</h3><p>å¼€å‘è¿‡Androidï¼Œç”¨è¿‡Androidçš„ListViewä»¥åï¼Œå¯¹UITableViewéœ€è¦æå‰è®¡ç®—Cellçš„é«˜åº¦å¾ˆä¸é€‚åº”ã€‚=ã€‚=</p>
<p>é¦–å…ˆè¦ç¡®å®šçš„æ˜¯ï¼Œåœ¨iOSä¸­ï¼Œç³»ç»Ÿä¼šå…ˆè°ƒç”¨â€œ<strong>tableView:heightForRowAtIndexPath:</strong>â€è·å–æ¯ä¸ªCellå³å°†æ˜¾ç¤ºçš„é«˜åº¦ï¼Œä»è€Œç¡®å®šæ•´ä¸ªUITableViewçš„å¸ƒå±€ã€‚ç„¶åæ‰è°ƒç”¨â€œ<strong>tableView:cellForRowAtIndexPath</strong>â€è·å–æ¯ä¸ªCellï¼Œæˆ‘ä»¬ä¹Ÿæ˜¯åœ¨è¿™é‡Œå¡«å……ã€è®¾ç½®Cellçš„ã€‚</p>
<p><strong>æ‰€ä»¥ï¼Œæ—¢ç„¶é«˜åº¦æ€»ä¼šè¢«ç”¨åˆ°ï¼Œé‚£å°±æ—©æ—©çš„åœ¨è·å–æ•°æ®æ—¶å°±è®¡ç®—å¥½å§ï¼</strong></p>
<h4 id="åœ¨Modelï¼ˆEntityï¼‰ä¸­è®¡ç®—å¹¶ä¿å­˜Cellçš„é«˜åº¦"><a href="#åœ¨Modelï¼ˆEntityï¼‰ä¸­è®¡ç®—å¹¶ä¿å­˜Cellçš„é«˜åº¦" class="headerlink" title="åœ¨Modelï¼ˆEntityï¼‰ä¸­è®¡ç®—å¹¶ä¿å­˜Cellçš„é«˜åº¦"></a>åœ¨Modelï¼ˆEntityï¼‰ä¸­è®¡ç®—å¹¶ä¿å­˜Cellçš„é«˜åº¦</h4><p>å…¶å®ï¼Œåœ¨Modelï¼ˆEntityï¼‰ä¸­ä¿å­˜UIçš„å‚æ•°æ˜¯å¾ˆå¥‡æ€ªçš„=ã€‚=ï¼ˆæœ€å¥½æ”¾åœ¨ViewModelä¸­ï¼Œå°±æ˜¯MVVMæ¨¡å¼çš„ï¼‰ï¼Œæˆ‘ä»¬çš„Entityå¯èƒ½å°±æ˜¯ä¸‹é¢çš„æ ·å­ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="variable">@interface</span> <span class="attribute">DataEntity </span>: NSObject</div><div class="line"></div><div class="line"><span class="comment">//åŸå§‹æ•°æ®</span></div><div class="line"><span class="variable">@property</span>(copy, nonatomic) NSString *content;</div><div class="line"><span class="variable">@property</span>(copy, nonatomic) NSString *title;</div><div class="line"></div><div class="line"><span class="comment">//Cell é«˜åº¦</span></div><div class="line"><span class="variable">@property</span>(assign, nonatomic) CGFloat cellHeight;</div><div class="line"></div><div class="line"><span class="comment">//è®¡ç®—é«˜åº¦</span></div><div class="line"><span class="selector-tag">-</span> (void)<span class="selector-tag">calculateCellHeight</span>;</div><div class="line"></div><div class="line">@<span class="selector-tag">end</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œå°±ä¸ç”¨åœ¨â€œ<strong>tableView:heightForRowAtIndexPath:</strong>â€ä¸­æ¯æ¬¡éƒ½è®¡ç®—äº†ã€‚</p>
<h3 id="æå‰åˆ›å»ºçœŸæ­£æ˜¾ç¤ºçš„ã€éœ€è¦åŠ å·¥çš„æ•°æ®å¹¶ç¼“å­˜"><a href="#æå‰åˆ›å»ºçœŸæ­£æ˜¾ç¤ºçš„ã€éœ€è¦åŠ å·¥çš„æ•°æ®å¹¶ç¼“å­˜" class="headerlink" title="æå‰åˆ›å»ºçœŸæ­£æ˜¾ç¤ºçš„ã€éœ€è¦åŠ å·¥çš„æ•°æ®å¹¶ç¼“å­˜"></a>æå‰åˆ›å»ºçœŸæ­£æ˜¾ç¤ºçš„ã€éœ€è¦åŠ å·¥çš„æ•°æ®å¹¶ç¼“å­˜</h3><p>Cellä¸­æ˜¾ç¤ºçš„å†…å®¹ï¼Œå¾ˆå¤šæ—¶å€™å¯èƒ½å¹¶ä¸æ˜¯ç›´æ¥ä»æœåŠ¡å™¨æ‹¿åˆ°çš„æ•°æ®ï¼Œè€Œæ˜¯ç»è¿‡â€œåŠ å·¥â€çš„æ•°æ®ã€‚å¦‚æœ¬æ–‡ä¸­çš„â€œåŠ¨æ€â€ä¹Ÿï¼Œæ¯ä¸ªCellçš„æ ‡é¢˜ã€æ­£æ–‡éƒ½æœ‰å¯ç‚¹å‡»çš„è¿æ¥Linkã€è¡¨æƒ…å›¾ç‰‡ç­‰å¯Œæ–‡æœ¬å†…å®¹ï¼Œè€Œæˆ‘ä»¬ä¸€èˆ¬ç”¨NSAttributeStringç±»æ¥æ˜¾ç¤ºã€‚</p>
<p>æ—¢ç„¶æ¯æ¬¡éƒ½ä¼šç”¨åˆ°ï¼Œå€’ä¸å¦‚åœ¨è·å–åˆ°æ•°æ®çš„æ—¶å€™å°±åˆ›å»ºã€åŠ å·¥å¥½è¿™äº›å†…å®¹ï¼Œç­‰åˆ°éœ€è¦ç°å®çš„æ—¶å€™ï¼Œç›´æ¥æ‹¿æ¥ç”¨ä¸å°±è¡Œäº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„Entityç±»å¯èƒ½å˜æˆä¸‹é¢è¿™ä¸ªæ ·å­:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">DataEntity</span> : <span class="title">NSObject</span></span></div><div class="line"></div><div class="line"><span class="comment">//åŸå§‹æ•°æ®</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *content;</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *title;</div><div class="line"></div><div class="line"><span class="comment">//Cell é«˜åº¦</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> cellHeight;</div><div class="line"></div><div class="line"><span class="comment">//çœŸæ­£æ˜¾ç¤ºçš„å†…å®¹</span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSAttributedString</span> *showTitle;</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSAttributedString</span> *showContent;</div><div class="line"></div><div class="line"><span class="comment">//è®¡ç®—é«˜åº¦</span></div><div class="line">- (<span class="keyword">void</span>)calculateCellHeight;</div><div class="line"></div><div class="line"><span class="comment">//åˆ›å»ºã€åŠ å·¥çœŸæ­£æ˜¾ç¤ºçš„å†…å®¹</span></div><div class="line">- (<span class="keyword">void</span>)setupShowTitileAndContent;</div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·ï¼Œåœ¨â€œ<strong>tableView:cellForRowAtIndexPath</strong>â€ä¸­ï¼Œæˆ‘ä»¬ç›´æ¥æ‹¿showTitleã€showContentæ¥æ˜¾ç¤ºå°±å¥½ï¼Œä¸ç”¨å†åˆ›å»ºã€‚</p>
<h3 id="ç¼“å­˜View"><a href="#ç¼“å­˜View" class="headerlink" title="ç¼“å­˜View!"></a>ç¼“å­˜View!</h3><p>ä»€ä¹ˆï¼Ÿç¼“å­˜Viewï¼Ÿï¼</p>
<p>æ˜¯çš„ï¼Œå½“Cellä¸­çš„éƒ¨åˆ†Viewæ˜¯éå¸¸ç‹¬ç«‹çš„ï¼Œå¹¶ä¸”ä¸ä¾¿äºé‡ç”¨çš„ï¼Œè€Œä¸”â€œä½“ç§¯â€éå¸¸å°ï¼Œåœ¨å†…å­˜å¯æ§çš„å‰æä¸‹ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥å°†è¿™äº›viewç¼“å­˜èµ·æ¥ï¼</p>
<p>æ–¹æ³•å½“ç„¶ä¹Ÿæ˜¯å°†ç¼“å­˜çš„viewæ”¾åœ¨Entityä¸­~ã€‚</p>
<h3 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h3><p>å½“ç„¶ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¼˜åŒ–æ–¹æ³•ï¼Œç®€å•è¯´ä¸€è¯´ï¼š</p>
<ul>
<li>å°½é‡è®¾ç½®Cellçš„viewä¸ºopaqueï¼Œé¿å…GPUå¯¹Cellä¸‹é¢çš„å†…å®¹ä¹Ÿè¿›è¡Œç»˜åˆ¶ã€‚</li>
<li>é¿å…å¤§é‡çš„å›¾ç‰‡ç¼©æ”¾ã€é¢œè‰²æ¸å˜ç­‰ã€‚</li>
<li>é¿å…åŒæ­¥çš„ä»ç½‘ç»œã€æ–‡ä»¶è·å–æ•°æ®ï¼ˆè¿™ä¸ªæ˜¯å¿…é¡»çš„=ã€‚=ï¼‰</li>
<li>ç”¨shadowPathåˆ›å»ºé˜´å½±ã€‚</li>
<li>å°½é‡å‡å°‘subviewçš„æ•°é‡ï¼Œå¦‚å¤šç”¨drawRectç»˜åˆ¶å…ƒç´ ï¼Œæ›¿ä»£ç”¨viewæ˜¾ç¤ºã€‚</li>
<li>å°½é‡æ˜¾ç¤ºâ€œ<strong>å¤§å°åˆšå¥½åˆé€‚</strong>â€çš„å›¾ç‰‡èµ„æºã€‚</li>
</ul>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯ï¼š</p>
<p><strong>ç¼“å­˜ä¸€åˆ‡å¯ä»¥ç¼“å­˜çš„ï¼å°±æ˜¯â€œç”¨ç©ºé—´æ›¿æ¢æ—¶é—´â€ï¼</strong></p>
<p><strong>åœ¨UITableViewçš„Delegateã€DataSourceæ–¹æ³•ä¸­ï¼Œå‡å°‘ä»»ä½•ä¸å¿…è¦çš„æ“ä½œ</strong></p>
<h2 id="å‚è€ƒï¼Œæ¨èé˜…è¯»"><a href="#å‚è€ƒï¼Œæ¨èé˜…è¯»" class="headerlink" title="å‚è€ƒï¼Œæ¨èé˜…è¯»"></a>å‚è€ƒï¼Œæ¨èé˜…è¯»</h2><ul>
<li><a href="http://www.raywenderlich.com/31166/25-ios-app-performance-tips-tricks#tableviews" target="_blank" rel="external">25 iOS App Performance Tips &amp; Tricks</a></li>
<li><a href="http://stackoverflow.com/questions/1352479/tricks-for-improving-iphone-uitableview-scrolling-performance" target="_blank" rel="external">Tricks for improving iPhone UITableView scrolling performance?</a></li>
<li><a href="http://stackoverflow.com/questions/6172158/how-can-i-speed-up-a-uitableview" target="_blank" rel="external">How can I speed up a UITableView?</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;éšç€Appçš„ç”¨æˆ·ç•Œé¢çš„å†…å®¹è¶Šæ¥è¶Šä¸°å¯Œï¼Œå†å¼ºçš„æ‰‹æœºå¯èƒ½éƒ½æ— æ³•åŒæ—¶æ¸²æŸ“å¤æ‚çš„UIç•Œé¢å’Œä¿è¯æµç•…çš„ä½“éªŒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿™äº›ç¨‹åºçŒ¿=ã€‚=åœ¨å†™ä»£ç çš„æ—¶å€™å°±è¦æ³¨æ„ï¼Œå¦‚ä½•å°½å¯èƒ½æé«˜ç”¨æˆ·çš„æ“ä½œæµç•…æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å‰çš„åšçš„é¡¹ç›®ï¼Œ&lt;a href=&quot;https://itunes.apple.com/us/app/qing-ju-yin-le-quan-guo-zui/id913235479?l=zh&amp;amp;ls=1&amp;amp;mt=8&quot;&gt;é’æ¡”éŸ³ä¹iOSå®¢æˆ·ç«¯&lt;/a&gt;é‡Œé¢çš„é¦–é¡µå°±æ˜¯ä¸€ä¸ªç±»ä¼¼å¾®ä¿¡æœ‹å‹åœˆçš„â€œåŠ¨æ€â€é¡µé¢ï¼Œå¤§è‡´å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://zorrochen.qiniudn.com/blog_ios_speed_up_uitableview_1_1.png?imageView2/0/h/300&quot; alt=&quot;é’æ¡”åŠ¨æ€é¡µé¢&quot;&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ˜¯ä½ ï¼Œä½ ä¼šæ€ä¹ˆå®ç°è¿™ä¸ªé¡µé¢å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™è¿˜ç”¨é—®ï¼Œå½“ç„¶æ˜¯ç”¨UITableView+è‡ªå®šä¹‰çš„UITableViewCellã€‚&lt;/p&gt;
&lt;p&gt;UITableViewæ˜¯å¯ä»¥æ»‘åŠ¨çš„ï¼Œä¸ºäº†ä¸è®©ç”¨æˆ·åœ¨æ»‘åŠ¨ä¸­æ„Ÿåˆ°æœ‰å¡é¡¿ï¼Œè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿä¸‹é¢ï¼Œæˆ‘å°±å†™ä¸€ä¸‹æˆ‘è‡ªå·±åœ¨åšé¡¹ç›®æ—¶çš„â€œç»éªŒâ€~&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="æ€§èƒ½" scheme="http://tutuge.me/tags/%E6%80%A7%E8%83%BD/"/>
    
  </entry>
  
  <entry>
    <title>NSStringçš„Copyä¸å†…å­˜åˆ†é…</title>
    <link href="http://tutuge.me/2015/02/18/NSString%E7%9A%84Copy%E4%B8%8E%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/"/>
    <id>http://tutuge.me/2015/02/18/NSStringçš„Copyä¸å†…å­˜åˆ†é…/</id>
    <published>2015-02-18T09:00:47.000Z</published>
    <updated>2016-03-20T09:03:45.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸ç®¡æ˜¯ç”¨ä»€ä¹ˆè¯­è¨€å¼€å‘ï¼Œå­—ç¬¦ä¸²åº”è¯¥ç®—æ˜¯ç”¨çš„æœ€å¤šçš„äº†ã€‚åœ¨Objective-Cä¸­ï¼Œå­—ç¬¦ä¸²ç±»æ˜¯NSStringï¼Œä»¥åŠå…¶å­ç±»NSMutableStringç­‰ã€‚æ‰€ä»¥ï¼Œå¯¹äºå­—ç¬¦ä¸²ç±»ï¼Œç¼–ç¨‹è¯­è¨€ã€ç¼–è¯‘å™¨ç­‰å¾€å¾€ä¼šåšç‰¹æ®Šå¤„ç†ã€‚ä¸‹é¢æˆ‘å°±è¯´è¯´æˆ‘è‡ªå·±åœ¨é¡¹ç›®ä¸­å‘ç°çš„NSStringçš„â€œå¥‡æ€ªâ€çš„åœ°æ–¹ã€‚</p>
<a id="more"></a>
<h2 id="å­—ç¬¦ä¸²å¸¸é‡ï¼Œcopyï¼ŒmutableCopy"><a href="#å­—ç¬¦ä¸²å¸¸é‡ï¼Œcopyï¼ŒmutableCopy" class="headerlink" title="å­—ç¬¦ä¸²å¸¸é‡ï¼Œcopyï¼ŒmutableCopy"></a>å­—ç¬¦ä¸²å¸¸é‡ï¼Œcopyï¼ŒmutableCopy</h2><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>å…ˆçœ‹çœ‹å¦‚ä¸‹é¢çš„ä»£ç ï¼ŒçŒœçŒœä¼šè¾“å‡ºä»€ä¹ˆï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSString</span> *str1 = <span class="string">@"abc"</span>;</div><div class="line"><span class="built_in">NSString</span> *str2 = <span class="string">@"abc"</span>;</div><div class="line"><span class="built_in">NSString</span> *str3 = [[<span class="built_in">NSString</span> alloc] initWithString:<span class="string">@"abc"</span>];</div><div class="line"><span class="built_in">NSString</span> *str4 = [str1 <span class="keyword">copy</span>];</div><div class="line"><span class="built_in">NSString</span> *str5 = [str1 mutableCopy];</div><div class="line"></div><div class="line"><span class="comment">//è¾“å‡ºå†…å­˜ä¸­çš„åœ°å€</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"str1: %p"</span>, str1);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"str2: %p"</span>, str2);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"str3: %p"</span>, str3);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"str4: %p"</span>, str4);</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"str5: %p"</span>, str5);</div></pre></td></tr></table></figure>
<p>ç›´æ¥ç»™å‡ºç»“æœï¼š</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åœ°å€å€¼ç”±è¿è¡Œæ—¶å†³å®šï¼Œä¸å”¯ä¸€</span></div><div class="line"><span class="symbol">str1:</span> <span class="number">0x10cd12040</span></div><div class="line"><span class="symbol">str2:</span> <span class="number">0x10cd12040</span></div><div class="line"><span class="symbol">str3:</span> <span class="number">0x10cd12040</span></div><div class="line"><span class="symbol">str4:</span> <span class="number">0x10cd12040</span></div><div class="line"><span class="symbol">str5:</span> <span class="number">0x7f874b508350</span> <span class="comment">//mutable copy</span></div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œæ˜¯ä¸æ˜¯å¾ˆâ€œç¥å¥‡â€ã€‚</p>
<h3 id="ç®€å•è§£é‡Š"><a href="#ç®€å•è§£é‡Š" class="headerlink" title="ç®€å•è§£é‡Š"></a>ç®€å•è§£é‡Š</h3><p>NSStringæ˜¯â€œä¸å¯å˜ï¼ˆimmutableï¼‰â€çš„ç±»å‹ï¼Œè¿™ä¸ªæ˜¯å…³é”®ã€‚<br>ä»£ç ä¸­çš„â€œ@â€å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ï¼Œè¿è¡Œæ—¶ä¼šæ£€æµ‹è¿™ä¸ªå­—ç¬¦ä¸²æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå­˜åœ¨çš„è¯ï¼Œå°±ç›´æ¥å°†è¿™ä¸ªå­—ç¬¦ä¸²çš„åœ°å€èµ‹ç»™å˜é‡ï¼›ä¸å­˜åœ¨çš„è¯ï¼Œåˆ™åˆ›å»ºï¼Œå†èµ‹å€¼ã€‚</p>
<p><strong>ç¬¬ä¸€è¡Œ</strong>: â€œabcâ€å­—ç¬¦ä¸²ä¸å­˜åœ¨ï¼Œåˆ›å»ºï¼Œå–å¾—å­—ç¬¦ä¸²åœ°å€â€œ0x10cd12040â€ï¼Œèµ‹ç»™str1.</p>
<p><strong>ç¬¬äºŒè¡Œ</strong>: â€œabcâ€å­—ç¬¦ä¸²å·²ç»å­˜åœ¨ï¼Œç›´æ¥å°†åœ°å€â€œ0x10cd12040â€èµ‹ç»™str2.</p>
<p><strong>ç¬¬ä¸‰è¡Œ</strong>: ï¼ˆè®°ä½ï¼ŒNSStringæ˜¯ä¸å¯å˜çš„ï¼‰allocå¹¶ä¸ä¼šåˆ†é…æ–°çš„å†…å­˜ï¼Œç›´æ¥å°†å­—ç¬¦ä¸²åœ°å€â€œ0x10cd12040â€èµ‹ç»™str3.</p>
<p><strong>ç¬¬å››è¡Œ</strong>: copyï¼Œæ—¢ç„¶æ˜¯ä¸å¯å˜çš„ï¼Œä¹Ÿå°±æ²¡æœ‰å¿…è¦åˆ†é…æ–°å†…å­˜ï¼Œç›´æ¥å°†åœ°å€â€œ0x10cd12040â€èµ‹ç»™str4.</p>
<p><strong>ç¬¬äº”è¡Œ</strong>: mutableCopyå…¶å®å°±æ˜¯åˆ›å»ºä¸€ä¸ªNSMutableStringçš„å®ä¾‹ï¼Œæ—¢ç„¶æ˜¯â€œå¯å˜ï¼ˆmutableï¼‰â€çš„ç±»å‹äº†ï¼Œå½“ç„¶è¦åˆ†é…æ–°çš„å†…å­˜ï¼Œæ‰€ä»¥ï¼Œå­—ç¬¦ä¸²çš„åœ°å€ä¹Ÿå˜æˆæ–°çš„â€œ0x7f874b508350â€ã€‚</p>
<p>å¯ä»¥è¿™ä¹ˆè¯´ï¼Œç¼–è¯‘å™¨ã€runtimeå……åˆ†åˆ©ç”¨äº†NSStringæ˜¯â€œ<strong>ä¸å¯å˜ï¼ˆimmutableï¼‰</strong>â€ç±»å‹è¿™ä¸ªç‰¹ç‚¹ï¼Œåªè¦å­—ç¬¦ä¸²å†…å®¹ä¸€è‡´ï¼Œå°±ä¸ä¼šåˆ†é…æ–°çš„å†…å­˜å‚¨å­˜ï¼Œå­—ç¬¦ä¸²åœ¨ç¨‹åºä¸­ä½¿ç”¨é‡éå¸¸å¤§ï¼Œè¿™ä¹ˆåšæ— ç–‘å¯ä»¥å¤§å¤§èŠ‚çœå†…å­˜ï¼Œæå‡æ€§èƒ½ã€‚</p>
<h2 id="Property-å’Œ-NSString"><a href="#Property-å’Œ-NSString" class="headerlink" title="Property å’Œ NSString"></a>Property å’Œ NSString</h2><p>å…ˆæ¥çœ‹çœ‹ä¸€ä¸ªUserEntityç±»ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//UserEntity.h</span></div><div class="line"></div><div class="line"><span class="variable">@interface</span> <span class="attribute">UserEntity </span>: NSObject &lt;NSCopying&gt;</div><div class="line"><span class="variable">@property</span>(strong, nonatomic) NSString *name;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>åªæœ‰ä¸€ä¸ªåä¸ºnameçš„NSStringç±»å‹Propertyã€‚<br>ç›¸ä¿¡å¤§å®¶å¯¹è¿™ä¸ªä¸é™Œç”Ÿå§ã€‚ä¸€èˆ¬æˆ‘ä»¬çš„åº”ç”¨ä¸­ä¼šæœ‰å¾ˆå¤šEntityç±»å‹ï¼Œæ¯ä¸ªEntityç±»é‡Œé¢è‚¯å®šé¿å…ä¸äº†æœ‰è®¸å¤šNSStringçš„å­—ç¬¦ä¸²ç±»å‹ã€‚è¿™é‡Œçš„nameçš„å±æ€§æ˜¯ï¼šstrongå’Œnonatomicï¼Œstrongè¡¨æ˜nameè¦â€œæŒæœ‰â€ä¸€ä»½nameæ‰€æŒ‡çš„å­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œnonatomicè¡¨ç¤ºpropertyç±»å‹ä¸ç”¨åŠ é”ã€‚</p>
<p>æ¥ç€å’±ä»¬çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">UserEntity *userEntity = [UserEntity <span class="keyword">new</span>];</div><div class="line"></div><div class="line"><span class="comment">//åˆ›å»ºmutableç±»å‹çš„å­—ç¬¦ä¸²</span></div><div class="line">NSMutableString *showName = [[NSMutableString alloc] <span class="string">initWithString:</span>@<span class="string">"tutuge"</span>];</div><div class="line"></div><div class="line"><span class="comment">//å…ˆä¿å­˜â€œtutugeâ€å­—ç¬¦ä¸²åˆ°userEntityçš„name</span></div><div class="line">userEntity.name = showName;</div><div class="line"></div><div class="line"><span class="comment">//ä¿®æ”¹showName</span></div><div class="line">[showName <span class="string">appendString:</span>@<span class="string">" blog"</span>];</div><div class="line"></div><div class="line"><span class="comment">//è¾“å‡ºuserEntityçš„nameå±æ€§</span></div><div class="line">NSLog(@<span class="string">"Name: %@"</span>, userEntity.name);</div></pre></td></tr></table></figure>
<p>çŒœçŒœä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ</p>
<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">Name:</span> tutuge blog</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œæˆ‘ä»¬æ˜æ˜æ˜¯ä¿å­˜çš„â€œtutugeâ€ï¼Œæ€ä¹ˆåˆ°åé¢è¾“å‡ºçš„æ˜¯â€œtutuge blogâ€ï¼Ÿ</p>
<h3 id="è®©NSStringç±»å‹çš„Propertyä¸ºCopyå‹"><a href="#è®©NSStringç±»å‹çš„Propertyä¸ºCopyå‹" class="headerlink" title="è®©NSStringç±»å‹çš„Propertyä¸ºCopyå‹"></a>è®©NSStringç±»å‹çš„Propertyä¸ºCopyå‹</h3><p>å› ä¸ºnameçš„Propertyå±æ€§æ˜¯strongçš„ï¼Œæ‰€ä»¥èµ‹å€¼åï¼Œå®ƒè·ŸshowNameå‡æŒ‡å‘åŒä¸€ä¸ªNSMutableStringå®ä¾‹ï¼Œå¦‚ä¸‹ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_ios_nsstring_copy_1_1.jpg" alt="å†…å­˜ç¤ºæ„å›¾"></p>
<p>æ‰€ä»¥æ”¹å˜äº†showNameï¼Œå½“ç„¶nameè¾“å‡ºçš„å€¼ä¹Ÿå°±å˜äº†ã€‚<br>è¿™ä¸ªæ—¶å€™ï¼Œnameçš„propertyå±æ€§å°±ä¸èƒ½æ˜¯strongäº†ï¼Œåº”è¯¥æ˜¯copyï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//UserEntity.h</span></div><div class="line"></div><div class="line"><span class="variable">@interface</span> <span class="attribute">UserEntity </span>: NSObject &lt;NSCopying&gt;</div><div class="line"><span class="variable">@property</span>(copy, nonatomic) NSString *name;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·çš„è¯ï¼Œå½“â€œ<strong>userEntity.name = showName;</strong>â€è¿™å¥è¿è¡Œåï¼Œå†…å­˜å¸ƒå±€å¦‚ä¸‹ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_ios_nsstring_copy_1_2.jpg" alt="å†…å­˜ç¤ºæ„å›¾"></p>
<p>è¿™æ ·ï¼Œå°±é¿å…äº†è¿™ä¸ªé—®é¢˜ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¾ˆæ‰€æ—¶å€™ï¼Œä»£ç å¹¶ä¸æ˜¯çœ‹ä¸Šå»é‚£æ ·â€œè¿è¡Œâ€çš„ï¼Œå¤šè¯•è¯•ï¼Œå¤šæŸ¥é˜…èµ„æ–™ï¼Œå°±èƒ½äº†è§£å…¶ä¸­çš„å¥¥ç§˜äº†~</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ä¸ç®¡æ˜¯ç”¨ä»€ä¹ˆè¯­è¨€å¼€å‘ï¼Œå­—ç¬¦ä¸²åº”è¯¥ç®—æ˜¯ç”¨çš„æœ€å¤šçš„äº†ã€‚åœ¨Objective-Cä¸­ï¼Œå­—ç¬¦ä¸²ç±»æ˜¯NSStringï¼Œä»¥åŠå…¶å­ç±»NSMutableStringç­‰ã€‚æ‰€ä»¥ï¼Œå¯¹äºå­—ç¬¦ä¸²ç±»ï¼Œç¼–ç¨‹è¯­è¨€ã€ç¼–è¯‘å™¨ç­‰å¾€å¾€ä¼šåšç‰¹æ®Šå¤„ç†ã€‚ä¸‹é¢æˆ‘å°±è¯´è¯´æˆ‘è‡ªå·±åœ¨é¡¹ç›®ä¸­å‘ç°çš„NSStringçš„â€œå¥‡æ€ªâ€çš„åœ°æ–¹ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨NSProxyå®ç°æ¶ˆæ¯è½¬å‘-æ¨¡å—åŒ–çš„ç½‘ç»œæ¥å£å±‚è®¾è®¡-åŸåˆ›</title>
    <link href="http://tutuge.me/2015/02/16/%E5%88%A9%E7%94%A8NSProxy%E5%AE%9E%E7%8E%B0%E6%B6%88%E6%81%AF%E8%BD%AC%E5%8F%91-%E6%A8%A1%E5%9D%97%E5%8C%96%E7%9A%84%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3%E5%B1%82%E8%AE%BE%E8%AE%A1-%E5%8E%9F%E5%88%9B/"/>
    <id>http://tutuge.me/2015/02/16/åˆ©ç”¨NSProxyå®ç°æ¶ˆæ¯è½¬å‘-æ¨¡å—åŒ–çš„ç½‘ç»œæ¥å£å±‚è®¾è®¡-åŸåˆ›/</id>
    <published>2015-02-16T10:52:08.000Z</published>
    <updated>2016-03-20T09:04:05.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><ul>
<li>2015-12-21: å…¶å®ç”¨CategoryæŒ‰ç…§ä¸šåŠ¡æ‹†åˆ†ç½‘ç»œè¯·æ±‚æ¥å£çš„ä»£ç ä¹Ÿæ˜¯éå¸¸æ£’çš„ï¼Œç›®å‰æˆ‘è‡ªå·±å°±æ˜¯è¿™ä¹ˆåšçš„=ã€‚=ï¼Œæ–‡ç« å°±å½“åšç†Ÿæ‚‰ä¸‹NSProxyå§~</li>
</ul>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¹‹å‰åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œæ‰€æœ‰ä¸šåŠ¡çš„ç½‘ç»œæ¥å£æ–¹æ³•ï¼Œå…¨éƒ¨éƒ½å†™åœ¨äº†ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œä¸€å¼€å§‹è¿˜å¥½ï¼Œæ¯•ç«Ÿæ¯ä¸ªæ–¹æ³•çš„ä»£ç ä¹Ÿåªæ˜¯åå‡ è¡Œï¼Œå¢åŠ ã€ä¿®æ”¹ä¹Ÿæ¯”è¾ƒå®¹æ˜“ã€‚ä½†æ˜¯éšç€æ¥å£çš„å¢å¤šï¼Œè¿™ä¸ªæ–‡ä»¶æ…¢æ…¢å±…ç„¶è¶…è¿‡äº†1000è¡Œï¼Œé‡Œé¢å‡ åä¸ªæ–¹æ³•éƒ½å†™åœ¨ä¸€èµ·ï¼Œå®åœ¨æ˜¯ä¸å¥½ç»´æŠ¤ã€‚</p>
<p>è™½ç„¶ä¿æŒè¿™æ ·ä¹Ÿæ²¡æœ‰ä»€ä¹ˆï¼Œå¤šç”¨ç”¨Cmd+Få°±èƒ½æ‰¾åˆ°ã€‚ä½†æ˜¯ï¼ŒçœŸæ˜¯è¶Šçœ‹è¶Šä¸é¡ºçœ¼ğŸ˜³ï¼Œ ä»£ç ä¸€å®šè¦æœ‰â€œç¾æ„Ÿâ€å•Š~ğŸ˜</p>
<p>æ‰€ä»¥åœ¨æŸ¥é˜…äº†å¤§é‡æ–‡ç« åï¼Œç»ˆäºæƒ³å‡ºäº†æœ¬æ–‡å³å°†è¯´æ˜çš„åŠæ³•ï¼Œè¶Šå‘è§‰å¾—Objective-Cçš„â€œæ¶ˆæ¯â€æœºåˆ¶æ˜¯å¤šä¹ˆçš„èµ~ğŸ˜š</p>
<h2 id="Github-ç¤ºä¾‹"><a href="#Github-ç¤ºä¾‹" class="headerlink" title="Github ç¤ºä¾‹"></a>Github ç¤ºä¾‹</h2><p>è´´ä¸Šæœ¬æ–‡ä¸­çš„ç¤ºä¾‹å·¥ç¨‹ï¼š<a href="https://github.com/zekunyan/HttpProxyExample" target="_blank" rel="external">https://github.com/zekunyan/HttpProxyExample</a></p>
<a id="more"></a>
<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>å…ˆæŠ›å‡ºé—®é¢˜ã€‚</p>
<p>ä¸€æ¬¾äº’è”ç½‘åº”ç”¨ï¼Œå…ä¸äº†è¦è·ŸæœåŠ¡å™¨æ‰“äº¤é“ï¼Œåœ¨iOSé¡¹ç›®ä¸­ï¼Œæœ€æœ‰åçš„ç½‘ç»œåº“åº”è¯¥å°±æ˜¯<a href="https://github.com/AFNetworking/AFNetworking" target="_blank" rel="external">AFNetworking</a>äº†ã€‚æ‰€ä»¥ï¼Œå¾ˆå¤šäººå°±ä¼šåˆ©ç”¨AFnetworkingæä¾›çš„Getã€Postç­‰åŸºæœ¬Httpè¯·æ±‚æ¥å£ï¼Œå°è£…è‡ªå·±çš„ç½‘ç»œæ¥å£å±‚ä»£ç ï¼Œæˆ‘è‡ªå·±åœ¨é¡¹ç›®ä¸­ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ã€‚</p>
<p>ä½†æ˜¯ï¼ŒAFNetworkingåªæ˜¯æä¾›äº†Getã€Postã€Jsonä¼ è¾“ç­‰åŸºæœ¬çš„Httpè¯·æ±‚æ–¹æ³•ï¼Œæ‰€ä»¥ä¸€æ—¦è½å®åˆ°å…·ä½“çš„ä¸šåŠ¡ç›¸å…³çš„è¯·æ±‚ä¸Šï¼Œæˆ‘ä»¬è¦ä¸ºæ¯ä¸ªè¯·æ±‚ï¼ˆURLï¼‰éƒ½å†™ä¸€ä¸ªå•ç‹¬çš„æ¥å£æ–¹æ³•ã€‚</p>
<p><strong>é‚£ä¹ˆï¼Œé—®é¢˜å°±æ¥äº†</strong></p>
<p>ä¸šåŠ¡ç›¸å…³çš„æ¥å£é‚£ä¹ˆå¤šï¼Œä¸¾ä¸ªä¾‹å­ï¼Œä»€ä¹ˆâ€œé€šè¿‡ç”¨æˆ·IDè·å–ç”¨æˆ·åŸºæœ¬ä¿¡æ¯â€ã€â€œè·å–ç”¨æˆ·çš„æ‰€æœ‰è¯„è®ºâ€ç­‰ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¹ˆå¤šæ–¹æ³•è¯¥æ€ä¹ˆç»„ç»‡å‘¢ï¼Ÿå…¨éƒ¨æ”¾åœ¨ä¸€èµ·ï¼Ÿé‚£è¿™ä¸ªæ¥å£ç±»å²‚ä¸æ˜¯ä¼šéå¸¸ä¹±ï¼Ÿä¸æ”¾åœ¨ä¸€èµ·ï¼Ÿé‚£å²‚ä¸æ˜¯ä¼šæœ‰å¾ˆå¤šä¸ªç½‘ç»œè¯·æ±‚ç±»ï¼Ÿ(è‡³äºè¦ä¸è¦ç»Ÿä¸€æ¥å£å…¥å£ï¼Œæˆ‘æƒ³è¿™ä¸ªæ ¹æ®é¡¹ç›®æ¥å†³å®šå§=ã€‚=)</p>
<h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><ul>
<li>æ‰€æœ‰ç½‘ç»œæ¥å£éƒ½ä»ç»Ÿä¸€çš„ç±»è°ƒç”¨ï¼Œå¦‚HttpProxyã€‚</li>
<li>ç½‘ç»œæ¥å£çš„å…·ä½“å®ç°ï¼ŒæŒ‰ç…§ä¸šåŠ¡åˆ’åˆ†åˆ°ä¸åŒçš„ç±»ä¸­ï¼Œå¦‚â€œ<strong>UserHttpHandler</strong>â€ã€â€œ<strong>CommentHttpHandler</strong>â€ã€‚</li>
</ul>
<p>å…¶å®ï¼ŒæŒ‰ç…§é¢å‘å¯¹è±¡çš„åŸåˆ™ï¼Œå°±æ˜¯æ¥å£ä»£ç†ç±»<strong>HttpProxy</strong>æ‹¥æœ‰è‹¥å¹²ä¸ªæŒ‰ç…§ä¸šåŠ¡åˆ’åˆ†çš„æ¥å£ï¼ˆInterfaceï¼‰ï¼Œè¿™äº›æ¥å£çš„æ‰€æœ‰æ–¹æ³•ç»„æˆäº†ç½‘ç»œå±‚çš„ä¸åŒçš„Httpè¯·æ±‚ã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_ios_http_proxy_1_1.jpg" alt="è¯·æ±‚ç¤ºæ„å›¾"></p>
<p>é‚£ä¹ˆï¼Œè°ƒç”¨çš„æ—¶å€™ï¼Œæ‰€æœ‰æ¥å£éƒ½ç”¨HttpProxyè°ƒç”¨ï¼Œå¦‚ï¼š</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®é™…è°ƒç”¨çš„æ˜¯UserHttpHandlerç±»çš„æ–¹æ³•</span></div><div class="line"><span class="selector-attr">[[HttpProxy sharedInstance]</span> getUserWithID:@<span class="number">100</span>];</div><div class="line"></div><div class="line"><span class="comment">//å®é™…è°ƒç”¨çš„æ˜¯CommentHttpHandlerç±»çš„æ–¹æ³•</span></div><div class="line"><span class="selector-attr">[[HttpProxy sharedInstance]</span> getCommentsWithDate:date];</div></pre></td></tr></table></figure>
<h2 id="å…³é”®"><a href="#å…³é”®" class="headerlink" title="å…³é”®"></a>å…³é”®</h2><p>æ ¹æ®å‰é¢çš„æè¿°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼Œå…³é”®å°±æ˜¯ï¼š<strong>æ¶ˆæ¯è½¬å‘ï¼ˆMessage Forwardï¼‰</strong></p>
<p>Objective-Cé‡Œé¢æ²¡æœ‰æˆ‘ä»¬ä¼ ç»Ÿçš„â€œæ–¹æ³•è°ƒç”¨â€ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯â€œæ¶ˆæ¯â€ï¼Œæ‰€æœ‰çš„æ–¹æ³•éƒ½æ˜¯é€šè¿‡å‘å¯¹è±¡å‘é€â€œæ¶ˆæ¯â€å®ç°è°ƒç”¨çš„ã€‚è€Œè¿™ä¸ªæœºåˆ¶ï¼Œä¹Ÿå°±ä¸ºæˆ‘ä»¬çš„å®ç°æä¾›äº†æ–¹ä¾¿ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼šæˆ‘ä»¬è¦å°†å‘ç»™â€œ<strong>HttpProxy</strong>â€çš„æ¶ˆæ¯ï¼Œè®©HttpProxyè½¬å‘ç»™çœŸæ­£èƒ½æ¥å—è¿™ä¸ªæ¶ˆæ¯çš„å¯¹è±¡ï¼ŒHttpProxyå°±æ˜¯ä¸ª<strong>ä»£ç†</strong>ã€‚</p>
<p>è‹¹æœå·²ç»ç»™æˆ‘ä»¬æä¾›äº†è¿™ä¸ªâ€œä»£ç†â€ç±»äº†-NSProxyã€‚</p>
<h2 id="NSProxy"><a href="#NSProxy" class="headerlink" title="NSProxy"></a>NSProxy</h2><p>ä»€ä¹ˆæ˜¯NSProxyï¼š</p>
<ul>
<li>NSProxyæ²¡æœ‰çˆ¶ç±»ï¼Œæ˜¯é¡¶çº§ç±»(æ ¹ç±»)ï¼Œè·ŸNSObjectåŒç­‰åœ°ä½ã€‚</li>
<li>NSProxyå’ŒNSObjectéƒ½å®ç°äº†â€œ<strong>NSObject</strong> Protocolâ€ã€‚</li>
<li>NSProxyè®¾è®¡æ—¶å°±æ˜¯ä»¥â€œæŠ½è±¡ç±»â€è®¾è®¡çš„ï¼Œä¸“é—¨ä¸º<strong>è½¬å‘æ¶ˆæ¯</strong>è€Œç”Ÿã€‚</li>
</ul>
<p>å®ç°è¦æ±‚:</p>
<ol>
<li>ç»§æ‰¿NSProxyçš„å­ç±»è¦å®ç°è‡ªå·±çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¦‚â€œinitâ€ã€â€œinitWithâ€ã€‚</li>
<li>é‡å†™<code>- forwardInvocation:</code>å’Œ<code>- methodSignatureForSelector:</code>æ–¹æ³•ï¼Œå®Œæˆæ¶ˆæ¯è½¬å‘ã€‚</li>
</ol>
<p>è¯¦ç»†å†…å®¹å‚è€ƒAppleçš„<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSProxy_Class/index.html#//apple_ref/occ/instm/NSProxy/forwardInvocation:" target="_blank" rel="external">æ–‡æ¡£</a>ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>å…ˆä¸ç®¡HttpProxyï¼Œå’±ä»¬çœ‹çœ‹å…·ä½“çš„æ¥å£ï¼Œå…ˆä¸¾ä¸¤ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//UserHttpHandler.h</span></div><div class="line"><span class="comment">//ç”¨æˆ·ç›¸å…³æ¥å£</span></div><div class="line"><span class="variable">@protocol</span> UserHttpHandler &lt;NSObject&gt;</div><div class="line">- (void)<span class="attribute">getUserWithID</span>:(NSNumber *)userID;</div><div class="line"><span class="variable">@end</span></div><div class="line"></div><div class="line"><span class="comment">//CommentHttpHandler.h</span></div><div class="line"><span class="comment">//è¯„è®ºç›¸å…³æ¥å£</span></div><div class="line"><span class="variable">@protocol</span> CommentHttpHandler &lt;NSObject&gt;</div><div class="line">- (void)<span class="attribute">getCommentsWithDate</span>:(NSDate *)date;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>å¥½çš„ï¼Œæ¥å£æœ‰äº†ï¼Œæˆ‘ä»¬çš„HttpProxyç±»åº”è¯¥â€œå®ç°â€äº†è¿™ä¸¤ä¸ªæ¥å£ã€‚<br>ç„¶åï¼Œæœ€å¥½æ˜¯å•ä¾‹ç±»ï¼Œæ‰€ä»¥è¿˜è¦æœ‰ä¸ªè·å–å•ä¾‹çš„æ–¹æ³•ã€‚<br>æœ€åï¼Œè¿˜éœ€è¦ä¸€ä¸ªå‘HttpProxyæ³¨å†Œå…·ä½“å®ç°äº†æ¥å£Protocolçš„æ–¹æ³•ã€‚</p>
<p>æ‰€ä»¥ï¼ŒHttpProxyåº”è¯¥æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//HttpProxy.h</span></div><div class="line"></div><div class="line"><span class="comment">//1. ç»§æ‰¿äº†NSproxyã€‚ 2. â€œå®ç°â€äº†ç½‘ç»œæ¥å£Protocol</span></div><div class="line"><span class="meta">@interface</span> <span class="string">HttpProxy :</span> NSProxy &lt;UserHttpHandler, CommentHttpHandler&gt;</div><div class="line"></div><div class="line"><span class="comment">//è·å–å•ä¾‹</span></div><div class="line">+ (instancetype)sharedInstance;</div><div class="line"></div><div class="line"><span class="comment">//æ³¨å†Œå…·ä½“å®ç°ç±»</span></div><div class="line">- (<span class="keyword">void</span>)<span class="string">registerHttpProtocol:</span>(Protocol *)httpProtocol <span class="string">handler:</span>(id)handler;</div><div class="line"></div><div class="line"><span class="meta">@end</span></div></pre></td></tr></table></figure>
<h3 id="æ‰¾åˆ°æ¶ˆæ¯å¯¹åº”çš„å®ç°ç±»å¯¹è±¡"><a href="#æ‰¾åˆ°æ¶ˆæ¯å¯¹åº”çš„å®ç°ç±»å¯¹è±¡" class="headerlink" title="æ‰¾åˆ°æ¶ˆæ¯å¯¹åº”çš„å®ç°ç±»å¯¹è±¡"></a>æ‰¾åˆ°æ¶ˆæ¯å¯¹åº”çš„å®ç°ç±»å¯¹è±¡</h3><p>å¦‚ä½•åœ¨HttpProxyåšæ¶ˆæ¯è½¬å‘æ—¶ï¼Œæ‰¾åˆ°æŸä¸ªæ¶ˆæ¯å¯¹åº”çš„çœŸæ­£çš„å®ç°ç±»å¯¹è±¡å‘¢ï¼Ÿ</p>
<p>æœ€å¥½çš„åŠæ³•å°±æ˜¯ä¿å­˜æ¯ä¸ªæ¥å£æ–¹æ³•åˆ°å…¶å®ç°ç±»å¯¹è±¡çš„æ˜ å°„ï¼Œå¯ä»¥ç”¨Dictionaryä¿å­˜ï¼Œå…³ç³»å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_ios_http_proxy_1_2.jpg" alt="image"></p>
<p>æ‰€ä»¥ï¼Œ<code>registerHttpProtocol:handler:</code>æ–¹æ³•çš„èŒè´£å°±æ˜¯ï¼š</p>
<ol>
<li>éå†Protocolçš„æ‰€æœ‰æ–¹æ³•ï¼ˆåˆ©ç”¨Objective-Cçš„<a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Introduction/Introduction.html" target="_blank" rel="external">Runtime</a>ï¼‰ã€‚</li>
<li>ä¿å­˜Protocolæ‰€æœ‰æ–¹æ³•åˆ°å®ç°ç±»çš„å¯¹è±¡çš„æ˜ å°„å…³ç³»ã€‚ï¼ˆç”¨æ–¹æ³•çš„å­—ç¬¦ä¸²è¡¨ç¤ºä½œä¸ºkeyï¼Œå®ç°ç±»å¯¹è±¡ä¸ºvalueï¼‰</li>
</ol>
<p>æ‰€ä»¥ï¼ŒHttpProxyåº”è¯¥æŒæœ‰ä¸€ä¸ªDictionaryçš„å®ä¾‹ï¼Œç”¨äºä¿å­˜æ˜ å°„å…³ç³»ï¼ŒHttpProxyçš„å®ç°éƒ¨åˆ†å¦‚ï¼š</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//HttpProxy.m</span></div><div class="line"></div><div class="line"><span class="variable">@interface</span> HttpProxy ()</div><div class="line"><span class="comment">//ä¿å­˜æ˜ å°„å…³ç³»çš„å­—å…¸ã€‚</span></div><div class="line"><span class="variable">@property</span>(strong, nonatomic) NSMutableDictionary *selToHandlerMap;</div><div class="line"><span class="variable">@end</span></div></pre></td></tr></table></figure>
<p>æ³¨å†Œæ–¹æ³•å®ç°å¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)registerHttpProtocol:(Protocol *)httpProtocol handler:(<span class="keyword">id</span>)handler &#123;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> numberOfMethods = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="comment">//è·å–Protocolçš„æ‰€æœ‰æ–¹æ³•</span></div><div class="line">    <span class="keyword">struct</span> objc_method_description *methods = protocol_copyMethodDescriptionList(</div><div class="line">            httpProtocol, <span class="literal">YES</span>, <span class="literal">YES</span>, &amp;numberOfMethods);</div><div class="line"></div><div class="line">    <span class="comment">//ä¸ºProtocolçš„æ¯ä¸ªæ–¹æ³•æ³¨å†ŒçœŸæ­£çš„å®ç°ç±»å¯¹è±¡handler</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numberOfMethods; i++) &#123;</div><div class="line">        <span class="keyword">struct</span> objc_method_description method = methods[i];</div><div class="line">        [_selToHandlerMap setValue:handler forKey:<span class="built_in">NSStringFromSelector</span>(method.name)];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å®ç°æ¶ˆæ¯çš„è½¬å‘"><a href="#å®ç°æ¶ˆæ¯çš„è½¬å‘" class="headerlink" title="å®ç°æ¶ˆæ¯çš„è½¬å‘"></a>å®ç°æ¶ˆæ¯çš„è½¬å‘</h3><p>æˆ‘ä»¬å·²ç»å¯ä»¥æ³¨å†Œæ¥å£ã€ä¿å­˜æ˜ å°„å…³ç³»äº†ï¼Œå‰©ä¸‹çš„å°±æ˜¯é‡å†™NSProxyçš„ä¸¤ä¸ªæ–¹æ³•ï¼Œä»¥å®ç°æ¶ˆæ¯çš„è½¬å‘ï¼Œè‡³äºè¿™ä¸¤ä¸ªæ–¹æ³•å…·ä½“ä½œç”¨æ˜¯ä»€ä¹ˆï¼Œè¯»è€…å¯ä»¥è‡ªè¡ŒæŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//HttpProxy.m</span></div><div class="line"></div><div class="line"><span class="comment">//è·å–Method signature</span></div><div class="line">- (NSMethodSignature *)<span class="string">methodSignatureForSelector:</span>(SEL)sel &#123;</div><div class="line"></div><div class="line">    <span class="comment">//è·å–methodçš„å­—ç¬¦ä¸²è¡¨ç¤º</span></div><div class="line">    NSString *methodsName = NSStringFromSelector(sel);</div><div class="line"></div><div class="line">    <span class="comment">//æŸ¥æ‰¾å¯¹åº”å®ç°ç±»å¯¹è±¡</span></div><div class="line">    id handler = [_selToHandlerMap <span class="string">valueForKey:</span>methodsName];</div><div class="line"></div><div class="line">    <span class="comment">//å†æ¬¡æ£€æŸ¥handleræ˜¯å¦å¯ä»¥ç›¸åº”æ­¤æ¶ˆæ¯</span></div><div class="line">    <span class="keyword">if</span> (handler != nil &amp;&amp; [handler <span class="string">respondsToSelector:</span>sel]) &#123;</div><div class="line">        <span class="keyword">return</span> [handler <span class="string">methodSignatureForSelector:</span>sel];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> [<span class="keyword">super</span> <span class="string">methodSignatureForSelector:</span>sel];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//è½¬å‘æ–¹æ³•æ¶ˆæ¯</span></div><div class="line">- (<span class="keyword">void</span>)<span class="string">forwardInvocation:</span>(NSInvocation *)invocation &#123;</div><div class="line">    NSString *methodsName = NSStringFromSelector(invocation.selector);</div><div class="line">    id handler = [_selToHandlerMap <span class="string">valueForKey:</span>methodsName];</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (handler != nil &amp;&amp; [handler <span class="string">respondsToSelector:</span>invocation.selector]) &#123;</div><div class="line">        [invocation <span class="string">invokeWithTarget:</span>handler];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        [<span class="keyword">super</span> <span class="string">forwardInvocation:</span>invocation];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>çœ‹çœ‹å¦‚ä½•ä½¿ç”¨HttpProxyï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//åˆå§‹åŒ–ï¼Œæ³¨å†ŒProtocolå¯¹åº”çš„å®ç°ç±»å¯¹è±¡</span></div><div class="line">[[HttpProxy sharedInstance] <span class="string">registerHttpProtocol:</span><span class="meta">@protocol</span>(UserHttpHandler) <span class="string">handler:</span>[UserHttpHandlerImp <span class="keyword">new</span>]];</div><div class="line">[[HttpProxy sharedInstance] <span class="string">registerHttpProtocol:</span><span class="meta">@protocol</span>(CommentHttpHandler) <span class="string">handler:</span>[CommentHttpHandlerImp <span class="keyword">new</span>]];</div><div class="line"></div><div class="line"><span class="comment">//è°ƒç”¨</span></div><div class="line">[[HttpProxy sharedInstance] <span class="string">getUserWithID:</span>@<span class="number">100</span>];</div><div class="line">[[HttpProxy sharedInstance] <span class="string">getCommentsWithDate:</span>[NSDate <span class="keyword">new</span>]];</div></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ‰€æœ‰çš„ä»£ç åŠç¤ºä¾‹éƒ½æäº¤åˆ°Githubäº†ï¼Œ<a href="https://github.com/zekunyan/HttpProxyExample" target="_blank" rel="external">HttpProxyExample</a>ã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œå°±æ˜¯åˆ©ç”¨Objective-Cçš„â€œæ¶ˆæ¯â€æœºåˆ¶ï¼Œç»§æ‰¿NSProxyæŠ½è±¡ç±»ï¼Œå®ç°è‡ªå·±å®šä¹‰çš„è½¬å‘æœºåˆ¶ï¼Œå°†ç½‘ç»œæ¥å£å±‚çš„å„ä¸ªæ–¹æ³•çš„å®ç°ä¸å£°æ˜åˆ†ç¦»ï¼Œæå‡é¡¹ç›®ä»£ç çš„å¯ç»´æŠ¤æ€§ï¼Œæ›´åŠ æ¨¡å—åŒ–ã€‚å¦‚ä¸‹å›¾è¡¨ç¤º:</p>
<p><img src="http://zorrochen.qiniudn.com/blog_ios_http_proxy_1_3.jpg" alt="image"></p>
<p>ä»¥ä¸Šï¼Œå°±æ˜¯æˆ‘è‡ªå·±åœ¨é¡¹ç›®ä¸­ï¼Œåˆ©ç”¨NSProxyè®¾è®¡å¹¶å®ç°çš„ç½‘ç»œæ¥å£å±‚ç»“æ„ã€‚ğŸ’ª</p>
<p>ä»äº†è§£NSProxyã€Runtimeåˆ°è®¾è®¡ã€å®ç°å‡ºè¿™ä¸ªç½‘ç»œå±‚æ¶æ„ï¼Œç€å®èŠ±äº†ç‚¹æ—¶é—´ï¼Œæ”¶è·çœŸæ˜¯ä¸å°‘ã€‚å…¶å®åƒè¿™ç§çº¯ä»£ç å±‚æ¬¡çš„é‡æ„ï¼Œå¾ˆå¤šäººä¼šè§‰å¾—â€œåƒåŠ›ä¸è®¨å¥½â€ğŸ˜¨ï¼Œä½†æˆ‘è§‰å¾—ï¼Œæ­£æ˜¯è¿™æ ·ï¼Œæ‰èƒ½çœŸæ­£è®©è‡ªå·±æå‡ã€‚</p>
<p>ä»£ç æ˜¯å…·æœ‰ç¾æ„Ÿçš„ï¼å—¯ï¼ğŸ˜</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSProxy_Class/index.html#//apple_ref/occ/instm/NSProxy" target="_blank" rel="external">NSProxy Class Reference</a></li>
<li><a href="http://objectivetoast.com/2014/05/12/nsproxy-nsobjects-lesser-known-sibling/" target="_blank" rel="external">NSProxy, NSObjectâ€™s Lesser-Known Sibling</a></li>
<li><a href="https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Introduction/Introduction.html" target="_blank" rel="external">Objective-C Runtime Programming Guide</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;æ›´æ–°&quot;&gt;&lt;a href=&quot;#æ›´æ–°&quot; class=&quot;headerlink&quot; title=&quot;æ›´æ–°&quot;&gt;&lt;/a&gt;æ›´æ–°&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;2015-12-21: å…¶å®ç”¨CategoryæŒ‰ç…§ä¸šåŠ¡æ‹†åˆ†ç½‘ç»œè¯·æ±‚æ¥å£çš„ä»£ç ä¹Ÿæ˜¯éå¸¸æ£’çš„ï¼Œç›®å‰æˆ‘è‡ªå·±å°±æ˜¯è¿™ä¹ˆåšçš„=ã€‚=ï¼Œæ–‡ç« å°±å½“åšç†Ÿæ‚‰ä¸‹NSProxyå§~&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ä¹‹å‰åœ¨åšé¡¹ç›®çš„æ—¶å€™ï¼Œæ‰€æœ‰ä¸šåŠ¡çš„ç½‘ç»œæ¥å£æ–¹æ³•ï¼Œå…¨éƒ¨éƒ½å†™åœ¨äº†ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œä¸€å¼€å§‹è¿˜å¥½ï¼Œæ¯•ç«Ÿæ¯ä¸ªæ–¹æ³•çš„ä»£ç ä¹Ÿåªæ˜¯åå‡ è¡Œï¼Œå¢åŠ ã€ä¿®æ”¹ä¹Ÿæ¯”è¾ƒå®¹æ˜“ã€‚ä½†æ˜¯éšç€æ¥å£çš„å¢å¤šï¼Œè¿™ä¸ªæ–‡ä»¶æ…¢æ…¢å±…ç„¶è¶…è¿‡äº†1000è¡Œï¼Œé‡Œé¢å‡ åä¸ªæ–¹æ³•éƒ½å†™åœ¨ä¸€èµ·ï¼Œå®åœ¨æ˜¯ä¸å¥½ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ä¿æŒè¿™æ ·ä¹Ÿæ²¡æœ‰ä»€ä¹ˆï¼Œå¤šç”¨ç”¨Cmd+Få°±èƒ½æ‰¾åˆ°ã€‚ä½†æ˜¯ï¼ŒçœŸæ˜¯è¶Šçœ‹è¶Šä¸é¡ºçœ¼ğŸ˜³ï¼Œ ä»£ç ä¸€å®šè¦æœ‰â€œç¾æ„Ÿâ€å•Š~ğŸ˜&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥åœ¨æŸ¥é˜…äº†å¤§é‡æ–‡ç« åï¼Œç»ˆäºæƒ³å‡ºäº†æœ¬æ–‡å³å°†è¯´æ˜çš„åŠæ³•ï¼Œè¶Šå‘è§‰å¾—Objective-Cçš„â€œæ¶ˆæ¯â€æœºåˆ¶æ˜¯å¤šä¹ˆçš„èµ~ğŸ˜š&lt;/p&gt;
&lt;h2 id=&quot;Github-ç¤ºä¾‹&quot;&gt;&lt;a href=&quot;#Github-ç¤ºä¾‹&quot; class=&quot;headerlink&quot; title=&quot;Github ç¤ºä¾‹&quot;&gt;&lt;/a&gt;Github ç¤ºä¾‹&lt;/h2&gt;&lt;p&gt;è´´ä¸Šæœ¬æ–‡ä¸­çš„ç¤ºä¾‹å·¥ç¨‹ï¼š&lt;a href=&quot;https://github.com/zekunyan/HttpProxyExample&quot;&gt;https://github.com/zekunyan/HttpProxyExample&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-3</title>
    <link href="http://tutuge.me/2015/02/14/Effective-Objective-C-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Item-3/"/>
    <id>http://tutuge.me/2015/02/14/Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-3/</id>
    <published>2015-02-14T08:51:51.000Z</published>
    <updated>2016-03-20T09:03:33.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>item 3è®²çš„æ˜¯Objective-Cé‡Œé¢çš„â€œå­—é¢é‡è¯­æ³•â€-â€œLiteral Syntaxâ€ï¼Œä¸ªäººè§‰å¾—éå¸¸æœ‰ç”¨ã€‚</p>
<h2 id="Item-3-Prefer-Literal-Syntax-over-the-Equivalent-Methods"><a href="#Item-3-Prefer-Literal-Syntax-over-the-Equivalent-Methods" class="headerlink" title="Item 3 - Prefer Literal Syntax over the Equivalent Methods"></a>Item 3 - Prefer Literal Syntax over the Equivalent Methods</h2><p>æœ¬èŠ‚è®²äº†Objective-Cä¸­çš„â€œå­—é¢é‡è¯­æ³•â€ï¼Œå¹¶ä¸”å»ºè®®æˆ‘ä»¬æ›´å¤šçš„ä½¿ç”¨è¿™ç§è¯­æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¼ ç»Ÿçš„ç­‰ä»·çš„å‡½æ•°æ–¹æ³•ã€‚</p>
<a id="more"></a>
<h2 id="å¼•å­"><a href="#å¼•å­" class="headerlink" title="å¼•å­"></a>å¼•å­</h2><p>å½“æˆ‘ä»¬ä½¿ç”¨Objective-Cç¼–ç¨‹çš„æ—¶å€™ï¼Œæ€»ä¼šç»å¸¸ä½¿ç”¨åˆ°å‡ ç§Foundationæ¡†æ¶ä¸­çš„åŸºæœ¬ç±»ï¼Œå¦‚NSStringã€NSNumberã€NSArrayã€NSDictionaryï¼Œæˆ–è€…æ˜¯å®ƒä»¬çš„å­ç±»ã€‚ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¼šè¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">NSString</span> *<span class="keyword">str </span>= <span class="comment">@"a string";</span></div></pre></td></tr></table></figure>
<p>ä¸çŸ¥é“å„ä½å†™è¿™å¥çš„æ—¶å€™æœ‰æ²¡æœ‰è§‰å¾—å¥‡æ€ªï¼Ÿä¸ºä»€ä¹ˆä¸ç”¨å…ˆâ€œallocâ€ï¼Œå†â€œinitWithXXXâ€è¿™ä¹ˆæ¥åˆ›å»ºå‘¢ã€‚æ˜¯çš„ï¼Œè¿™é‡Œåˆ›å»ºå­—ç¬¦ä¸²ï¼Œå°±ç”¨åˆ°äº†Objective-Cæä¾›çš„â€œå­—é¢é‡è¯­æ³•â€-â€œLiteral Syntaxâ€ï¼Œè€Œè¿™ç§è¯­æ³•çš„â€œæ ‡å¿—â€å°±æ˜¯â€œ@â€ç¬¦å·ã€‚<br>æœ‰äº†å­—é¢é‡è¯­æ³•ï¼Œæˆ‘ä»¬å°±ä¸ç”¨æ¯æ¬¡åˆ›å»ºä¸€äº›åŸºæœ¬ç±»å‹çš„æ—¶å€™ï¼Œå†™ä¸€å¤§å †allocã€initäº†ã€‚</p>
<h2 id="NSNumber"><a href="#NSNumber" class="headerlink" title="NSNumber"></a>NSNumber</h2><p>å­—ç¬¦ä¸²å¯ä»¥ç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºï¼Œæ•°å­—ç±»NSNumberè‚¯å®šä¹Ÿå¯ä»¥ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSNumber</span> *intNum = @<span class="number">1</span>;</div><div class="line"><span class="built_in">NSNumber</span> *floatNum = @<span class="number">1.1</span>f;</div><div class="line"><span class="built_in">NSNumber</span> *doubleNum = @<span class="number">1.1</span>;</div><div class="line"><span class="built_in">NSNumber</span> *boolNum = @YES;</div><div class="line"><span class="built_in">NSNumber</span> *charNum = @<span class="string">'a'</span>;</div><div class="line"></div><div class="line"><span class="comment">//ä¸ç”¨å­—é¢é‡è¯­æ³•</span></div><div class="line"><span class="built_in">NSNumber</span> *intNumber = [[<span class="built_in">NSNumber</span> alloc] initWithInt:<span class="number">1</span>];</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿~</p>
<h2 id="NSArray"><a href="#NSArray" class="headerlink" title="NSArray"></a>NSArray</h2><h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><p>æ•°ç»„ç®—æ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„äº†ï¼Œå¦‚æœæ²¡æœ‰å­—é¢é‡è¯­æ³•ï¼Œåˆ›å»ºæ•°ç»„å¯èƒ½æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NSArray *numbers = [[NSArray alloc] <span class="symbol">initWithObjects:</span><span class="variable">@1</span>, <span class="variable">@1</span>.<span class="number">1</span>, <span class="variable">@2</span>.0f, <span class="variable">@YES</span>, <span class="keyword">nil</span>];</div></pre></td></tr></table></figure>
<p>ç”¨å­—é¢é‡è¯­æ³•çš„è¯ï¼Œå°±æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NSArray *numbers = <span class="symbol">@[</span><span class="symbol">@1</span>, <span class="symbol">@1</span><span class="number">.1</span>, <span class="symbol">@2</span><span class="number">.0</span>f, <span class="symbol">@YES]</span><span class="comment">;</span></div></pre></td></tr></table></figure>
<h3 id="å­˜å–å€¼"><a href="#å­˜å–å€¼" class="headerlink" title="å­˜å–å€¼"></a>å­˜å–å€¼</h3><p>åˆ›å»ºäº†æ•°ç»„ï¼Œè‚¯å®šè¦ä»æ•°ç»„é‡Œé¢å–å€¼ï¼Œç”¨NSArrayçš„æ–¹æ³•å°±æ˜¯è¿™æ ·ï¼š</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å–</span></div><div class="line">NSNumber *aNumber = [numbers objectAtIndex:<span class="number">2</span>];</div><div class="line"><span class="comment">//å­˜</span></div><div class="line">NSMutableArray *mutableArray = [[NSMutableArray alloc] initWithArray:@[@1, @2, @3]];</div><div class="line">[mutableArray replaceObjectAtIndex:<span class="number">1</span> withObject:@4];</div></pre></td></tr></table></figure>
<p>è·ŸCè¯­è¨€ã€Javaè¿™äº›è¯­æ³•å¾ˆä¸ä¸€æ ·å•Šï¼Œäººå®¶éƒ½æ˜¯é€šè¿‡ä¸­æ‹¬å·â€œ[]â€ç›´æ¥ç”¨ä¸‹æ ‡å–å€¼å°±å¯ä»¥ã€‚æœ‰äº†å­—é¢é‡åŒè¯­æ³•ï¼ŒObjective-Cä¹Ÿå¯ä»¥è¿™æ ·:</p>
<figure class="highlight mel"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å–</span></div><div class="line">NSNumber *aNumber = numbers[<span class="number">2</span>];</div><div class="line"><span class="comment">//å­˜</span></div><div class="line">NSMutableArray *mutableArray = [[NSMutableArray alloc] initWithArray:@[@1, @2, @3]];</div><div class="line">mutableArray[<span class="number">1</span>] = @4;</div></pre></td></tr></table></figure>
<h3 id="è¦æ³¨æ„çš„åœ°æ–¹"><a href="#è¦æ³¨æ„çš„åœ°æ–¹" class="headerlink" title="è¦æ³¨æ„çš„åœ°æ–¹"></a>è¦æ³¨æ„çš„åœ°æ–¹</h3><p>ä¼ ç»Ÿçš„é€šè¿‡â€œinitWithObjectsâ€æ–¹æ³•åˆ›å»ºæ•°ç»„çš„æ—¶å€™ï¼Œæ˜¯æ ¹æ®æœ€åçš„â€œnilâ€åˆ¤æ–­æ•°ç»„æ˜¯å¦ç»“æŸçš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨äºåˆå§‹åŒ–æ•°ç»„çš„å…ƒç´ ä¸­æœ‰â€œnilâ€å€¼ä¹Ÿä¸ä¼šå¯¼è‡´å¼‚å¸¸ï¼ˆExceptionï¼‰ï¼Œå¦‚ä¸‹è¯­å¥ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSNumber</span> *number1 = @<span class="number">1</span>;</div><div class="line"><span class="built_in">NSNumber</span> *number2 = <span class="literal">nil</span>; <span class="comment">//ç©ºæŒ‡é’ˆ</span></div><div class="line"><span class="built_in">NSNumber</span> *number3 = @<span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">//åˆ›å»º</span></div><div class="line"><span class="built_in">NSArray</span> *numbers = [[<span class="built_in">NSArray</span> alloc] initWithObjects:</div><div class="line">  number1, number2, number3, <span class="literal">nil</span>];</div><div class="line"></div><div class="line"><span class="comment">//è¾“å‡ºä¸º1ï¼Œå› ä¸ºnumber2ï¼Œåˆ›å»ºåˆ°number2å°±æˆªæ­¢äº†</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"numbers count: %d"</span>, numbers.count);</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œå¦‚æœç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºï¼Œå°±æ˜¯å‡ºé—®é¢˜ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSNumber</span> *number1 = @<span class="number">1</span>;</div><div class="line"><span class="built_in">NSNumber</span> *number2 = <span class="literal">nil</span>;</div><div class="line"><span class="built_in">NSNumber</span> *number3 = @<span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">//åˆ›å»ºå‡ºç°å¼‚å¸¸ï¼ï¼ï¼</span></div><div class="line"><span class="built_in">NSArray</span> *numbers = @[number1, number2, number3];</div><div class="line"></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"numbers count: %d"</span>, numbers.count);</div></pre></td></tr></table></figure>
<p>å› ä¸ºå­—é¢é‡è¯­æ³•åªæ˜¯å•çº¯çš„å°†ä¸­æ‹¬å·ä¸­çš„å…ƒç´ å…¨éƒ¨åŠ åˆ°æ•°ç»„ä¸­ï¼Œä½†æ˜¯ï¼ŒObjective-Cä¸­çš„æ•°ç»„æ˜¯ä¸å¯ä»¥å­˜æ”¾nilå€¼çš„ï¼Œæ‰€ä»¥ç¨‹åºä¼šè¿è¡Œæ—¶æŠ›å‡ºå¼‚å¸¸ã€‚</p>
<h2 id="NSDictionary"><a href="#NSDictionary" class="headerlink" title="NSDictionary"></a>NSDictionary</h2><h3 id="åˆ›å»º-1"><a href="#åˆ›å»º-1" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><p>å¦‚æœä¸ç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºå­—å…¸ï¼Œä¼ ç»Ÿçš„åˆ›å»ºå‡½æ•°ç®€ç›´ä»¤äººåŒªå¤·æ‰€æ€ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// number1-&gt;@1</span></div><div class="line"><span class="comment">// number2-&gt;@2</span></div><div class="line"><span class="built_in">NSDictionary</span> *dict = [[<span class="built_in">NSDictionary</span> alloc] initWithObjectsAndKeys:@<span class="number">1</span>, <span class="string">@"number1"</span>, @<span class="number">2</span>, <span class="string">@"number2"</span>, <span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<p>æ˜¯ä¸æ˜¯å¾ˆå¥‡æ€ªï¼Œ<strong>valueåœ¨å‰é¢ï¼Œkeyåœ¨åé¢</strong></p>
<p>æ‰€ä»¥ï¼Œè¿˜æ˜¯ç”¨æ–°çš„è¯­æ³•å§ï¼š</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NSDictionary <span class="symbol">*</span>dict = <span class="meta">@&#123;</span><span class="meta">@"number1"</span> : <span class="meta">@1,</span> <span class="meta">@"number2"</span> : <span class="meta">@2&#125;;</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·æ‰ç¬¦åˆâ€œå¸¸è¯†â€å˜›ï¼Œkeyåœ¨å‰ï¼Œvalueåœ¨åé¢ï¼Œè·ŸJSONçš„å®šä¹‰ä¸€æ ·ã€‚</p>
<h3 id="å­˜å–å€¼-1"><a href="#å­˜å–å€¼-1" class="headerlink" title="å­˜å–å€¼"></a>å­˜å–å€¼</h3><p>å–å€¼çš„è¯­æ³•è·ŸNSArrayçš„è¯­æ³•å¾ˆæƒ³ï¼Œåªä¸è¿‡æ˜¯å°†ä¸‹æ ‡æ•°å­—å˜æˆäº†keyï¼š</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ä¼ ç»Ÿ</span></div><div class="line">NSNumber *number1 = [dict <span class="string">objectForKey:</span>@<span class="string">"number1"</span>];</div><div class="line">[dict <span class="string">setValue:</span>@<span class="number">5</span> <span class="string">forKey:</span>@<span class="string">"number1"</span>];</div><div class="line"></div><div class="line"><span class="comment">//å­—é¢é‡è¯­æ³•</span></div><div class="line">NSNumber *number2 = dict[@<span class="string">"number1"</span>];</div><div class="line">dict[@<span class="string">"number1"</span>] = @<span class="number">6</span>;</div></pre></td></tr></table></figure>
<h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><p>éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œè·Ÿåˆ›å»ºæ•°ç»„ä¸€æ ·ï¼ŒNSDictionaryçš„valueä¸èƒ½ä¸ºnilå€¼ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥è¯´ï¼Œä½¿ç”¨å­—é¢é‡è¯­æ³•å¯ä»¥è®©ä»£ç æ›´åŠ æ¸…æ™°ã€ç®€å•ï¼Œæ¯•ç«Ÿï¼Œæ›´å°‘çš„ä»£ç ï¼Œæœ‰æ—¶å€™æ„å‘³ç€æ›´å°‘çš„é”™è¯¯ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;item 3è®²çš„æ˜¯Objective-Cé‡Œé¢çš„â€œå­—é¢é‡è¯­æ³•â€-â€œLiteral Syntaxâ€ï¼Œä¸ªäººè§‰å¾—éå¸¸æœ‰ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Item-3-Prefer-Literal-Syntax-over-the-Equivalent-Methods&quot;&gt;&lt;a href=&quot;#Item-3-Prefer-Literal-Syntax-over-the-Equivalent-Methods&quot; class=&quot;headerlink&quot; title=&quot;Item 3 - Prefer Literal Syntax over the Equivalent Methods&quot;&gt;&lt;/a&gt;Item 3 - Prefer Literal Syntax over the Equivalent Methods&lt;/h2&gt;&lt;p&gt;æœ¬èŠ‚è®²äº†Objective-Cä¸­çš„â€œå­—é¢é‡è¯­æ³•â€ï¼Œå¹¶ä¸”å»ºè®®æˆ‘ä»¬æ›´å¤šçš„ä½¿ç”¨è¿™ç§è¯­æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¼ ç»Ÿçš„ç­‰ä»·çš„å‡½æ•°æ–¹æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="ç¿»è¯‘" scheme="http://tutuge.me/tags/%E7%BF%BB%E8%AF%91/"/>
    
      <category term="ç¬”è®°" scheme="http://tutuge.me/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-2</title>
    <link href="http://tutuge.me/2015/02/06/Effective-Objective-C-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Item-2/"/>
    <id>http://tutuge.me/2015/02/06/Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-2/</id>
    <published>2015-02-06T08:43:46.000Z</published>
    <updated>2016-03-20T09:03:31.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¬¬äºŒå¼¹æ¥äº†ã€‚</p>
<h2 id="Item-2-Minimize-Importing-Headers-in-Headers"><a href="#Item-2-Minimize-Importing-Headers-in-Headers" class="headerlink" title="Item 2 - Minimize Importing Headers in Headers"></a>Item 2 - Minimize Importing Headers in Headers</h2><p>è¿™ä¸€èŠ‚è®²çš„æ˜¯å°½é‡åœ¨ä¸€ä¸ªå¤´æ–‡ä»¶ä¸­å‡å°‘å…¶å®ƒå¤´æ–‡ä»¶çš„å¼•å…¥ã€‚</p>
<a id="more"></a>
<h2 id="å¤´æ–‡ä»¶"><a href="#å¤´æ–‡ä»¶" class="headerlink" title="å¤´æ–‡ä»¶"></a>å¤´æ–‡ä»¶</h2><p>Objective-Cå’ŒCè¯­è¨€ã€C++å¾ˆåƒï¼Œéƒ½å°†ç±»çš„å®ç°ä¸å£°æ˜åˆ†å¼€ï¼Œç”¨.håç¼€åæ–‡ä»¶è¡¨ç¤ºå£°æ˜æ–‡ä»¶ï¼Œç”¨.mæ–‡ä»¶å®ç°ç±»ã€‚å½“è¦ç”¨åˆ°è¿™ä¸ªç±»çš„æ—¶å€™ï¼Œåªéœ€è¦å¼•å…¥å¤´æ–‡ä»¶å³å¯ï¼Œè‡³äºç¼–è¯‘å™¨ã€è¿è¡Œæ—¶æ˜¯å¦‚ä½•çŸ¥é“å¤´æ–‡ä»¶é‡Œé¢çš„ç±»å¯¹åº”çš„å®ç°åœ¨å“ªé‡Œï¼Œåœ¨è¿™äº†ä¸åšè¯´æ˜ã€‚ä¸€ä¸‹ç”¨ä¾‹å­è¯´æ˜ï¼Œå…ˆçœ‹çœ‹ä¸‹é¢çš„ç±»ï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Wheel.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">//è½¦è½®ç±»</span></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Wheel</span> : <span class="title">NSObject</span></span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *manufacturer;</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSUInteger</span> radius;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ç¬¬äºŒä¸ªç±»</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Engine.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">//å‘åŠ¨æœºç±»</span></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Engine</span> : <span class="title">NSObject</span></span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *manufacturer;</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">assign</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSUInteger</span> power;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>ç„¶åå°±æ˜¯è½¦ç±»Carï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Car.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">//æ±½è½¦ç±»ï¼Œåªæœ‰ä¸€ä¸ªè½®å­ï¼Œä¸è¦å¥‡æ€ª=ã€‚=</span></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Car</span> : <span class="title">NSObject</span></span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) Wheel *wheel;</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) Engine *engine;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„åˆ°å°‘äº†ä»€ä¹ˆä¸œè¥¿æ²¡æœ‰ï¼Ÿ<br>æ˜¯çš„ï¼Œå†™è¿‡Cè¯­è¨€ã€C++çš„ç«¥é‹ä¸€ä¸‹å°±èƒ½å‘ç°ï¼ŒCarç±»æ²¡æœ‰å¼•å…¥Engineå’ŒWheelçš„å¤´æ–‡ä»¶ï¼Œè‚¯å®šä¼šç¼–è¯‘å‡ºé”™çš„ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¸çŸ¥é“Engineã€Wheelç±»æ˜¯å•¥ã€‚<br>é‚£å¥½ï¼Œæˆ‘ä»¬åŠ ä¸Šä¸‹é¢ä¸¤è¡Œï¼š</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">#<span class="keyword">import</span> <span class="string">"Wheel.h"</span></div><div class="line">#<span class="keyword">import</span> <span class="string">"Engine.h"</span></div></pre></td></tr></table></figure>
<p>å—¯ã€‚è¿™æ ·å°±ä¸ä¼šå‡ºé”™äº†ã€‚ä½†æ˜¯è¿™æ ·çœŸçš„å¥½å—ï¼ŸObjective-Cç»™æˆ‘ä»¬æä¾›äº†@classå…³é”®å­—ï¼Œå°±æ˜¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚</p>
<h2 id="å‰ç½®å£°æ˜ï¼ˆforward-declarationï¼‰"><a href="#å‰ç½®å£°æ˜ï¼ˆforward-declarationï¼‰" class="headerlink" title="å‰ç½®å£°æ˜ï¼ˆforward declarationï¼‰"></a>å‰ç½®å£°æ˜ï¼ˆforward declarationï¼‰</h2><p>ä½•ä¸ºå‰ç½®å£°æ˜ï¼Ÿçœ‹çœ‹ä¸‹é¢çš„Carç±»çš„å¤´æ–‡ä»¶ä¾‹å­ã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Car.h</span></div><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">//å‰ç½®å£°æ˜</span></div><div class="line"><span class="class"><span class="keyword">@class</span> <span class="title">Wheel</span>;</span></div><div class="line"><span class="class"><span class="keyword">@class</span> <span class="title">Engine</span>;</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Car</span> : <span class="title">NSObject</span></span></div><div class="line"><span class="keyword">@property</span>(<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) Wheel *wheel;</div><div class="line"><span class="keyword">@property</span>(<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) Engine *engine;</div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>@classå°±æ˜¯ç±»çš„å‰ç½®å£°æ˜ï¼ˆforward declarationï¼‰ï¼Œå°±æ˜¯å‘Šè¯‰ç¼–è¯‘å™¨â€œå—¨ï¼Œä¸ç”¨æ‰¾äº†ï¼ŒWheelç±»å’ŒEngineç±»æ˜¯è‚¯å®šå­˜åœ¨çš„ï¼Œç”¨åˆ°çš„æ—¶å€™å†æ‰¾â€ã€‚æœ‰äº†å‰ç½®å£°æ˜ï¼Œæˆ‘ä»¬å°±ä¸ç”¨æ˜¾å¼çš„å¼•å…¥Wheelç±»å’ŒEngineç±»äº†ã€‚</p>
<p>å½“ç„¶ï¼Œåœ¨Carç±»çš„å®ç°æ–‡ä»¶.mæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦æ˜¾å¼çš„å¼•å…¥Wheelå’ŒEngineç±»çš„ï¼Œå› ä¸ºåœ¨è¿™é‡Œæˆ‘ä»¬è¦å…·ä½“ç”¨åˆ°è¿™ä¸¤ä¸ªç±»äº†ï¼Œå½“ç„¶è¦çŸ¥é“ç±»çš„ç»†èŠ‚ã€‚</p>
<h3 id="ä¸ºä½•ä¸è¦importï¼Ÿ"><a href="#ä¸ºä½•ä¸è¦importï¼Ÿ" class="headerlink" title="ä¸ºä½•ä¸è¦importï¼Ÿ"></a>ä¸ºä½•ä¸è¦importï¼Ÿ</h3><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥importå‘¢ï¼Ÿå› ä¸ºå¦‚æœç›´æ¥ç”¨importå¼•å…¥Wheelå’ŒEngineçš„å£°æ˜ï¼Œé‚£ä¹ˆä»»ä½•importå¼•å…¥äº†Carç±»çš„æ–‡ä»¶ï¼Œä¹ŸåŒæ—¶ä¼šå¼•å…¥Wheelã€Engineç±»çš„å£°æ˜ï¼Œè€Œä¸”æœ€ç»ˆæˆ‘ä»¬å¯èƒ½å¹¶ä¸ä¸€å®šä¼šç›´æ¥è·ŸWheelã€Engineç±»æ‰“äº¤é“ï¼Œè¿™æ ·ä¸å°±å¼•å…¥äº†â€œæ²¡æœ‰ç”¨â€çš„ç±»äº†å—ï¼Ÿè€Œä¸”è¿™æ ·åšå¾ˆå¯èƒ½é€ æˆæ–‡ä»¶å¼•å…¥æˆâ€œç¯â€ã€‚</p>
<p>è™½ç„¶importå¯ä»¥é¿å…é‡å¤å£°æ˜é€ æˆç¼–è¯‘å‡ºé”™ï¼Œä¼ ç»Ÿçš„Cè¯­è¨€ã€C++åœ¨å£°æ˜çš„æ—¶å€™ä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼é¿å…é‡å¤å£°æ˜ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _WHEEL_H_</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> _WHEEL_H_</span></div><div class="line"></div><div class="line"><span class="comment">//å£°æ˜å†…å®¹...</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯æ—¢ç„¶Objective-Cæœ‰@classè¿™ç§å‰ç½®å£°æ˜çš„åŠæ³•ï¼Œä¸ºä½•ä¸ç”¨å‘¢ã€‚</p>
<h2 id="å¿…é¡»ç”¨importçš„æ—¶å€™"><a href="#å¿…é¡»ç”¨importçš„æ—¶å€™" class="headerlink" title="å¿…é¡»ç”¨importçš„æ—¶å€™"></a>å¿…é¡»ç”¨importçš„æ—¶å€™</h2><p>å½“ç„¶ï¼Œ@classè¿™æ ·çš„å‰ç½®å£°æ˜å¹¶ä¸èƒ½è§£å†³ä¸€åˆ‡å¤´æ–‡ä»¶å¼•å…¥çš„é—®é¢˜ï¼Œå¦‚ä¸‹è¿™æ ·çš„ç±»ï¼Œå°±å¿…é¡»è¦ç”¨importï¼š</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">&lt;Foundation/Foundation.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">//Car çš„å£°æ˜</span></div><div class="line"><span class="meta">#import <span class="meta-string">"Car.h"</span></span></div><div class="line"></div><div class="line"><span class="comment">//Driver protocolçš„å®šä¹‰</span></div><div class="line"><span class="meta">#import <span class="meta-string">"Driver.h"</span></span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BigCar</span> : <span class="title">Car</span> &lt;<span class="title">Driver</span>&gt;</span></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure>
<p>æ˜¯çš„ï¼Œå½“ç±»éœ€è¦è¢«ç»§æ‰¿ã€å®šä¹‰çš„protocoléœ€è¦å®ç°çš„æ—¶å€™ï¼Œå°±éœ€è¦importç›¸å…³çš„å¤´æ–‡ä»¶äº†ï¼ˆprotocolçš„å®ç°å¦‚æœè·Ÿç±»çš„ä½¿ç”¨è€…æ²¡æœ‰å…³è”ï¼Œå¯ä»¥å®šä¹‰åœ¨ç±»çš„å®ç°æ–‡ä»¶ä¸­çš„â€œæ‰©å±•categoryâ€ä¸­ï¼‰,å½“ç„¶ï¼Œè¿˜æœ‰@protocolè¿™æ ·çš„protocolçš„å‰ç½®å£°æ˜ï¼Œæ€ä¹ˆç”¨å°±ç•™ç»™è¯»è€…è‡ªå·±æŸ¥é˜…ç›¸å…³èµ„æ–™äº†ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¤§è´¹å‘¨ç« çš„è®²äº†è¿™ä¹ˆå¤šï¼Œå…¶å®ç›®çš„å°±æ˜¯ä¸€ä¸ªï¼šå°½é‡å°‘åœ¨å¤´æ–‡ä»¶é‡Œé¢å¼•å…¥å…¶ä»–å¤´æ–‡ä»¶ã€‚</p>
<p>æœ€ç»ˆçš„ç›®çš„å°±æ˜¯<strong>åªæš´éœ²æœ€å°‘çš„ç»†èŠ‚</strong>ã€‚</p>
<p>å†™ä»£ç æœ‰æ®µæ—¶é—´äº†ï¼Œä¸€ç›´éƒ½åœ¨ç¢ç£¨è¿™å¥è¯ï¼Œå¸Œæœ›è¯»è€…ä¹Ÿèƒ½å¥½å¥½ä½“ä¼š~</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ç¬¬äºŒå¼¹æ¥äº†ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Item-2-Minimize-Importing-Headers-in-Headers&quot;&gt;&lt;a href=&quot;#Item-2-Minimize-Importing-Headers-in-Headers&quot; class=&quot;headerlink&quot; title=&quot;Item 2 - Minimize Importing Headers in Headers&quot;&gt;&lt;/a&gt;Item 2 - Minimize Importing Headers in Headers&lt;/h2&gt;&lt;p&gt;è¿™ä¸€èŠ‚è®²çš„æ˜¯å°½é‡åœ¨ä¸€ä¸ªå¤´æ–‡ä»¶ä¸­å‡å°‘å…¶å®ƒå¤´æ–‡ä»¶çš„å¼•å…¥ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="ç¿»è¯‘" scheme="http://tutuge.me/tags/%E7%BF%BB%E8%AF%91/"/>
    
      <category term="ç¬”è®°" scheme="http://tutuge.me/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-1</title>
    <link href="http://tutuge.me/2015/02/05/Effective-Objective-C-%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Item-1/"/>
    <id>http://tutuge.me/2015/02/05/Effective-Objective-C-è¯»ä¹¦ç¬”è®°-Item-1/</id>
    <published>2015-02-04T17:17:08.000Z</published>
    <updated>2016-06-16T16:16:51.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä¸€ç›´éƒ½åœ¨åšé¡¹ç›®ï¼Œæ²¡ä»€ä¹ˆæ—¶é—´ä½œæ€»ç»“ï¼Œæ„Ÿè§‰å¾ˆä¸æ˜¯æ»‹å‘³ã€‚ç°åœ¨æ”¾å‡äº†ï¼Œå—¯ï¼Œç»ˆäºæœ‰æ—¶é—´äº†~~å“ˆå“ˆï¼ˆå¤©ç”Ÿç¨‹åºçŒ¿ä¸€æšå¥½ä¸å¥½=ã€‚=ï¼‰<br>æœ€è¿‘å¼€å§‹è¯»è‹±æ–‡ç‰ˆçš„Effective Objective-C 2.0ï¼Œè§‰å¾—ä¸é”™ï¼Œå°±æ€»ç»“äº›ä¸œè¥¿ï¼Œåˆ†äº«ç»™å„ä½è¯»è€…å§ã€‚</p>
<h2 id="Item-1-Familiarize-Yourself-with-Objective-Câ€™s-Roots"><a href="#Item-1-Familiarize-Yourself-with-Objective-Câ€™s-Roots" class="headerlink" title="Item 1 - Familiarize Yourself with Objective-Câ€™s Roots"></a>Item 1 - Familiarize Yourself with Objective-Câ€™s Roots</h2><p>ç¬¬ä¸€ç« çš„ç›®çš„ï¼Œå°±æ˜¯è®©å¤§å®¶ç†Ÿæ‚‰Objective-Cï¼Œè‡ªç„¶ï¼Œæ ‡é¢˜çš„æ„æ€ä¹Ÿå°±æ˜¯â€œäº†è§£Objective-Cçš„åŸºæœ¬æ¦‚å¿µâ€ï¼Œä¸å¤šè¯´ï¼Œå¼€å†™ã€‚</p>
<a id="more"></a>
<h2 id="æ¶ˆæ¯ä¸è¿è¡Œæ—¶"><a href="#æ¶ˆæ¯ä¸è¿è¡Œæ—¶" class="headerlink" title="æ¶ˆæ¯ä¸è¿è¡Œæ—¶"></a>æ¶ˆæ¯ä¸è¿è¡Œæ—¶</h2><p>æ€»çš„æ¥è¯´ï¼ŒObjective-Cè·ŸC++ã€Javaè¿™äº›é¢å‘å¯¹è±¡çš„è¯­è¨€æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰è®¸å¤šä¸åŒçš„åœ°æ–¹ã€‚å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡çœ‹åˆ°Objective-Cçš„è¯­æ³•ï¼Œä¸€å®šè§‰å¾—éå¸¸å¥‡æ€ªï¼Œå› ä¸ºObjective-Cä½¿ç”¨çš„æ˜¯åŸºäºæ¶ˆæ¯ï¼ˆMessageï¼‰çš„æ¡†æ¶ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„æ–¹æ³•ã€å‡½æ•°è°ƒç”¨ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//Objective-C</span></div><div class="line">Person *person = [Person <span class="keyword">new</span><span class="type"></span>];</div><div class="line">[person setName:<span class="type"></span>@<span class="string">"tutuge"</span> age:<span class="type">24</span>];</div><div class="line"></div><div class="line"><span class="comment">//Java</span></div><div class="line">Person person = <span class="keyword">new</span> <span class="type">Person</span>();</div><div class="line">person.setNameAndAge(<span class="string">"tutuge"</span>, <span class="number">24</span>);</div><div class="line"></div><div class="line"><span class="comment">//C++</span></div><div class="line">Person *person = <span class="keyword">new</span> <span class="type">Person</span>;</div><div class="line">person-&gt;setNameAndAge(<span class="string">"tutuge"</span>, <span class="number">24</span>);</div></pre></td></tr></table></figure>
<p>å¾ˆå¥‡æ€ªæ˜¯ä¸æ˜¯ï¼Œå„ç§ä¸­æ‹¬å·ã€‚ä½†æ˜¯æˆ‘è§‰å¾—ï¼ŒObjectiveâ€”Cè¿™ä¹ˆè®¾è®¡å°±æ˜¯ä¸ºäº†æ—¶åˆ»æé†’ä½ ï¼Œâ€œæˆ‘æ˜¯åŸºäºæ¶ˆæ¯æœºåˆ¶çš„ï¼â€ã€‚æ¶ˆæ¯ï¼Œçš„ç¡®æ˜¯Objective-Cä¸Javaã€C++è¿™ç§è¯­è¨€æœ€å¤§çš„ä¸åŒï¼Œè€Œä¸”ï¼Œè¿™ç§ä¸åŒè¿œä¸æ­¢åœ¨è¯­æ³•ä¸Šé¢ã€‚ç®€å•æ¥è¯´å¦‚ä¸‹ä¸¤ç‚¹ï¼š</p>
<ul>
<li><strong>åŸºäºæ¶ˆæ¯çš„è°ƒç”¨ï¼š</strong> æ‰€æœ‰çš„å‡½æ•°è°ƒç”¨éƒ½æ˜¯åœ¨â€œè¿è¡Œæ—¶â€å†³å®šçš„ã€‚</li>
<li><strong>åŸºäºæ–¹æ³•çš„è°ƒç”¨ï¼š</strong> æ‰€æœ‰çš„å‡½æ•°è°ƒç”¨éƒ½æ˜¯åœ¨â€œç¼–è¯‘æ—¶â€å†³å®šçš„ï¼Œå°±æ˜¯ç¼–è¯‘å™¨ç¼–è¯‘æ—¶å†³å®šçš„ã€‚</li>
</ul>
<p>å…¶å®ï¼Œè¿è¢«è°ƒæ–¹æ³•çš„å¯¹è±¡ç±»å‹ï¼Œéƒ½æ˜¯åœ¨è¿è¡Œæ—¶å†³å®šçš„ã€‚æ‰€ä»¥è¯´ï¼ŒObjective-Cçš„è¿è¡Œæ—¶ç³»ç»Ÿï¼Œæ‹…è´Ÿäº†ç»å¤§éƒ¨åˆ†çš„å·¥ä½œã€‚è¿™ä¹ˆè®¾è®¡çš„ä¼˜ç‚¹ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå°±æ˜¯å½“è¿è¡Œæ—¶ç³»ç»Ÿå‡çº§æ—¶ï¼ŒåŸæœ‰çš„ä»£ç ä¸ç”¨é‡æ–°ç¼–è¯‘å³å¯â€œäº«å—â€å‡çº§å¸¦æ¥çš„å¥½å¤„ã€‚</p>
<h2 id="Cçš„è¶…é›†"><a href="#Cçš„è¶…é›†" class="headerlink" title="Cçš„è¶…é›†"></a>Cçš„è¶…é›†</h2><p>Objective-Cæ˜¯Cè¯­è¨€çš„è¶…é›†ï¼Œæ‰€ä»¥Cè¯­è¨€æ‰€å…·æœ‰çš„ä¸€åˆ‡ç‰¹æ€§ï¼ŒObjective-Céƒ½å¯ä»¥å…¼å®¹ï¼Œå……åˆ†ç†è§£Cè¯­è¨€çš„å†…å­˜æ¨¡å‹ï¼Œå¯¹ç†è§£Objective-Cå¾ˆæœ‰å¸®åŠ©ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">NSString</span> *<span class="keyword">str </span>= <span class="comment">@"a string";</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸€è¡Œä»£ç è·ŸCè¯­è¨€æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œï¼ˆå¿½ç•¥@ç¬¦å·=ã€‚=ï¼‰ï¼ŒåŸç†è·ŸCè¯­è¨€ä¹Ÿæ˜¯ä¸€è‡´çš„ï¼Œå°±æ˜¯stræŒ‡é’ˆæ˜¯NSStringç±»å‹çš„æŒ‡é’ˆï¼ŒæŒ‡å‘äº†ä¸€å—å­˜ç€å­—ç¬¦ä¸²â€œa stringâ€çš„å†…å­˜åŒºåŸŸã€‚ä¸åŒçš„æ˜¯ï¼Œåœ¨Objective-Cé‡Œï¼Œæ‰€æœ‰çš„å¯¹è±¡åªå¯ä»¥å£°æ˜ä¸ºæŒ‡é’ˆç±»å‹ï¼Œæ‰€ä»¥å¦‚ä¸‹ä»£ç æ˜¯ä¸åˆç†çš„ï¼š</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">NSString str<span class="comment">;</span></div></pre></td></tr></table></figure>
<p>ä¸ºäº†æ›´å……åˆ†çš„ç†è§£ï¼Œå’±ä»¬çœ‹çœ‹å¦‚ä¸‹ä¾‹å­ï¼š</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">NSString</span> *<span class="keyword">str1 </span>= <span class="comment">@"a string";</span></div><div class="line"><span class="symbol">NSString</span> *<span class="keyword">str2 </span>= <span class="keyword">str1;</span></div></pre></td></tr></table></figure>
<p>ç†Ÿæ‚‰Cè¯­è¨€çš„æœ‹å‹åº”è¯¥çŸ¥é“è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Œå†…å­˜å½“ä¸­åªæœ‰ä¸€å—åŒºåŸŸå‚¨å­˜ç€â€œa stringâ€è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œstr1ã€str2éƒ½æ˜¯æŒ‡å‘ç€è¿™ä¸ªåŒºåŸŸçš„å­—ç¬¦ä¸²æŒ‡é’ˆã€‚å¦‚ä¸‹å›¾ï¼š</p>
<p><img src="http://zorrochen.qiniudn.com/blog_effective_objective_c_item_1_1.jpg" alt="image"></p>
<ul>
<li>str1ã€str2éƒ½åœ¨æ ˆå†…å­˜ä¸Šåˆ†é…çš„ï¼Œå°±æ˜¯å­—ç¬¦ä¸²ï¼ˆNSStringï¼‰ç±»å‹çš„æŒ‡é’ˆã€‚</li>
<li>â€œa stringâ€å­—ç¬¦ä¸²å®é™…å‚¨å­˜åœ¨å †å†…å­˜ä¸Šã€‚</li>
<li>str1ã€str2å‡æŒ‡å‘åŒä¸€å—å†…å­˜åŒºåŸŸã€‚</li>
</ul>
<p>æ­¤å¤„çš„æ ˆå†…å­˜ã€å †å†…å­˜è·ŸCè¯­è¨€ä¸­çš„æ¦‚å¿µä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œä¸åŒçš„æ˜¯ï¼Œåœ¨Objective-Cä¸­ï¼Œæˆ‘ä»¬ä¸ç”¨æ‰‹åŠ¨å»mallocã€freeå†…å­˜ï¼ŒObjective-Cä½¿ç”¨å†…å­˜è®¡æ•°è®¡æ•°å¸®æˆ‘ä»¬ç®¡ç†å†…å­˜ã€‚</p>
<h2 id="ç»“æ„ä½“ï¼ŒåŸºæœ¬ç±»å‹"><a href="#ç»“æ„ä½“ï¼ŒåŸºæœ¬ç±»å‹" class="headerlink" title="ç»“æ„ä½“ï¼ŒåŸºæœ¬ç±»å‹"></a>ç»“æ„ä½“ï¼ŒåŸºæœ¬ç±»å‹</h2><p>åœ¨Objective-Cä¸­ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„å˜é‡éƒ½æ˜¯æŒ‡é’ˆç±»å‹çš„ï¼Œåƒintã€floatã€doubleè¿™äº›ä¾æ—§æ˜¯ä¼ ç»Ÿçš„â€œæ ˆä¸Šåˆ†é…â€çš„ï¼Œå½“ç„¶ï¼Œè¿˜æœ‰ç»“æ„ä½“structã€æšä¸¾enumã€è”åˆunionç­‰ã€‚å¦‚ï¼š</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">CGPoint point = CGPointMake(<span class="number">10</span>, <span class="number">10</span>);</div><div class="line">CGRect frame = CGRectMake(<span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">10</span>);</div></pre></td></tr></table></figure>
<p>è¿™çš„CGPointã€CGRectéƒ½æ˜¯ç»“æ„ä½“ï¼Œä½†æ˜¯éƒ½æ˜¯ç›´æ¥åœ¨æ ˆä¸Šåˆ†é…å†…å­˜çš„ï¼Œä»¥å‡å°‘è¿‡åº¦ä½¿ç”¨Objective-Cç±»å‹çš„ç±»ï¼ˆå‡å°‘è¿è¡Œæ—¶çš„å‹åŠ›ï¼‰ï¼Œå„ä½è¯»è€…ä½¿ç”¨çš„æ—¶å€™è¦æ³¨æ„ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é›¶æ•£çš„è¯´äº†ä¸€äº›Objective-Cçš„ç‰¹ç‚¹ï¼Œè¿œè¿œä¸è¶³ä»¥è®²æ˜ç™½Objective-Cï¼Œæˆ‘è¿™åªæ˜¯æ ¹æ®Effective Objective-Cè¿™æœ¬ä¹¦ç»™ä¸ªå¼•å­ï¼Œè¿˜æ˜¯æ¨èAppleçš„å®˜æ–¹æ•™ç¨‹ã€æ–‡æ¡£ï¼Œè¦æƒ³æŒæ¡æ‰å®ï¼Œè¿˜æ˜¯è¦ä¸€æ­¥ä¸€æ­¥æ¥~</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;ä¸€ç›´éƒ½åœ¨åšé¡¹ç›®ï¼Œæ²¡ä»€ä¹ˆæ—¶é—´ä½œæ€»ç»“ï¼Œæ„Ÿè§‰å¾ˆä¸æ˜¯æ»‹å‘³ã€‚ç°åœ¨æ”¾å‡äº†ï¼Œå—¯ï¼Œç»ˆäºæœ‰æ—¶é—´äº†~~å“ˆå“ˆï¼ˆå¤©ç”Ÿç¨‹åºçŒ¿ä¸€æšå¥½ä¸å¥½=ã€‚=ï¼‰&lt;br&gt;æœ€è¿‘å¼€å§‹è¯»è‹±æ–‡ç‰ˆçš„Effective Objective-C 2.0ï¼Œè§‰å¾—ä¸é”™ï¼Œå°±æ€»ç»“äº›ä¸œè¥¿ï¼Œåˆ†äº«ç»™å„ä½è¯»è€…å§ã€‚&lt;/p&gt;
&lt;h2 id=&quot;Item-1-Familiarize-Yourself-with-Objective-Câ€™s-Roots&quot;&gt;&lt;a href=&quot;#Item-1-Familiarize-Yourself-with-Objective-Câ€™s-Roots&quot; class=&quot;headerlink&quot; title=&quot;Item 1 - Familiarize Yourself with Objective-Câ€™s Roots&quot;&gt;&lt;/a&gt;Item 1 - Familiarize Yourself with Objective-Câ€™s Roots&lt;/h2&gt;&lt;p&gt;ç¬¬ä¸€ç« çš„ç›®çš„ï¼Œå°±æ˜¯è®©å¤§å®¶ç†Ÿæ‚‰Objective-Cï¼Œè‡ªç„¶ï¼Œæ ‡é¢˜çš„æ„æ€ä¹Ÿå°±æ˜¯â€œäº†è§£Objective-Cçš„åŸºæœ¬æ¦‚å¿µâ€ï¼Œä¸å¤šè¯´ï¼Œå¼€å†™ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
      <category term="ç¿»è¯‘" scheme="http://tutuge.me/tags/%E7%BF%BB%E8%AF%91/"/>
    
      <category term="ç¬”è®°" scheme="http://tutuge.me/tags/%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>iOSé¡¹ç›®çš„ç›®å½•ç»“æ„-åŸåˆ›</title>
    <link href="http://tutuge.me/2015/02/01/iOS%E9%A1%B9%E7%9B%AE%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84-%E5%8E%9F%E5%88%9B/"/>
    <id>http://tutuge.me/2015/02/01/iOSé¡¹ç›®çš„ç›®å½•ç»“æ„-åŸåˆ›/</id>
    <published>2015-01-31T18:27:21.000Z</published>
    <updated>2016-08-07T06:11:25.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ®µæ—¶é—´ä¸€ç›´åœ¨åšiOSçš„é¡¹ç›®ï¼ˆ<a href="https://itunes.apple.com/cn/app/qing-ju-yin-le-quan-guo-zui/id913235479?mt=8" target="_blank" rel="external">é’æ¡”éŸ³ä¹App</a>ï¼‰ï¼Œéšç€ä»£ç é‡çš„ä¸Šå‡ï¼Œé€æ¸æ„è¯†åˆ°é¡¹ç›®çš„æ•´ä½“ç›®å½•ç»“æ„åˆ’åˆ†æ˜¯å¤šä¹ˆé‡è¦ï¼Œæ¸…æ™°çš„ç›®å½•ç»“æ„ï¼Œèƒ½å¤Ÿæ›´å¥½çš„åº”å¯¹æ–°çš„éœ€æ±‚ï¼Œæ›´å®¹æ˜“é‡æ„ã€‚è™½ç„¶ä¸€ç›´éƒ½æ˜¯ä¸€ä¸ªäººåœ¨åš=ã€‚=ï¼Œä½†æ˜¯è¿˜æ˜¯æ·±æ·±åœ°ä½“ä¼šåˆ°ç›®å½•ç»“æ„çš„é‡è¦æ€§ã€‚</p>
<a id="more"></a>
<h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><p>è¯´å†å¤šéƒ½ä¸å¦‚æ¥ä¸ªä¾‹å­å®åœ¨ï¼Œå¦‚ä¸‹ï¼š(VCæŒ‡çš„æ˜¯viewController)</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line"><span class="string">|---General</span></div><div class="line">    <span class="string">|---AppDelegate</span></div><div class="line">    <span class="string">|---Application</span></div><div class="line">    <span class="string">|---Constant</span></div><div class="line">    <span class="string">|---UI</span></div><div class="line">        <span class="string">|---View</span></div><div class="line">        <span class="string">|---VC</span></div><div class="line">        ...</div><div class="line">    <span class="string">|---Category</span></div><div class="line">    ...</div><div class="line"><span class="string">|---Entity</span></div><div class="line">    <span class="string">|---BaseEntity</span></div><div class="line">    <span class="string">|---UserEntity</span></div><div class="line">    <span class="string">|---CommentEntity</span></div><div class="line">    ...</div><div class="line"><span class="string">|---Http</span></div><div class="line">    <span class="string">|---Api</span></div><div class="line">    <span class="string">|---Manager</span></div><div class="line">    <span class="string">|---CodeHandler</span></div><div class="line">    <span class="string">|---ErrorHandler</span></div><div class="line">    <span class="string">|---HttpHandler</span></div><div class="line">        <span class="string">|---UserHttpHandler</span></div><div class="line">        <span class="string">|---CommentHttpHandler</span></div><div class="line">        ...</div><div class="line"><span class="string">|---DB</span></div><div class="line">    <span class="string">|---DBHelper</span></div><div class="line">    <span class="string">|---DBService</span></div><div class="line">    ...</div><div class="line"><span class="string">|---Util</span></div><div class="line">    <span class="string">|---StringUtil</span></div><div class="line">    <span class="string">|---NumberUtil</span></div><div class="line">    <span class="string">|---TimeUtil</span></div><div class="line">    ...</div><div class="line"><span class="string">|---Service</span></div><div class="line">    <span class="string">|---AccountService</span></div><div class="line">    <span class="string">|---ShareService</span></div><div class="line">    ...</div><div class="line"><span class="string">|---Lib</span></div><div class="line">    <span class="string">|---Umeng</span></div><div class="line">    <span class="string">|---QQSDK</span></div><div class="line">    <span class="string">|---SVProgressHUD</span></div><div class="line">    ...</div><div class="line"><span class="string">|---Module</span></div><div class="line">    <span class="string">|---Login</span></div><div class="line">        <span class="string">|---View</span></div><div class="line">        <span class="string">|---VC</span></div><div class="line">        <span class="string">|---XIB</span></div><div class="line">    <span class="string">|---Comment</span></div><div class="line">        <span class="string">|---View</span></div><div class="line">        <span class="string">|---VC</span></div><div class="line">        <span class="string">|---XIB</span></div><div class="line">        <span class="string">|---Business</span></div><div class="line">    <span class="string">|---Feeds</span></div><div class="line">    ...</div></pre></td></tr></table></figure>
<p>ä¹ä¸€çœ‹å¥½å¤šï¼Œåˆ«è¢«å“åˆ°=ã€‚=ï¼Œå®¹æˆ‘ç»†ç»†è®²è§£ã€‚</p>
<h2 id="è¯¦ç»†è®²è§£"><a href="#è¯¦ç»†è®²è§£" class="headerlink" title="è¯¦ç»†è®²è§£"></a>è¯¦ç»†è®²è§£</h2><h3 id="General"><a href="#General" class="headerlink" title="General"></a>General</h3><p>Generalå¥½ç†è§£ï¼Œæ”¾çš„å°±æ˜¯å¦‚AppDelegateä¹‹ç±»çš„ã€é¡¹ç›®ä¸­æœ€æ™®é€šçš„ã€æœ€å¸¸ç”¨çš„ç»„ä»¶ã€‚</p>
<p><strong>AppDelegate</strong>:</p>
<p>Appçš„Delegateç±»å®ç°ï¼Œè¿™ä¸ªå¿…é¡»æœ‰ï¼Œå°±ä¸ç”¨è¯´äº†å§ã€‚</p>
<p><strong>Application</strong>:</p>
<p>å¦‚æœè‡ªå®šä¹‰å®ç°äº†Applicationç±»ï¼Œå°±æ”¾åœ¨è¿™é‡Œã€‚</p>
<p><strong>Constant</strong>:</p>
<p>é¡¾åæ€ä¹‰ï¼Œå¸¸é‡ï¼Œé¡¹ç›®ç”¨åˆ°çš„æ‰€æœ‰å…¬å…±å¸¸é‡ï¼Œå¦‚enumæšä¸¾ç±»å‹çš„ã€Notificationçš„Tagï¼Œå¸¸ç”¨çš„é¢œè‰²ã€å­—ç¬¦ä¸²ç­‰ç­‰ç­‰ï¼Œéƒ½å¯ä»¥æŒ‰ç…§è‡ªå·±çš„éœ€æ±‚åˆ’åˆ†ä¸åŒçš„Groupï¼Œæ”¾åˆ°Constanté‡Œé¢ã€‚</p>
<p><strong>UI</strong>:</p>
<p>é¡¹ç›®ä¸­è‡ªå®šä¹‰çš„UIViewã€UIViewControllerå­ç±»ä¹‹ç±»çš„ä»£ç ï¼Œå°±å¯¹åº”æ”¾åœ¨UIä¸‹çš„Viewã€VCä¸­ã€‚</p>
<p><strong>Category</strong>:</p>
<p>å¯¹ç³»ç»Ÿç±»åšçš„æ‰©å±•ï¼Œå„ç§Categoryï¼Œå¦‚<code>NSString+XXXExtension</code>è¿™ç§ï¼Œå°±ç»Ÿä¸€æ”¾åœ¨Categoryç›®å½•ä¸‹ã€‚</p>
<p>å¦‚è¿˜æœ‰å…¶ä»–çš„é€šç”¨ç»„ä»¶ï¼Œä¹Ÿä¸å¦¨æ”¾åˆ°è¿™é‡Œï¼Œåšç»Ÿä¸€çš„ç®¡ç†ã€‚</p>
<hr>
<h3 id="Entity"><a href="#Entity" class="headerlink" title="Entity"></a>Entity</h3><p>Entityï¼Œä¹Ÿæœ‰äººå–œæ¬¢å«Modelï¼ˆå…³äºEntityå’ŒModelçš„åŒºåˆ«ï¼Œæ¨èçœ‹çœ‹<a href="http://blogsh.de/2011/09/08/models-vs-entities/" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>ï¼Œä¸ªäººè§‰å¾—ç ”ç©¶ç ”ç©¶Entityå’ŒModelæ¦‚å¿µçš„åŒºåˆ«è¿˜æ˜¯å¾ˆæœ‰å¥½å¤„çš„ï¼‰ï¼Œå°±æ˜¯ç¨‹åºä¸­çš„â€œå®ä½“â€ï¼Œå¦‚ä¸€ä¸ªç”¨æˆ·ã€ä¸€æ¡è¯„è®ºã€ä¸€é¦–æ­Œç­‰ç­‰ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹â€œä¸ªä½“â€çš„é›†åˆã€æ‰“åŒ…ï¼Œå…·ä½“çš„è‡ªå·±æŸ¥æŸ¥å§ï¼Œç½‘ä¸Šä¸€å¤§å †çš„ï¼Œæ„Ÿè§‰è·ŸJavaBeançš„æ¦‚å¿µæ¯”è¾ƒåƒã€‚</p>
<p>é€šå¸¸æ¥è¯´ï¼Œæ¯ä¸ªEntityç±»éƒ½æ¯”è¾ƒç®€å•ï¼ŒåªåŒ…å«è‹¥å¹²ä¸ªå±æ€§ã€‚ä½†æ˜¯æœ‰æ—¶å€™å¯èƒ½è¦åšç»Ÿä¸€çš„å¤„ç†ï¼Œå¦‚ï¼Œåœ¨ä»æœåŠ¡å™¨å–å›çš„JSONæ•°æ®è§£åŒ…æˆå…·ä½“çš„Entityç±»ï¼Œå¹¶ä¸”æ‰§è¡Œä¸€ç³»åˆ—åˆå§‹åŒ–æ“ä½œç­‰ç­‰ï¼Œæ‰€ä»¥å¯èƒ½è¦å¯¹æ‰€æœ‰çš„Entityç±»åšç»Ÿä¸€å¤„ç†ã€‚æ‰€ä»¥è¯´ï¼Œå¯ä»¥å®šåˆ¶ç›¸åº”çš„BaseEntityåŸºç±»ï¼Œåˆ©ç”¨æ¨¡æ¿æ–¹æ³•ç­‰åŠæ³•ï¼Œå®šåˆ¶ç»Ÿä¸€çš„åˆå§‹åŒ–æµç¨‹ï¼ˆå¥½åƒæ‰¯è¿œäº†=ã€‚=ï¼Œè¿™ä¸ªåé¢ä¼šè¯¦ç»†å†™ç¯‡ä¸œè¥¿åˆ†äº«ç»™å¤§å®¶ï¼‰ï¼ŒBaseEntityå°±æ˜¯æ”¾è¿™äº›åŸºç±»çš„ä¸œè¥¿çš„ã€‚</p>
<p>æœ‰äº†BaseEntityåï¼Œå¯¹åº”çš„å„ä¸ªä¸šåŠ¡ä¸­çš„å…·ä½“Entityï¼Œå¦‚UserEntityã€CommentEntityï¼Œå°±å¯ä»¥åˆ†é—¨åˆ«ç±»çš„å»ºç«‹å•ç‹¬çš„Groupå­˜æ”¾ã€‚</p>
<hr>
<h3 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h3><p>è¿™ä¸ªGroupé‡Œé¢æ”¾è·Ÿç½‘ç»œè¯·æ±‚ç›¸å…³çš„ä¸œè¥¿ï¼Œè¯¦ç»†å¦‚ä¸‹ï¼š</p>
<p><strong>Api</strong>:</p>
<p>äº’è”ç½‘åº”ç”¨å°‘ä¸äº†è·ŸæœåŠ¡å™¨æ‰“äº¤é“çš„å„ç§ç½‘ç»œæ¥å£ï¼Œæ‰€ä»¥æˆ‘åœ¨é¡¹ç›®ä¸­æŠŠæ‰€æœ‰çš„APIå¯¹åº”çš„ç›¸å¯¹URLåœ°å€ã€å‚æ•°æ³¨é‡Šè¦æ±‚ç­‰ç­‰éƒ½æ”¾åœ¨äº†è¿™é‡Œï¼Œå¥½ç»Ÿä¸€ç®¡ç†ã€‚</p>
<p><strong>Manager</strong>:</p>
<p>å®šä¹‰æœ€åŸºæœ¬çš„ç½‘ç»œè¯·æ±‚ï¼Œå¦‚GETã€POSTã€PUTç­‰è¯·æ±‚çš„åŸºæœ¬å°è£…ï¼Œè·å–å›¾ç‰‡çš„åŸºæœ¬å°è£…ã€‚<br>ä¸€èˆ¬æ¥è¯´å°±æ˜¯å®šåˆ¶ç»Ÿä¸€çš„åŸºæœ¬è¯·æ±‚æ¥å£ï¼Œå¯¹ä¸Šå±‚æä¾›ä¸€è‡´ã€ç¨³å®šçš„æœåŠ¡ï¼ŒçœŸæ­£çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯ä»¥è‡ªå·±ç”¨iOSåŸç”Ÿçš„Apiå†™ï¼Œä¹Ÿå¯ä»¥ç”¨AFNetworkingç­‰ç¬¬ä¸‰æ–¹åº“åšå°è£…ï¼Œå›¾ç‰‡ä¹Ÿå¯ä»¥çµæ´»çš„ç”¨AFNetworkingã€SDWebImageè¿™äº›ä¼˜ç§€çš„åº“å®ç°ã€‚è¿˜æœ‰å°±æ˜¯ï¼Œå¯ä»¥æ–¹ä¾¿çš„ç»Ÿä¸€å¯¹è¯·æ±‚åšå¤„ç†ï¼Œå¦‚é”™è¯¯å¤„ç†ã€Httpçš„Codeã€çŠ¶æ€å¤„ç†ç­‰ç­‰ã€‚è¿˜å¯ä»¥ç»Ÿä¸€çš„å¢åŠ è¯·æ±‚å‚æ•°ï¼Œå¦‚ç»Ÿä¸€ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½å¢åŠ ç”¨æˆ·çš„IDã€tokenä»€ä¹ˆçš„ã€‚</p>
<p><strong>CodeHandler</strong></p>
<p>å¤§éƒ¨åˆ†çš„APIè®¾è®¡éƒ½ä¼šæœ‰ç›¸åº”çš„çŠ¶æ€ç ã€Codeï¼Œä¸ºäº†æ–¹ä¾¿æ‰©å±•ï¼Œå¯ä»¥æŠŠè¿™äº›å¤„ç†Codeçš„ç±»å•ç‹¬æ”¾åœ¨è¿™é‡Œã€‚</p>
<p><strong>ErrorHandler</strong></p>
<p>è¿™ä¸ªå°±å°‘ä¸äº†äº†ï¼Œå¯¹Httpçš„é”™è¯¯è¿›è¡Œå•ç‹¬å¤„ç†ï¼ŒåŠ Logä»€ä¹ˆçš„ã€‚</p>
<p><strong>HttpHandler</strong></p>
<p>è¿™ä¸ªGroupé‡Œé¢æ”¾çš„æ˜¯çœŸæ­£å®ç°æ¥å£çš„ç±»ï¼Œå¦‚ä»€ä¹ˆUserHttpHandlerã€CommentHttpHandlerä¹‹ç±»çš„ï¼Œå°±æ˜¯å…·ä½“å®ç°äº†æ¥å£è°ƒç”¨ã€å¤„ç†è¿”å›æ•°æ®ã€å›è°ƒçš„ç±»ã€‚</p>
<p>Httpé‡Œé¢çš„å„ä¸ªGroupçš„ç±»å…¶å®éƒ½æ˜¯ç›¸äº’å…³è”çš„ï¼Œè®¾è®¡çš„æ—¶å€™å¯ä»¥å®šåˆ¶ç»Ÿä¸€çš„æ¥å£ï¼ˆProtocolï¼‰ï¼Œç„¶ååˆ›å»ºç±»å®ç°ï¼ˆconformï¼‰è¿™äº›æ¥å£ï¼Œä¹Ÿå°±æ˜¯é¢å‘æ¥å£çš„ç¼–ç¨‹ï¼Œä»¥æœ€å¤§é™åº¦çš„å‡å°‘æ¥å£å±‚çš„å„ä¸ªèŒèƒ½ä¹‹é—´çš„è€¦åˆï¼Œæ–¹ä¾¿æ‰©å±•ã€‚</p>
<hr>
<h3 id="DB"><a href="#DB" class="headerlink" title="DB"></a>DB</h3><p>ä»‹äºiOSçš„SQLiteä¸æ˜¯é‚£ä¹ˆå¥½ç”¨ï¼Œæ‰€ä»¥éå¸¸æœ‰å¿…è¦ä¸ºæ“ä½œæ•°æ®åº“çš„ç±»å»ºç«‹å•ç‹¬çš„åœ°ç›˜=ã€‚=</p>
<p><strong>DBHelper</strong>:</p>
<p>æ”¾åŸºç¡€çš„æ“ä½œæ•°æ®åº“çš„ç±»ï¼Œå¦‚ç®€å•çš„æŸ¥æ‰¾ã€æ’å…¥ã€æ›´æ–°ã€äº‹åŠ¡æ›´æ–°ç­‰ç­‰æ“ä½œï¼Œä¸ºè´Ÿè½½çš„æ•°æ®åº“ä¸šåŠ¡é€»è¾‘å°è£…åº•å±‚æ¥å£ã€‚æ¯”å¦‚å¯¹æµè¡Œçš„FMDBè¿›è¡Œå°è£…ç­‰ç­‰ã€‚</p>
<p><strong>DBService</strong>:</p>
<p>è¿™é‡Œæ”¾å…·ä½“çš„æ•°æ®åº“ä¸šåŠ¡å®ç°ç±»ï¼Œè‡³äºä¸ºä»€ä¹ˆå«â€œServiceâ€ï¼Œå› ä¸ºæˆ‘ä¹Ÿæƒ³ä¸å‡ºä»€ä¹ˆå¥½çš„åå­—äº†=ã€‚= æŒ‰ç…§è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ç»„ç»‡å³å¯ã€‚</p>
<hr>
<h3 id="Util"><a href="#Util" class="headerlink" title="Util"></a>Util</h3><p>æ”¾å¸¸ç”¨çš„å·¥å…·ç±»çš„åœ°æ–¹ã€‚å¦‚å­—ç¬¦ä¸²æ“ä½œçš„ç±»StringUtilã€æ—¶é—´è®¡ç®—æ ¼å¼åŒ–ç±»TimeUtilç­‰ï¼ŒæŒ‰å…·ä½“éœ€æ±‚è€Œå®šï¼Œè¿™ä¸ªå°±ä¸ç”¨å¤šè¯´äº†å§ã€‚</p>
<hr>
<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><p>é¡¹ç›®çš„éœ€æ±‚å¤šäº†ï¼Œä¸šåŠ¡é€»è¾‘çš„ä»£ç å°±ä¼šè¶Šæ¥è¶Šå¤šï¼Œæ€»ä¸èƒ½éƒ½æ”¾åœ¨view controlleré‡Œé¢å§ã€‚ä¸€äº›å¤šå¤„ç”¨åˆ°çš„ï¼Œæˆ–è€…éå¸¸ç‹¬ç«‹çš„ä¸šåŠ¡ä»£ç ï¼Œå®Œå…¨å¯ä»¥æŠ½ç¦»å‡ºæ¥ï¼Œå®ç°ä¸ºå•ç‹¬çš„ã€è·Ÿç•Œé¢æ— å…³çš„ä¸šåŠ¡ç±»ã€‚å› ä¸ºåšçš„äº‹å¾ˆæ‚ï¼Œæ‰€ä»¥å¹²è„†å°±å«Serviceäº†ã€‚</p>
<p><strong>AccountService</strong>ã€<strong>ShareService</strong>å°±æ˜¯è¿™ç§ç±»ã€‚è€Œä¸”å¤§éƒ¨åˆ†çš„Serviceéƒ½åº”è¯¥æ˜¯å•ä¾‹ç±»ï¼Œå¦‚<strong>AccountService</strong>ç±»å¯èƒ½ç»´æŠ¤ç€ç¨‹åºè¿è¡ŒæœŸé—´çš„è´¦æˆ·ä¿¡æ¯ï¼Œ<strong>ShareService</strong>å¯¹ç¨‹åºçš„åˆ†äº«åŠŸèƒ½åšäº†ç»Ÿä¸€å¤„ç†ç­‰ç­‰ï¼Œå…·ä½“æ€ä¹ˆç”¨å°±éšå„ä½äº†ã€‚</p>
<hr>
<h3 id="Lib"><a href="#Lib" class="headerlink" title="Lib"></a>Lib</h3><p>Libï¼Œæ”¾å„ç§ç¬¬ä¸‰æ–¹åº“ï¼Œå› é¡¹ç›®éœ€è¦ä¿®æ”¹è¿‡çš„ç¬¬ä¸‰æ–¹ç»„ä»¶ç­‰ï¼Œåƒä»€ä¹ˆå‹ç›Ÿã€QQSDKä¹‹ç±»çš„å°±å¯ä»¥æ”¾è¿™ã€‚å½“ç„¶ï¼Œä¸€äº›ä¸ä¼šåšæ”¹åŠ¨çš„åº“æœ€å¥½è¿˜æ˜¯ç”¨CocoaoPodåšç»Ÿä¸€ç®¡ç†ã€‚</p>
<hr>
<h3 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h3><p>ç»ˆäºè®²åˆ°äº†æœ€é‡è¦çš„åœ°æ–¹ã€‚</p>
<p>iOSå·¥ç¨‹ä¸­æœ€å¤šçš„æ–‡ä»¶å¾€å¾€å°±æ˜¯å„ç§Viewã€ViewControllerç±»ï¼Œä»¥å‰æ€»æ˜¯çœ‹åˆ°æœ‰äººåªåˆ›å»ºä¸¤ä¸ªGroupï¼Œä¸€ä¸ªå«Viewsï¼Œå¦ä¸€ä¸ªå«ViewControllersï¼Œç„¶åæ‰€æœ‰çš„Viewsã€ViewControlleréƒ½å¾€é‡Œé¢å¡ï¼Œç„¶åéšç€éœ€æ±‚çš„å¢åŠ ï¼Œè¿™ä¸¤ä¸ªGroupä¹Ÿè‡ƒè‚¿ä¸å ªã€‚ã€‚ã€‚</p>
<p><strong>åŠæ³•æ€»æ˜¯æœ‰çš„ã€‚å°±æ˜¯ä¸ºå·¥ç¨‹åˆ’åˆ†æ¨¡å—-Module</strong></p>
<p>å¦‚ä½•åˆ’åˆ†Moduleï¼Ÿæˆ‘è®¤ä¸ºï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹ä¸¤ç‚¹å»ºç«‹ï¼š</p>
<ol>
<li>ä»¥é¡µé¢è·³è½¬åˆ†æ”¯åˆ’åˆ†ã€‚</li>
<li>ä»¥åŠŸèƒ½åˆ’åˆ†ã€‚</li>
</ol>
<p><strong>ä»¥é¡µé¢è·³è½¬åˆ†æ”¯åˆ’åˆ†</strong></p>
<p>å°±æ˜¯æŒ‰ç…§åº”ç”¨çš„é¡µé¢è®¾è®¡ä¸ä¸šåŠ¡é€»è¾‘ï¼Œä»æœ€é¡¶çº§å¼€å§‹ï¼Œä¸€çº§ä¸€çº§é¡µé¢å¾€ä¸‹è·³è½¬ï¼Œæ‰¾å‡ºå…¶ä¸­çš„ç‹¬ç«‹åˆ†æ”¯ï¼Œå½’ä¸ºä¸€ä¸ªModuleæ¨¡å—ã€‚<br>ä¸¾ä¾‹æ¥è¯´ï¼Œåº”ç”¨ä¸»ç•Œé¢æœ‰4ä¸ªTabé¡µï¼Œå°±å…ˆåˆ†å‡ºå››ä¸ªModuleï¼Œç„¶åä¸€çº§ä¸€çº§å¾€ä¸‹è·³è½¬ï¼Œé‡åˆ°åˆ†æ”¯å°±å»ºç«‹æ–°çš„Moduleï¼Œå¦‚æ­¤é€’å½’çš„å»ºç«‹ï¼Œå°±èƒ½å¤§è‡´åˆ’åˆ†å‡ºå„ä¸ªModuleã€‚å½“ç„¶ï¼Œè¿™ä¹ˆåšæ˜¯æœ€ç²—ç³™çš„ï¼Œè¿˜è¦æ ¹æ®æƒ…å†µï¼Œå°†ä¸åŒçš„åˆ†æ”¯Moduleåˆå¹¶æˆä¸€ä¸ªModuleï¼Œç®€åŒ–ä»£ç çš„ç»„æˆã€‚æˆ‘åœ¨è¿™åªæ˜¯æä¾›ä¸ªåˆ’åˆ†Moduleçš„æ–¹æ³•ï¼Œå…·ä½“æ€ä¹ˆè®¾è®¡å°±çœ‹å„ä½è¯»è€…äº†=ã€‚=</p>
<p><strong>ä»¥åŠŸèƒ½åˆ’åˆ†</strong></p>
<p>è¿™ä¸ªå¥½ç†è§£ï¼Œæ— éå°±æ˜¯æ ¹æ®å‰æœŸé¡¹ç›®çš„åŠŸèƒ½æ¨¡å—åˆ’åˆ†å·¥ç¨‹çš„ä»£ç Moduleç»„æˆã€‚å¦‚ä»€ä¹ˆç”¨æˆ·è®¾ç½®Moduleã€è¯„è®ºModuleã€ç™»å½•Moduleç­‰ç­‰ã€‚</p>
<p>æ€»çš„æ¥æ•°ï¼Œå°±æ˜¯è¦ç”¨Moduleå°†å·¥ç¨‹çš„ä»£ç åˆ†ç±»ç®¡ç†ï¼Œæ¯ä¸ªModuleå…·æœ‰å¤§è‡´ç›¸åŒçš„ç»“æ„ï¼Œå¦‚éƒ½å¯èƒ½æœ‰æœ¬Moduleç”¨åˆ°çš„Viewã€ViewControllerï¼Œè‡ªå®šä¹‰çš„ç±»Classç­‰ç­‰ï¼Œå°±æ˜¯è¯´ï¼ŒæŒ‰ç…§èŒèƒ½å¯¹ä»£ç åˆ’åˆ†ï¼Œé¿å…å°†æ‰€æœ‰çš„ç±»éƒ½å †åœ¨ä¸€èµ·ï¼Œä¹Ÿå¥½åº”å¯¹æ–°çš„éœ€æ±‚ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å•°å•°å—¦å—¦è¯´äº†ä¸€å¤§å †ï¼Œæƒ³å¿…å„ä½éƒ½çœ‹çƒ¦äº†å§=ã€‚=åˆšå¼€å§‹å†™åšå®¢ï¼Œå†™åˆ°ä¸€ä¸ªåœ°æ–¹ï¼Œåˆä¼šå¼•å‡ºå¦ä¸€å—ï¼Œå†™ç€å†™ç€å®¹æ˜“å†™åäº†ã€‚</p>
<p>å†™ä¹‹å‰æˆ‘ä¹Ÿå¤§è‡´æœäº†ä¸€ä¸‹ï¼Œå‘ç°ç½‘ä¸Šç›¸å…³çš„èµ„æ–™å¥½å°‘ï¼Œä½†æ˜¯å®é™…çš„ç»éªŒå‘Šè¯‰æˆ‘ï¼Œé¡¹ç›®å·¥ç¨‹çš„ç›®å½•ç»“æ„éå¸¸é‡è¦ï¼Œæ— è®ºæ˜¯å¯¹å¼€å‘è¿˜æ˜¯å¯¹åæœŸçš„ç»´æŠ¤ï¼Œæ‰€ä»¥æƒ³ç€åº”è¯¥å†™ç¯‡ä¸œè¥¿ï¼Œåˆ†äº«æˆ‘è‡ªå·±çš„ç»éªŒç»™å¤§å®¶ï¼Œæœ‰å•¥é—®é¢˜ï¼Œå¤šææ„è§å•Š~~~</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è¿™æ®µæ—¶é—´ä¸€ç›´åœ¨åšiOSçš„é¡¹ç›®ï¼ˆ&lt;a href=&quot;https://itunes.apple.com/cn/app/qing-ju-yin-le-quan-guo-zui/id913235479?mt=8&quot;&gt;é’æ¡”éŸ³ä¹App&lt;/a&gt;ï¼‰ï¼Œéšç€ä»£ç é‡çš„ä¸Šå‡ï¼Œé€æ¸æ„è¯†åˆ°é¡¹ç›®çš„æ•´ä½“ç›®å½•ç»“æ„åˆ’åˆ†æ˜¯å¤šä¹ˆé‡è¦ï¼Œæ¸…æ™°çš„ç›®å½•ç»“æ„ï¼Œèƒ½å¤Ÿæ›´å¥½çš„åº”å¯¹æ–°çš„éœ€æ±‚ï¼Œæ›´å®¹æ˜“é‡æ„ã€‚è™½ç„¶ä¸€ç›´éƒ½æ˜¯ä¸€ä¸ªäººåœ¨åš=ã€‚=ï¼Œä½†æ˜¯è¿˜æ˜¯æ·±æ·±åœ°ä½“ä¼šåˆ°ç›®å½•ç»“æ„çš„é‡è¦æ€§ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="iOS" scheme="http://tutuge.me/categories/iOS/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="iOS" scheme="http://tutuge.me/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>Androidå¼€æºåº“-LinkTextView-åŸåˆ›</title>
    <link href="http://tutuge.me/2014/11/02/LinkTextView-Android%E5%BC%80%E6%BA%90%E5%BA%93-%E5%8E%9F%E5%88%9B/"/>
    <id>http://tutuge.me/2014/11/02/LinkTextView-Androidå¼€æºåº“-åŸåˆ›/</id>
    <published>2014-11-01T18:34:46.000Z</published>
    <updated>2016-08-07T06:12:55.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿‘æ¥å› ä¸ºé¡¹ç›®çš„ç¼˜æ•…ï¼Œä»”ç»†ç ”ç©¶äº†ä¸€ä¸‹å¦‚ä½•åœ¨Androidçš„TextViewé‡Œé¢ç»‘å®šå¯ä»¥ç‚¹å‡»çš„é“¾æ¥ï¼Œå¹¶ä¸”å®šåˆ¶é“¾æ¥çš„é¢œè‰²ï¼ŒåŒ…æ‹¬æ­£å¸¸çŠ¶æ€ã€æŒ‰ä¸‹å»æ—¶çš„æ–‡å­—ã€èƒŒæ™¯çš„é¢œè‰²ï¼Œå½“ç„¶ï¼Œè¿˜æœ‰ç‚¹å‡»åçš„å›è°ƒã€‚</p>
<p>ä¸ºäº†ä»¥åæ–¹ä¾¿è‡ªå·±ï¼Œä¹Ÿä¸ºäº†æ–¹ä¾¿æ›´å¤šçš„äººï¼Œå°±æŠŠè¿™äº›å°è£…æˆäº†ä¸€ä¸ªç®€å•çš„å¼€æºåº“ï¼Œä¹Ÿç®—æ˜¯æˆ‘è‡ªå·±çš„<strong><em>ç¬¬ä¸€ä¸ªå¼€æºåº“</em></strong>å§ã€‚</p>
<h2 id="LinkTextView"><a href="#LinkTextView" class="headerlink" title="LinkTextView"></a>LinkTextView</h2><p>åç§°ï¼š<a href="https://github.com/zekunyan/LinkTextView" target="_blank" rel="external">LinkTextView</a>ã€‚å–œæ¬¢çš„è¯å°±Starä¸€ä¸‹å§ã€‚</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p><img src="http://zorrochen.qiniudn.com/LinkTextView_Sample.gif" alt="ç¤ºä¾‹"></p>
<a id="more"></a>
<h3 id="åŠŸèƒ½ï¼š"><a href="#åŠŸèƒ½ï¼š" class="headerlink" title="åŠŸèƒ½ï¼š"></a>åŠŸèƒ½ï¼š<br></h3><ol>
<li>å¯ä»¥æ–¹ä¾¿çš„å¯¹TextViewé‡Œé¢çš„æ–‡å­—å¢åŠ å¯ç‚¹å‡»é“¾æ¥ï¼Œå¹¶ä¸”ç»‘å®šå›è°ƒã€‚</li>
<li>å¯ä»¥ä¸ºæ¯ä¸ªé“¾æ¥<strong>å•ç‹¬</strong>è®¾ç½®<strong>æ–‡å­—</strong>ã€é“¾æ¥<strong>èƒŒæ™¯</strong>çš„<strong>æ­£å¸¸</strong>ã€<strong>æŒ‰ä¸‹</strong>çŠ¶æ€ä¸‹çš„é¢œè‰²ã€‚</li>
<li>å¯ä»¥ä¸ºæ¯ä¸ªé“¾æ¥ç»‘å®šä»»æ„ç±»å‹çš„â€œé™„ä»¶â€å¯¹è±¡ï¼Œä½œä¸ºç‚¹å‡»é“¾æ¥æ—¶çš„å›è°ƒå‚æ•°ã€‚</li>
</ol>
<h2 id="è®²è§£"><a href="#è®²è§£" class="headerlink" title="è®²è§£"></a>è®²è§£</h2><p>ä¸‹é¢åˆ†é‡ç‚¹è®²è§£ä¸€ä¸‹ã€‚</p>
<h3 id="1-ä¸ºæ–‡å­—å¢åŠ å¯ç‚¹å‡»é“¾æ¥ï¼Œç»‘å®šå›è°ƒã€‚"><a href="#1-ä¸ºæ–‡å­—å¢åŠ å¯ç‚¹å‡»é“¾æ¥ï¼Œç»‘å®šå›è°ƒã€‚" class="headerlink" title="1. ä¸ºæ–‡å­—å¢åŠ å¯ç‚¹å‡»é“¾æ¥ï¼Œç»‘å®šå›è°ƒã€‚"></a>1. ä¸ºæ–‡å­—å¢åŠ å¯ç‚¹å‡»é“¾æ¥ï¼Œç»‘å®šå›è°ƒã€‚</h3><p>ä¸ºæ–‡å­—å¢åŠ é“¾æ¥ï¼Œå·²ç»æ˜¯è€ç”Ÿå¸¸è°ˆäº†ï¼ŒçœŸæ˜¯ä¸€æœä¸€å¤§æŠŠï¼Œä¸è¿‡åœ¨è¿™é‡Œè¿˜æ˜¯ç®€å•è®²ä¸€ä¸‹ã€‚</p>
<p>ç”¨è¿‡TextViewåº”è¯¥éƒ½çŸ¥é“è¿™ä¸ªæ¥å£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setText</span> <span class="params">(CharSequence text)</span></span></div></pre></td></tr></table></figure>
<p>å…¶ä¸­CharSequenceæ¥å£çš„å­æ¥å£é‡Œé¢æœ‰Spannableï¼Œè€Œç”±è¿™ä¸ªæ¥å£æ´¾ç”Ÿå‡ºæ¥çš„ç±»SpannableStringï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥å¯¹TextViewé‡Œé¢çš„æ–‡å­—åšé™„åŠ æ•ˆæœçš„åŸå› ã€‚å¦‚æ”¹å˜é¢œè‰²ã€å¢åŠ è¶…é“¾æ¥ç­‰ï¼Œæœ‰å…´è¶£çš„å„ä½å¯ä»¥å»ä»”ç»†æŸ¥æŸ¥ã€‚ä¸‹é¢ç®€å•çš„è¯´è¯´æ€ä¹ˆåŠ å¯ç‚¹å‡»çš„é“¾æ¥ã€‚</p>
<p><strong>é¦–å…ˆåˆ›å»ºSpannableString</strong>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">SpannableString text = <span class="keyword">new</span> SpannableString(<span class="string">"LinkTextView dadada"</span>);</div></pre></td></tr></table></figure>
<p><strong>ç»‘å®šClickableSpanå›è°ƒ</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ClickableSpan clickableSpan = <span class="keyword">new</span> ClickableSpan() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">        <span class="comment">//ç‚¹å‡»äº†é“¾æ¥ï¼Œåšä½ æƒ³å¹²çš„äº‹å§=ã€‚=</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">text.setSpan(clickableSpan, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<p><strong>æœ€åå†setText</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">textView.setText(text);</div></pre></td></tr></table></figure>
<p>çœ‹ï¼Œç»‘å®šå¯ä»¥ç‚¹å‡»çš„é“¾æ¥å°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p>
<h3 id="2-æ”¹å˜æ­£å¸¸ã€æŒ‰ä¸‹æ—¶çš„æ–‡å­—ã€é“¾æ¥èƒŒæ™¯é¢œè‰²ã€‚"><a href="#2-æ”¹å˜æ­£å¸¸ã€æŒ‰ä¸‹æ—¶çš„æ–‡å­—ã€é“¾æ¥èƒŒæ™¯é¢œè‰²ã€‚" class="headerlink" title="2. æ”¹å˜æ­£å¸¸ã€æŒ‰ä¸‹æ—¶çš„æ–‡å­—ã€é“¾æ¥èƒŒæ™¯é¢œè‰²ã€‚"></a>2. æ”¹å˜æ­£å¸¸ã€æŒ‰ä¸‹æ—¶çš„æ–‡å­—ã€é“¾æ¥èƒŒæ™¯é¢œè‰²ã€‚</h3><p>å¾€å¾€ç³»ç»Ÿé»˜è®¤çš„é“¾æ¥é¢œè‰²æ˜¯ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚çš„ï¼Œæ‰€ä»¥æœ€å¥½èƒ½å¯¹é“¾æ¥çš„æ–‡å­—ã€èƒŒæ™¯çš„æŒ‰ä¸‹ã€æ¾å¼€æ—¶çš„é¢œè‰²åšå®šåˆ¶ã€‚</p>
<p><strong><em>ä½†æ˜¯å¥½å‘=ã€‚=ï¼ŒGoogleå±…ç„¶æ²¡æœ‰ä¸ºClickableSpanå¢åŠ æŒ‰ä¸‹æ—¶çš„å›è°ƒ</em></strong></p>
<p>é‚£å°±åªå¥½è‡ªå·±é€ è½®å­äº†ã€‚</p>
<h4 id="é¦–å…ˆ"><a href="#é¦–å…ˆ" class="headerlink" title="é¦–å…ˆ"></a>é¦–å…ˆ</h4><p>å¿…é¡»è¦èƒ½è·å–åˆ°é“¾æ¥æŒ‰ä¸‹æ—¶çš„å›è°ƒï¼Œåº”è¯¥æ˜¯onTouchä»€ä¹ˆçš„ï¼Œäºæ˜¯ï¼Œå°±æŸ¥åˆ°äº†ç±»ï¼šLinkMovementMethodã€‚<br>åœ¨TextViewä¸­å¯ä»¥ç”¨æ–¹æ³•ï¼špublic final void setMovementMethod (MovementMethod movement)è®¾å®šç›‘å¬ï¼Œè€ŒLinkMovementMethodç±»é‡Œé¢å°±å¯ä»¥ç›‘å¬åˆ°é“¾æ¥çš„onTouchï¼</p>
<p><strong>LinkMovementMethodçš„onTouchå°±æ˜¯ä»‹ä¸ªæ ·å­çš„</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">boolean</span>	 <span class="title">onTouchEvent</span><span class="params">(TextView textView, Spannable spannable, MotionEvent event)</span></span></div></pre></td></tr></table></figure>
<p>äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡eventæ¥åˆ¤æ–­æ˜¯æŒ‰ä¸‹è¿˜æ˜¯ç§»åŠ¨ç­‰ç­‰æ“ä½œã€‚<br>ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œè¿™é‡Œçš„spannableæ˜¯æ•´ä¸ªTextViewå…¨éƒ¨çš„æ–‡å­—ï¼Œæ‰€ä»¥ï¼Œåªèƒ½é€šè¿‡eventé‡Œé¢çš„xã€yåæ ‡ï¼Œæ‰¾åˆ°å…·ä½“ç‚¹å‡»çš„æ˜¯å“ªä¸ªé“¾æ¥ã€‚è¿™é‡Œï¼Œè¦æ„Ÿè°¢stack overflowä¸Šçš„å¤§ç¥çš„<a href="http://stackoverflow.com/questions/20856105/change-the-text-color-of-a-clickablespan-when-pressed" target="_blank" rel="external">å¸–å­</a>ã€‚</p>
<p>å…·ä½“çš„æ‰¾ç‚¹å‡»é“¾æ¥çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> TouchableSpan <span class="title">getPressedSpan</span><span class="params">(TextView textView, Spannable spannable, MotionEvent event)</span> </span>&#123;</div><div class="line">    <span class="comment">//è·å–ç‚¹å‡»çš„xã€yåæ ‡</span></div><div class="line">    <span class="keyword">int</span> x = (<span class="keyword">int</span>) event.getX();</div><div class="line">    <span class="keyword">int</span> y = (<span class="keyword">int</span>) event.getY();</div><div class="line">    <span class="comment">//å‡å»Padding</span></div><div class="line">    x -= textView.getTotalPaddingLeft();</div><div class="line">    y -= textView.getTotalPaddingTop();</div><div class="line">    <span class="comment">//åŠ ä¸Šæ»šåŠ¨çš„åç§»</span></div><div class="line">    x += textView.getScrollX();</div><div class="line">    y += textView.getScrollY();</div><div class="line">    <span class="comment">//è·å–ç¬¬å‡ è¡Œã€ä»¥åŠåç§»</span></div><div class="line">    Layout layout = textView.getLayout();</div><div class="line">    <span class="keyword">int</span> line = layout.getLineForVertical(y);</div><div class="line">    <span class="keyword">int</span> off = layout.getOffsetForHorizontal(line, x);</div><div class="line">    <span class="comment">//è·å–çœŸæ­£ç‚¹å‡»çš„é“¾æ¥</span></div><div class="line">    TouchableSpan[] link = spannable.getSpans(off, off, TouchableSpan.class);</div><div class="line">    TouchableSpan touchedSpan = <span class="keyword">null</span>;</div><div class="line">    <span class="keyword">if</span> (link.length &gt; <span class="number">0</span>) &#123;</div><div class="line">        touchedSpan = link[<span class="number">0</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> touchedSpan;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åˆ°æ­¤ï¼Œæˆ‘ä»¬å·²ç»èƒ½è·å–åˆ°é“¾æ¥çš„ç‚¹å‡»çŠ¶æ€ï¼Œå¹¶ä¸”æ•æ‰åˆ°å…·ä½“ç‚¹å‡»çš„ClickableSpanã€‚</p>
<h4 id="æ¥ç€"><a href="#æ¥ç€" class="headerlink" title="æ¥ç€"></a>æ¥ç€</h4><p>å°±æ˜¯æ”¹å˜é“¾æ¥çš„æ–‡å­—ã€èƒŒæ™¯é¢œè‰²ã€‚</p>
<p>ClickableSpançš„æ–¹æ³•é‡Œé¢ï¼Œé™¤äº†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View widget)</span></span>;</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰å°±æ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateDrawState</span><span class="params">(TextPaint textPaint)</span></span>;</div></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯æ›´æ–°æ–‡å­—æ¸²æŸ“æ•ˆæœçš„ã€‚æˆ‘ä»¬ç”¨å¦‚ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼Œå°±èƒ½å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setColor</span> <span class="params">(<span class="keyword">int</span> color)</span></span>;</div><div class="line">bgColorå±æ€§</div></pre></td></tr></table></figure>
<h4 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h4><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥æ•æ‰åˆ°é“¾æ¥çš„ç‚¹å‡»çŠ¶æ€ï¼Œèƒ½è·å–åˆ°çœŸæ­£çš„ç‚¹å‡»çš„é“¾æ¥ï¼Œè¿˜æœ‰èƒ½åˆ·æ–°é“¾æ¥çš„é¢œè‰²äº†ï¼Œç›¸ä¿¡èªæ˜çš„ä½ ä¸€å®šèƒ½è‡ªå·±ç¢ç£¨å‡ºæ¥ï¼Œæ€ä¹ˆæ ·å®ç°æ–‡ç« å¼€å¤´çš„æ•ˆæœã€‚=v=</p>
<h4 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h4><ol>
<li>Androidå®˜æ–¹æ–‡æ¡£ã€‚</li>
<li>StackOverFlowçš„ï¼š<a href="http://stackoverflow.com/questions/20856105/change-the-text-color-of-a-clickablespan-when-pressed" target="_blank" rel="external">Change the text color of a ClickableSpan when pressedã€‚</a></li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;è¿‘æ¥å› ä¸ºé¡¹ç›®çš„ç¼˜æ•…ï¼Œä»”ç»†ç ”ç©¶äº†ä¸€ä¸‹å¦‚ä½•åœ¨Androidçš„TextViewé‡Œé¢ç»‘å®šå¯ä»¥ç‚¹å‡»çš„é“¾æ¥ï¼Œå¹¶ä¸”å®šåˆ¶é“¾æ¥çš„é¢œè‰²ï¼ŒåŒ…æ‹¬æ­£å¸¸çŠ¶æ€ã€æŒ‰ä¸‹å»æ—¶çš„æ–‡å­—ã€èƒŒæ™¯çš„é¢œè‰²ï¼Œå½“ç„¶ï¼Œè¿˜æœ‰ç‚¹å‡»åçš„å›è°ƒã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä»¥åæ–¹ä¾¿è‡ªå·±ï¼Œä¹Ÿä¸ºäº†æ–¹ä¾¿æ›´å¤šçš„äººï¼Œå°±æŠŠè¿™äº›å°è£…æˆäº†ä¸€ä¸ªç®€å•çš„å¼€æºåº“ï¼Œä¹Ÿç®—æ˜¯æˆ‘è‡ªå·±çš„&lt;strong&gt;&lt;em&gt;ç¬¬ä¸€ä¸ªå¼€æºåº“&lt;/em&gt;&lt;/strong&gt;å§ã€‚&lt;/p&gt;
&lt;h2 id=&quot;LinkTextView&quot;&gt;&lt;a href=&quot;#LinkTextView&quot; class=&quot;headerlink&quot; title=&quot;LinkTextView&quot;&gt;&lt;/a&gt;LinkTextView&lt;/h2&gt;&lt;p&gt;åç§°ï¼š&lt;a href=&quot;https://github.com/zekunyan/LinkTextView&quot;&gt;LinkTextView&lt;/a&gt;ã€‚å–œæ¬¢çš„è¯å°±Starä¸€ä¸‹å§ã€‚&lt;/p&gt;
&lt;h3 id=&quot;Example&quot;&gt;&lt;a href=&quot;#Example&quot; class=&quot;headerlink&quot; title=&quot;Example&quot;&gt;&lt;/a&gt;Example&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;http://zorrochen.qiniudn.com/LinkTextView_Sample.gif&quot; alt=&quot;ç¤ºä¾‹&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Android" scheme="http://tutuge.me/categories/Android/"/>
    
    
      <category term="åŸåˆ›" scheme="http://tutuge.me/tags/%E5%8E%9F%E5%88%9B/"/>
    
      <category term="Android" scheme="http://tutuge.me/tags/Android/"/>
    
      <category term="å¼€æº" scheme="http://tutuge.me/tags/%E5%BC%80%E6%BA%90/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬ä¸€ç¯‡Blog</title>
    <link href="http://tutuge.me/2014/11/01/%E7%AC%AC%E4%B8%80%E7%AF%87Blog/"/>
    <id>http://tutuge.me/2014/11/01/ç¬¬ä¸€ç¯‡Blog/</id>
    <published>2014-10-31T16:13:15.000Z</published>
    <updated>2016-08-07T06:21:05.000Z</updated>
    
    <content type="html"><![CDATA[<p>æ‹–äº†å¾ˆä¹…ï¼Œç»ˆäºå¼€å§‹å†™åšå®¢äº†ã€‚<br>ä¸€ç›´è§‰å¾—è‡ªå·±çš„çŸ¥è¯†å‚¨å¤‡ä¸å¤Ÿï¼Œä¸€ç›´éƒ½åœ¨å­¦ä¹ ï¼Œä¸€ç›´éƒ½åœ¨ç§¯ç´¯ã€‚ï¼ˆå…¶å®å°±æ˜¯æ‡’å¥½å—=ã€‚=ï¼‰</p>
<p>è¯´ç‚¹å•¥å‘¢ï¼Œæƒ³åˆ°å•¥å°±è¯´å•¥å§~</p>
<a id="more"></a>
<p>ä»å°å°±å–œæ¬¢æ¨¡å‹ã€ä¹é«˜ç§¯æœ¨ï¼Œå–œæ¬¢æ‹†ä¸œè¥¿ï¼Œå°è±¡æœ€æ·±çš„å°±æ˜¯æŠŠå®¶é‡Œçš„é«˜çº§å½•éŸ³æœºæ‹†äº†ï¼Œè£…ä¸å›å»ï¼Œå¡åˆ°äº†åºŠåº•ä¸‹ã€‚ã€‚ã€‚</p>
<p>ä¸Šäº†å­¦ä¹‹åï¼Œåˆå¼€å§‹æ£é¼“å››é©±è½¦ï¼Œè‡ªå·±åšé©¬è¾¾ï¼Œç»•çº¿åœˆï¼Œå®¶é‡Œé›¶ä»¶ä¸€å¤§å †ï¼Œä¸²è”ä¸€å †ç”µæ± ï¼Œç»„è£…é¥æ§è½¦ï¼Œå”¯ä¸€çš„é—æ†¾ï¼Œå°±æ˜¯æ²¡æœ‰åšæˆé¥æ§é£æœºï¼ˆæ²¡é’±=ã€=ï¼‰ã€‚</p>
<p>æ¥ç€ï¼Œå®¶é‡Œæœ‰äº†ç”µè„‘ï¼ï¼ï¼è¿™è¦æ„Ÿè°¢è€çˆ¹ï¼Œå½“æ—¶èŠ±äº†ä¸€ä¸‡å¤šï¼Œæ¶²æ™¶æ˜¾ç¤ºå™¨ï¼Œåˆšä¸Šå¸‚çš„å¥”è…¾4å•Šï¼</p>
<p>äºæ˜¯ï¼Œæˆ‘åˆå¼€å§‹æ‹†ç”µè„‘ã€‚ã€‚ã€‚æ¢æ˜¾å¡ã€è¶…é¢‘ï¼Œè·‘åˆ†ï¼Œå†è¶…é¢‘ï¼Œå†è·‘åˆ†ï¼Œ3DMarkå°±æ˜¯ä¿ºçš„ç¥–å®—å•Š~</p>
<p>ç»ˆäºï¼Œèµ°ä¸Šäº†<strong>ç¼–ç¨‹</strong>è¿™æ¡â€œ<strong>ä¸å½’è·¯</strong>â€ï¼Œä¹‰æ— åé¡¾ï¼Œä¸€ç›´åˆ°äº†ç°åœ¨ã€‚</p>
<p>ç”¨Dev-C++æŠ˜è…¾Cè¯­è¨€ï¼Œæ•°æ®ç»“æ„ã€ç®—æ³•ï¼Œæ¥ç€åˆæ˜¯C++ï¼ŒWindow APIï¼ŒQTï¼ˆè¿™ä¸ªçœŸè§‰å¾—ä¸é”™ï¼‰ï¼ŒMFCï¼ˆè½¯ä»¶è¯¾è®¾ï¼‰ï¼ŒJavaï¼ŒPythonï¼ŒAndroidï¼ˆä¸Šçº¿äº†å‡ ä¸ªå°åº”ç”¨ï¼Œæ‹¿äº†Googleå…¨å›½å¤§å­¦ç”ŸAndroidåº”ç”¨å¼€å‘å¤§èµ›åä¸­åœ°åŒºä¸‰ç­‰å¥–ï¼‰ï¼ŒiOSï¼ˆä¸Šçº¿åº”ç”¨ï¼Œé’æ¡”éŸ³ä¹ï¼‰ï¼ŒLinuxï¼Œè¿˜æœ‰å„ç§MySQLã€MongoDBç­‰æ•°æ®åº“çš„çº ç»“ï¼Œçœ‹å„ç§åšå®¢ã€‚ã€‚ã€‚</p>
<p>æ¯å¤©çœ‹çš„å¾ˆå¤šï¼Œæƒ³çš„ä¹Ÿä¸å°‘ï¼Œä½†æ˜¯ç»ˆç©¶ä¸å¤Ÿç²¾é€šï¼Œè·¯è¿˜å¾ˆé•¿å•Š~</p>
<p>å½“ç„¶ï¼Œæœ€æ„Ÿè°¢çš„å°±æ˜¯æˆ‘çš„å¥³æœ‹å‹~é™ˆå› ç´ ~</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‹–äº†å¾ˆä¹…ï¼Œç»ˆäºå¼€å§‹å†™åšå®¢äº†ã€‚&lt;br&gt;ä¸€ç›´è§‰å¾—è‡ªå·±çš„çŸ¥è¯†å‚¨å¤‡ä¸å¤Ÿï¼Œä¸€ç›´éƒ½åœ¨å­¦ä¹ ï¼Œä¸€ç›´éƒ½åœ¨ç§¯ç´¯ã€‚ï¼ˆå…¶å®å°±æ˜¯æ‡’å¥½å—=ã€‚=ï¼‰&lt;/p&gt;
&lt;p&gt;è¯´ç‚¹å•¥å‘¢ï¼Œæƒ³åˆ°å•¥å°±è¯´å•¥å§~&lt;/p&gt;
    
    </summary>
    
      <category term="å…¶å®ƒ" scheme="http://tutuge.me/categories/%E5%85%B6%E5%AE%83/"/>
    
    
      <category term="æ‚çƒ©" scheme="http://tutuge.me/tags/%E6%9D%82%E7%83%A9/"/>
    
  </entry>
  
</feed>
